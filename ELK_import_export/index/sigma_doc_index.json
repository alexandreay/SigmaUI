{"Wp3knmUBtApo-eN_puXG": {"category": 11, "updated": "2018-10-25T10:10:15.000Z", "hash": "16dea18de423981c907481a59f86645f496331ac976b03d3603c783d12e0b16e", "title": "Secure Deletion with SDelete", "permission_id": 3, "title_keyword": "Secure Deletion with SDelete", "released": "2017-06-14T14:55:32.000Z", "sigma_text": "title: Secure Deletion with SDelete\r\nstatus: experimental\r\ndescription: Detects renaming of file while deletion with SDelete tool\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1107\r\n- attack.t1116\r\n- attack.s0195\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4656\"\r\n    - \"4663\"\r\n    - \"4658\"\r\n    ObjectName:\r\n    - '*.AAA'\r\n    - '*.ZZZ'\r\n  condition: selection\r\nfalsepositives:\r\n- Legitime usage of SDelete\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_sdelete.yml", "sigma_text_keyword": "title: Secure Deletion with SDelete\r\nstatus: experimental\r\ndescription: Detects renaming of file while deletion with SDelete tool\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1107\r\n- attack.t1116\r\n- attack.s0195\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4656\"\r\n    - \"4663\"\r\n    - \"4658\"\r\n    ObjectName:\r\n    - '*.AAA'\r\n    - '*.ZZZ'\r\n  condition: selection\r\nfalsepositives:\r\n- Legitime usage of SDelete\r\nlevel: medium"}, "g53knmUBtApo-eN_g98g": {"category": 15, "updated": "2018-10-31T10:42:53.000Z", "hash": "9dd68a17edb2e65227a7455946690e6eb34d8c300fcc7cd7ebb98b9f08fd9583", "title": "Java Running with Remote Debugging", "permission_id": 3, "title_keyword": "Java Running with Remote Debugging", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Java Running with Remote Debugging\r\ndescription: Detcts a JAVA process running with remote debugging allowing more than just localhost to connect\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: '*transport=dt_socket,address=*'\r\n  exclusion:\r\n  - CommandLine: '*address=127.0.0.1*'\r\n  - CommandLine: '*address=localhost*'\r\n  condition: selection and not exclusion\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": "/windows/sysmon/sysmon_vul_java_remote_debugging.yml", "sigma_text_keyword": "title: Java Running with Remote Debugging\r\ndescription: Detcts a JAVA process running with remote debugging allowing more than just localhost to connect\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: '*transport=dt_socket,address=*'\r\n  exclusion:\r\n  - CommandLine: '*address=127.0.0.1*'\r\n  - CommandLine: '*address=localhost*'\r\n  condition: selection and not exclusion\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "oJ3knmUBtApo-eN_iuA4": {"category": 15, "updated": "2018-11-23T14:51:31.000Z", "hash": "913ac02e63fb886b6d0cc1e483df66173f2d2d1e06ec5c1d7f890dc846d2a5b6", "title": "Microsoft Workflow Compiler", "permission_id": 3, "title_keyword": "Microsoft Workflow Compiler", "released": "2018-08-18T05:53:28.000Z", "sigma_text": "title: Microsoft Workflow Compiler\r\nstatus: experimental\r\ndescription: Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.\r\nauthor: Nik Seetharaman\r\nreferences:\r\n- https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\Microsoft.Workflow.Compiler.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Legitimate MWC use (unlikely in modern enterprise environments)\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.Defense Evasion", "git_filepath": "/windows/sysmon/sysmon_workflow_compiler.yml", "sigma_text_keyword": "title: Microsoft Workflow Compiler\r\nstatus: experimental\r\ndescription: Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.\r\nauthor: Nik Seetharaman\r\nreferences:\r\n- https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\Microsoft.Workflow.Compiler.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Legitimate MWC use (unlikely in modern enterprise environments)\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.Defense Evasion"}, "2Z3knmUBtApo-eN_i-CM": {"category": 8, "updated": "2018-10-24T09:36:25.000Z", "hash": "d0db06dc46ee2b4c9b2e0844ae4685e2db0b2ca471cfe8f630365bb75a96112b", "title": "Registry Persistence Mechanisms", "permission_id": 3, "title_keyword": "Registry Persistence Mechanisms", "released": "2018-04-20T10:14:31.000Z", "sigma_text": "title: Registry Persistence Mechanisms\r\ndescription: Detects persistence registry keys. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection_reg1d\"\r\nreferences:\r\n- https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\r\ndate: 2018/04/11\r\nauthor: Karneades\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_reg1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\*\\GlobalFlag'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\ReportingMode'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\MonitorProcess'\r\n    EventType: SetValue\r\n  condition: selection_reg1\r\nfalsepositives:\r\n- unknown\r\nlevel: critical", "git_filepath": null, "sigma_text_keyword": "title: Registry Persistence Mechanisms\r\ndescription: Detects persistence registry keys. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection_reg1d\"\r\nreferences:\r\n- https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\r\ndate: 2018/04/11\r\nauthor: Karneades\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_reg1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\*\\GlobalFlag'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\ReportingMode'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\MonitorProcess'\r\n    EventType: SetValue\r\n  condition: selection_reg1\r\nfalsepositives:\r\n- unknown\r\nlevel: critical"}, "Up3knmUBtApo-eN_oOTJ": {"category": 15, "updated": "2019-02-26T13:31:07.000Z", "hash": "fad2ec68d72bc3cc48bf83476928f9b30cc1bf1c8d5e94b660764434742b0307", "title": "WScript or CScript Dropper", "permission_id": 3, "title_keyword": "WScript or CScript Dropper", "released": "2017-05-05T15:30:46.000Z", "sigma_text": "title: WScript or CScript Dropper\r\nstatus: experimental\r\ndescription: Detects wscript/cscript executions of scripts located in user directories\r\nauthor: Margaritis Dimitrios, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    CommandLine:\r\n    - '* C:\\Users\\*.jse *'\r\n    - '* C:\\Users\\*.vbe *'\r\n    - '* C:\\Users\\*.js *'\r\n    - '* C:\\Users\\*.vba *'\r\n    - '* C:\\Users\\*.vbs *'\r\n    - '* C:\\ProgramData\\*.jse *'\r\n    - '* C:\\ProgramData\\*.vbe *'\r\n    - '* C:\\ProgramData\\*.js *'\r\n    - '* C:\\ProgramData\\*.vba *'\r\n    - '* C:\\ProgramData\\*.vbs *'\r\n  falsepositive:\r\n    ParentImage: '*\\winzip*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Winzip\r\n- Other self-extractors\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_malware_script_dropper.yml", "sigma_text_keyword": "title: WScript or CScript Dropper\r\nstatus: experimental\r\ndescription: Detects wscript/cscript executions of scripts located in user directories\r\nauthor: Margaritis Dimitrios, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    CommandLine:\r\n    - '* C:\\Users\\*.jse *'\r\n    - '* C:\\Users\\*.vbe *'\r\n    - '* C:\\Users\\*.js *'\r\n    - '* C:\\Users\\*.vba *'\r\n    - '* C:\\Users\\*.vbs *'\r\n    - '* C:\\ProgramData\\*.jse *'\r\n    - '* C:\\ProgramData\\*.vbe *'\r\n    - '* C:\\ProgramData\\*.js *'\r\n    - '* C:\\ProgramData\\*.vba *'\r\n    - '* C:\\ProgramData\\*.vbs *'\r\n  falsepositive:\r\n    ParentImage: '*\\winzip*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Winzip\r\n- Other self-extractors\r\nlevel: high"}, "2J3knmUBtApo-eN_i-B8": {"category": 8, "updated": "2018-10-26T14:44:17.000Z", "hash": "9aa44486e66fd6af43819cc15c3cf98f99d7b559fe817db1d8340de0f5db8c0e", "title": "Schtask Creation (Sysmon).", "permission_id": 3, "title_keyword": "Schtask Creation (Sysmon).", "released": "2018-09-07T12:34:11.000Z", "sigma_text": "title: Schtask Creation (Sysmon).\r\ndescription: Detects usage of schtask usage.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - schtask.exe\r\n  condition: selection\r\nfields:\r\n- Image\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Schtask Creation (Sysmon).\r\ndescription: Detects usage of schtask usage.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - schtask.exe\r\n  condition: selection\r\nfields:\r\n- Image\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "r25ULmkBFVBAemBcOlaW": {"category": 8, "updated": "2019-02-27T13:11:13.000Z", "hash": "c859df20682d2fb226ed691d398225cef11e77c7a4078dfda5b53abd1e68ce19", "title": "Metasploit Framework User Agents (Proxy).", "permission_id": 3, "title_keyword": "Metasploit Framework User Agents (Proxy).", "released": "2019-02-27T09:42:30.000Z", "sigma_text": "title: Metasploit Framework User Agents (Proxy).\r\ndescription: Metasploit Framework User Agents Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/ekjCavTq\r\ndate: 2019/02/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\r\n    - Mozilla/5.0\r\n    - Mozilla/4.0 (compatible; Metasploit RSPEC)\r\n    - Mozilla/5.0 (iPad; CPU OS 9_3_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13E238 Safari/601.1\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/Projects/NSPR\r\n    - Mozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Safari/604.1\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/5.0 (iPod touch; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B150 Safari/602.1\r\n    - Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4\r\n    - Mozilla/5.0 (iPad; CPU OS 8_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12H143 Safari/600.1.4\r\n    - Mozilla/5.0 (iPad; CPU OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F69 Safari/600.1.4\r\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\n    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0 Iceweasel/31.7.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/43.0.2357.81 Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.125 Safari/537.36\r\n    - Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.3 (KHTML, like Gecko) Chrome/6.0.472.63 Safari/534.3\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.0\r\n    - Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.152 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.79 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/7.1.7 Safari/537.85.16\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/600.6.3 (KHTML, like Gecko) Version/7.1.6 Safari/537.85.15\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.78.2 (KHTML, like Gecko) Version/6.1.6 Safari/537.78.2\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.59.10 (KHTML, like Gecko) Version/5.1.9 Safari/534.59.10\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Safari/604.1.38\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0.1 Safari/602.2.14\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.11 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.11\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.6.3 (KHTML, like Gecko) Version/8.0.6 Safari/600.6.3\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.5.17 (KHTML, like Gecko) Version/8.0.6 Safari/600.6.3\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.5.17 (KHTML, like Gecko) Version/8.0.5 Safari/600.5.17\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/600.4.10 (KHTML, like Gecko) Version/8.0.4 Safari/600.4.10\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/600.3.18 (KHTML, like Gecko) Version/8.0.3 Safari/600.3.18\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/4.0 (compatible; SPIPE/1.0\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": null, "sigma_text_keyword": "title: Metasploit Framework User Agents (Proxy).\r\ndescription: Metasploit Framework User Agents Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/ekjCavTq\r\ndate: 2019/02/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\r\n    - Mozilla/5.0\r\n    - Mozilla/4.0 (compatible; Metasploit RSPEC)\r\n    - Mozilla/5.0 (iPad; CPU OS 9_3_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13E238 Safari/601.1\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/Projects/NSPR\r\n    - Mozilla/5.0 (iPhone; CPU iPhone OS 11_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Safari/604.1\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/5.0 (iPod touch; CPU iPhone OS 10_1_1 like Mac OS X) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0 Mobile/14B150 Safari/602.1\r\n    - Mozilla/5.0 (iPhone; CPU iPhone OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F70 Safari/600.1.4\r\n    - Mozilla/5.0 (iPad; CPU OS 8_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12H143 Safari/600.1.4\r\n    - Mozilla/5.0 (iPad; CPU OS 8_3 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12F69 Safari/600.1.4\r\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\n    - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0 Iceweasel/31.7.0\r\n    - Mozilla/5.0 (X11; Linux x86_64; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/43.0.2357.81 Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.125 Safari/537.36\r\n    - Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebKit/534.3 (KHTML, like Gecko) Chrome/6.0.472.63 Safari/534.3\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.0\r\n    - Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.152 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.135 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.79 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/7.1.7 Safari/537.85.16\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/600.6.3 (KHTML, like Gecko) Version/7.1.6 Safari/537.85.15\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.78.2 (KHTML, like Gecko) Version/6.1.6 Safari/537.78.2\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.59.10 (KHTML, like Gecko) Version/5.1.9 Safari/534.59.10\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Safari/604.1.38\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/602.2.14 (KHTML, like Gecko) Version/10.0.1 Safari/602.2.14\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/602.1.50 (KHTML, like Gecko) Version/10.0 Safari/602.1.50\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.12 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.12\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/600.7.11 (KHTML, like Gecko) Version/8.0.7 Safari/600.7.11\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.6.3 (KHTML, like Gecko) Version/8.0.6 Safari/600.6.3\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.5.17 (KHTML, like Gecko) Version/8.0.6 Safari/600.6.3\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/600.5.17 (KHTML, like Gecko) Version/8.0.5 Safari/600.5.17\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/600.4.10 (KHTML, like Gecko) Version/8.0.4 Safari/600.4.10\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/600.3.18 (KHTML, like Gecko) Version/8.0.3 Safari/600.3.18\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:49.0) Gecko/20100101 Firefox/49.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:39.0) Gecko/20100101 Firefox/39.0\r\n    - Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0\r\n    - Mozilla/4.0 (compatible; SPIPE/1.0\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "zG22E2gBFVBAemBcQG7L": {"category": 8, "updated": "2019-01-29T08:39:55.000Z", "hash": "f922ef7e93e32a8e45e32a083d18df9610a134ba8436f585b0b81f624f2fc087", "title": "Hooking Detection (Sysmon).", "permission_id": 3, "title_keyword": "Hooking Detection (Sysmon).", "released": "2019-01-29T08:39:55.000Z", "sigma_text": "title: Hooking Detection (Sysmon).\r\ndescription: Similar to Process Injection, adversaries may use hooking to load and execute malicious code within the context of another process, masking the execution while also allowing access to the process's memory and possibly elevated privileges. Installing hooking mechanisms may also provide Persistence via continuous invocation when the functions are called through normal use.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1179/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - /INJECTRUNNING\r\n  selection1:\r\n    event_id: 1\r\n  selection2:\r\n    event_data.Image: mavinject.exe\r\n  condition: selection1 AND selection0 AND selection2\r\nfalsepositives:\r\n- Low\r\nlevel: medium\r\ntags:\r\n- attack.Credential Access\r\n- attack.t1179", "git_filepath": "", "sigma_text_keyword": "title: Hooking Detection (Sysmon).\r\ndescription: Similar to Process Injection, adversaries may use hooking to load and execute malicious code within the context of another process, masking the execution while also allowing access to the process's memory and possibly elevated privileges. Installing hooking mechanisms may also provide Persistence via continuous invocation when the functions are called through normal use.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1179/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - /INJECTRUNNING\r\n  selection1:\r\n    event_id: 1\r\n  selection2:\r\n    event_data.Image: mavinject.exe\r\n  condition: selection1 AND selection0 AND selection2\r\nfalsepositives:\r\n- Low\r\nlevel: medium\r\ntags:\r\n- attack.Credential Access\r\n- attack.t1179"}, "6p3knmUBtApo-eN_quUz": {"category": 15, "updated": "2019-02-26T15:18:27.000Z", "hash": "5725adc2c259fd3567196dd6918a7f4840b05fcc509ffedd7dedd81654511aad", "title": "Suspicious PowerShell Invocation based on Parent Process", "permission_id": 3, "title_keyword": "Suspicious PowerShell Invocation based on Parent Process", "released": "2017-03-16T17:58:59.000Z", "sigma_text": "title: Suspicious PowerShell Invocation based on Parent Process\r\nstatus: experimental\r\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    Image:\r\n    - '*\\powershell.exe'\r\n  falsepositive:\r\n    CurrentDirectory: '*\\Health Service State\\\\*'\r\n  condition: selection and not falsepositive\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Microsoft Operations Manager (MOM)\r\n- Other scripts\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_powershell_parent_combo.yml", "sigma_text_keyword": "title: Suspicious PowerShell Invocation based on Parent Process\r\nstatus: experimental\r\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    Image:\r\n    - '*\\powershell.exe'\r\n  falsepositive:\r\n    CurrentDirectory: '*\\Health Service State\\\\*'\r\n  condition: selection and not falsepositive\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Microsoft Operations Manager (MOM)\r\n- Other scripts\r\nlevel: medium"}, "e53knmUBtApo-eN_ieB2": {"category": 15, "updated": "2019-02-26T15:02:32.000Z", "hash": "f6c50a4ebf31d0f888dba3ea523446c92af3726832d920f6a4d735c13cd52014", "title": "New RUN Key Pointing to Suspicious Folder", "permission_id": 3, "title_keyword": "New RUN Key Pointing to Suspicious Folder", "released": "2017-10-17T14:19:56.000Z", "sigma_text": "title: New RUN Key Pointing to Suspicious Folder\r\nstatus: experimental\r\ndescription: Detects suspicious new RUN key element pointing to an executable in a suspicious folder\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\r\nauthor: Florian Roth, Markus Neis\r\ntags:\r\n- attack.persistence\r\n- attack.t1060\r\ndate: 2018/08/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\\*'\r\n    Details:\r\n    - C:\\Windows\\Temp\\\\*\r\n    - '*\\AppData\\\\*'\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Temp\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n    - C:\\Users\\Desktop\\\\*\r\n  condition: selection\r\nfields:\r\n- Image\r\nfalsepositives:\r\n- Software with rare behaviour\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_run_key_img_folder.yml", "sigma_text_keyword": "title: New RUN Key Pointing to Suspicious Folder\r\nstatus: experimental\r\ndescription: Detects suspicious new RUN key element pointing to an executable in a suspicious folder\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\r\nauthor: Florian Roth, Markus Neis\r\ntags:\r\n- attack.persistence\r\n- attack.t1060\r\ndate: 2018/08/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\\*'\r\n    Details:\r\n    - C:\\Windows\\Temp\\\\*\r\n    - '*\\AppData\\\\*'\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Temp\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n    - C:\\Users\\Desktop\\\\*\r\n  condition: selection\r\nfields:\r\n- Image\r\nfalsepositives:\r\n- Software with rare behaviour\r\nlevel: high"}, "tZ3knmUBtApo-eN_hN_p": {"category": 11, "updated": "2018-10-25T10:08:07.000Z", "hash": "a705bfe888483d8b96f998652d8ff895361e0304cce92af4f058c522a070a4b1", "title": "Relevant Anti-Virus Event", "permission_id": 3, "title_keyword": "Relevant Anti-Virus Event", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Relevant Anti-Virus Event\r\ndescription: This detection method points out highly relevant Antivirus events. Modified by SOC Prime, replaced condition \"keywords and not 1 of filters\" with \"keywords and not filters\"\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  keywords:\r\n  - HTool\r\n  - Hacktool\r\n  - ASP/Backdoor\r\n  - JSP/Backdoor\r\n  - PHP/Backdoor\r\n  - Backdoor.ASP\r\n  - Backdoor.JSP\r\n  - Backdoor.PHP\r\n  - Webshell\r\n  - Portscan\r\n  - Mimikatz\r\n  - WinCred\r\n  - PlugX\r\n  - Korplug\r\n  - Pwdump\r\n  - Chopper\r\n  - WmiExec\r\n  - Xscan\r\n  - Clearlog\r\n  - ASPXSpy\r\n  filters:\r\n  - Keygen\r\n  - Crack\r\n  condition: keywords and not filters\r\nfalsepositives:\r\n- Some software piracy tools (key generators, cracks) are classified as hack tools\r\nlevel: high", "git_filepath": "/windows/builtin/win_av_relevant_match.yml", "sigma_text_keyword": "title: Relevant Anti-Virus Event\r\ndescription: This detection method points out highly relevant Antivirus events. Modified by SOC Prime, replaced condition \"keywords and not 1 of filters\" with \"keywords and not filters\"\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  keywords:\r\n  - HTool\r\n  - Hacktool\r\n  - ASP/Backdoor\r\n  - JSP/Backdoor\r\n  - PHP/Backdoor\r\n  - Backdoor.ASP\r\n  - Backdoor.JSP\r\n  - Backdoor.PHP\r\n  - Webshell\r\n  - Portscan\r\n  - Mimikatz\r\n  - WinCred\r\n  - PlugX\r\n  - Korplug\r\n  - Pwdump\r\n  - Chopper\r\n  - WmiExec\r\n  - Xscan\r\n  - Clearlog\r\n  - ASPXSpy\r\n  filters:\r\n  - Keygen\r\n  - Crack\r\n  condition: keywords and not filters\r\nfalsepositives:\r\n- Some software piracy tools (key generators, cracks) are classified as hack tools\r\nlevel: high"}, "7Z3knmUBtApo-eN_ht95": {"category": 2, "updated": "2018-11-30T12:52:40.000Z", "hash": "0c9c03b32fbd3a56c27deabac903b5bfdd3e3aefed0f2e3292d33cd881cbd407", "title": "Pandemic Registry Key", "permission_id": 3, "title_keyword": "Pandemic Registry Key", "released": "2017-06-01T20:48:59.000Z", "sigma_text": "title: Pandemic Registry Key\r\nstatus: experimental\r\ndescription: Detects Pandemic Windows Implant\r\nreferences:\r\n- https://wikileaks.org/vault7/#Pandemic\r\n- https://twitter.com/MalwareJake/status/870349480356454401\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1105\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*'\r\n    - '*\\SYSTEM\\ControlSet001\\services\\null\\Instance*'\r\n    - '*\\SYSTEM\\ControlSet002\\services\\null\\Instance*'\r\n  selection2:\r\n    EventID: \"1\"\r\n    Command: loaddll -a *\r\n  condition: selection1 or selection2\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- Image\r\n- User\r\n- TargetObject\r\nfalsepositives:\r\n- unknown\r\nlevel: critical", "git_filepath": "/apt/apt_pandemic.yml", "sigma_text_keyword": "title: Pandemic Registry Key\r\nstatus: experimental\r\ndescription: Detects Pandemic Windows Implant\r\nreferences:\r\n- https://wikileaks.org/vault7/#Pandemic\r\n- https://twitter.com/MalwareJake/status/870349480356454401\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1105\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*'\r\n    - '*\\SYSTEM\\ControlSet001\\services\\null\\Instance*'\r\n    - '*\\SYSTEM\\ControlSet002\\services\\null\\Instance*'\r\n  selection2:\r\n    EventID: \"1\"\r\n    Command: loaddll -a *\r\n  condition: selection1 or selection2\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- Image\r\n- User\r\n- TargetObject\r\nfalsepositives:\r\n- unknown\r\nlevel: critical"}, "CJ3knmUBtApo-eN_meMR": {"category": 1, "updated": "2018-10-25T09:51:32.000Z", "hash": "1b8395377e2664f001b1c357602f2249fedc5f02e779d3fa0c281c3c30009604", "title": "Django framework exceptions", "permission_id": 3, "title_keyword": "Django framework exceptions", "released": "2017-09-16T22:32:57.000Z", "sigma_text": "title: Django framework exceptions\r\ndescription: Detects suspicious Django web application framework exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://docs.djangoproject.com/en/1.11/ref/exceptions/\r\n- https://docs.djangoproject.com/en/1.11/topics/logging/#django-security\r\nlogsource:\r\n  category: application\r\n  product: django\r\ndetection:\r\n  keywords:\r\n  - SuspiciousOperation\r\n  - DisallowedHost\r\n  - DisallowedModelAdminLookup\r\n  - DisallowedModelAdminToField\r\n  - DisallowedRedirect\r\n  - InvalidSessionKey\r\n  - RequestDataTooBig\r\n  - SuspiciousFileOperation\r\n  - SuspiciousMultipartForm\r\n  - SuspiciousSession\r\n  - TooManyFieldsSent\r\n  - PermissionDenied\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium", "git_filepath": "/application/appframework_django_exceptions.yml", "sigma_text_keyword": "title: Django framework exceptions\r\ndescription: Detects suspicious Django web application framework exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://docs.djangoproject.com/en/1.11/ref/exceptions/\r\n- https://docs.djangoproject.com/en/1.11/topics/logging/#django-security\r\nlogsource:\r\n  category: application\r\n  product: django\r\ndetection:\r\n  keywords:\r\n  - SuspiciousOperation\r\n  - DisallowedHost\r\n  - DisallowedModelAdminLookup\r\n  - DisallowedModelAdminToField\r\n  - DisallowedRedirect\r\n  - InvalidSessionKey\r\n  - RequestDataTooBig\r\n  - SuspiciousFileOperation\r\n  - SuspiciousMultipartForm\r\n  - SuspiciousSession\r\n  - TooManyFieldsSent\r\n  - PermissionDenied\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium"}, "Y53knmUBtApo-eN_reZu": {"category": 8, "updated": "2018-11-07T15:01:49.000Z", "hash": "df76d03850343e503640d81ef7df673c51d746b7f194e8b45575e17df5cfd33f", "title": "Enabling RDP remotely using PsExec", "permission_id": 3, "title_keyword": "Enabling RDP remotely using PsExec", "released": "2018-04-27T05:53:23.000Z", "sigma_text": "title: Enabling RDP remotely using PsExec\r\ndescription: Detects enabling RDP remotely via PsExec.\r\nauthor: Ruslan Mikhalov, SOC Prime\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  sysmon_remoterdpenable:\r\n    EventID: \"1\"\r\n    Image: '*\\reg.exe'\r\n    CommandLine: '\"reg\" add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f'\r\n    ParentCommandLine: '*\\PSEXESVC.exe'\r\n  condition: sysmon_remoterdpenable\r\nfields:\r\n- EventID\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low\r\nreference:\r\n- https://twitter.com/zuphzuph/status/987383421847486464?s=21\r\nstatus: testing\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Enabling RDP remotely using PsExec\r\ndescription: Detects enabling RDP remotely via PsExec.\r\nauthor: Ruslan Mikhalov, SOC Prime\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  sysmon_remoterdpenable:\r\n    EventID: \"1\"\r\n    Image: '*\\reg.exe'\r\n    CommandLine: '\"reg\" add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f'\r\n    ParentCommandLine: '*\\PSEXESVC.exe'\r\n  condition: sysmon_remoterdpenable\r\nfields:\r\n- EventID\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low\r\nreference:\r\n- https://twitter.com/zuphzuph/status/987383421847486464?s=21\r\nstatus: testing\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1059"}, "pW5XKWkBFVBAemBcTFH7": {"category": 12, "updated": "2019-02-26T10:34:20.000Z", "hash": "18cd6807686758da04f20ccd21a850e8a4a50d274de6b08b2d3d466c7f8bbe56", "title": "WannaCry Ransomware", "permission_id": 3, "title_keyword": "WannaCry Ransomware", "released": "2019-02-26T10:34:20.000Z", "sigma_text": "title: WannaCry Ransomware\r\ndescription: Detects WannaCry Ransomware Activity\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\r\nauthor: Florian Roth\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    NewProcessName:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\WanaDecryptor*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n  condition: selection1 or selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\WanaDecryptor*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n  condition: selection1 or selection2\r\nlevel: critical\r\nfalsepositives:\r\n- Unknown", "git_filepath": "/windows/malware/win_mal_wannacry.yml", "sigma_text_keyword": "title: WannaCry Ransomware\r\ndescription: Detects WannaCry Ransomware Activity\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa\r\nauthor: Florian Roth\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    NewProcessName:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\WanaDecryptor*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n  condition: selection1 or selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\WanaDecryptor*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n  condition: selection1 or selection2\r\nlevel: critical\r\nfalsepositives:\r\n- Unknown"}, "PW5pCmkBFVBAemBcZDwn": {"category": 2, "updated": "2019-02-20T10:18:49.000Z", "hash": "b7109a613c6a708792dda07ebdbfbe33ed47e0cc684f061dd415b5d7c06a61e7", "title": "Defrag Deactivation", "permission_id": 3, "title_keyword": "Defrag Deactivation", "released": "2019-02-20T10:17:52.000Z", "sigma_text": "action: global\r\ntitle: Defrag Deactivation\r\ndescription: Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group\r\nreferences:\r\n- https://securelist.com/apt-slingshot/84312/\r\ntags:\r\n- attack.persistence\r\nauthor: Florian Roth\r\ndate: 2018/03/10\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Audit Other Object Access Events > Success'\r\ndetection:\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*schtasks* /delete *Defrag\\ScheduledDefrag*'\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Audit Other Object Access Events > Success'\r\ndetection:\r\n  selection:\r\n    EventID: 4701\r\n    TaskName: \\Microsoft\\Windows\\Defrag\\ScheduledDefrag", "git_filepath": "/apt/apt_slingshot.yml", "sigma_text_keyword": "action: global\r\ntitle: Defrag Deactivation\r\ndescription: Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group\r\nreferences:\r\n- https://securelist.com/apt-slingshot/84312/\r\ntags:\r\n- attack.persistence\r\nauthor: Florian Roth\r\ndate: 2018/03/10\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Audit Other Object Access Events > Success'\r\ndetection:\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*schtasks* /delete *Defrag\\ScheduledDefrag*'\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Audit Other Object Access Events > Success'\r\ndetection:\r\n  selection:\r\n    EventID: 4701\r\n    TaskName: \\Microsoft\\Windows\\Defrag\\ScheduledDefrag"}, "653knmUBtApo-eN_jOAJ": {"category": 5, "updated": "2018-10-25T13:26:37.000Z", "hash": "0b70dafdd6b94745b1e0e77d6948420a42312078c9da2593471087f919221f91", "title": "Flash Player Update from Suspicious Location", "permission_id": 3, "title_keyword": "Flash Player Update from Suspicious Location", "released": "2017-10-25T06:40:30.000Z", "sigma_text": "title: Flash Player Update from Suspicious Location\r\nstatus: experimental\r\ndescription: Detects a flashplayer update from an unofficial location\r\nreferences:\r\n- https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    cs-uri-query:\r\n    - '*/install_flash_player.exe'\r\n    - '*/flash_install.php*'\r\n  filter:\r\n    cs-uri-query: '*.adobe.com/*'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Unknown flash download locations\r\nlevel: high", "git_filepath": "/proxy/proxy_susp_flash_download_loc.yml", "sigma_text_keyword": "title: Flash Player Update from Suspicious Location\r\nstatus: experimental\r\ndescription: Detects a flashplayer update from an unofficial location\r\nreferences:\r\n- https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    cs-uri-query:\r\n    - '*/install_flash_player.exe'\r\n    - '*/flash_install.php*'\r\n  filter:\r\n    cs-uri-query: '*.adobe.com/*'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Unknown flash download locations\r\nlevel: high"}, "o53knmUBtApo-eN_rubK": {"category": 11, "updated": "2019-02-26T13:41:48.000Z", "hash": "5f3e15ecc1416a0282d44b0c113477ace9330551187f6408f4744d466ba1adbe", "title": "Successful Overpass the Hash Attempt", "permission_id": 3, "title_keyword": "Successful Overpass the Hash Attempt", "released": "2018-02-12T20:57:22.000Z", "sigma_text": "title: Successful Overpass the Hash Attempt\r\nstatus: experimental\r\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\r\nreferences:\r\n- https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\r\nauthor: Roberto Rodriguez, Dominik Schaudel\r\ndate: 2018/02/12\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1075\r\n- attack.s0002\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 9\r\n    LogonProcessName: seclogo\r\n    AuthenticationPackageName: Negotiate\r\n  condition: selection\r\nfalsepositives:\r\n- Runas command-line tool using /netonly parameter\r\nlevel: high", "git_filepath": "/windows/builtin/win_overpass_the_hash.yml", "sigma_text_keyword": "title: Successful Overpass the Hash Attempt\r\nstatus: experimental\r\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\r\nreferences:\r\n- https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\r\nauthor: Roberto Rodriguez, Dominik Schaudel\r\ndate: 2018/02/12\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1075\r\n- attack.s0002\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 9\r\n    LogonProcessName: seclogo\r\n    AuthenticationPackageName: Negotiate\r\n  condition: selection\r\nfalsepositives:\r\n- Runas command-line tool using /netonly parameter\r\nlevel: high"}, "UZ3knmUBtApo-eN_puWZ": {"category": 13, "updated": "2018-10-26T16:29:16.000Z", "hash": "2b32b0a748d2b6cb013ef5ec9c767266e2891a92fc01a24926f7e3efc476e9a7", "title": "PsExec Tool Execution", "permission_id": 3, "title_keyword": "PsExec Tool Execution", "released": "2017-06-12T21:57:06.000Z", "sigma_text": "title: PsExec Tool Execution\r\nstatus: experimental\r\ndescription: Detects PsExec service installation and execution events (service and Sysmon)\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  service_installation:\r\n    EventID: \"7045\"\r\n    ServiceName: PSEXESVC\r\n    ServiceFileName: '*\\PSEXESVC.exe'\r\n  service_execution:\r\n    EventID: \"7036\"\r\n    ServiceName: PSEXESVC\r\n  sysmon_processcreation:\r\n    EventID: \"1\"\r\n    Image: '*\\PSEXESVC.exe'\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: service_installation or service_execution or sysmon_processcreation\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- ServiceName\r\n- ServiceFileName\r\nfalsepositives:\r\n- unknown\r\nlevel: low", "git_filepath": "/windows/other/win_tool_psexec.yml", "sigma_text_keyword": "title: PsExec Tool Execution\r\nstatus: experimental\r\ndescription: Detects PsExec service installation and execution events (service and Sysmon)\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  service_installation:\r\n    EventID: \"7045\"\r\n    ServiceName: PSEXESVC\r\n    ServiceFileName: '*\\PSEXESVC.exe'\r\n  service_execution:\r\n    EventID: \"7036\"\r\n    ServiceName: PSEXESVC\r\n  sysmon_processcreation:\r\n    EventID: \"1\"\r\n    Image: '*\\PSEXESVC.exe'\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: service_installation or service_execution or sysmon_processcreation\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- ServiceName\r\n- ServiceFileName\r\nfalsepositives:\r\n- unknown\r\nlevel: low"}, "E53knmUBtApo-eN_meNU": {"category": 15, "updated": "2018-10-24T12:39:49.000Z", "hash": "15eeafdb86bbe4fed8870090b853e0da20c45ca69277a29aa5262fcdaa9cd61a", "title": "WSF/JSE/JS/VBA/VBE File Execution", "permission_id": 3, "title_keyword": "WSF/JSE/JS/VBA/VBE File Execution", "released": "2017-03-16T17:58:32.000Z", "sigma_text": "title: WSF/JSE/JS/VBA/VBE File Execution\r\nstatus: experimental\r\ndescription: Detects suspicious file execution by wscript and cscript\r\nauthor: Michael Haag\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    CommandLine:\r\n    - '*.jse'\r\n    - '*.vbe'\r\n    - '*.js'\r\n    - '*.vba'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_script_execution.yml", "sigma_text_keyword": "title: WSF/JSE/JS/VBA/VBE File Execution\r\nstatus: experimental\r\ndescription: Detects suspicious file execution by wscript and cscript\r\nauthor: Michael Haag\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    CommandLine:\r\n    - '*.jse'\r\n    - '*.vbe'\r\n    - '*.js'\r\n    - '*.vba'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\r\nlevel: medium"}, "253knmUBtApo-eN_keH1": {"category": 4, "updated": "2018-10-23T12:04:53.000Z", "hash": "7ba22a331e99e0b6bfb422300197361cd7e462eec4ac9b1832e5cfed8e7d07ab", "title": "DNS TXT Answer with possible execution strings", "permission_id": 3, "title_keyword": "DNS TXT Answer with possible execution strings", "released": "2018-08-08T13:51:56.000Z", "sigma_text": "title: DNS TXT Answer with possible execution strings\r\nstatus: experimental\r\ndescription: Detects strings used in command execution in DNS TXT Answer\r\nreferences:\r\n- https://twitter.com/stvemillertime/status/1024707932447854592\r\n- https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1\r\ntags:\r\n- attack.t1071\r\nauthor: Markus Neis\r\ndate: 2018/08/08\r\nlogsource:\r\n  category: dns\r\ndetection:\r\n  selection:\r\n    answer:\r\n    - '*IEX*'\r\n    - '*Invoke-Expression*'\r\n    - '*cmd.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/network/net_susp_dns_txt_exec_strings.yml", "sigma_text_keyword": "title: DNS TXT Answer with possible execution strings\r\nstatus: experimental\r\ndescription: Detects strings used in command execution in DNS TXT Answer\r\nreferences:\r\n- https://twitter.com/stvemillertime/status/1024707932447854592\r\n- https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1\r\ntags:\r\n- attack.t1071\r\nauthor: Markus Neis\r\ndate: 2018/08/08\r\nlogsource:\r\n  category: dns\r\ndetection:\r\n  selection:\r\n    answer:\r\n    - '*IEX*'\r\n    - '*Invoke-Expression*'\r\n    - '*cmd.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "153knmUBtApo-eN_o-T3": {"category": 15, "updated": "2019-02-26T15:07:15.000Z", "hash": "94302374325dc1524d3a707094f4e796ecc13283fdf541960050ad7f1415881a", "title": "cmdkey Cached Credentials Recon", "permission_id": 3, "title_keyword": "cmdkey Cached Credentials Recon", "released": "2018-03-08T18:25:05.000Z", "sigma_text": "title: cmdkey Cached Credentials Recon\r\nstatus: experimental\r\ndescription: Detects usage of cmdkey to look for cached credentials.\r\nreference:\r\n- https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\r\n- https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx\r\nauthor: jmallette\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\cmdkey.exe'\r\n    CommandLine: '* /list *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- User\r\nfalsepositives:\r\n- Legitimate administrative tasks.\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_cmdkey_recon.yml", "sigma_text_keyword": "title: cmdkey Cached Credentials Recon\r\nstatus: experimental\r\ndescription: Detects usage of cmdkey to look for cached credentials.\r\nreference:\r\n- https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\r\n- https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx\r\nauthor: jmallette\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\cmdkey.exe'\r\n    CommandLine: '* /list *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- User\r\nfalsepositives:\r\n- Legitimate administrative tasks.\r\nlevel: low"}, "mp3knmUBtApo-eN_kOGI": {"category": 3, "updated": "2018-10-23T15:38:52.000Z", "hash": "c85b331fa0bc8bb7f8d3268ddf86f456ff9d32160bccd0793f88ffdcb4136ddc", "title": "Shellshock Expression", "permission_id": 3, "title_keyword": "Shellshock Expression", "released": "2017-03-14T13:53:29.000Z", "sigma_text": "title: Shellshock Expression\r\ndescription: Detects shellshock expressions in log files\r\nreferences:\r\n- http://rubular.com/r/zxBfjWfFYs\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  expression:\r\n  - /\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/\r\n  condition: expression\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/linux/lnx_shellshock.yml", "sigma_text_keyword": "title: Shellshock Expression\r\ndescription: Detects shellshock expressions in log files\r\nreferences:\r\n- http://rubular.com/r/zxBfjWfFYs\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  expression:\r\n  - /\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/\r\n  condition: expression\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "HZ3knmUBtApo-eN_jeF8": {"category": 8, "updated": "2018-10-26T14:47:19.000Z", "hash": "8350f11fd51185f233f87bf20b38eefa2d87e83f2ac863baa34bcfd2400621f7", "title": "USB f ile stealer (UsbGuard) detector (Sysmon).", "permission_id": 3, "title_keyword": "USB f ile stealer (UsbGuard) detector (Sysmon).", "released": "2018-07-19T12:18:09.000Z", "sigma_text": "title: USB f ile stealer (UsbGuard) detector (Sysmon).\r\ndescription: It is a small, standalone program that monitors USB drives connected to the computer and copies all files that match the filter chosen by the attackers.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 050EB7D20EE8EF1E1DAEE2F421E5BF648FB645DF\r\n    - 069A919B3BC8070BB2D71D3E1AD9F7642D8ECF0F\r\n    - 0D265E0BDA9DF83815759ABCA64938EC0FF65733\r\n    - 0D7DF910D0FB7B100F084BFB8DFA0A9F2371171A\r\n    - 2FF3F5DA2960BE95E50B751680F450896AD1ED67\r\n    - 3200ECC7503F184F72AB9DA1DC3E1F8D43DDFD48\r\n    - 46D256EF277328E803D2B15CA7C188267059949D\r\n    - 524EE1B7269D02F725E55254A015200BB472463A\r\n    - 53A0EFD3D448DA8E32CFDDA5848312D3CF802B06\r\n    - 6FC150A9CAFA75813E7473C687935E7E4A5DCE24\r\n    - 70559245303F99630A27CB47B328C20C9666F0BB\r\n    - 7D8044A5CBEFE3B016F2132A5750C30BB647E599\r\n    - 8FD919D531A7A80615517E1AC13C2D0F050AF20D\r\n    - 9D22421DA9696B535C708178C72323F64D31FC80\r\n    - BFD2DFA3D6AF31DF4B9CC2F6B31B239ADF1CECA1\r\n    - C08A6222B59A187F3CF27A7BAE4CACFACC97DDEE\r\n    - C2F6A65E14605828880927B9BA3C386507BD8161\r\n    - C562006D2FA53B15052A4B80C94B86355CCA7427\r\n    - CB43058D9EBB517832DF7058641AEDF6B303E736\r\n    - CC8A9C28E884FDA0E1B3F6CEAB12805FEA17D3C1\r\n    - D3CC27CA772E30C6260C5A3B6309D27F08A295CD\r\n    - E7A2DE3776BA7D939711E620C7D6AB25946C9881\r\n    - EE6EFA7A6A85A1B2FA6351787A1612F060086320\r\n    - EF0ABB3A0CD1E65B33C0F109DD18F156FC0F0CDE\r\n    - F63BE193C8A0FBB430F3B88CC8194D755BAD9CD1\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: USB f ile stealer (UsbGuard) detector (Sysmon).\r\ndescription: It is a small, standalone program that monitors USB drives connected to the computer and copies all files that match the filter chosen by the attackers.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 050EB7D20EE8EF1E1DAEE2F421E5BF648FB645DF\r\n    - 069A919B3BC8070BB2D71D3E1AD9F7642D8ECF0F\r\n    - 0D265E0BDA9DF83815759ABCA64938EC0FF65733\r\n    - 0D7DF910D0FB7B100F084BFB8DFA0A9F2371171A\r\n    - 2FF3F5DA2960BE95E50B751680F450896AD1ED67\r\n    - 3200ECC7503F184F72AB9DA1DC3E1F8D43DDFD48\r\n    - 46D256EF277328E803D2B15CA7C188267059949D\r\n    - 524EE1B7269D02F725E55254A015200BB472463A\r\n    - 53A0EFD3D448DA8E32CFDDA5848312D3CF802B06\r\n    - 6FC150A9CAFA75813E7473C687935E7E4A5DCE24\r\n    - 70559245303F99630A27CB47B328C20C9666F0BB\r\n    - 7D8044A5CBEFE3B016F2132A5750C30BB647E599\r\n    - 8FD919D531A7A80615517E1AC13C2D0F050AF20D\r\n    - 9D22421DA9696B535C708178C72323F64D31FC80\r\n    - BFD2DFA3D6AF31DF4B9CC2F6B31B239ADF1CECA1\r\n    - C08A6222B59A187F3CF27A7BAE4CACFACC97DDEE\r\n    - C2F6A65E14605828880927B9BA3C386507BD8161\r\n    - C562006D2FA53B15052A4B80C94B86355CCA7427\r\n    - CB43058D9EBB517832DF7058641AEDF6B303E736\r\n    - CC8A9C28E884FDA0E1B3F6CEAB12805FEA17D3C1\r\n    - D3CC27CA772E30C6260C5A3B6309D27F08A295CD\r\n    - E7A2DE3776BA7D939711E620C7D6AB25946C9881\r\n    - EE6EFA7A6A85A1B2FA6351787A1612F060086320\r\n    - EF0ABB3A0CD1E65B33C0F109DD18F156FC0F0CDE\r\n    - F63BE193C8A0FBB430F3B88CC8194D755BAD9CD1\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "sm6lOGkBFVBAemBc3WEE": {"category": 2, "updated": "2019-03-01T09:46:27.000Z", "hash": "cc125a94cff30cfebf355b7149f86feeff5abeebad1269163d5ec967b967d2fe", "title": "Hurricane Panda Activity\u044e", "permission_id": 3, "title_keyword": "Hurricane Panda Activity\u044e", "released": "2019-03-01T09:46:27.000Z", "sigma_text": "title: Hurricane Panda Activity\u044e\r\ndescription: Detects Hurricane Panda Activity\u044e\r\nreferences:\r\n- https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/\r\nauthor: Florian Roth\r\nstatus: experimental\r\ndate: 2018/02/25\r\nmodified: 2018/12/11\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* localgroup administrators admin /add'\r\n    - '*\\Win64.exe*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '* localgroup administrators admin /add'\r\n    - '*\\Win64.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.g0009\r\n- attack.t1068", "git_filepath": "/apt/apt_hurricane_panda.yml", "sigma_text_keyword": "title: Hurricane Panda Activity\u044e\r\ndescription: Detects Hurricane Panda Activity\u044e\r\nreferences:\r\n- https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/\r\nauthor: Florian Roth\r\nstatus: experimental\r\ndate: 2018/02/25\r\nmodified: 2018/12/11\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* localgroup administrators admin /add'\r\n    - '*\\Win64.exe*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '* localgroup administrators admin /add'\r\n    - '*\\Win64.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.g0009\r\n- attack.t1068"}, "ep3knmUBtApo-eN_gt_z": {"category": 15, "updated": "2018-10-31T10:36:03.000Z", "hash": "cb511259e8bf6c211f8ea40ad76add854346acff28284a7487ba5c273c5036ff", "title": "Exploit for CVE-2015-1641", "permission_id": 3, "title_keyword": "Exploit for CVE-2015-1641", "released": "2018-02-22T15:59:40.000Z", "sigma_text": "title: Exploit for CVE-2015-1641\r\nstatus: experimental\r\ndescription: Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641\r\nreferences:\r\n- https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/\r\n- https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2018/02/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\MicroScMgmt.exe '\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.Execution\r\n- attack.Defense Evasion\r\n- attack.t1064", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2015_1641.yml", "sigma_text_keyword": "title: Exploit for CVE-2015-1641\r\nstatus: experimental\r\ndescription: Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641\r\nreferences:\r\n- https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/\r\n- https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2018/02/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\MicroScMgmt.exe '\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.Execution\r\n- attack.Defense Evasion\r\n- attack.t1064"}, "p53knmUBtApo-eN_ouSh": {"category": 15, "updated": "2018-11-23T15:44:46.000Z", "hash": "f1e59acf9d7c11b1292229eeacadc65adb2583df938b5cf33ef0243ef0664a92", "title": "Exploit for CVE-2017-8759", "permission_id": 3, "title_keyword": "Exploit for CVE-2017-8759", "released": "2018-02-22T12:29:19.000Z", "sigma_text": "title: Exploit for CVE-2017-8759\r\ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\r\n- https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2017/09/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\csc.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_8759.yml", "sigma_text_keyword": "title: Exploit for CVE-2017-8759\r\ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\r\n- https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2017/09/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\csc.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical"}, "hJ3knmUBtApo-eN_ieCn": {"category": 15, "updated": "2018-10-24T12:50:39.000Z", "hash": "0d83f5dc6b099c28f6e9575dfcac72a596d4f79761bfc531e93fa3f4eb0ae02c", "title": "Suspicious WMI execution", "permission_id": 3, "title_keyword": "Suspicious WMI execution", "released": "2017-03-25T13:48:23.000Z", "sigma_text": "title: Suspicious WMI execution\r\nstatus: experimental\r\ndescription: Detects WMI executing suspicious commands\r\nreferences:\r\n- https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/\r\n- https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1\r\n- https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/\r\nauthor: Michael Haag, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\wmic.exe'\r\n    CommandLine:\r\n    - '*/NODE:*process call create *'\r\n    - '* path AntiVirusProduct get *'\r\n    - '* path FirewallProduct get *'\r\n    - '* shadowcopy delete *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.execution\r\n- attack.t1047\r\nfalsepositives:\r\n- Will need to be tuned\r\n- If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine.\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_wmi_execution.yml", "sigma_text_keyword": "title: Suspicious WMI execution\r\nstatus: experimental\r\ndescription: Detects WMI executing suspicious commands\r\nreferences:\r\n- https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/\r\n- https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1\r\n- https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/\r\nauthor: Michael Haag, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\wmic.exe'\r\n    CommandLine:\r\n    - '*/NODE:*process call create *'\r\n    - '* path AntiVirusProduct get *'\r\n    - '* path FirewallProduct get *'\r\n    - '* shadowcopy delete *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.execution\r\n- attack.t1047\r\nfalsepositives:\r\n- Will need to be tuned\r\n- If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine.\r\nlevel: medium"}, "MZ3knmUBtApo-eN_muMp": {"category": 15, "updated": "2019-02-26T14:57:14.000Z", "hash": "793b67b26c74b47c59c7e3c19ae314389c812d5b0aa893556396cd338427287b", "title": "Execution in Webserver Root Folder", "permission_id": 3, "title_keyword": "Execution in Webserver Root Folder", "released": "2017-03-13T22:56:06.000Z", "sigma_text": "title: Execution in Webserver Root Folder\r\nstatus: experimental\r\ndescription: Detects a suspicious program execution in a web service root folder (filter out false positives)\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wwwroot\\\\*'\r\n    - '*\\wmpub\\\\*'\r\n    - '*\\htdocs\\\\*'\r\n  filter:\r\n    Image:\r\n    - '*bin\\\\*'\r\n    - '*\\Tools\\\\*'\r\n    - '*\\SMSComponent\\\\*'\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Various applications\r\n- Tools that include ping or nslookup command invocations\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_execution_path_webserver.yml", "sigma_text_keyword": "title: Execution in Webserver Root Folder\r\nstatus: experimental\r\ndescription: Detects a suspicious program execution in a web service root folder (filter out false positives)\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wwwroot\\\\*'\r\n    - '*\\wmpub\\\\*'\r\n    - '*\\htdocs\\\\*'\r\n  filter:\r\n    Image:\r\n    - '*bin\\\\*'\r\n    - '*\\Tools\\\\*'\r\n    - '*\\SMSComponent\\\\*'\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Various applications\r\n- Tools that include ping or nslookup command invocations\r\nlevel: medium"}, "953knmUBtApo-eN_kuGB": {"category": 2, "updated": "2018-10-23T15:53:15.000Z", "hash": "418991c406d0e6e9cc65b4d4ea32489c85849fa1e8ae0f807cb45c89e6447513", "title": "Turla Service Install", "permission_id": 3, "title_keyword": "Turla Service Install", "released": "2017-03-31T17:25:41.000Z", "sigma_text": "title: Turla Service Install\r\ndescription: This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET\r\nreferences:\r\n- https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0010\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n    ServiceName:\r\n    - srservice\r\n    - ipvpn\r\n    - hkmsvc\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/apt/apt_carbonpaper_turla.yml", "sigma_text_keyword": "title: Turla Service Install\r\ndescription: This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET\r\nreferences:\r\n- https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0010\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n    ServiceName:\r\n    - srservice\r\n    - ipvpn\r\n    - hkmsvc\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "SJ3knmUBtApo-eN_oORu": {"category": 1, "updated": "2018-10-25T09:50:25.000Z", "hash": "89f4bed9bcdae9ed701db5438694531303407b51c7cfde19e79ef9769ed7f173", "title": "Suspicious SQL Error Messages", "permission_id": 3, "title_keyword": "Suspicious SQL Error Messages", "released": "2017-12-07T15:21:02.000Z", "sigma_text": "title: Suspicious SQL Error Messages\r\nstatus: experimental\r\ndescription: Detects SQL error messages that indicate probing for an injection attack\r\nauthor: Bjoern Kimminich\r\nreferences:\r\n- http://www.sqlinjection.net/errors\r\nlogsource:\r\n  category: application\r\n  product: sql\r\ndetection:\r\n  keywords:\r\n  - quoted string not properly terminated\r\n  - You have an error in your SQL syntax\r\n  - Unclosed quotation mark\r\n  - near \"*\": syntax error\r\n  - SELECTs to the left and right of UNION do not have the same number of result columns\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\nlevel: high", "git_filepath": "/application/app_sqlinjection_errors.yml", "sigma_text_keyword": "title: Suspicious SQL Error Messages\r\nstatus: experimental\r\ndescription: Detects SQL error messages that indicate probing for an injection attack\r\nauthor: Bjoern Kimminich\r\nreferences:\r\n- http://www.sqlinjection.net/errors\r\nlogsource:\r\n  category: application\r\n  product: sql\r\ndetection:\r\n  keywords:\r\n  - quoted string not properly terminated\r\n  - You have an error in your SQL syntax\r\n  - Unclosed quotation mark\r\n  - near \"*\": syntax error\r\n  - SELECTs to the left and right of UNION do not have the same number of result columns\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\nlevel: high"}, "OZ3knmUBtApo-eN_juEV": {"category": 15, "updated": "2019-02-26T13:30:51.000Z", "hash": "28219e8db6534defa0d15da1bdf7e06be042636f886812a2137cb6d701cb5c2e", "title": "Malware Shellcode in Verclsid Target Process", "permission_id": 3, "title_keyword": "Malware Shellcode in Verclsid Target Process", "released": "2017-03-04T09:38:23.000Z", "sigma_text": "title: Malware Shellcode in Verclsid Target Process\r\nstatus: experimental\r\ndescription: Detetcs a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro. Modified by SOC Prime, replaced condition \"selection and 1 of combination*\" with \"selection and (combination1 or combination2)\"\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/837743453039534080\r\nauthor: John Lambert, Florian Roth\r\ndate: 2017/03/04\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\r\ndetection:\r\n  selection:\r\n    EventID: 10\r\n    TargetImage: '*\\verclsid.exe'\r\n    GrantedAccess: \"0x1FFFFF\"\r\n  combination1:\r\n    CallTrace: '*|UNKNOWN(*VBE7.DLL*'\r\n  combination2:\r\n    SourceImage: '*\\Microsoft Office\\*'\r\n    CallTrace: '*|UNKNOWN*'\r\n  condition: selection and (combination1 or combination2)\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_malware_verclsid_shellcode.yml", "sigma_text_keyword": "title: Malware Shellcode in Verclsid Target Process\r\nstatus: experimental\r\ndescription: Detetcs a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro. Modified by SOC Prime, replaced condition \"selection and 1 of combination*\" with \"selection and (combination1 or combination2)\"\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/837743453039534080\r\nauthor: John Lambert, Florian Roth\r\ndate: 2017/03/04\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\r\ndetection:\r\n  selection:\r\n    EventID: 10\r\n    TargetImage: '*\\verclsid.exe'\r\n    GrantedAccess: \"0x1FFFFF\"\r\n  combination1:\r\n    CallTrace: '*|UNKNOWN(*VBE7.DLL*'\r\n  combination2:\r\n    SourceImage: '*\\Microsoft Office\\*'\r\n    CallTrace: '*|UNKNOWN*'\r\n  condition: selection and (combination1 or combination2)\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "j53knmUBtApo-eN_kOEZ": {"category": 15, "updated": "2018-10-24T14:01:06.000Z", "hash": "25c1b434a86a87f76839cc68f65f273e8a24a159a6809e8eb573f9b7b7fa6979", "title": "DHCP Callout DLL installation", "permission_id": 3, "title_keyword": "DHCP Callout DLL installation", "released": "2017-05-15T18:58:31.000Z", "sigma_text": "title: DHCP Callout DLL installation\r\nstatus: experimental\r\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\r\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_dhcp_calloutdll.yml", "sigma_text_keyword": "title: DHCP Callout DLL installation\r\nstatus: experimental\r\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\r\n    - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "3m24E2gBFVBAemBcpm72": {"category": 8, "updated": "2019-02-26T12:20:07.000Z", "hash": "b30b33c3cef6c7447254715e5d34bc419e72f4ca838cd798af74659019ecd2ad", "title": "Detecting phishing domains (Proxy)", "permission_id": 3, "title_keyword": "Detecting phishing domains (Proxy)", "released": "2019-01-03T12:38:14.000Z", "sigma_text": "title: Detecting phishing domains (Proxy)\r\ndescription: This rule detects network connections to Phishing domains.\r\nauthor: Dmitriy Dyakon, SOC Prime\r\nreferences:\r\n- https://twitter.com/PhishingAi/status/1079816931123838976\r\n- https://pastebin.com/4ctJYu1f\r\n- https://twitter.com/PhishingAi/status/1080569878820589569\r\n- https://twitter.com/PhishingAi/status/1080581569021136896\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection_URLs_1:\r\n    resource.URL:\r\n    - com-managers-updateds-notifications-accounts.com\r\n    - com-updated-manager-notifications-accounts.info\r\n    - com-index-managers-updateds-notifications-accounts.com\r\n    - com-notice-index-managers-review-accounts.com\r\n    - appleid.com-notice-index-managers-review-accounts.com\r\n    - appleid.com-index-managers-updateds-notifications-accounts.com\r\n    - appleid.com-updated-manager-notifications-accounts.info\r\n    - appleid.com-manager-updateds-account-notifeds.com\r\n    - com-manager-updateds-account-notifeds.com\r\n    - appleid.com-managers-updateds-notifications-accounts.com\r\n    - appleid.com-index-managers-updateds-notifications-accounts.info\r\n    - com-index-managers-updateds-notifications-accounts.info\r\n  selection_URLs_2:\r\n    resource.URL:\r\n    - com-authenticationid-account-id-291175.com\r\n    - com-authentication-account-id-67800.com\r\n    - account-signinid.com-authentication-account-id-67800.com\r\n    - com-reviewid-account-authenticationid-11250.com\r\n    - com-authentication-account-id-67991.com\r\n    - accountid-signin.com-authenticationid-account-id-291175.com\r\n  selection_URLs_3:\r\n    resource.URL:\r\n    - reverify-id-apple.com\r\n    - re-verify-id-apple.com\r\n    - reverify-id-apple.com\r\n    - un-verify-id-apple.com\r\n    - unverify-id-apple.com\r\n    - re-verify-id-apple.com\r\n    - unverify-id-apple.com\r\n    - www.unverify-id-apple.com\r\n    - un-verify-id-apple.com\r\n    - wazze-design.com\r\n    - www.wazze-design.com\r\n    - www.re-verify-id-apple.com\r\n    - www.reverify-id-apple.com\r\n    - www.un-verify-id-apple.com\r\n    - ns1.stitis.com\r\n    - ns2.stitis.com\r\n    - disable-id-apple.com\r\n    - www.support-id-icloud.com\r\n    - apple.com-verif-id.app\r\n  selection_URLs_4:\r\n    resource.URL:\r\n    - pages-secure.com-verifications-account-webservices-appleid.com\r\n    - com-verifications-account-webservices-appleid.com\r\n    - com-verifications-account-webservices-appleid.com\r\n    - com-page-secure-webmail-supportcenter.com\r\n    - identification-account.com-page-secure-webmail-supportcenter.com\r\n    - www.com-page-secure-webmail-supportcenter.com\r\n    - com-page-secure-webmail-supportcenter.com\r\n  condition: selection_URLs_1 OR selection_URLs_2 OR selection_URLs_3 OR selection_URLs_4\r\nfields:\r\n- resource.URL\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: Detecting phishing domains (Proxy)\r\ndescription: This rule detects network connections to Phishing domains.\r\nauthor: Dmitriy Dyakon, SOC Prime\r\nreferences:\r\n- https://twitter.com/PhishingAi/status/1079816931123838976\r\n- https://pastebin.com/4ctJYu1f\r\n- https://twitter.com/PhishingAi/status/1080569878820589569\r\n- https://twitter.com/PhishingAi/status/1080581569021136896\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection_URLs_1:\r\n    resource.URL:\r\n    - com-managers-updateds-notifications-accounts.com\r\n    - com-updated-manager-notifications-accounts.info\r\n    - com-index-managers-updateds-notifications-accounts.com\r\n    - com-notice-index-managers-review-accounts.com\r\n    - appleid.com-notice-index-managers-review-accounts.com\r\n    - appleid.com-index-managers-updateds-notifications-accounts.com\r\n    - appleid.com-updated-manager-notifications-accounts.info\r\n    - appleid.com-manager-updateds-account-notifeds.com\r\n    - com-manager-updateds-account-notifeds.com\r\n    - appleid.com-managers-updateds-notifications-accounts.com\r\n    - appleid.com-index-managers-updateds-notifications-accounts.info\r\n    - com-index-managers-updateds-notifications-accounts.info\r\n  selection_URLs_2:\r\n    resource.URL:\r\n    - com-authenticationid-account-id-291175.com\r\n    - com-authentication-account-id-67800.com\r\n    - account-signinid.com-authentication-account-id-67800.com\r\n    - com-reviewid-account-authenticationid-11250.com\r\n    - com-authentication-account-id-67991.com\r\n    - accountid-signin.com-authenticationid-account-id-291175.com\r\n  selection_URLs_3:\r\n    resource.URL:\r\n    - reverify-id-apple.com\r\n    - re-verify-id-apple.com\r\n    - reverify-id-apple.com\r\n    - un-verify-id-apple.com\r\n    - unverify-id-apple.com\r\n    - re-verify-id-apple.com\r\n    - unverify-id-apple.com\r\n    - www.unverify-id-apple.com\r\n    - un-verify-id-apple.com\r\n    - wazze-design.com\r\n    - www.wazze-design.com\r\n    - www.re-verify-id-apple.com\r\n    - www.reverify-id-apple.com\r\n    - www.un-verify-id-apple.com\r\n    - ns1.stitis.com\r\n    - ns2.stitis.com\r\n    - disable-id-apple.com\r\n    - www.support-id-icloud.com\r\n    - apple.com-verif-id.app\r\n  selection_URLs_4:\r\n    resource.URL:\r\n    - pages-secure.com-verifications-account-webservices-appleid.com\r\n    - com-verifications-account-webservices-appleid.com\r\n    - com-verifications-account-webservices-appleid.com\r\n    - com-page-secure-webmail-supportcenter.com\r\n    - identification-account.com-page-secure-webmail-supportcenter.com\r\n    - www.com-page-secure-webmail-supportcenter.com\r\n    - com-page-secure-webmail-supportcenter.com\r\n  condition: selection_URLs_1 OR selection_URLs_2 OR selection_URLs_3 OR selection_URLs_4\r\nfields:\r\n- resource.URL\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "153knmUBtApo-eN_qeXO": {"category": 8, "updated": "2019-01-02T14:57:39.000Z", "hash": "637b47222acad945754e8417947ead0e0ef6b4278a23c02f2860466333154460", "title": "Sobaken RAT detector (Sysmon).", "permission_id": 3, "title_keyword": "Sobaken RAT detector (Sysmon).", "released": "2018-07-19T10:22:19.000Z", "sigma_text": "title: Sobaken RAT detector (Sysmon).\r\ndescription: Sobaken is a heavily modified version of Quasar with fewer functionalities to make the executable smaller. However, it does come with a fewanti-sandbox and other evasion techniques.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 087F77998004207BCCFFBF3030B6789648930FA5\r\n    - 0A4A2BCB3EF4E19973D5C4BE4E141B665CC0BFE0\r\n    - 1CEEF0813C0F096E6DA5461DC4B3BF901C500C56\r\n    - 293DBFF0230DAB3C4C21428F90C8EF06E9F35608\r\n    - 37E2947BFB5FC0839087C5BCE194EC193F824C85\r\n    - 39525CBCA591F2A10946BA62A56E4C3382CD4FC0\r\n    - 3CE0A18E9A8A2B95827008DBFF16364B6FEDF361\r\n    - 3E869038080DAE006FF6B20DF9B0CD9CB3A5E1A1\r\n    - 400830AB6DD46789B00D081ADF0F82623472FB13\r\n    - 43F382A330A454FF83F4F35FB571ECF587A4694A\r\n    - 4449FBE2B28A81B760B284880ADBED43462C2030\r\n    - 4712AF28168FD728A13EFD520E0665FFD076B6FB\r\n    - 4F504D7B35660943B206D6034752C686365EA58D\r\n    - 53239A62E09BB0B4E49B7954D533258FEF3342C4\r\n    - 540292753FA0CC4ACB49E5F11FEDEA4B7DEF11D8\r\n    - 5589E8018DC7F934A8FDAB62670C9140AF31CAB6\r\n    - 57BBA7D8786D3B0C5F93BC20AB505DF3F69C72D4\r\n    - 630FE59D60F6882A0B9E35ED606BF06AD4BA048C\r\n    - 63EA7C844D86882F491812813AAAD746738A6BE9\r\n    - 64121FA2FD2E38AC85A911A9F7ADD8CA1E1A9820\r\n    - 64DBA711FDD52FECF534CAC0C6FE8848FE36F196\r\n    - 650AB5E674FEF431EBC8CF98141506DDC80C5E64\r\n    - 6EF13E9D5B0B6FCB5EB2A7439AAD7B21EA7FB7AC\r\n    - 7177F64362A504F3DF8AA815CEF7136D5A819C04\r\n    - 9B91EC03A09C4CF6DBEC637B3551BDCA11F04A9B\r\n    - A26764AFB1DAC34CAA2123F7BF3543D385147024\r\n    - A55319D3DBD7B9A587F5156CF201C327C803FBC9\r\n    - A841FF1EE379269F00261337A043448D3D72E6FD\r\n    - AAB5BAAAE8A2577E1036769F0D349F553E4D129B\r\n    - ACB989B3401780999474C5B1D7F9198ECA11549A\r\n    - B65372E41E7761A68AEF87001BBB698D8D8D5EC6\r\n    - BDB5E0B6CA0AA03E0BECA23B46A8420473091DFF\r\n    - C4421084C19423D311A94D7BB6CB0169C44CBECD\r\n    - C7E76993BB419DC755BD0C04255AB88E6C77B294\r\n    - CF5238C467EBE2704528EED18AB4259BFDC604E3\r\n    - D2334E161A1720E2DF048E4366150729B9395144\r\n    - D35FB6E031720876482E728A40532703EF02A305\r\n    - D82DF2903AA4BC5FD4274B5D1BFAF9E081771628\r\n    - E4B3CBCA9A53B7B93177A270C2A76F981D157C34\r\n    - E585AA2C5BFB9D42D2E58DB3833330D056713B9A\r\n    - F4A485696FC871307C22906701CBBB3FA522499B\r\n    - F5C75450108440D0BC9E7B210F072EF25A196D20\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Sobaken RAT detector (Sysmon).\r\ndescription: Sobaken is a heavily modified version of Quasar with fewer functionalities to make the executable smaller. However, it does come with a fewanti-sandbox and other evasion techniques.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 087F77998004207BCCFFBF3030B6789648930FA5\r\n    - 0A4A2BCB3EF4E19973D5C4BE4E141B665CC0BFE0\r\n    - 1CEEF0813C0F096E6DA5461DC4B3BF901C500C56\r\n    - 293DBFF0230DAB3C4C21428F90C8EF06E9F35608\r\n    - 37E2947BFB5FC0839087C5BCE194EC193F824C85\r\n    - 39525CBCA591F2A10946BA62A56E4C3382CD4FC0\r\n    - 3CE0A18E9A8A2B95827008DBFF16364B6FEDF361\r\n    - 3E869038080DAE006FF6B20DF9B0CD9CB3A5E1A1\r\n    - 400830AB6DD46789B00D081ADF0F82623472FB13\r\n    - 43F382A330A454FF83F4F35FB571ECF587A4694A\r\n    - 4449FBE2B28A81B760B284880ADBED43462C2030\r\n    - 4712AF28168FD728A13EFD520E0665FFD076B6FB\r\n    - 4F504D7B35660943B206D6034752C686365EA58D\r\n    - 53239A62E09BB0B4E49B7954D533258FEF3342C4\r\n    - 540292753FA0CC4ACB49E5F11FEDEA4B7DEF11D8\r\n    - 5589E8018DC7F934A8FDAB62670C9140AF31CAB6\r\n    - 57BBA7D8786D3B0C5F93BC20AB505DF3F69C72D4\r\n    - 630FE59D60F6882A0B9E35ED606BF06AD4BA048C\r\n    - 63EA7C844D86882F491812813AAAD746738A6BE9\r\n    - 64121FA2FD2E38AC85A911A9F7ADD8CA1E1A9820\r\n    - 64DBA711FDD52FECF534CAC0C6FE8848FE36F196\r\n    - 650AB5E674FEF431EBC8CF98141506DDC80C5E64\r\n    - 6EF13E9D5B0B6FCB5EB2A7439AAD7B21EA7FB7AC\r\n    - 7177F64362A504F3DF8AA815CEF7136D5A819C04\r\n    - 9B91EC03A09C4CF6DBEC637B3551BDCA11F04A9B\r\n    - A26764AFB1DAC34CAA2123F7BF3543D385147024\r\n    - A55319D3DBD7B9A587F5156CF201C327C803FBC9\r\n    - A841FF1EE379269F00261337A043448D3D72E6FD\r\n    - AAB5BAAAE8A2577E1036769F0D349F553E4D129B\r\n    - ACB989B3401780999474C5B1D7F9198ECA11549A\r\n    - B65372E41E7761A68AEF87001BBB698D8D8D5EC6\r\n    - BDB5E0B6CA0AA03E0BECA23B46A8420473091DFF\r\n    - C4421084C19423D311A94D7BB6CB0169C44CBECD\r\n    - C7E76993BB419DC755BD0C04255AB88E6C77B294\r\n    - CF5238C467EBE2704528EED18AB4259BFDC604E3\r\n    - D2334E161A1720E2DF048E4366150729B9395144\r\n    - D35FB6E031720876482E728A40532703EF02A305\r\n    - D82DF2903AA4BC5FD4274B5D1BFAF9E081771628\r\n    - E4B3CBCA9A53B7B93177A270C2A76F981D157C34\r\n    - E585AA2C5BFB9D42D2E58DB3833330D056713B9A\r\n    - F4A485696FC871307C22906701CBBB3FA522499B\r\n    - F5C75450108440D0BC9E7B210F072EF25A196D20\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "WZ3knmUBtApo-eN_iODE": {"category": 11, "updated": "2019-02-26T15:23:08.000Z", "hash": "2c9bc6dcfc5a78d559b0275c4d358cf363ebbd826fc4096581f643e4ea87dc23", "title": "Rare Service Installs", "permission_id": 3, "title_keyword": "Rare Service Installs", "released": "2017-03-08T18:09:34.000Z", "sigma_text": "title: Rare Service Installs\r\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services\r\nstatus: experimental\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 7045\r\n  timeframe: 7d\r\n  condition: selection | count(ServiceFileName) < 5\r\nfalsepositives:\r\n- Software installation\r\n- Software updates\r\nlevel: low", "git_filepath": "/windows/builtin/win_rare_service_installs.yml", "sigma_text_keyword": "title: Rare Service Installs\r\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services\r\nstatus: experimental\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 7045\r\n  timeframe: 7d\r\n  condition: selection | count(ServiceFileName) < 5\r\nfalsepositives:\r\n- Software installation\r\n- Software updates\r\nlevel: low"}, "aG0wGGgBFVBAemBcxXMC": {"category": 8, "updated": "2019-01-24T16:02:01.000Z", "hash": "90475045212feb7de528ee0d29eeb0152e7513d831bb942f2e6c512ba7347791", "title": "LoJax Malware (Proxy/Firewall).", "permission_id": 3, "title_keyword": "LoJax Malware (Proxy/Firewall).", "released": "2019-01-04T09:38:08.000Z", "sigma_text": "title: LoJax Malware (Proxy/Firewall).\r\ndescription: LoJax rootkit Detector (Sednit group).\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://github.com/eset/malware-ioc/blob/master/sednit/lojax.adoc\r\n- https://asert.arbornetworks.com/lojax-fancy-since-2016/\r\ndate: 2019/01/17\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  SelectionSRC:\r\n    src_ip:\r\n    - 185.77.129.106\r\n    - 185.144.82.239\r\n    - 93.113.131.103\r\n    - 185.86.149.54\r\n    - 185.86.151.104\r\n    - 103.41.177.43\r\n    - 185.86.148.184\r\n    - 185.94.191.65\r\n    - 86.106.131.54\r\n    - 169.239.12.133\r\n    - 185.86.151.2\r\n  SelectionDST:\r\n    dst_ip:\r\n    - 185.77.129.106\r\n    - 185.144.82.239\r\n    - 93.113.131.103\r\n    - 185.86.149.54\r\n    - 185.86.151.104\r\n    - 103.41.177.43\r\n    - 185.86.148.184\r\n    - 185.94.191.65\r\n    - 86.106.131.54\r\n    - 169.239.12.133\r\n    - 185.86.151.2\r\n  SelectionD:\r\n    destination.domain:\r\n    - secao.org\r\n    - ikmtrust.com\r\n    - sysanalyticweb.com\r\n    - lxwo.org\r\n    - jflynci.com\r\n    - remotepx.net\r\n    - rdsnets.com\r\n    - rpcnetconnect.com\r\n    - webstp.com\r\n    - elaxo.org\r\n  condition: SelectionSRC or SelectionDST or SelectionD\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: LoJax Malware (Proxy/Firewall).\r\ndescription: LoJax rootkit Detector (Sednit group).\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://github.com/eset/malware-ioc/blob/master/sednit/lojax.adoc\r\n- https://asert.arbornetworks.com/lojax-fancy-since-2016/\r\ndate: 2019/01/17\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  SelectionSRC:\r\n    src_ip:\r\n    - 185.77.129.106\r\n    - 185.144.82.239\r\n    - 93.113.131.103\r\n    - 185.86.149.54\r\n    - 185.86.151.104\r\n    - 103.41.177.43\r\n    - 185.86.148.184\r\n    - 185.94.191.65\r\n    - 86.106.131.54\r\n    - 169.239.12.133\r\n    - 185.86.151.2\r\n  SelectionDST:\r\n    dst_ip:\r\n    - 185.77.129.106\r\n    - 185.144.82.239\r\n    - 93.113.131.103\r\n    - 185.86.149.54\r\n    - 185.86.151.104\r\n    - 103.41.177.43\r\n    - 185.86.148.184\r\n    - 185.94.191.65\r\n    - 86.106.131.54\r\n    - 169.239.12.133\r\n    - 185.86.151.2\r\n  SelectionD:\r\n    destination.domain:\r\n    - secao.org\r\n    - ikmtrust.com\r\n    - sysanalyticweb.com\r\n    - lxwo.org\r\n    - jflynci.com\r\n    - remotepx.net\r\n    - rdsnets.com\r\n    - rpcnetconnect.com\r\n    - webstp.com\r\n    - elaxo.org\r\n  condition: SelectionSRC or SelectionDST or SelectionD\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "CZ3knmUBtApo-eN_h-AF": {"category": 2, "updated": "2018-10-23T16:00:21.000Z", "hash": "ecf4a3fced389f72443a683a183904a490431d2360344f1bdccd83961af5449a", "title": "Ps.exe Renamed SysInternals Tool", "permission_id": 3, "title_keyword": "Ps.exe Renamed SysInternals Tool", "released": "2017-10-22T10:55:26.000Z", "sigma_text": "title: Ps.exe Renamed SysInternals Tool\r\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report\r\nreferences:\r\n- https://www.us-cert.gov/ncas/alerts/TA17-293A\r\ntags:\r\n- attack.defense_evasion\r\n- attack.g0035\r\n- attack.t1036\r\nauthor: Florian Roth\r\ndate: 2017/10/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: ps.exe -accepteula\r\n  condition: selection\r\nfalsepositives:\r\n- Renamed SysInternals tool\r\nlevel: high", "git_filepath": "/apt/apt_ta17_293a_ps.yml", "sigma_text_keyword": "title: Ps.exe Renamed SysInternals Tool\r\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report\r\nreferences:\r\n- https://www.us-cert.gov/ncas/alerts/TA17-293A\r\ntags:\r\n- attack.defense_evasion\r\n- attack.g0035\r\n- attack.t1036\r\nauthor: Florian Roth\r\ndate: 2017/10/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: ps.exe -accepteula\r\n  condition: selection\r\nfalsepositives:\r\n- Renamed SysInternals tool\r\nlevel: high"}, "VZ3knmUBtApo-eN_juGw": {"category": 11, "updated": "2019-02-26T15:23:15.000Z", "hash": "f58f69867dcfd0576e811fce20743bb8786785c87234451001b9ce39f51ee8b0", "title": "Weak Encryption Enabled and Kerberoast", "permission_id": 3, "title_keyword": "Weak Encryption Enabled and Kerberoast", "released": "2017-04-03T13:12:58.000Z", "sigma_text": "title: Weak Encryption Enabled and Kerberoast\r\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\r\nreferences:\r\n- https://adsecurity.org/?p=2053\r\n- https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\r\ndetection:\r\n  selection:\r\n    EventID: 4738\r\n  keywords:\r\n  - DES\r\n  - Preauth\r\n  - Encrypted\r\n  filters:\r\n  - Enabled\r\n  condition: selection and keywords and filters\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/builtin/win_alert_enable_weak_encryption.yml", "sigma_text_keyword": "title: Weak Encryption Enabled and Kerberoast\r\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\r\nreferences:\r\n- https://adsecurity.org/?p=2053\r\n- https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\r\ndetection:\r\n  selection:\r\n    EventID: 4738\r\n  keywords:\r\n  - DES\r\n  - Preauth\r\n  - Encrypted\r\n  filters:\r\n  - Enabled\r\n  condition: selection and keywords and filters\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "3iUgO2cBqjf_D59HS5V8": {"category": 8, "updated": "2019-01-02T15:12:25.000Z", "hash": "6ac5f124e2c0964d8074c3b15eef614adb8a771c317266e4944a431fcf8eecd9", "title": "Detecting Gamaredon Group's C&C servers IP addresses and domains (Proxy)", "permission_id": 3, "title_keyword": "Detecting Gamaredon Group's C&C servers IP addresses and domains (Proxy)", "released": "2018-11-22T11:13:51.000Z", "sigma_text": "title: Detecting Gamaredon Group's C&C servers IP addresses and domains (Proxy)\r\ndescription: This rule detects network connections to compromised IPs and domains related with Gamaredon Group activity (Proxy - domain/IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection1:\r\n    src_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection2:\r\n    dst_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection3:\r\n    resource.URL:\r\n    - natos-drp.ddns.net\r\n    - nato-drp.ddns.net\r\n    - updates-spreadwork.pw\r\n    - ukraine-news.ddns.net\r\n    - ukraina-drp.ddns.net\r\n    - tovar-es.ddns.net\r\n    - start-usb.ddns.net\r\n    - sovetkirov.ddns.net\r\n    - singles-office.ddns.net\r\n    - single-office.ddns.net\r\n    - yousister.ddns.net\r\n    - wq03.ddns.net\r\n    - wq02.ddns.net\r\n    - wq01.ddns.net\r\n    - werdikt.ddns.net\r\n    - wareface.ddns.net\r\n    - vnc-new.ddns.net\r\n    - ut03.ddns.net\r\n    - ut02.ddns.net\r\n    - ut01.ddns.net\r\n    - us03.ddns.net\r\n    - us02.ddns.net\r\n    - us01.ddns.net\r\n    - topline.myftp.org\r\n    - sushi-bar.ddns.net\r\n    - po03.ddns.net\r\n    - po02.ddns.net\r\n    - po01.ddns.net\r\n    - pk03.ddns.net\r\n    - pk02.ddns.net\r\n    - pk01.ddns.net\r\n    - orizoh88.ddns.net\r\n    - optima-se.ddns.net\r\n    - new-club.ddns.net\r\n    - mykarina.ddns.net\r\n    - microsoft-single.ddns.net\r\n    - metro-exodus.ddns.net\r\n    - marishka.ddns.net\r\n    - macdocs.ddns.net\r\n    - karasto01.ddns.net\r\n    - gr03.ddns.net\r\n    - gr02.ddns.net\r\n    - gr01.ddns.net\r\n    - connect-updates.ddns.net\r\n    - chrome-update.ddns.net\r\n    - samotsvety.com.ua\r\n    - admin-ru.ru\r\n    - adobe.update-service.net\r\n    - apploadapp.webhop.me\r\n    - brokbridge.com\r\n    - cat.gotdns.ch\r\n    - check-update.ru\r\n    - childrights.in.ua\r\n    - conhost.myftp.org\r\n    - docdownload.ddns.net\r\n    - downloads.email-attachments.ru\r\n    - downloads.file-attachments.ru\r\n    - dyndownload.serveirc.com\r\n    - e.muravej.ua\r\n    - email-attachments.ru\r\n    - file-attachments.ru\r\n    - freefiles.myftp.biz\r\n    - getmyfile.webhop.me\r\n    - googlefiles.serveftp.com\r\n    - grom56.ddns.net\r\n    - grom90.ddns.net\r\n    - hrome-update.ru\r\n    - hrome-updater.ru\r\n    - loaderskypetm.webhop.me\r\n    - loadsoulip.serveftp.com\r\n    - mail.file-attachments.ru\r\n    - mails.redirectme.net\r\n    - mars-ru.ru\r\n    - msrestore.ru\r\n    - oficialsite.webhop.me\r\n    - parkingdoma.webhop.me\r\n    - poligjong.webhop.me\r\n    - polistar.ddns.net\r\n    - proxy-spread.ru\r\n    - rms.admin-ru.ru\r\n    - skypeemocache.ru\r\n    - skypeupdate.ru\r\n    - spbpool.ddns.net\r\n    - spread-service.ru\r\n    - spread-ss.ru\r\n    - spread-updates.ru\r\n    - stor.tainfo.com.ua\r\n    - tortilla.sytes.net\r\n    - ukrnet.serveftp.com\r\n    - ukrway.galaktion.ru\r\n    - umachka.ua\r\n    - update-service.net\r\n    - updatesp.ddns.net\r\n    - updateviber.sytes.net\r\n    - webclidie.webhop.me\r\n    - win-restore.ru\r\n    - winloaded.sytes.net\r\n    - winupdateloader.ru\r\n    - www.file-attachments.ru\r\n    - www.win-restore.ru\r\n    - yfperoliz.webhop.me\r\n    - prestigeclub.frantov.com.ua\r\n    - viberload.ddns.net\r\n  condition: selection1 or selection2 or selection3\r\nfields:\r\n- source.ip\r\n- destination.ip\r\n- resource.URL\r\nfalsepositives:\r\n- Clean URLs related to mentioned IPs.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: Detecting Gamaredon Group's C&C servers IP addresses and domains (Proxy)\r\ndescription: This rule detects network connections to compromised IPs and domains related with Gamaredon Group activity (Proxy - domain/IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection1:\r\n    src_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection2:\r\n    dst_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection3:\r\n    resource.URL:\r\n    - natos-drp.ddns.net\r\n    - nato-drp.ddns.net\r\n    - updates-spreadwork.pw\r\n    - ukraine-news.ddns.net\r\n    - ukraina-drp.ddns.net\r\n    - tovar-es.ddns.net\r\n    - start-usb.ddns.net\r\n    - sovetkirov.ddns.net\r\n    - singles-office.ddns.net\r\n    - single-office.ddns.net\r\n    - yousister.ddns.net\r\n    - wq03.ddns.net\r\n    - wq02.ddns.net\r\n    - wq01.ddns.net\r\n    - werdikt.ddns.net\r\n    - wareface.ddns.net\r\n    - vnc-new.ddns.net\r\n    - ut03.ddns.net\r\n    - ut02.ddns.net\r\n    - ut01.ddns.net\r\n    - us03.ddns.net\r\n    - us02.ddns.net\r\n    - us01.ddns.net\r\n    - topline.myftp.org\r\n    - sushi-bar.ddns.net\r\n    - po03.ddns.net\r\n    - po02.ddns.net\r\n    - po01.ddns.net\r\n    - pk03.ddns.net\r\n    - pk02.ddns.net\r\n    - pk01.ddns.net\r\n    - orizoh88.ddns.net\r\n    - optima-se.ddns.net\r\n    - new-club.ddns.net\r\n    - mykarina.ddns.net\r\n    - microsoft-single.ddns.net\r\n    - metro-exodus.ddns.net\r\n    - marishka.ddns.net\r\n    - macdocs.ddns.net\r\n    - karasto01.ddns.net\r\n    - gr03.ddns.net\r\n    - gr02.ddns.net\r\n    - gr01.ddns.net\r\n    - connect-updates.ddns.net\r\n    - chrome-update.ddns.net\r\n    - samotsvety.com.ua\r\n    - admin-ru.ru\r\n    - adobe.update-service.net\r\n    - apploadapp.webhop.me\r\n    - brokbridge.com\r\n    - cat.gotdns.ch\r\n    - check-update.ru\r\n    - childrights.in.ua\r\n    - conhost.myftp.org\r\n    - docdownload.ddns.net\r\n    - downloads.email-attachments.ru\r\n    - downloads.file-attachments.ru\r\n    - dyndownload.serveirc.com\r\n    - e.muravej.ua\r\n    - email-attachments.ru\r\n    - file-attachments.ru\r\n    - freefiles.myftp.biz\r\n    - getmyfile.webhop.me\r\n    - googlefiles.serveftp.com\r\n    - grom56.ddns.net\r\n    - grom90.ddns.net\r\n    - hrome-update.ru\r\n    - hrome-updater.ru\r\n    - loaderskypetm.webhop.me\r\n    - loadsoulip.serveftp.com\r\n    - mail.file-attachments.ru\r\n    - mails.redirectme.net\r\n    - mars-ru.ru\r\n    - msrestore.ru\r\n    - oficialsite.webhop.me\r\n    - parkingdoma.webhop.me\r\n    - poligjong.webhop.me\r\n    - polistar.ddns.net\r\n    - proxy-spread.ru\r\n    - rms.admin-ru.ru\r\n    - skypeemocache.ru\r\n    - skypeupdate.ru\r\n    - spbpool.ddns.net\r\n    - spread-service.ru\r\n    - spread-ss.ru\r\n    - spread-updates.ru\r\n    - stor.tainfo.com.ua\r\n    - tortilla.sytes.net\r\n    - ukrnet.serveftp.com\r\n    - ukrway.galaktion.ru\r\n    - umachka.ua\r\n    - update-service.net\r\n    - updatesp.ddns.net\r\n    - updateviber.sytes.net\r\n    - webclidie.webhop.me\r\n    - win-restore.ru\r\n    - winloaded.sytes.net\r\n    - winupdateloader.ru\r\n    - www.file-attachments.ru\r\n    - www.win-restore.ru\r\n    - yfperoliz.webhop.me\r\n    - prestigeclub.frantov.com.ua\r\n    - viberload.ddns.net\r\n  condition: selection1 or selection2 or selection3\r\nfields:\r\n- source.ip\r\n- destination.ip\r\n- resource.URL\r\nfalsepositives:\r\n- Clean URLs related to mentioned IPs.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "qp3knmUBtApo-eN_luJu": {"category": 15, "updated": "2018-10-25T13:33:35.000Z", "hash": "d453b4d7d866868c9773ae07c5ec0f56345857357b2ca3e2d46ef4bc197ac6c9", "title": "Exploit for CVE-2017-0261", "permission_id": 3, "title_keyword": "Exploit for CVE-2017-0261", "released": "2018-02-22T12:29:19.000Z", "sigma_text": "title: Exploit for CVE-2017-0261\r\nstatus: experimental\r\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\r\nauthor: Florian Roth\r\ndate: 2018/02/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\FLTLDR.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_0261.yml", "sigma_text_keyword": "title: Exploit for CVE-2017-0261\r\nstatus: experimental\r\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\r\nauthor: Florian Roth\r\ndate: 2018/02/22\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\WINWORD.EXE'\r\n    Image: '*\\FLTLDR.exe*'\r\n  condition: selection\r\nfalsepositives:\r\n- Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)\r\nlevel: medium"}, "KZ3knmUBtApo-eN_k-KY": {"category": 11, "updated": "2018-10-25T10:15:07.000Z", "hash": "f2bf8e7b8a96fe9a80c58b2be07b52ac4244e2229c92d58456e9f888c9115a64", "title": "Interactive Logon to Server Systems", "permission_id": 3, "title_keyword": "Interactive Logon to Server Systems", "released": "2017-03-17T08:44:24.000Z", "sigma_text": "title: Interactive Logon to Server Systems\r\ndescription: Detects interactive console logons to\r\nauthor: Florian Roth\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1078\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"528\"\r\n    - \"529\"\r\n    - \"4624\"\r\n    - \"4625\"\r\n    LogonType: \"2\"\r\n    ComputerName:\r\n    - '%ServerSystems%'\r\n    - '%DomainControllers%'\r\n  filter:\r\n    LogonProcessName: Advapi\r\n    ComputerName: '%Workstations%'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrative activity via KVM or ILO board\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_interactive_logons.yml", "sigma_text_keyword": "title: Interactive Logon to Server Systems\r\ndescription: Detects interactive console logons to\r\nauthor: Florian Roth\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1078\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"528\"\r\n    - \"529\"\r\n    - \"4624\"\r\n    - \"4625\"\r\n    LogonType: \"2\"\r\n    ComputerName:\r\n    - '%ServerSystems%'\r\n    - '%DomainControllers%'\r\n  filter:\r\n    LogonProcessName: Advapi\r\n    ComputerName: '%Workstations%'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrative activity via KVM or ILO board\r\nlevel: medium"}, "dZ3knmUBtApo-eN_p-VO": {"category": 11, "updated": "2019-02-26T15:35:25.000Z", "hash": "4590dcd10a78cc8e3777630d1ad75f12956873b09fc628f35bcc2256cb09b749", "title": "Security Eventlog Cleared", "permission_id": 3, "title_keyword": "Security Eventlog Cleared", "released": "2017-02-18T23:31:59.000Z", "sigma_text": "title: Security Eventlog Cleared\r\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1070\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 517\r\n    - 1102\r\n    - 104\r\n  condition: selection\r\nfalsepositives:\r\n- Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\r\n- System provisioning (system reset before the golden image creation)\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_security_eventlog_cleared.yml", "sigma_text_keyword": "title: Security Eventlog Cleared\r\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1070\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 517\r\n    - 1102\r\n    - 104\r\n  condition: selection\r\nfalsepositives:\r\n- Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\r\n- System provisioning (system reset before the golden image creation)\r\nlevel: high"}, "bp3knmUBtApo-eN_oeRq": {"category": 15, "updated": "2019-02-26T15:03:33.000Z", "hash": "84a670d6cdbbee477db0cb0d9a399cb4f6fcb06faaf72e925d83b89ddb5ec06a", "title": "Execution in Non-Executable Folder", "permission_id": 3, "title_keyword": "Execution in Non-Executable Folder", "released": "2017-03-13T22:56:06.000Z", "sigma_text": "title: Execution in Non-Executable Folder\r\nstatus: experimental\r\ndescription: Detects a suspicious exection from an uncommon folder\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\All Users\\\\*'\r\n    - '*\\Users\\Default\\\\*'\r\n    - '*\\Users\\Public\\\\*'\r\n    - C:\\Perflogs\\\\*\r\n    - '*\\config\\systemprofile\\\\*'\r\n    - '*\\Windows\\Fonts\\\\*'\r\n    - '*\\Windows\\IME\\\\*'\r\n    - '*\\Windows\\addins\\\\*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_execution_path.yml", "sigma_text_keyword": "title: Execution in Non-Executable Folder\r\nstatus: experimental\r\ndescription: Detects a suspicious exection from an uncommon folder\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\All Users\\\\*'\r\n    - '*\\Users\\Default\\\\*'\r\n    - '*\\Users\\Public\\\\*'\r\n    - C:\\Perflogs\\\\*\r\n    - '*\\config\\systemprofile\\\\*'\r\n    - '*\\Windows\\Fonts\\\\*'\r\n    - '*\\Windows\\IME\\\\*'\r\n    - '*\\Windows\\addins\\\\*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "N53knmUBtApo-eN_iOAH": {"category": 11, "updated": "2019-02-26T15:25:23.000Z", "hash": "3b8f0f813b71d165771f1e965903aa0e9400a876c141755cae487c4b6f9656c9", "title": "Rare Schtasks Creations", "permission_id": 3, "title_keyword": "Rare Schtasks Creations", "released": "2017-03-23T10:45:10.000Z", "sigma_text": "title: Rare Schtasks Creations\r\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\r\nstatus: experimental\r\nauthor: Florian Roth\r\ntags:\r\n- attack.execution\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1053\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.\r\ndetection:\r\n  selection:\r\n    EventID: 4698\r\n  timeframe: 7d\r\n  condition: selection | count(TaskName) < 5\r\nfalsepositives:\r\n- Software installation\r\n- Software updates\r\nlevel: low", "git_filepath": "/windows/builtin/win_rare_schtasks_creations.yml", "sigma_text_keyword": "title: Rare Schtasks Creations\r\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\r\nstatus: experimental\r\nauthor: Florian Roth\r\ntags:\r\n- attack.execution\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1053\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.\r\ndetection:\r\n  selection:\r\n    EventID: 4698\r\n  timeframe: 7d\r\n  condition: selection | count(TaskName) < 5\r\nfalsepositives:\r\n- Software installation\r\n- Software updates\r\nlevel: low"}, "HJ3knmUBtApo-eN_k-JR": {"category": 11, "updated": "2018-10-26T16:24:09.000Z", "hash": "b97378c5948383b95bb2717b785889344f07c3f258e69eb235adadddfcfcbcd2", "title": "Password Change on Directory Service Restore Mode (DSRM) Account", "permission_id": 3, "title_keyword": "Password Change on Directory Service Restore Mode (DSRM) Account", "released": "2017-02-19T21:43:27.000Z", "sigma_text": "title: Password Change on Directory Service Restore Mode (DSRM) Account\r\nstatus: stable\r\ndescription: The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.\r\nreferences:\r\n- https://adsecurity.org/?p=1714\r\nauthor: Thomas Patzke\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4794\"\r\n  condition: selection\r\nfalsepositives:\r\n- Initial installation of a domain controller\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_dsrm_password_change.yml", "sigma_text_keyword": "title: Password Change on Directory Service Restore Mode (DSRM) Account\r\nstatus: stable\r\ndescription: The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.\r\nreferences:\r\n- https://adsecurity.org/?p=1714\r\nauthor: Thomas Patzke\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4794\"\r\n  condition: selection\r\nfalsepositives:\r\n- Initial installation of a domain controller\r\nlevel: high"}, "LZ3knmUBtApo-eN_h-DS": {"category": 14, "updated": "2019-02-26T13:37:50.000Z", "hash": "279683ef8df54ce7f7e0fd54b11c73e511a28c483289ffec4e3b40102935083e", "title": "Malicious PowerShell Keywords", "permission_id": 3, "title_keyword": "Malicious PowerShell Keywords", "released": "2017-03-05T00:47:25.000Z", "sigma_text": "title: Malicious PowerShell Keywords\r\nstatus: experimental\r\ndescription: Detects keywords from well-known PowerShell exploitation frameworks\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keywords:\r\n  - AdjustTokenPrivileges\r\n  - IMAGE_NT_OPTIONAL_HDR64_MAGIC\r\n  - Management.Automation.RuntimeException\r\n  - Microsoft.Win32.UnsafeNativeMethods\r\n  - ReadProcessMemory.Invoke\r\n  - Runtime.InteropServices\r\n  - SE_PRIVILEGE_ENABLED\r\n  - System.Security.Cryptography\r\n  - System.Runtime.InteropServices\r\n  - LSA_UNICODE_STRING\r\n  - MiniDumpWriteDump\r\n  - PAGE_EXECUTE_READ\r\n  - Net.Sockets.SocketFlags\r\n  - Reflection.Assembly\r\n  - SECURITY_DELEGATION\r\n  - TOKEN_ADJUST_PRIVILEGES\r\n  - TOKEN_ALL_ACCESS\r\n  - TOKEN_ASSIGN_PRIMARY\r\n  - TOKEN_DUPLICATE\r\n  - TOKEN_ELEVATION\r\n  - TOKEN_IMPERSONATE\r\n  - TOKEN_INFORMATION_CLASS\r\n  - TOKEN_PRIVILEGES\r\n  - TOKEN_QUERY\r\n  - Metasploit\r\n  - Mimikatz\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_malicious_keywords.yml", "sigma_text_keyword": "title: Malicious PowerShell Keywords\r\nstatus: experimental\r\ndescription: Detects keywords from well-known PowerShell exploitation frameworks\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keywords:\r\n  - AdjustTokenPrivileges\r\n  - IMAGE_NT_OPTIONAL_HDR64_MAGIC\r\n  - Management.Automation.RuntimeException\r\n  - Microsoft.Win32.UnsafeNativeMethods\r\n  - ReadProcessMemory.Invoke\r\n  - Runtime.InteropServices\r\n  - SE_PRIVILEGE_ENABLED\r\n  - System.Security.Cryptography\r\n  - System.Runtime.InteropServices\r\n  - LSA_UNICODE_STRING\r\n  - MiniDumpWriteDump\r\n  - PAGE_EXECUTE_READ\r\n  - Net.Sockets.SocketFlags\r\n  - Reflection.Assembly\r\n  - SECURITY_DELEGATION\r\n  - TOKEN_ADJUST_PRIVILEGES\r\n  - TOKEN_ALL_ACCESS\r\n  - TOKEN_ASSIGN_PRIMARY\r\n  - TOKEN_DUPLICATE\r\n  - TOKEN_ELEVATION\r\n  - TOKEN_IMPERSONATE\r\n  - TOKEN_INFORMATION_CLASS\r\n  - TOKEN_PRIVILEGES\r\n  - TOKEN_QUERY\r\n  - Metasploit\r\n  - Mimikatz\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high"}, "353knmUBtApo-eN_sOYB": {"category": 14, "updated": "2019-02-26T13:39:25.000Z", "hash": "2017c3976ac578ef1bb079745cd396835fd3c5ce7aa6860338aaa8fd34d7c737", "title": "PowerShell PSAttack", "permission_id": 3, "title_keyword": "PowerShell PSAttack", "released": "2017-03-05T00:47:25.000Z", "sigma_text": "title: PowerShell PSAttack\r\nstatus: experimental\r\ndescription: Detects the use of PSAttack PowerShell hack tool\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  selection:\r\n    EventID: 4103\r\n  keyword:\r\n  - PS ATTACK!!!\r\n  condition: selection and keyword\r\nfalsepositives:\r\n- Pentesters\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_psattack.yml", "sigma_text_keyword": "title: PowerShell PSAttack\r\nstatus: experimental\r\ndescription: Detects the use of PSAttack PowerShell hack tool\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  selection:\r\n    EventID: 4103\r\n  keyword:\r\n  - PS ATTACK!!!\r\n  condition: selection and keyword\r\nfalsepositives:\r\n- Pentesters\r\nlevel: high"}, "qZ3knmUBtApo-eN_nOPq": {"category": 2, "updated": "2018-10-23T15:57:28.000Z", "hash": "ebfcc78532a2f5e8aed0d28008936fd5a0dcc2b86f99de70f4fda640e0fe8fd2", "title": "Elise Backdoor", "permission_id": 3, "title_keyword": "Elise Backdoor", "released": "2018-01-31T22:52:24.000Z", "sigma_text": "title: Elise Backdoor\r\nstatus: experimental\r\ndescription: Detects Elise backdoor acitivty as used by APT32\r\nreferences:\r\n- https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting\r\ntags:\r\n- attack.g0030\r\n- attack.g0050\r\n- attack.s0081\r\nauthor: Florian Roth\r\ndate: 2018/01/31\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    Image: C:\\Windows\\SysWOW64\\cmd.exe\r\n    CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\r\n  selection2:\r\n    EventID: \"1\"\r\n    CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical", "git_filepath": "/apt/apt_elise.yml", "sigma_text_keyword": "title: Elise Backdoor\r\nstatus: experimental\r\ndescription: Detects Elise backdoor acitivty as used by APT32\r\nreferences:\r\n- https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting\r\ntags:\r\n- attack.g0030\r\n- attack.g0050\r\n- attack.s0081\r\nauthor: Florian Roth\r\ndate: 2018/01/31\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    Image: C:\\Windows\\SysWOW64\\cmd.exe\r\n    CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\r\n  selection2:\r\n    EventID: \"1\"\r\n    CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical"}, "YJ3knmUBtApo-eN_juH9": {"category": 5, "updated": "2019-02-26T14:16:33.000Z", "hash": "c615ff4ea194c528ee10802af0cdd6b332aec5a2a908a869b32ab625266a12df", "title": "Empty User Agent", "permission_id": 3, "title_keyword": "Empty User Agent", "released": "2017-07-08T14:37:44.000Z", "sigma_text": "title: Empty User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious empty user agent strings in proxy logs\r\nreferences:\r\n- https://twitter.com/Carlos_Perez/status/883455096645931008\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: \"\"\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium", "git_filepath": "/proxy/proxy_empty_ua.yml", "sigma_text_keyword": "title: Empty User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious empty user agent strings in proxy logs\r\nreferences:\r\n- https://twitter.com/Carlos_Perez/status/883455096645931008\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: \"\"\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium"}, "pJ3knmUBtApo-eN_kOG6": {"category": 15, "updated": "2019-02-26T14:40:36.000Z", "hash": "319cf10e0af29e2a8688c932f05f325317811bfda0cc4020acd7b9c27b23db85", "title": "Suspicious TSCON Start", "permission_id": 3, "title_keyword": "Suspicious TSCON Start", "released": "2018-03-17T18:14:13.000Z", "sigma_text": "title: Suspicious TSCON Start\r\nstatus: experimental\r\ndescription: Detects a tscon.exe start as LOCAL SYSTEM\r\nreference:\r\n- http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\r\n- https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\r\nauthor: Florian Roth\r\ndate: 2018/03/17\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    User: NT AUTHORITY\\SYSTEM\r\n    Image: '*\\tscon.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_tscon_localsystem.yml", "sigma_text_keyword": "title: Suspicious TSCON Start\r\nstatus: experimental\r\ndescription: Detects a tscon.exe start as LOCAL SYSTEM\r\nreference:\r\n- http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\r\n- https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\r\nauthor: Florian Roth\r\ndate: 2018/03/17\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    User: NT AUTHORITY\\SYSTEM\r\n    Image: '*\\tscon.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "e53knmUBtApo-eN_leJO": {"category": 15, "updated": "2019-02-26T14:35:31.000Z", "hash": "fb0822e4a12b1a3bced67e937ca329e6d2bd1f5b30420b1eaa9011923141f460", "title": "Scheduled Task Creation", "permission_id": 3, "title_keyword": "Scheduled Task Creation", "released": "2017-03-13T19:45:28.000Z", "sigma_text": "title: Scheduled Task Creation\r\nstatus: experimental\r\ndescription: Detects the creation of scheduled tasks in user session\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\schtasks.exe'\r\n    CommandLine: '* /create *'\r\n  filter:\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.privelege_escalation\r\n- attack.t1053\r\n- attack.s0111\r\nfalsepositives:\r\n- Administrative activity\r\n- Software installation\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_susp_schtask_creation.yml", "sigma_text_keyword": "title: Scheduled Task Creation\r\nstatus: experimental\r\ndescription: Detects the creation of scheduled tasks in user session\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\schtasks.exe'\r\n    CommandLine: '* /create *'\r\n  filter:\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.privelege_escalation\r\n- attack.t1053\r\n- attack.s0111\r\nfalsepositives:\r\n- Administrative activity\r\n- Software installation\r\nlevel: low"}, "fJ3knmUBtApo-eN_j-Gf": {"category": 15, "updated": "2018-10-24T09:33:03.000Z", "hash": "619b08b6c45141e28ec6f5e90a6332256f03635c0d4d806477ddda4045f90002", "title": "Office Macro Starts Cmd", "permission_id": 3, "title_keyword": "Office Macro Starts Cmd", "released": "2017-03-02T10:06:53.000Z", "sigma_text": "title: Office Macro Starts Cmd\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Word or Excel\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\WINWORD.EXE'\r\n    - '*\\EXCEL.EXE'\r\n    Image: '*\\cmd.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_office_macro_cmd.yml", "sigma_text_keyword": "title: Office Macro Starts Cmd\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Word or Excel\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\WINWORD.EXE'\r\n    - '*\\EXCEL.EXE'\r\n    Image: '*\\cmd.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "L53knmUBtApo-eN_jeHa": {"category": 1, "updated": "2018-10-25T09:51:11.000Z", "hash": "5c279f74e55d0eaf1ce425303faa5abd4a3d64dba1f57e9c1ce3034a470be605", "title": "Ruby on Rails framework exceptions", "permission_id": 3, "title_keyword": "Ruby on Rails framework exceptions", "released": "2017-08-11T22:43:10.000Z", "sigma_text": "title: Ruby on Rails framework exceptions\r\ndescription: Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- http://edgeguides.rubyonrails.org/security.html\r\n- http://guides.rubyonrails.org/action_controller_overview.html\r\n- https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception\r\n- https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb\r\nlogsource:\r\n  category: application\r\n  product: ruby_on_rails\r\ndetection:\r\n  keywords:\r\n  - ActionController::InvalidAuthenticityToken\r\n  - ActionController::InvalidCrossOriginRequest\r\n  - ActionController::MethodNotAllowed\r\n  - ActionController::BadRequest\r\n  - ActionController::ParameterMissing\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium", "git_filepath": "/application/appframework_ruby_on_rails_exceptions.yml", "sigma_text_keyword": "title: Ruby on Rails framework exceptions\r\ndescription: Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- http://edgeguides.rubyonrails.org/security.html\r\n- http://guides.rubyonrails.org/action_controller_overview.html\r\n- https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception\r\n- https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb\r\nlogsource:\r\n  category: application\r\n  product: ruby_on_rails\r\ndetection:\r\n  keywords:\r\n  - ActionController::InvalidAuthenticityToken\r\n  - ActionController::InvalidCrossOriginRequest\r\n  - ActionController::MethodNotAllowed\r\n  - ActionController::BadRequest\r\n  - ActionController::ParameterMissing\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium"}, "a21u9GcBFVBAemBcClyU": {"category": 8, "updated": "2019-01-25T10:00:05.000Z", "hash": "36f90a4f6c59646964065d81c999f8d65f2420ec44d669ec642040a2c657f42c", "title": "Possible Process Enumeration (Sysmon/Windows Logs).", "permission_id": 3, "title_keyword": "Possible Process Enumeration (Sysmon/Windows Logs).", "released": "2019-01-25T10:00:05.000Z", "sigma_text": "title: Possible Process Enumeration (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network.\r\nreferences:\r\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/tasklist\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-6\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - tasklist.exe\r\n    - Get-Process*\r\n  selection1:\r\n  - event_id: 1\r\n  selection2:\r\n  - event_id: 4688\r\n  condition: (selection1 or selection2) and selection0\r\nfalsepositives:\r\n- Medium\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1057", "git_filepath": "", "sigma_text_keyword": "title: Possible Process Enumeration (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network.\r\nreferences:\r\n- https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/tasklist\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-6\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - tasklist.exe\r\n    - Get-Process*\r\n  selection1:\r\n  - event_id: 1\r\n  selection2:\r\n  - event_id: 4688\r\n  condition: (selection1 or selection2) and selection0\r\nfalsepositives:\r\n- Medium\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1057"}, "Ep3knmUBtApo-eN_jeEh": {"category": 8, "updated": "2018-10-31T11:03:37.000Z", "hash": "fc6f5a35345022f2cc9797d49d548600f589cf2b0357fdfbce4ffed9649682d4", "title": "VPNFilter Destructive Malware detection (domain/IP)", "permission_id": 3, "title_keyword": "VPNFilter Destructive Malware detection (domain/IP)", "released": "2018-05-24T03:41:26.000Z", "sigma_text": "title: VPNFilter Destructive Malware detection (domain/IP)\r\ndescription: This rule detects VPNFilter Destructive Malware  activity (domain/IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nstatus: testing\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection1:\r\n    URL:\r\n    - photobucket.com/user/nikkireed11/library\r\n    - photobucket.com/user/nikkireed11/library\r\n    - photobucket.com/user/kmila302/library\r\n    - photobucket.com/user/lisabraun87/library\r\n    - photobucket.com/user/eva_green1/library\r\n    - photobucket.com/user/monicabelci4/library\r\n    - photobucket.com/user/katyperry45/library\r\n    - photobucket.com/user/saragray1/library\r\n    - photobucket.com/user/millerfred/library\r\n    - photobucket.com/user/jeniferaniston1/library\r\n    - photobucket.com/user/amandaseyfried1/library\r\n    - photobucket.com/user/suwe8/library\r\n    - photobucket.com/user/bob7301/library\r\n    - toknowall.com\r\n  selection2:\r\n    SourceIP:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  selection3:\r\n    DestinationIP:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  keywords:\r\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\r\n  - tljmmy4vmkqbdof4.onion/bin32/update.php\r\n  - zuh3vcyskd4gipkm.onion/bin32/update.php\r\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\r\n  condition: selection1 or selection2 or selection3 or keywords\r\nfields:\r\n- DestinationIp\r\n- URL\r\n- UserAgent\r\n- SourceIp\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ndate: 2018/05/24\r\nreference:\r\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\r\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\r\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\r\n- https://blogs.cisco.com/security/talos/vpnfilter\r\n- https://jask.com/from-russia-with-love/\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": null, "sigma_text_keyword": "title: VPNFilter Destructive Malware detection (domain/IP)\r\ndescription: This rule detects VPNFilter Destructive Malware  activity (domain/IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nstatus: testing\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection1:\r\n    URL:\r\n    - photobucket.com/user/nikkireed11/library\r\n    - photobucket.com/user/nikkireed11/library\r\n    - photobucket.com/user/kmila302/library\r\n    - photobucket.com/user/lisabraun87/library\r\n    - photobucket.com/user/eva_green1/library\r\n    - photobucket.com/user/monicabelci4/library\r\n    - photobucket.com/user/katyperry45/library\r\n    - photobucket.com/user/saragray1/library\r\n    - photobucket.com/user/millerfred/library\r\n    - photobucket.com/user/jeniferaniston1/library\r\n    - photobucket.com/user/amandaseyfried1/library\r\n    - photobucket.com/user/suwe8/library\r\n    - photobucket.com/user/bob7301/library\r\n    - toknowall.com\r\n  selection2:\r\n    SourceIP:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  selection3:\r\n    DestinationIP:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  keywords:\r\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\r\n  - tljmmy4vmkqbdof4.onion/bin32/update.php\r\n  - zuh3vcyskd4gipkm.onion/bin32/update.php\r\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\r\n  condition: selection1 or selection2 or selection3 or keywords\r\nfields:\r\n- DestinationIp\r\n- URL\r\n- UserAgent\r\n- SourceIp\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ndate: 2018/05/24\r\nreference:\r\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\r\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\r\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\r\n- https://blogs.cisco.com/security/talos/vpnfilter\r\n- https://jask.com/from-russia-with-love/\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "9J3knmUBtApo-eN_jOA0": {"category": 8, "updated": "2018-10-26T14:45:41.000Z", "hash": "b96e8b4adef8a47ff8c4cfdf11cc931bac407d1f372615e70c8efb26a6e7d94c", "title": "MSHTA spwaned by SVCHOST as seen in LethalHTA (Sysmon).", "permission_id": 3, "title_keyword": "MSHTA spwaned by SVCHOST as seen in LethalHTA (Sysmon).", "released": "2018-09-07T12:38:29.000Z", "sigma_text": "title: MSHTA spwaned by SVCHOST as seen in LethalHTA (Sysmon).\r\ndescription: Detects MSHTA.EXE spwaned by SVCHOST described in report.\r\nauthor: Markus Neis, Alexandr Yampolskyi\r\nreferences:\r\n- https://codewhitesec.blogspot.com/2018/07/lethalhta.html\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\svchost.exe'\r\n    Command_Line:\r\n    - '*/mshta.exe'\r\n  condition: selection\r\nfields:\r\n- ParentImage\r\n- Command_Line\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: MSHTA spwaned by SVCHOST as seen in LethalHTA (Sysmon).\r\ndescription: Detects MSHTA.EXE spwaned by SVCHOST described in report.\r\nauthor: Markus Neis, Alexandr Yampolskyi\r\nreferences:\r\n- https://codewhitesec.blogspot.com/2018/07/lethalhta.html\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\svchost.exe'\r\n    Command_Line:\r\n    - '*/mshta.exe'\r\n  condition: selection\r\nfields:\r\n- ParentImage\r\n- Command_Line\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "rJ3knmUBtApo-eN_rub3": {"category": 13, "updated": "2019-02-26T15:14:55.000Z", "hash": "4df4302f61fa2e364afe83f64319eae23405274d01318b0132a69636023821f6", "title": "WMI Persistence", "permission_id": 3, "title_keyword": "WMI Persistence", "released": "2017-08-22T08:02:54.000Z", "sigma_text": "title: WMI Persistence\r\nstatus: experimental\r\ndescription: Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)\r\nauthor: Florian Roth\r\nreferences:\r\n- https://twitter.com/mattifestation/status/899646620148539397\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.t1047\r\nlogsource:\r\n  product: windows\r\n  service: wmi\r\ndetection:\r\n  selection:\r\n    EventID: 5861\r\n  keywords:\r\n  - ActiveScriptEventConsumer\r\n  - CommandLineEventConsumer\r\n  - CommandLineTemplate\r\n  - Binding EventFilter\r\n  selection2:\r\n    EventID: 5859\r\n  condition: (selection and keywords) or selection2\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high", "git_filepath": "/windows/other/win_wmi_persistence.yml", "sigma_text_keyword": "title: WMI Persistence\r\nstatus: experimental\r\ndescription: Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)\r\nauthor: Florian Roth\r\nreferences:\r\n- https://twitter.com/mattifestation/status/899646620148539397\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.t1047\r\nlogsource:\r\n  product: windows\r\n  service: wmi\r\ndetection:\r\n  selection:\r\n    EventID: 5861\r\n  keywords:\r\n  - ActiveScriptEventConsumer\r\n  - CommandLineEventConsumer\r\n  - CommandLineTemplate\r\n  - Binding EventFilter\r\n  selection2:\r\n    EventID: 5859\r\n  condition: (selection and keywords) or selection2\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high"}, "Pp3knmUBtApo-eN_puU3": {"category": 14, "updated": "2019-02-26T13:39:00.000Z", "hash": "8f6807591f26398330e9e9227c23566157876669737d97829fa5a453d7c653ca", "title": "Suspicious PowerShell Invocations - Specific", "permission_id": 3, "title_keyword": "Suspicious PowerShell Invocations - Specific", "released": "2017-03-12T16:06:53.000Z", "sigma_text": "title: Suspicious PowerShell Invocations - Specific\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation command parameters\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keywords:\r\n  - ' -nop -w hidden -c * [Convert]::FromBase64String'\r\n  - ' -w hidden -noni -nop -c \"iex(New-Object'\r\n  - ' -w hidden -ep bypass -Enc'\r\n  - powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run\r\n  - bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download\r\n  - iex(New-Object Net.WebClient).Download\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_suspicious_invocation_specific.yml", "sigma_text_keyword": "title: Suspicious PowerShell Invocations - Specific\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation command parameters\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keywords:\r\n  - ' -nop -w hidden -c * [Convert]::FromBase64String'\r\n  - ' -w hidden -noni -nop -c \"iex(New-Object'\r\n  - ' -w hidden -ep bypass -Enc'\r\n  - powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run\r\n  - bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download\r\n  - iex(New-Object Net.WebClient).Download\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high"}, "uZ3knmUBtApo-eN_qOW6": {"category": 11, "updated": "2018-10-26T16:17:26.000Z", "hash": "41db409178c2ae95e7193dc326a2f2dadaa200dbb2c65256aaba311f1eb29ccf", "title": "USB Device Plugged", "permission_id": 3, "title_keyword": "USB Device Plugged", "released": "2017-11-09T07:40:46.000Z", "sigma_text": "title: USB Device Plugged\r\ndescription: Detects plugged USB devices\r\nreferences:\r\n- https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/\r\n- https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/\r\nstatus: experimental\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: driver-framework\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"2003\"\r\n    - \"2100\"\r\n    - \"2102\"\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low", "git_filepath": "/windows/builtin/win_usb_device_plugged.yml", "sigma_text_keyword": "title: USB Device Plugged\r\ndescription: Detects plugged USB devices\r\nreferences:\r\n- https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/\r\n- https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/\r\nstatus: experimental\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: driver-framework\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"2003\"\r\n    - \"2100\"\r\n    - \"2102\"\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low"}, "w26YFGkBFVBAemBciURx": {"category": 2, "updated": "2019-02-26T12:11:04.000Z", "hash": "1121a85064ed27d76d61e90db52dab17275ca57f2d4418b853c07e6345a0248f", "title": "CrackMapExecWin.", "permission_id": 3, "title_keyword": "CrackMapExecWin.", "released": "2019-02-22T09:45:34.000Z", "sigma_text": "title: CrackMapExecWin.\r\ndescription: Detects CrackMapExecWin Activity as Described by NCSC.\r\nreferences:\r\n- https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\r\nstatus: experimental\r\nauthor: Markus Neis, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    NewProcessName:\r\n    - '*\\crackmapexec.exe'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\crackmapexec.exe'\r\n  condition: selection1\r\nfalsepositives:\r\n- None.\r\nlevel: critical\r\ntags:\r\n- attack.g0035", "git_filepath": "/apt/apt_dragonfly.yml", "sigma_text_keyword": "title: CrackMapExecWin.\r\ndescription: Detects CrackMapExecWin Activity as Described by NCSC.\r\nreferences:\r\n- https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\r\nstatus: experimental\r\nauthor: Markus Neis, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    NewProcessName:\r\n    - '*\\crackmapexec.exe'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\crackmapexec.exe'\r\n  condition: selection1\r\nfalsepositives:\r\n- None.\r\nlevel: critical\r\ntags:\r\n- attack.g0035"}, "253knmUBtApo-eN_l-Ls": {"category": 8, "updated": "2018-10-26T14:40:11.000Z", "hash": "02c5fa844eb6c318e393b22d67176561b96c3d2500c3e8f837b70e835d0aa903", "title": "WatchdogProc usage (Sysmon).", "permission_id": 3, "title_keyword": "WatchdogProc usage (Sysmon).", "released": "2018-09-07T12:32:53.000Z", "sigma_text": "title: WatchdogProc usage (Sysmon).\r\ndescription: Detects watchdogproc on the command line.\r\nreferences:\r\n- https://www.endgame.com/blog/technical-blog/malware-personal-touch\r\n- https://media.blackhat.com/us-13/US-13-Geffner-End-To-End-Analysis-of-a-Domain-Generating-Algorithm-Malware-Family-WP.pdf\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - watchdogproc*\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- Not very common, but occurs.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: WatchdogProc usage (Sysmon).\r\ndescription: Detects watchdogproc on the command line.\r\nreferences:\r\n- https://www.endgame.com/blog/technical-blog/malware-personal-touch\r\n- https://media.blackhat.com/us-13/US-13-Geffner-End-To-End-Analysis-of-a-Domain-Generating-Algorithm-Malware-Family-WP.pdf\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - watchdogproc*\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- Not very common, but occurs.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059"}, "Cp3knmUBtApo-eN_kuL4": {"category": 14, "updated": "2019-02-26T13:37:13.000Z", "hash": "fde6bee198102bb36401e0443cc5aa2e09c69b4c28fd63567b9301355e6b7b93", "title": "PowerShell called from an Executable Version Mismatch", "permission_id": 3, "title_keyword": "PowerShell called from an Executable Version Mismatch", "released": "2017-03-05T00:47:25.000Z", "sigma_text": "title: PowerShell called from an Executable Version Mismatch\r\nstatus: experimental\r\ndescription: Detects PowerShell called from an executable by the version mismatch method\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell-classic\r\ndetection:\r\n  selection1:\r\n    EventID: 400\r\n    EngineVersion:\r\n    - 2.*\r\n    - 4.*\r\n    - 5.*\r\n    HostVersion: 3.*\r\n  condition: selection1\r\nfalsepositives:\r\n- Penetration Tests\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_exe_calling_ps.yml", "sigma_text_keyword": "title: PowerShell called from an Executable Version Mismatch\r\nstatus: experimental\r\ndescription: Detects PowerShell called from an executable by the version mismatch method\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell-classic\r\ndetection:\r\n  selection1:\r\n    EventID: 400\r\n    EngineVersion:\r\n    - 2.*\r\n    - 4.*\r\n    - 5.*\r\n    HostVersion: 3.*\r\n  condition: selection1\r\nfalsepositives:\r\n- Penetration Tests\r\n- Unknown\r\nlevel: high"}, "JJ3knmUBtApo-eN_h-CT": {"category": 15, "updated": "2019-02-26T14:40:16.000Z", "hash": "09b87d7951f2c3a1e4a99c62710beec68cd86620a34024ff1303b02c49f8d3d2", "title": "Microsoft Office Product Spawning Windows Shell", "permission_id": 3, "title_keyword": "Microsoft Office Product Spawning Windows Shell", "released": "2017-03-04T22:22:44.000Z", "sigma_text": "title: Microsoft Office Product Spawning Windows Shell\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\ntags:\r\n- attack.execution\r\n- attack.defense_evasion\r\n- attack.t1059\r\n- attack.T1202\r\nauthor: Michael Haag, Florian Roth, Markus Neis\r\ndate: 2018/04/06\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\WINWORD.EXE'\r\n    - '*\\EXCEL.EXE'\r\n    - '*\\POWERPNT.exe'\r\n    - '*\\MSPUB.exe'\r\n    - '*\\VISIO.exe'\r\n    - '*\\OUTLOOK.EXE'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\scrcons.exe'\r\n    - '*\\schtasks.exe'\r\n    - '*\\regsvr32.exe'\r\n    - '*\\hh.exe'\r\n    - '*\\wmic.exe'\r\n    - '*\\mshta.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\msiexec.exe'\r\n    - '*\\forfiles.exe'\r\n    - '*\\scriptrunner.exe'\r\n    - '*\\mftrace.exe'\r\n    - '*\\AppVLP.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_office_shell.yml", "sigma_text_keyword": "title: Microsoft Office Product Spawning Windows Shell\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\ntags:\r\n- attack.execution\r\n- attack.defense_evasion\r\n- attack.t1059\r\n- attack.T1202\r\nauthor: Michael Haag, Florian Roth, Markus Neis\r\ndate: 2018/04/06\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\WINWORD.EXE'\r\n    - '*\\EXCEL.EXE'\r\n    - '*\\POWERPNT.exe'\r\n    - '*\\MSPUB.exe'\r\n    - '*\\VISIO.exe'\r\n    - '*\\OUTLOOK.EXE'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\scrcons.exe'\r\n    - '*\\schtasks.exe'\r\n    - '*\\regsvr32.exe'\r\n    - '*\\hh.exe'\r\n    - '*\\wmic.exe'\r\n    - '*\\mshta.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\msiexec.exe'\r\n    - '*\\forfiles.exe'\r\n    - '*\\scriptrunner.exe'\r\n    - '*\\mftrace.exe'\r\n    - '*\\AppVLP.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "4J3knmUBtApo-eN_quUE": {"category": 6, "updated": "2018-10-23T16:17:04.000Z", "hash": "74966badd0ff8e36e23a8522edf6821736627cf166db87c8b1fb01c60db5f65a", "title": "Apache Segmentation Fault", "permission_id": 3, "title_keyword": "Apache Segmentation Fault", "released": "2017-02-28T16:53:06.000Z", "sigma_text": "title: Apache Segmentation Fault\r\ndescription: Detects a segmentation fault error message caused by a creashing apacke worker process\r\nauthor: Florian Roth\r\nreferences:\r\n- http://www.securityfocus.com/infocus/1633\r\nlogsource:\r\n  product: apache\r\ndetection:\r\n  keywords:\r\n  - exit signal Segmentation Fault\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/web/web_apache_segfault.yml", "sigma_text_keyword": "title: Apache Segmentation Fault\r\ndescription: Detects a segmentation fault error message caused by a creashing apacke worker process\r\nauthor: Florian Roth\r\nreferences:\r\n- http://www.securityfocus.com/infocus/1633\r\nlogsource:\r\n  product: apache\r\ndetection:\r\n  keywords:\r\n  - exit signal Segmentation Fault\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "cp3knmUBtApo-eN_ieBF": {"category": 15, "updated": "2018-10-23T11:38:02.000Z", "hash": "0bc9be2f5ddf0931e033ba3a2295e19eb9271c73027bfd06f3b349d7f4018600", "title": "Powershell AMSI Bypass via .NET Reflection", "permission_id": 3, "title_keyword": "Powershell AMSI Bypass via .NET Reflection", "released": "2018-08-17T16:26:04.000Z", "sigma_text": "title: Powershell AMSI Bypass via .NET Reflection\r\nstatus: experimental\r\ndescription: Detects Request to amsiInitFailed that can be used to disable AMSI Scanning\r\nreferences:\r\n- https://twitter.com/mattifestation/status/735261176745988096\r\n- https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120\r\nauthor: Markus Neis\r\ndate: 2018/08/17\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*System.Management.Automation.AmsiUtils*'\r\n  selection2:\r\n    CommandLine:\r\n    - '*amsiInitFailed*'\r\n  condition: selection1 and selection2\r\n  falsepositives:\r\n  - Potential Admin Activity\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_powershell_AMSI_bypass.yml", "sigma_text_keyword": "title: Powershell AMSI Bypass via .NET Reflection\r\nstatus: experimental\r\ndescription: Detects Request to amsiInitFailed that can be used to disable AMSI Scanning\r\nreferences:\r\n- https://twitter.com/mattifestation/status/735261176745988096\r\n- https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120\r\nauthor: Markus Neis\r\ndate: 2018/08/17\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*System.Management.Automation.AmsiUtils*'\r\n  selection2:\r\n    CommandLine:\r\n    - '*amsiInitFailed*'\r\n  condition: selection1 and selection2\r\n  falsepositives:\r\n  - Potential Admin Activity\r\nlevel: high"}, "0yWpO2cBqjf_D59HNJbW": {"category": 8, "updated": "2019-01-02T14:49:20.000Z", "hash": "4ecdf8235b027ea936df45a761f07ffd53d6e9b8e9a07737d6879b3d68ebbcaf", "title": "Evasion Base64 decode arguments in Powershell. (Possible APT29 activity)", "permission_id": 3, "title_keyword": "Evasion Base64 decode arguments in Powershell. (Possible APT29 activity)", "released": "2018-11-22T13:44:02.000Z", "sigma_text": "title: Evasion Base64 decode arguments in Powershell. (Possible APT29 activity)\r\ndescription: Powershell command included some specific obfuscation, which may indicate attempts to bypass specific detection logic.\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html\r\nauthor: Roman Ranskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_id: \"1\"\r\n  selection1:\r\n    event_data.CommandLine: \\'FromBase\\'+0x40+\\'String\\'\r\n  condition: selection0 and selection1\r\nfalsepositives:\r\n- low\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1027\r\n- attack.Execution\r\n- attack.t1086", "git_filepath": "", "sigma_text_keyword": "title: Evasion Base64 decode arguments in Powershell. (Possible APT29 activity)\r\ndescription: Powershell command included some specific obfuscation, which may indicate attempts to bypass specific detection logic.\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html\r\nauthor: Roman Ranskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_id: \"1\"\r\n  selection1:\r\n    event_data.CommandLine: \\'FromBase\\'+0x40+\\'String\\'\r\n  condition: selection0 and selection1\r\nfalsepositives:\r\n- low\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1027\r\n- attack.Execution\r\n- attack.t1086"}, "lZ3knmUBtApo-eN_ouRE": {"category": 8, "updated": "2019-01-02T14:57:23.000Z", "hash": "d37f7fd94bfc6aa8a983ffa5c3b0ad1681ae8a9c7140fa04679f00a42c7e6b31", "title": "Password stealer (PwdFetcher) detector (Sysmon).", "permission_id": 3, "title_keyword": "Password stealer (PwdFetcher) detector (Sysmon).", "released": "2018-07-19T12:14:24.000Z", "sigma_text": "title: Password stealer (PwdFetcher) detector (Sysmon).\r\ndescription: .\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 2A5C9D4DAE5E53B2962FBE2B7FA8798A127BC9A6\r\n    - 9B1586766AF9885EF960F05F8606D1230B36AC15\r\n    - A2F0D5AF81D93752CFF1CF1E8BB9E6CAEE6D1B5E\r\n    - CE18467B33161E39C36FC6C5B52F68D49ABCFC2A\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Password stealer (PwdFetcher) detector (Sysmon).\r\ndescription: .\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 2A5C9D4DAE5E53B2962FBE2B7FA8798A127BC9A6\r\n    - 9B1586766AF9885EF960F05F8606D1230B36AC15\r\n    - A2F0D5AF81D93752CFF1CF1E8BB9E6CAEE6D1B5E\r\n    - CE18467B33161E39C36FC6C5B52F68D49ABCFC2A\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "6J3knmUBtApo-eN_sOY5": {"category": 15, "updated": "2019-02-26T14:54:12.000Z", "hash": "f2462d81728a7dfd750aa3580f868a5a7036a33b31ce58674095c02bf1a986a7", "title": "Malicious Named Pipe", "permission_id": 3, "title_keyword": "Malicious Named Pipe", "released": "2017-11-06T13:24:42.000Z", "sigma_text": "title: Malicious Named Pipe\r\nstatus: experimental\r\ndescription: Detects the creation of a named pipe used by known APT malware\r\nreferences:\r\n- Various sources\r\ndate: 2017/11/06\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: Note that you have to configure logging for PipeEvents in Symson config\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 17\r\n    - 18\r\n    PipeName:\r\n    - \\isapi_http\r\n    - \\isapi_dg\r\n    - \\isapi_dg2\r\n    - \\sdlrpc\r\n    - \\ahexec\r\n    - \\winsession\r\n    - \\lsassw\r\n    - \\46a676ab7f179e511e30dd2dc41bd388\r\n    - \\9f81f59bc58452127884ce513865ed20\r\n    - \\e710f28d59aa529d6792ca6ff0ca1b34\r\n    - \\rpchlp_3\r\n    - \\NamePipe_MoreWindows\r\n    - \\pcheap_reuse\r\n    - \\NamePipe_MoreWindows\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privelege_escalation\r\n- attack.t1055\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_mal_namedpipes.yml", "sigma_text_keyword": "title: Malicious Named Pipe\r\nstatus: experimental\r\ndescription: Detects the creation of a named pipe used by known APT malware\r\nreferences:\r\n- Various sources\r\ndate: 2017/11/06\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: Note that you have to configure logging for PipeEvents in Symson config\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 17\r\n    - 18\r\n    PipeName:\r\n    - \\isapi_http\r\n    - \\isapi_dg\r\n    - \\isapi_dg2\r\n    - \\sdlrpc\r\n    - \\ahexec\r\n    - \\winsession\r\n    - \\lsassw\r\n    - \\46a676ab7f179e511e30dd2dc41bd388\r\n    - \\9f81f59bc58452127884ce513865ed20\r\n    - \\e710f28d59aa529d6792ca6ff0ca1b34\r\n    - \\rpchlp_3\r\n    - \\NamePipe_MoreWindows\r\n    - \\pcheap_reuse\r\n    - \\NamePipe_MoreWindows\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privelege_escalation\r\n- attack.t1055\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical"}, "8Z3knmUBtApo-eN_sOZs": {"category": 15, "updated": "2018-10-24T14:15:31.000Z", "hash": "554ef95a0327224a84f2fa6a30c3555ee070c07dd9dc4bf7792e884f5ae95daa", "title": "Sticky Key Like Backdoor Usage", "permission_id": 3, "title_keyword": "Sticky Key Like Backdoor Usage", "released": "2018-03-15T18:53:34.000Z", "sigma_text": "title: Sticky Key Like Backdoor Usage\r\ndescription: Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen\r\nreferences:\r\n- https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1015\r\nauthor: Florian Roth, @twjackomo\r\ndate: 2018/03/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_process:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\winlogon.exe'\r\n    CommandLine:\r\n    - '*\\cmd.exe sethc.exe *'\r\n    - '*\\cmd.exe utilman.exe *'\r\n    - '*\\cmd.exe osk.exe *'\r\n    - '*\\cmd.exe Magnify.exe *'\r\n    - '*\\cmd.exe Narrator.exe *'\r\n    - '*\\cmd.exe DisplaySwitch.exe *'\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger'\r\n    EventType: SetValue\r\n  condition: selection_process or selection_registry\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_stickykey_like_backdoor.yml", "sigma_text_keyword": "title: Sticky Key Like Backdoor Usage\r\ndescription: Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen\r\nreferences:\r\n- https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1015\r\nauthor: Florian Roth, @twjackomo\r\ndate: 2018/03/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_process:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\winlogon.exe'\r\n    CommandLine:\r\n    - '*\\cmd.exe sethc.exe *'\r\n    - '*\\cmd.exe utilman.exe *'\r\n    - '*\\cmd.exe osk.exe *'\r\n    - '*\\cmd.exe Magnify.exe *'\r\n    - '*\\cmd.exe Narrator.exe *'\r\n    - '*\\cmd.exe DisplaySwitch.exe *'\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger'\r\n    - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger'\r\n    EventType: SetValue\r\n  condition: selection_process or selection_registry\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical"}, "253knmUBtApo-eN_ht8W": {"category": 11, "updated": "2019-02-26T15:29:48.000Z", "hash": "6c718f6844e9b6e1d0b39a464824e450d70bc541798fea25e8a7604ecc2a8bda", "title": "Executable used by PlugX in Uncommon Location", "permission_id": 3, "title_keyword": "Executable used by PlugX in Uncommon Location", "released": "2017-06-12T09:02:49.000Z", "sigma_text": "title: Executable used by PlugX in Uncommon Location\r\nstatus: experimental\r\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\r\nreferences:\r\n- http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/\r\n- https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/\r\nauthor: Florian Roth\r\ndate: 2017/06/12\r\ntags:\r\n- attack.s0013\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection_cammute:\r\n    EventID: 4688\r\n    CommandLine: '*\\CamMute.exe'\r\n  filter_cammute:\r\n    EventID: 4688\r\n    CommandLine: '*\\Lenovo\\Communication Utility\\\\*'\r\n  selection_chrome_frame:\r\n    EventID: 4688\r\n    CommandLine: '*\\chrome_frame_helper.exe'\r\n  filter_chrome_frame:\r\n    EventID: 4688\r\n    CommandLine: '*\\Google\\Chrome\\application\\\\*'\r\n  selection_devemu:\r\n    EventID: 4688\r\n    CommandLine: '*\\dvcemumanager.exe'\r\n  filter_devemu:\r\n    EventID: 4688\r\n    CommandLine: '*\\Microsoft Device Emulator\\\\*'\r\n  selection_gadget:\r\n    EventID: 4688\r\n    CommandLine: '*\\Gadget.exe'\r\n  filter_gadget:\r\n    EventID: 4688\r\n    CommandLine: '*\\Windows Media Player\\\\*'\r\n  selection_hcc:\r\n    EventID: 4688\r\n    CommandLine: '*\\hcc.exe'\r\n  filter_hcc:\r\n    EventID: 4688\r\n    CommandLine: '*\\HTML Help Workshop\\\\*'\r\n  selection_hkcmd:\r\n    EventID: 4688\r\n    CommandLine: '*\\hkcmd.exe'\r\n  filter_hkcmd:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\System32\\\\*'\r\n    - '*\\SysNative\\\\*'\r\n    - '*\\SysWowo64\\\\*'\r\n  selection_mc:\r\n    EventID: 4688\r\n    CommandLine: '*\\Mc.exe'\r\n  filter_mc:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n  selection_msmpeng:\r\n    EventID: 4688\r\n    CommandLine: '*\\MsMpEng.exe'\r\n  filter_msmpeng:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Security Client\\\\*'\r\n    - '*\\Windows Defender\\\\*'\r\n    - '*\\AntiMalware\\\\*'\r\n  selection_msseces:\r\n    EventID: 4688\r\n    CommandLine: '*\\msseces.exe'\r\n  filter_msseces:\r\n    EventID: 4688\r\n    CommandLine: '*\\Microsoft Security Center\\\\*'\r\n  selection_oinfo:\r\n    EventID: 4688\r\n    CommandLine: '*\\OInfoP11.exe'\r\n  filter_oinfo:\r\n    EventID: 4688\r\n    CommandLine: '*\\Common Files\\Microsoft Shared\\\\*'\r\n  selection_oleview:\r\n    EventID: 4688\r\n    CommandLine: '*\\OleView.exe'\r\n  filter_oleview:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n    - '*\\Windows Resource Kit\\\\*'\r\n  selection_rc:\r\n    EventID: 4688\r\n    CommandLine: '*\\rc.exe'\r\n  filter_rc:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n    - '*\\Windows Resource Kit\\\\*'\r\n    - '*\\Microsoft.NET\\\\*'\r\n  condition: ( selection_cammute and not filter_cammute ) or ( selection_chrome_frame and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview and not filter_oleview ) or ( selection_rc and not filter_rc )\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/builtin/win_plugx_susp_exe_locations.yml", "sigma_text_keyword": "title: Executable used by PlugX in Uncommon Location\r\nstatus: experimental\r\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\r\nreferences:\r\n- http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/\r\n- https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/\r\nauthor: Florian Roth\r\ndate: 2017/06/12\r\ntags:\r\n- attack.s0013\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection_cammute:\r\n    EventID: 4688\r\n    CommandLine: '*\\CamMute.exe'\r\n  filter_cammute:\r\n    EventID: 4688\r\n    CommandLine: '*\\Lenovo\\Communication Utility\\\\*'\r\n  selection_chrome_frame:\r\n    EventID: 4688\r\n    CommandLine: '*\\chrome_frame_helper.exe'\r\n  filter_chrome_frame:\r\n    EventID: 4688\r\n    CommandLine: '*\\Google\\Chrome\\application\\\\*'\r\n  selection_devemu:\r\n    EventID: 4688\r\n    CommandLine: '*\\dvcemumanager.exe'\r\n  filter_devemu:\r\n    EventID: 4688\r\n    CommandLine: '*\\Microsoft Device Emulator\\\\*'\r\n  selection_gadget:\r\n    EventID: 4688\r\n    CommandLine: '*\\Gadget.exe'\r\n  filter_gadget:\r\n    EventID: 4688\r\n    CommandLine: '*\\Windows Media Player\\\\*'\r\n  selection_hcc:\r\n    EventID: 4688\r\n    CommandLine: '*\\hcc.exe'\r\n  filter_hcc:\r\n    EventID: 4688\r\n    CommandLine: '*\\HTML Help Workshop\\\\*'\r\n  selection_hkcmd:\r\n    EventID: 4688\r\n    CommandLine: '*\\hkcmd.exe'\r\n  filter_hkcmd:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\System32\\\\*'\r\n    - '*\\SysNative\\\\*'\r\n    - '*\\SysWowo64\\\\*'\r\n  selection_mc:\r\n    EventID: 4688\r\n    CommandLine: '*\\Mc.exe'\r\n  filter_mc:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n  selection_msmpeng:\r\n    EventID: 4688\r\n    CommandLine: '*\\MsMpEng.exe'\r\n  filter_msmpeng:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Security Client\\\\*'\r\n    - '*\\Windows Defender\\\\*'\r\n    - '*\\AntiMalware\\\\*'\r\n  selection_msseces:\r\n    EventID: 4688\r\n    CommandLine: '*\\msseces.exe'\r\n  filter_msseces:\r\n    EventID: 4688\r\n    CommandLine: '*\\Microsoft Security Center\\\\*'\r\n  selection_oinfo:\r\n    EventID: 4688\r\n    CommandLine: '*\\OInfoP11.exe'\r\n  filter_oinfo:\r\n    EventID: 4688\r\n    CommandLine: '*\\Common Files\\Microsoft Shared\\\\*'\r\n  selection_oleview:\r\n    EventID: 4688\r\n    CommandLine: '*\\OleView.exe'\r\n  filter_oleview:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n    - '*\\Windows Resource Kit\\\\*'\r\n  selection_rc:\r\n    EventID: 4688\r\n    CommandLine: '*\\rc.exe'\r\n  filter_rc:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\Microsoft Visual Studio*'\r\n    - '*\\Microsoft SDK*'\r\n    - '*\\Windows Kit*'\r\n    - '*\\Windows Resource Kit\\\\*'\r\n    - '*\\Microsoft.NET\\\\*'\r\n  condition: ( selection_cammute and not filter_cammute ) or ( selection_chrome_frame and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu ) or ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview and not filter_oleview ) or ( selection_rc and not filter_rc )\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "ZZ3knmUBtApo-eN_oeQ4": {"category": 5, "updated": "2019-02-26T14:34:29.000Z", "hash": "7b47b29cbc7ef34f0ca74579bee01587c319250ecb46a878df363483c858d4ec", "title": "Malware User Agent", "permission_id": 3, "title_keyword": "Malware User Agent", "released": "2017-07-08T15:59:05.000Z", "sigma_text": "title: Malware User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used by malware in proxy logs\r\nreferences:\r\n- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\r\n- http://www.botopedia.org/search?searchword=scan&searchphrase=all\r\n- https://networkraptor.blogspot.com/2015/01/user-agent-strings.html\r\n- https://perishablepress.com/blacklist/ua-2013.txt\r\n- https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)\r\n    - HttpBrowser/1.0\r\n    - '*<|>*'\r\n    - nsis_inetc (mozilla)\r\n    - Wget/1.9+cvs-stable (Red Hat modified)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\r\n    - '*zeroup*'\r\n    - Mozilla/5.0 (Windows NT 5.1 ; v.*\r\n    - '* adlib/*'\r\n    - '* tiny'\r\n    - '* BGroom *'\r\n    - '* changhuatong'\r\n    - '* CholTBAgent'\r\n    - Mozilla/5.0 WinInet\r\n    - RookIE/1.0\r\n    - M\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\r\n    - Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)\r\n    - backdoorbot\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)\r\n    - Opera/8.81 (Windows NT 6.0; U; en)\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)\r\n    - Opera\r\n    - Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)\r\n    - Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)\r\n    - MSIE\r\n    - '*(Charon; Inferno)'\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n    - Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)\r\n    - '* pxyscand*'\r\n    - '* asd'\r\n    - '* mdms'\r\n    - sample\r\n    - nocase\r\n    - Moxilla\r\n    - Win32 *\r\n    - '*Microsoft Internet Explorer*'\r\n    - agent *\r\n    - AutoIt\r\n    - IczelionDownLoad\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/proxy/proxy_ua_malware.yml", "sigma_text_keyword": "title: Malware User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used by malware in proxy logs\r\nreferences:\r\n- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\r\n- http://www.botopedia.org/search?searchword=scan&searchphrase=all\r\n- https://networkraptor.blogspot.com/2015/01/user-agent-strings.html\r\n- https://perishablepress.com/blacklist/ua-2013.txt\r\n- https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)\r\n    - HttpBrowser/1.0\r\n    - '*<|>*'\r\n    - nsis_inetc (mozilla)\r\n    - Wget/1.9+cvs-stable (Red Hat modified)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\r\n    - '*zeroup*'\r\n    - Mozilla/5.0 (Windows NT 5.1 ; v.*\r\n    - '* adlib/*'\r\n    - '* tiny'\r\n    - '* BGroom *'\r\n    - '* changhuatong'\r\n    - '* CholTBAgent'\r\n    - Mozilla/5.0 WinInet\r\n    - RookIE/1.0\r\n    - M\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)\r\n    - Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)\r\n    - backdoorbot\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)\r\n    - Opera/8.81 (Windows NT 6.0; U; en)\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)\r\n    - Opera\r\n    - Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)\r\n    - Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)\r\n    - MSIE\r\n    - '*(Charon; Inferno)'\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n    - Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)\r\n    - '* pxyscand*'\r\n    - '* asd'\r\n    - '* mdms'\r\n    - sample\r\n    - nocase\r\n    - Moxilla\r\n    - Win32 *\r\n    - '*Microsoft Internet Explorer*'\r\n    - agent *\r\n    - AutoIt\r\n    - IczelionDownLoad\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "pCVyX2cBqjf_D59Hbr5s": {"category": 8, "updated": "2019-01-02T14:45:23.000Z", "hash": "57517d36325347844c9ab29771e78ef1f084359cf236159cadf5382a62b43023", "title": "NjRAT RAT/Backdoor (Proxy).", "permission_id": 3, "title_keyword": "NjRAT RAT/Backdoor (Proxy).", "released": "2018-11-29T12:30:28.000Z", "sigma_text": "title: NjRAT RAT/Backdoor (Proxy).\r\ndescription: NjRAT RAT/Backdoor Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://precisionsec.com/threat-intelligence-feeds/njrat/\r\ndate: 2016/11/24\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionURL:\r\n    resource.URL:\r\n    - http://ghancommercialbank.com/msn/newclient.exe\r\n    - http://f.top4top.net/p_3667b75e1.png\r\n    - http://f.top4top.net/p_42526hb61.png\r\n    - http://cdn.discordapp.com/attachments/482228034632548363/506077641061826561/doublepumpcheck.exe\r\n    - http://cdn.discordapp.com/attachments/482925954109276160/507526114491498496/photoshop.exe\r\n    - https://cdn.discordapp.com/attachments/436298448665575427/481620773501534208/111111111.exe\r\n    - http://ldrldr.icu/njr.exe\r\n    - http://kapitanbomba.hopto.org/file.exe\r\n    - https://s3.us-east-2.amazonaws.com/qued/xwizard.exe\r\n    - https://cdn.discordapp.com/attachments/498525611422121996/507533173954183170/Server.exe\r\n  condition: selectionURL\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: NjRAT RAT/Backdoor (Proxy).\r\ndescription: NjRAT RAT/Backdoor Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://precisionsec.com/threat-intelligence-feeds/njrat/\r\ndate: 2016/11/24\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionURL:\r\n    resource.URL:\r\n    - http://ghancommercialbank.com/msn/newclient.exe\r\n    - http://f.top4top.net/p_3667b75e1.png\r\n    - http://f.top4top.net/p_42526hb61.png\r\n    - http://cdn.discordapp.com/attachments/482228034632548363/506077641061826561/doublepumpcheck.exe\r\n    - http://cdn.discordapp.com/attachments/482925954109276160/507526114491498496/photoshop.exe\r\n    - https://cdn.discordapp.com/attachments/436298448665575427/481620773501534208/111111111.exe\r\n    - http://ldrldr.icu/njr.exe\r\n    - http://kapitanbomba.hopto.org/file.exe\r\n    - https://s3.us-east-2.amazonaws.com/qued/xwizard.exe\r\n    - https://cdn.discordapp.com/attachments/498525611422121996/507533173954183170/Server.exe\r\n  condition: selectionURL\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "fp3knmUBtApo-eN_p-V9": {"category": 15, "updated": "2018-08-31T16:19:32.000Z", "hash": "b90dc674e0ee126ea792ddde5622d57b31889aa790259a606ad44b36e3b9d87e", "title": "Mimikatz In-Memory", "permission_id": 3, "title_keyword": "Mimikatz In-Memory", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Mimikatz In-Memory\nstatus: experimental\ndescription: Detects certain DLL loads when Mimikatz gets executed\nreferences:\n    - https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/\ntags:\n    - attack.s0002\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selector:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\rundll32.exe'\n    dllload1:\n        ImageLoaded: '*\\vaultcli.dll'\n    dllload2:\n        ImageLoaded: '*\\wlanapi.dll'        \n    exclusion:\n        ImageLoaded:\n            - 'ntdsapi.dll'\n            - 'netapi32.dll'\n            - 'imm32.dll'\n            - 'samlib.dll'\n            - 'combase.dll'\n            - 'srvcli.dll'\n            - 'shcore.dll'\n            - 'ntasn1.dll'\n            - 'cryptdll.dll'\n            - 'logoncli.dll'\n    timeframe: 30s\n    condition: selector | near dllload1 and dllload2 and not exclusion\nfalsepositives:\n    - unknown\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_mimikatz_inmemory_detection.yml", "sigma_text_keyword": "title: Mimikatz In-Memory\nstatus: experimental\ndescription: Detects certain DLL loads when Mimikatz gets executed\nreferences:\n    - https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/\ntags:\n    - attack.s0002\n    - attack.lateral_movement\n    - attack.credential_access\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selector:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\rundll32.exe'\n    dllload1:\n        ImageLoaded: '*\\vaultcli.dll'\n    dllload2:\n        ImageLoaded: '*\\wlanapi.dll'        \n    exclusion:\n        ImageLoaded:\n            - 'ntdsapi.dll'\n            - 'netapi32.dll'\n            - 'imm32.dll'\n            - 'samlib.dll'\n            - 'combase.dll'\n            - 'srvcli.dll'\n            - 'shcore.dll'\n            - 'ntasn1.dll'\n            - 'cryptdll.dll'\n            - 'logoncli.dll'\n    timeframe: 30s\n    condition: selector | near dllload1 and dllload2 and not exclusion\nfalsepositives:\n    - unknown\nlevel: medium\n"}, "sJ3knmUBtApo-eN_qOWO": {"category": 8, "updated": "2018-10-26T15:55:46.000Z", "hash": "8398f087c7629e02e30c8ea13a5b4da4db9eead69fc486fec2358124e1b80243", "title": "Lojack Double-Agent Communication", "permission_id": 3, "title_keyword": "Lojack Double-Agent Communication", "released": "2018-05-03T09:37:38.000Z", "sigma_text": "title: Lojack Double-Agent Communication\r\ndescription: Lojack Double-Agent Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://asert.arbornetworks.com/lojack-becomes-a-double-agent/\r\ndate: 2008/04/01\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - sysanalyticweb.com\r\n    - elaxo.org\r\n    - ikmtrust.com\r\n    - lxwo.org\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: Lojack Double-Agent Communication\r\ndescription: Lojack Double-Agent Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://asert.arbornetworks.com/lojack-becomes-a-double-agent/\r\ndate: 2008/04/01\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - sysanalyticweb.com\r\n    - elaxo.org\r\n    - ikmtrust.com\r\n    - lxwo.org\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "oJ3knmUBtApo-eN_nOO3": {"category": 11, "updated": "2018-10-26T16:18:10.000Z", "hash": "930620db0d605e24e83bd8de2f2b446ee1f40383e14fcd4a8e406c1bea9b1a18", "title": "Kerberos Manipulation", "permission_id": 3, "title_keyword": "Kerberos Manipulation", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Kerberos Manipulation\r\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\r\nauthor: Florian Roth\r\ntags:\r\n- attack.credential_access\r\n- attack.t1212\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"675\"\r\n    - \"4768\"\r\n    - \"4769\"\r\n    - \"4771\"\r\n    FailureCode:\r\n    - \"0x9\"\r\n    - \"0xA\"\r\n    - \"0xB\"\r\n    - \"0xF\"\r\n    - \"0x10\"\r\n    - \"0x11\"\r\n    - \"0x13\"\r\n    - \"0x14\"\r\n    - \"0x1A\"\r\n    - \"0x1F\"\r\n    - \"0x21\"\r\n    - \"0x22\"\r\n    - \"0x23\"\r\n    - \"0x24\"\r\n    - \"0x26\"\r\n    - \"0x27\"\r\n    - \"0x28\"\r\n    - \"0x29\"\r\n    - \"0x2C\"\r\n    - \"0x2D\"\r\n    - \"0x2E\"\r\n    - \"0x2F\"\r\n    - \"0x31\"\r\n    - \"0x32\"\r\n    - \"0x3E\"\r\n    - \"0x3F\"\r\n    - \"0x40\"\r\n    - \"0x41\"\r\n    - \"0x43\"\r\n    - \"0x44\"\r\n  condition: selection\r\nfalsepositives:\r\n- Faulty legacy applications\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_kerberos_manipulation.yml", "sigma_text_keyword": "title: Kerberos Manipulation\r\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\r\nauthor: Florian Roth\r\ntags:\r\n- attack.credential_access\r\n- attack.t1212\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"675\"\r\n    - \"4768\"\r\n    - \"4769\"\r\n    - \"4771\"\r\n    FailureCode:\r\n    - \"0x9\"\r\n    - \"0xA\"\r\n    - \"0xB\"\r\n    - \"0xF\"\r\n    - \"0x10\"\r\n    - \"0x11\"\r\n    - \"0x13\"\r\n    - \"0x14\"\r\n    - \"0x1A\"\r\n    - \"0x1F\"\r\n    - \"0x21\"\r\n    - \"0x22\"\r\n    - \"0x23\"\r\n    - \"0x24\"\r\n    - \"0x26\"\r\n    - \"0x27\"\r\n    - \"0x28\"\r\n    - \"0x29\"\r\n    - \"0x2C\"\r\n    - \"0x2D\"\r\n    - \"0x2E\"\r\n    - \"0x2F\"\r\n    - \"0x31\"\r\n    - \"0x32\"\r\n    - \"0x3E\"\r\n    - \"0x3F\"\r\n    - \"0x40\"\r\n    - \"0x41\"\r\n    - \"0x43\"\r\n    - \"0x44\"\r\n  condition: selection\r\nfalsepositives:\r\n- Faulty legacy applications\r\nlevel: high"}, "l53knmUBtApo-eN_nON5": {"category": 11, "updated": "2018-10-23T14:46:31.000Z", "hash": "1fe154de86dc3835fab2654c26536746307ea55a529c832feb3760d484b7d062", "title": "WCE wceaux.dll Access", "permission_id": 3, "title_keyword": "WCE wceaux.dll Access", "released": "2017-06-14T13:59:45.000Z", "sigma_text": "title: WCE wceaux.dll Access\r\nstatus: experimental\r\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\n- attack.s0005\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4656\"\r\n    - \"4658\"\r\n    - \"4660\"\r\n    - \"4663\"\r\n    ObjectName: '*\\wceaux.dll'\r\n  condition: selection\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: critical", "git_filepath": "/windows/builtin/win_mal_wceaux_dll.yml", "sigma_text_keyword": "title: WCE wceaux.dll Access\r\nstatus: experimental\r\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.jpcert.or.jp/english/pub/sr/ir_research.html\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\n- attack.s0005\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4656\"\r\n    - \"4658\"\r\n    - \"4660\"\r\n    - \"4663\"\r\n    ObjectName: '*\\wceaux.dll'\r\n  condition: selection\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: critical"}, "mp3knmUBtApo-eN_ruac": {"category": 11, "updated": "2019-02-26T13:41:19.000Z", "hash": "19e3d63c27b8c58aaaac8f147df9415a8b41e81b4c25a1603f58f58f9e262202", "title": "Reconnaissance Activity", "permission_id": 3, "title_keyword": "Reconnaissance Activity", "released": "2017-12-11T08:31:54.000Z", "sigma_text": "title: Reconnaissance Activity\r\nstatus: experimental\r\ndescription: Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"\r\ntags:\r\n- attack.discovery\r\n- attack.t1087\r\n- attack.t1069\r\n- attack.s0039\r\nreferences:\r\n- https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\r\nauthor: Florian Roth, Jack Croock\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems\r\ndetection:\r\n  selection:\r\n  - EventID: 4661\r\n    ObjectType: SAM_USER\r\n    ObjectName: S-1-5-21-*-500\r\n    AccessMask: \"0x2d\"\r\n  - EventID: 4661\r\n    ObjectType: SAM_GROUP\r\n    ObjectName: S-1-5-21-*-512\r\n    AccessMask: \"0x2d\"\r\n  condition: selection\r\nfalsepositives:\r\n- Administrator activity\r\n- Penetration tests\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_net_recon_activity.yml", "sigma_text_keyword": "title: Reconnaissance Activity\r\nstatus: experimental\r\ndescription: Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"\r\ntags:\r\n- attack.discovery\r\n- attack.t1087\r\n- attack.t1069\r\n- attack.s0039\r\nreferences:\r\n- https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\r\nauthor: Florian Roth, Jack Croock\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems\r\ndetection:\r\n  selection:\r\n  - EventID: 4661\r\n    ObjectType: SAM_USER\r\n    ObjectName: S-1-5-21-*-500\r\n    AccessMask: \"0x2d\"\r\n  - EventID: 4661\r\n    ObjectType: SAM_GROUP\r\n    ObjectName: S-1-5-21-*-512\r\n    AccessMask: \"0x2d\"\r\n  condition: selection\r\nfalsepositives:\r\n- Administrator activity\r\n- Penetration tests\r\nlevel: high"}, "qZ3knmUBtApo-eN_iuBh": {"category": 1, "updated": "2018-10-25T09:50:46.000Z", "hash": "f1a3247f73dcfc335c016a71a02c0ff160b9cea43ff2453b8f70f12c81a63555", "title": "Python SQL Exceptions", "permission_id": 3, "title_keyword": "Python SQL Exceptions", "released": "2017-08-11T22:44:18.000Z", "sigma_text": "title: Python SQL Exceptions\r\ndescription: Generic rule for SQL exceptions in Python according to PEP 249\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.python.org/dev/peps/pep-0249/#exceptions\r\nlogsource:\r\n  category: application\r\n  product: python\r\ndetection:\r\n  exceptions:\r\n  - DataError\r\n  - IntegrityError\r\n  - ProgrammingError\r\n  - OperationalError\r\n  condition: exceptions\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium", "git_filepath": "/application/app_python_sql_exceptions.yml", "sigma_text_keyword": "title: Python SQL Exceptions\r\ndescription: Generic rule for SQL exceptions in Python according to PEP 249\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://www.python.org/dev/peps/pep-0249/#exceptions\r\nlogsource:\r\n  category: application\r\n  product: python\r\ndetection:\r\n  exceptions:\r\n  - DataError\r\n  - IntegrityError\r\n  - ProgrammingError\r\n  - OperationalError\r\n  condition: exceptions\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium"}, "tZ3knmUBtApo-eN_r-Yn": {"category": 11, "updated": "2018-11-07T14:13:47.000Z", "hash": "1b4918d0464e44e0ceb4c0fbf63127c953f162a379c53fca5a4cf6497ce7ec8c", "title": "DHCP Server Loaded the CallOut DLL", "permission_id": 3, "title_keyword": "DHCP Server Loaded the CallOut DLL", "released": "2017-05-15T18:58:31.000Z", "sigma_text": "title: DHCP Server Loaded the CallOut DLL\r\nstatus: experimental\r\ndescription: This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\ntags:\r\n- attack.defense_evasion\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"1033\"\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": "/windows/builtin/win_susp_dhcp_config.yml", "sigma_text_keyword": "title: DHCP Server Loaded the CallOut DLL\r\nstatus: experimental\r\ndescription: This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\ntags:\r\n- attack.defense_evasion\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"1033\"\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.Execution\r\n- attack.t1059"}, "_SVQZWcBqjf_D59HPcXR": {"category": 8, "updated": "2019-01-02T14:44:45.000Z", "hash": "d87cb3b231f142fa2c4413fabf0882bf8aa68f01d164eb760104792314cbc3b6", "title": "KingMiner cryptojacker (Sysmon).", "permission_id": 3, "title_keyword": "KingMiner cryptojacker (Sysmon).", "released": "2018-11-30T15:53:17.000Z", "sigma_text": "title: KingMiner cryptojacker (Sysmon).\r\ndescription: KingMiner cryptojacker Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://cyware.com/news/new-kingminer-cryptojacker-hijacks-windows-servers-and-uses-advanced-detection-evading-techniques-82b38940\r\n- https://research.checkpoint.com/kingminer-the-new-and-improved-cryptojacker/\r\ndate: 2018/11/30\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - dea32433519c4628deeac802c0f1435a1b0d27d89f1ae5c1729ec7223f9eb04d\r\n    - 147d572d7f6664c8adf42ef92e4dbad06c5d21cc820a20163d814c77136cfbab\r\n    - 122b7906a359deb22bf777c602ac2619ca5ea156c4937dcdf96583210677db52\r\n    - c5894d2afc946c064f8c2b58791fe64b48e26f0da5bdcc6ef9ba147f334f43f9\r\n    - e61fbe58c28720ac4c0a1822d5da9a622a24f352d34e6c1cf5f704dbdd9b9b34\r\n    - 2b54329a13c4f79bea3886a21a7ba5fe19c4418596b774893fdef020e03ed07d\r\n    - f128a63c107c3006ebf448d6ec743d11eb491ecb508e4ce63ba084f9792c25da\r\n    - 7357bdf70d042f246de1f830de783499d75e61388eed93d9ce74180ce06524d0\r\n    - 956a1231726503d840794af61fb6ac9bc326296597eff1c8da636f84e3c32874\r\n    - 8fa8cdb771d7c66406a7116e9c09ed18030afb1f94430c807782274f3847cb92\r\n    - a3598d3301630ba64aa7663980296b59df243f5f17ed1b4fd56dcbcab599231c\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: KingMiner cryptojacker (Sysmon).\r\ndescription: KingMiner cryptojacker Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://cyware.com/news/new-kingminer-cryptojacker-hijacks-windows-servers-and-uses-advanced-detection-evading-techniques-82b38940\r\n- https://research.checkpoint.com/kingminer-the-new-and-improved-cryptojacker/\r\ndate: 2018/11/30\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - dea32433519c4628deeac802c0f1435a1b0d27d89f1ae5c1729ec7223f9eb04d\r\n    - 147d572d7f6664c8adf42ef92e4dbad06c5d21cc820a20163d814c77136cfbab\r\n    - 122b7906a359deb22bf777c602ac2619ca5ea156c4937dcdf96583210677db52\r\n    - c5894d2afc946c064f8c2b58791fe64b48e26f0da5bdcc6ef9ba147f334f43f9\r\n    - e61fbe58c28720ac4c0a1822d5da9a622a24f352d34e6c1cf5f704dbdd9b9b34\r\n    - 2b54329a13c4f79bea3886a21a7ba5fe19c4418596b774893fdef020e03ed07d\r\n    - f128a63c107c3006ebf448d6ec743d11eb491ecb508e4ce63ba084f9792c25da\r\n    - 7357bdf70d042f246de1f830de783499d75e61388eed93d9ce74180ce06524d0\r\n    - 956a1231726503d840794af61fb6ac9bc326296597eff1c8da636f84e3c32874\r\n    - 8fa8cdb771d7c66406a7116e9c09ed18030afb1f94430c807782274f3847cb92\r\n    - a3598d3301630ba64aa7663980296b59df243f5f17ed1b4fd56dcbcab599231c\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "Ep3knmUBtApo-eN_h-Ay": {"category": 2, "updated": "2018-10-23T15:55:56.000Z", "hash": "dd0468d55358a54a4dafa4c7fb75124fc909b5706e5665b2264b94ad185189df", "title": "StoneDrill Service Install", "permission_id": 3, "title_keyword": "StoneDrill Service Install", "released": "2017-03-07T08:24:12.000Z", "sigma_text": "title: StoneDrill Service Install\r\ndescription: This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky\r\nauthor: Florian Roth\r\nreferences:\r\n- https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\r\ntags:\r\n- attack.persistence\r\n- attack.g0064\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n    ServiceName: NtsSrv\r\n    ServiceFileName: '* LocalService'\r\n  condition: selection\r\nfalsepositives:\r\n- Unlikely\r\nlevel: high", "git_filepath": "/apt/apt_stonedrill.yml", "sigma_text_keyword": "title: StoneDrill Service Install\r\ndescription: This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky\r\nauthor: Florian Roth\r\nreferences:\r\n- https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\r\ntags:\r\n- attack.persistence\r\n- attack.g0064\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n    ServiceName: NtsSrv\r\n    ServiceFileName: '* LocalService'\r\n  condition: selection\r\nfalsepositives:\r\n- Unlikely\r\nlevel: high"}, "G53knmUBtApo-eN_h-Be": {"category": 11, "updated": "2019-02-26T15:33:11.000Z", "hash": "f74a8c5147b4b38bfa9ddc918069bc3b828f2a2330a94fe2670cde9eac6bcb4a", "title": "PsExec Service Start", "permission_id": 3, "title_keyword": "PsExec Service Start", "released": "2018-03-15T18:54:22.000Z", "sigma_text": "title: PsExec Service Start\r\ndescription: Detects a PsExec service start\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine: C:\\Windows\\PSEXESVC.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low", "git_filepath": "/windows/builtin/win_psexesvc_start.yml", "sigma_text_keyword": "title: PsExec Service Start\r\ndescription: Detects a PsExec service start\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine: C:\\Windows\\PSEXESVC.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low"}, "853knmUBtApo-eN_pOSl": {"category": 2, "updated": "2019-02-26T14:03:06.000Z", "hash": "0bf303acfcfc095cf69f692c367a3e82fd39db1735b133d5d7c4051c5ce26c6b", "title": "Equation Group Indicators", "permission_id": 3, "title_keyword": "Equation Group Indicators", "released": "2017-04-09T18:11:56.000Z", "sigma_text": "title: Equation Group Indicators\r\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\r\nreferences:\r\n- https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\r\ntags:\r\n- attack.execution\r\n- attack.g0020\r\n- attack.t1059\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - 'chown root*chmod 4777 '\r\n  - cp /bin/sh .;chown\r\n  - chmod 4777 /tmp/.scsi/dev/bin/gsh\r\n  - chown root:root /tmp/.scsi/dev/bin/\r\n  - chown root:root x;\r\n  - /bin/telnet locip locport < /dev/console | /bin/sh\r\n  - /tmp/ratload\r\n  - 'ewok -t '\r\n  - 'xspy -display '\r\n  - cat > /dev/tcp/127.0.0.1/80 <<END\r\n  - rm -f /current/tmp/ftshell.latest\r\n  - 'ghost_* -v '\r\n  - ' --wipe > /dev/null'\r\n  - ping -c 2 *; grep * /proc/net/arp >/tmp/gx\r\n  - iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\r\n  - '> /var/log/audit/audit.log; rm -f .'\r\n  - cp /var/log/audit/audit.log .tmp\r\n  - sh >/dev/tcp/* <&1 2>&1\r\n  - ncat -vv -l -p * <\r\n  - nc -vv -l -p * <\r\n  - < /dev/console | uudecode && uncompress\r\n  - sendmail -osendmail;chmod +x sendmail\r\n  - /usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron\r\n  - chmod 666 /var/run/utmp~\r\n  - chmod 700 nscd crond\r\n  - cp /etc/shadow /tmp/.\r\n  - </dev/console |uudecode > /dev/null 2>&1 && uncompress\r\n  - chmod 700 jp&&netstat -an|grep\r\n  - uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755\r\n  - chmod 700 crond\r\n  - wget http*; chmod +x /tmp/sendmail\r\n  - chmod 700 fp sendmail pt\r\n  - chmod 755 /usr/vmsys/bin/pipe\r\n  - chmod -R 755 /usr/vmsys\r\n  - chmod 755 $opbin/*tunnel\r\n  - chmod 700 sendmail\r\n  - chmod 0700 sendmail\r\n  - /usr/bin/wget http*sendmail;chmod +x sendmail;\r\n  - '&& telnet * 2>&1 </dev/console'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/apt/apt_equationgroup_lnx.yml", "sigma_text_keyword": "title: Equation Group Indicators\r\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\r\nreferences:\r\n- https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\r\ntags:\r\n- attack.execution\r\n- attack.g0020\r\n- attack.t1059\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - 'chown root*chmod 4777 '\r\n  - cp /bin/sh .;chown\r\n  - chmod 4777 /tmp/.scsi/dev/bin/gsh\r\n  - chown root:root /tmp/.scsi/dev/bin/\r\n  - chown root:root x;\r\n  - /bin/telnet locip locport < /dev/console | /bin/sh\r\n  - /tmp/ratload\r\n  - 'ewok -t '\r\n  - 'xspy -display '\r\n  - cat > /dev/tcp/127.0.0.1/80 <<END\r\n  - rm -f /current/tmp/ftshell.latest\r\n  - 'ghost_* -v '\r\n  - ' --wipe > /dev/null'\r\n  - ping -c 2 *; grep * /proc/net/arp >/tmp/gx\r\n  - iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\r\n  - '> /var/log/audit/audit.log; rm -f .'\r\n  - cp /var/log/audit/audit.log .tmp\r\n  - sh >/dev/tcp/* <&1 2>&1\r\n  - ncat -vv -l -p * <\r\n  - nc -vv -l -p * <\r\n  - < /dev/console | uudecode && uncompress\r\n  - sendmail -osendmail;chmod +x sendmail\r\n  - /usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron\r\n  - chmod 666 /var/run/utmp~\r\n  - chmod 700 nscd crond\r\n  - cp /etc/shadow /tmp/.\r\n  - </dev/console |uudecode > /dev/null 2>&1 && uncompress\r\n  - chmod 700 jp&&netstat -an|grep\r\n  - uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755\r\n  - chmod 700 crond\r\n  - wget http*; chmod +x /tmp/sendmail\r\n  - chmod 700 fp sendmail pt\r\n  - chmod 755 /usr/vmsys/bin/pipe\r\n  - chmod -R 755 /usr/vmsys\r\n  - chmod 755 $opbin/*tunnel\r\n  - chmod 700 sendmail\r\n  - chmod 0700 sendmail\r\n  - /usr/bin/wget http*sendmail;chmod +x sendmail;\r\n  - '&& telnet * 2>&1 </dev/console'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "zp3knmUBtApo-eN_i-A0": {"category": 15, "updated": "2019-02-26T15:00:45.000Z", "hash": "f618b86f1a2294ef984286f421d8f237edd3a1fa96b70519427485aa5f75d553", "title": "PowerShell Network Connections", "permission_id": 3, "title_keyword": "PowerShell Network Connections", "released": "2017-03-13T12:57:41.000Z", "sigma_text": "title: PowerShell Network Connections\r\nstatus: experimental\r\ndescription: Detetcs a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.youtube.com/watch?v=DLtJTxMWZ2o\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image: '*\\powershell.exe'\r\n  filter:\r\n    DestinationIp:\r\n    - 10.*\r\n    - 192.168.*\r\n    - 172.*\r\n    - 127.0.0.1\r\n    DestinationIsIpv6: \"false\"\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrative scripts\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_powershell_network_connection.yml", "sigma_text_keyword": "title: PowerShell Network Connections\r\nstatus: experimental\r\ndescription: Detetcs a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.youtube.com/watch?v=DLtJTxMWZ2o\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image: '*\\powershell.exe'\r\n  filter:\r\n    DestinationIp:\r\n    - 10.*\r\n    - 192.168.*\r\n    - 172.*\r\n    - 127.0.0.1\r\n    DestinationIsIpv6: \"false\"\r\n    User: NT AUTHORITY\\SYSTEM\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrative scripts\r\nlevel: low"}, "3W0go2gBFVBAemBcWNxn": {"category": 8, "updated": "2019-01-31T08:57:12.000Z", "hash": "fa0a538f3d03bdb0ef9a1ed8d093087e4bd7c73f8c14175dd45c5ba910496da1", "title": "Suspicious Program Location Process Starts", "permission_id": 3, "title_keyword": "Suspicious Program Location Process Starts", "released": "2019-01-31T08:57:12.000Z", "sigma_text": "title: Suspicious Program Location Process Starts\r\nstatus: experimental\r\ndescription: Detects programs running in suspicious files system locations\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2019/01/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\Public\\*'\r\n    - C:\\Perflogs\\*\r\n    - '*\\Windows\\Fonts\\*'\r\n    - '*\\Windows\\IME\\*'\r\n    - '*\\Windows\\addins\\*'\r\n    - '*\\Windows\\debug\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Initial Access\r\n- attack.t1193\r\n- attack.t1189", "git_filepath": "", "sigma_text_keyword": "title: Suspicious Program Location Process Starts\r\nstatus: experimental\r\ndescription: Detects programs running in suspicious files system locations\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2019/01/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\Public\\*'\r\n    - C:\\Perflogs\\*\r\n    - '*\\Windows\\Fonts\\*'\r\n    - '*\\Windows\\IME\\*'\r\n    - '*\\Windows\\addins\\*'\r\n    - '*\\Windows\\debug\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Initial Access\r\n- attack.t1193\r\n- attack.t1189"}, "fJ3knmUBtApo-eN_m-Pw": {"category": 11, "updated": "2019-02-26T13:42:25.000Z", "hash": "1a661964123ccb0f265bab7566a33cd1d3f6b12d4180f0095746187a9bd2faf8", "title": "Pass the Hash Activity", "permission_id": 3, "title_keyword": "Pass the Hash Activity", "released": "2017-03-08T17:04:31.000Z", "sigma_text": "title: Pass the Hash Activity\r\nstatus: experimental\r\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\r\nreferences:\r\n- https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\r\nauthor: Ilias el Matani, The Information Assurance Directorate at the NSA\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1075\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\r\ndetection:\r\n  selection:\r\n  - EventID: 4624\r\n    LogonType: 3\r\n    LogonProcessName: NtLmSsp\r\n    WorkstationName: '%Workstations%'\r\n    ComputerName: '%Workstations%'\r\n  - EventID: 4625\r\n    LogonType: 3\r\n    LogonProcessName: NtLmSsp\r\n    WorkstationName: '%Workstations%'\r\n    ComputerName: '%Workstations%'\r\n  filter:\r\n    AccountName: ANONYMOUS LOGON\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrator activity\r\n- Penetration tests\r\nlevel: medium", "git_filepath": "/windows/builtin/win_pass_the_hash.yml", "sigma_text_keyword": "title: Pass the Hash Activity\r\nstatus: experimental\r\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\r\nreferences:\r\n- https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\r\nauthor: Ilias el Matani, The Information Assurance Directorate at the NSA\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1075\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\r\ndetection:\r\n  selection:\r\n  - EventID: 4624\r\n    LogonType: 3\r\n    LogonProcessName: NtLmSsp\r\n    WorkstationName: '%Workstations%'\r\n    ComputerName: '%Workstations%'\r\n  - EventID: 4625\r\n    LogonType: 3\r\n    LogonProcessName: NtLmSsp\r\n    WorkstationName: '%Workstations%'\r\n    ComputerName: '%Workstations%'\r\n  filter:\r\n    AccountName: ANONYMOUS LOGON\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Administrator activity\r\n- Penetration tests\r\nlevel: medium"}, "nZ3knmUBtApo-eN_qOUp": {"category": 15, "updated": "2018-11-23T15:43:50.000Z", "hash": "bf6172f3b9a621bf37ced2be676fc669e2c6e81b4b669c5b8bdcaf6e872c17bd", "title": "Suspicious Svchost Process", "permission_id": 3, "title_keyword": "Suspicious Svchost Process", "released": "2017-08-31T09:07:45.000Z", "sigma_text": "title: Suspicious Svchost Process\r\nstatus: experimental\r\ndescription: Detects a suspicious svchost process start\r\nauthor: Florian Roth\r\ndate: 2017/08/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\svchost.exe'\r\n  filter:\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.Defense Evasion\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_svchost.yml", "sigma_text_keyword": "title: Suspicious Svchost Process\r\nstatus: experimental\r\ndescription: Detects a suspicious svchost process start\r\nauthor: Florian Roth\r\ndate: 2017/08/15\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\svchost.exe'\r\n  filter:\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.Defense Evasion\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "0J3knmUBtApo-eN_hd-g": {"category": 8, "updated": "2018-11-23T14:58:05.000Z", "hash": "a95f76ef0aaedfa229f8d64857c4d3b935bb7c769ba4e9d6741751bb25ee49b1", "title": "klist purge", "permission_id": 3, "title_keyword": "klist purge", "released": "2018-04-27T09:13:03.000Z", "sigma_text": "title: klist purge\r\ndescription: Delete Evidence of Pass-the-Ticket attack\r\nauthor: Ruslan Mikhalov, SOC Prime\r\nstatus: testing\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  sysmon_klistpurge:\r\n    EventID: \"1\"\r\n    CommandLine: klist*purge\r\n  condition: sysmon_klistpurge\r\nfields:\r\n- EventID\r\n- CommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1070\r\nreference:\r\n- https://attack.mitre.org/wiki/Technique/T1097\r\n- \"\"", "git_filepath": null, "sigma_text_keyword": "title: klist purge\r\ndescription: Delete Evidence of Pass-the-Ticket attack\r\nauthor: Ruslan Mikhalov, SOC Prime\r\nstatus: testing\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  sysmon_klistpurge:\r\n    EventID: \"1\"\r\n    CommandLine: klist*purge\r\n  condition: sysmon_klistpurge\r\nfields:\r\n- EventID\r\n- CommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1070\r\nreference:\r\n- https://attack.mitre.org/wiki/Technique/T1097\r\n- \"\""}, "MZ3knmUBtApo-eN_q-b0": {"category": 15, "updated": "2018-10-24T11:58:09.000Z", "hash": "ed11bcc9167e7a4c44350e80a389e13db4454cdfbdb25c1513e53a2c73975645", "title": "QuarksPwDump Dump File", "permission_id": 3, "title_keyword": "QuarksPwDump Dump File", "released": "2018-02-10T14:25:36.000Z", "sigma_text": "title: QuarksPwDump Dump File\r\nstatus: experimental\r\ndescription: Detects a dump file written by QuarksPwDump password dumper\r\nreferences:\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm\r\nauthor: Florian Roth\r\ndate: 2018/02/10\r\nlevel: critical\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"11\"\r\n    TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown", "git_filepath": "/windows/sysmon/sysmon_quarkspw_filedump.yml", "sigma_text_keyword": "title: QuarksPwDump Dump File\r\nstatus: experimental\r\ndescription: Detects a dump file written by QuarksPwDump password dumper\r\nreferences:\r\n- https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm\r\nauthor: Florian Roth\r\ndate: 2018/02/10\r\nlevel: critical\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"11\"\r\n    TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown"}, "5J3knmUBtApo-eN_kuEi": {"category": 11, "updated": "2018-10-23T15:17:48.000Z", "hash": "380698ff7b049d45e7bde8126a06c347e87b86dd37979e7817494752b0d924f2", "title": "Malicious Service Install", "permission_id": 3, "title_keyword": "Malicious Service Install", "released": "2017-05-15T14:06:16.000Z", "sigma_text": "title: Malicious Service Install\r\ndescription: This method detects well-known keywords of malicious services in the Windows System Eventlog\r\nauthor: Florian Roth\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\n- attack.s0005\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"7045\"\r\n    - \"4697\"\r\n  keywords:\r\n  - WCE SERVICE\r\n  - WCESERVICE\r\n  - DumpSvc\r\n  quarkspwdump:\r\n    EventID: \"16\"\r\n    HiveName: '*\\AppData\\Local\\Temp\\SAM*.dmp'\r\n  condition: ( selection and keywords ) or quarkspwdump\r\nfalsepositives:\r\n- Unlikely\r\nlevel: high", "git_filepath": "/windows/builtin/win_mal_creddumper.yml", "sigma_text_keyword": "title: Malicious Service Install\r\ndescription: This method detects well-known keywords of malicious services in the Windows System Eventlog\r\nauthor: Florian Roth\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\n- attack.s0005\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"7045\"\r\n    - \"4697\"\r\n  keywords:\r\n  - WCE SERVICE\r\n  - WCESERVICE\r\n  - DumpSvc\r\n  quarkspwdump:\r\n    EventID: \"16\"\r\n    HiveName: '*\\AppData\\Local\\Temp\\SAM*.dmp'\r\n  condition: ( selection and keywords ) or quarkspwdump\r\nfalsepositives:\r\n- Unlikely\r\nlevel: high"}, "Y53knmUBtApo-eN_puX1": {"category": 15, "updated": "2018-10-24T09:38:20.000Z", "hash": "aad6a37cc4f3c2c7f80524e4e67bef4742a8543db6c4d9b3e7c06920a50f0aa5", "title": "Bitsadmin Download", "permission_id": 3, "title_keyword": "Bitsadmin Download", "released": "2017-03-09T06:49:35.000Z", "sigma_text": "title: Bitsadmin Download\r\nstatus: experimental\r\ndescription: Detects usage of bitsadmin downloading a file\r\nreferences:\r\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\r\n- https://isc.sans.edu/diary/22264\r\ntags:\r\n- attack.defense_evasion\r\n- attack.persistence\r\n- attack.t1197\r\n- attack.s0190\r\nauthor: Michael Haag\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\bitsadmin.exe'\r\n    CommandLine:\r\n    - /transfer\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_bitsadmin_download.yml", "sigma_text_keyword": "title: Bitsadmin Download\r\nstatus: experimental\r\ndescription: Detects usage of bitsadmin downloading a file\r\nreferences:\r\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\r\n- https://isc.sans.edu/diary/22264\r\ntags:\r\n- attack.defense_evasion\r\n- attack.persistence\r\n- attack.t1197\r\n- attack.s0190\r\nauthor: Michael Haag\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\bitsadmin.exe'\r\n    CommandLine:\r\n    - /transfer\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium"}, "720jo2gBFVBAemBccdx6": {"category": 8, "updated": "2019-01-31T09:01:20.000Z", "hash": "e3cafa958b912cae7c9187f5264f4b061af1eecfe878e16f5a85d46ba8c2d4ab", "title": "WMI Event Subscription", "permission_id": 3, "title_keyword": "WMI Event Subscription", "released": "2019-01-31T09:00:35.000Z", "sigma_text": "title: WMI Event Subscription\r\nstatus: experimental\r\ndescription: Detects creation of WMI event subscription persistence method\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1084/\r\ntags:\r\n- attack.Persistence\r\n- attack.t1084\r\n- attack.Execution\r\n- attack.t1047\r\nauthor: Tom Ueltschi (@c_APT_ure)\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selector:\r\n    EventID:\r\n    - 19\r\n    - 20\r\n    - 21\r\n  condition: selector\r\nfalsepositives:\r\n- exclude legitimate (vetted) use of WMI event subscription in your network\r\nlevel: high", "git_filepath": "", "sigma_text_keyword": "title: WMI Event Subscription\r\nstatus: experimental\r\ndescription: Detects creation of WMI event subscription persistence method\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1084/\r\ntags:\r\n- attack.Persistence\r\n- attack.t1084\r\n- attack.Execution\r\n- attack.t1047\r\nauthor: Tom Ueltschi (@c_APT_ure)\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selector:\r\n    EventID:\r\n    - 19\r\n    - 20\r\n    - 21\r\n  condition: selector\r\nfalsepositives:\r\n- exclude legitimate (vetted) use of WMI event subscription in your network\r\nlevel: high"}, "R53knmUBtApo-eN_iOBl": {"category": 11, "updated": "2018-10-25T11:46:08.000Z", "hash": "99c6ae60bba87a00a5d11bda1db9d80d84a3552b0a5154459df70ec3f5cc3852", "title": "Addition of SID History to Active Directory Object", "permission_id": 3, "title_keyword": "Addition of SID History to Active Directory Object", "released": "2017-02-19T21:43:27.000Z", "sigma_text": "title: Addition of SID History to Active Directory Object\r\nstatus: stable\r\ndescription: An attacker can use the SID history attribute to gain additional privileges.\r\nreferences:\r\n- https://adsecurity.org/?p=1772\r\nauthor: Thomas Patzke\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.t1178\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4765\"\r\n    - \"4766\"\r\n  condition: selection\r\nfalsepositives:\r\n- Migration of an account into a new domain\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_add_sid_history.yml", "sigma_text_keyword": "title: Addition of SID History to Active Directory Object\r\nstatus: stable\r\ndescription: An attacker can use the SID history attribute to gain additional privileges.\r\nreferences:\r\n- https://adsecurity.org/?p=1772\r\nauthor: Thomas Patzke\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.t1178\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4765\"\r\n    - \"4766\"\r\n  condition: selection\r\nfalsepositives:\r\n- Migration of an account into a new domain\r\nlevel: medium"}, "m26jOGkBFVBAemBcJmG7": {"category": 2, "updated": "2019-03-01T09:43:30.000Z", "hash": "1de7bed0b4b2b4d8207e681401b1eafa5ff85b137902fd5573331e3877b43abc", "title": "Equation Group DLL_U Load.", "permission_id": 3, "title_keyword": "Equation Group DLL_U Load.", "released": "2019-03-01T09:43:30.000Z", "sigma_text": "title: Equation Group DLL_U Load.\r\ndescription: Detects a specific tool and export used by EquationGroup.\r\nreferences:\r\n- https://github.com/adamcaudill/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=\r\n- https://securelist.com/apt-slingshot/84312/\r\n- https://twitter.com/cyb3rops/status/972186477512839170\r\nauthor: Florian Roth\r\ndate: 2018/03/10\r\nmodified: 2018/12/11\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\rundll32.exe'\r\n    CommandLine: '*,dll_u'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '* -export dll_u *'\r\n  condition: selection1 OR selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    Image: '*\\rundll32.exe'\r\n    ProcessCommandLine: '*,dll_u'\r\n  selection2:\r\n    EventID: 4688\r\n    ProcessCommandLine: '* -export dll_u *'\r\n  condition: selection1 OR selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.execution\r\n- attack.g0020\r\n- attack.t1059", "git_filepath": "/apt/apt_equationgroup_dll_u_load.yml", "sigma_text_keyword": "title: Equation Group DLL_U Load.\r\ndescription: Detects a specific tool and export used by EquationGroup.\r\nreferences:\r\n- https://github.com/adamcaudill/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=\r\n- https://securelist.com/apt-slingshot/84312/\r\n- https://twitter.com/cyb3rops/status/972186477512839170\r\nauthor: Florian Roth\r\ndate: 2018/03/10\r\nmodified: 2018/12/11\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\rundll32.exe'\r\n    CommandLine: '*,dll_u'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '* -export dll_u *'\r\n  condition: selection1 OR selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    Image: '*\\rundll32.exe'\r\n    ProcessCommandLine: '*,dll_u'\r\n  selection2:\r\n    EventID: 4688\r\n    ProcessCommandLine: '* -export dll_u *'\r\n  condition: selection1 OR selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.execution\r\n- attack.g0020\r\n- attack.t1059"}, "221tM2gBFVBAemBcrIfM": {"category": 8, "updated": "2019-01-16T12:11:19.000Z", "hash": "c2591469050f05b9b5509437302ad9f3843ea9ce4ec67848d6c56883ac51354d", "title": "BetaBot (Neurevt) (Sysmon).", "permission_id": 3, "title_keyword": "BetaBot (Neurevt) (Sysmon).", "released": "2019-01-09T16:24:12.000Z", "sigma_text": "title: BetaBot (Neurevt) (Sysmon).\r\ndescription: BetaBot is a stealer software.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/pollo290987/status/1083026735841587202\r\n- https://twitter.com/avman1995/status/1084347108553981954\r\ndate: 2019/01/13\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - b4576437f4b06d438a03a9f8f0776cde\r\n    - a0763d3332bb87595ed6303ab3cdb8fff7dd1e976ee161003a62316fea332941\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: BetaBot (Neurevt) (Sysmon).\r\ndescription: BetaBot is a stealer software.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/pollo290987/status/1083026735841587202\r\n- https://twitter.com/avman1995/status/1084347108553981954\r\ndate: 2019/01/13\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - b4576437f4b06d438a03a9f8f0776cde\r\n    - a0763d3332bb87595ed6303ab3cdb8fff7dd1e976ee161003a62316fea332941\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "953knmUBtApo-eN_jOBz": {"category": 8, "updated": "2019-01-02T14:57:44.000Z", "hash": "b50fc0a7cc2de5c89f3016ac71166f41aba8894bb5114cc2c2e4a51c2abbf5d2", "title": "Vermin backdoor detector (Sysmon).", "permission_id": 3, "title_keyword": "Vermin backdoor detector (Sysmon).", "released": "2018-07-19T10:19:20.000Z", "sigma_text": "title: Vermin backdoor detector (Sysmon).\r\ndescription: Vermin is a full-featured backdoor capable of stealing credentials, keylogging and recording audio.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 028EBDBEBAC7239B41A1F4CE8D2CC61B1E09983B\r\n    - 07E1AF6D3F7B42D2E26DF12A217DEBACEDB8B1B9\r\n    - 09457ACB28C754AA419AB6A7E8B1940201EF3FFE\r\n    - 0EEE92EC2723ED9623F84082DAD962778F4CF776\r\n    - 10128AB8770FBDECD81B8894208A760A3C266D78\r\n    - 131F99A2E18A358B60F09FD61EE312E74B02C07C\r\n    - 14F69C7BFAF1DF16E755CCF754017089238B0E7B\r\n    - 1509F85DE302BE83A47D5AFAD9BEE2542BA317FC\r\n    - 170CEE6523B6620124F52201D943D7D9CA7B95E5\r\n    - 191159F855A0E580290871C945245E3597A5F25C\r\n    - 1F12C32A41D82E978DE333CD4E93FDAA1396BE94\r\n    - 22B17966B597568DB46B94B253CD37CBCF561321\r\n    - 2C7332D8247376842BD1B1BD5298844307649C99\r\n    - 2E08BA5DF30C0718C1733A7836B5F4D98D84905E\r\n    - 2EDF808F8252A4CBCB92F47A0AEDC1AAAE79A777\r\n    - 360F54B33AC960EE29CA0557A28F6BB8417EF409\r\n    - 431FCE6A47D0A48A57F699AA084C9FF175A9D15F\r\n    - 45438834FDC5C690DA3BC1F60722BE86B871280D\r\n    - 4A8A8188E3A7A137651B24780DF37CB6F610CC19\r\n    - 4C1E4E136B7922F9E28D1B38E9760E28929E4F0B\r\n    - 5B6EA57FFC09593C3B65D903368EA5F7FAA2EB68\r\n    - 61D366939FE36861B2FECB38A4DFF6D86C925A00\r\n    - 6A72366D8AE09F72F0466FB59E8ED372F8B460D7\r\n    - 6FECA622B0FB282064F7DE42BA472A8EC908D0D6\r\n    - 70A772485C5ED330C6876FA901BA722CD44CA05E\r\n    - 70D97367A3DBD5D45482B6AF8C78C58B64D3F3B3\r\n    - 7803FD9753930522705F2B6B4E73622887892C28\r\n    - 7B11A84B18DC4B5F1F2826E7925F0B2DC1B936AE\r\n    - 889FD0BEB3197DDD6C88F5C40D6B8E4D74A892CE\r\n    - 9B6FBABFA2A77FA633F7A2EB352979D5C68CEBC6\r\n    - A451291F17489E3A59F440A1B693D691B053C531\r\n    - A53D77E55A06CF131D670339BACEC5AC0F0C6D66\r\n    - A925D0AFB5D4F5FAC65543C993BE4172F1DBF329\r\n    - B5F81C804E47B76C74C38DF03A5CBE8A4FE69A9A\r\n    - B99DE55043099E9506B304660B8E1374787AB195\r\n    - C00C104FC3E9F5977D11C67EF0C8C671D4DFC412\r\n    - CA0296FA9F48E83EA3F26988401B3F4C4E655F7A\r\n    - D4C6540E789BD3839D65E7EDA5CCA8832493649E\r\n    - D5EDE1BBB9A12757E24BE283AFC8D746ADC4A0D4\r\n    - DEFBFD98C74BEFF839EEB189F0F6C385AD6BA19B\r\n    - ECF152EB6417A069573F2C7D9A35B9CC31EC8F56\r\n    - EE2D40825C77C8DFEF67999F0C521919E6672A10\r\n    - EF09AC6BA08A116F2C4080CBEE8CEF9523E21265\r\n    - F414C49CF502D1B6CC46E08F3AC97D7846B30732\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Vermin backdoor detector (Sysmon).\r\ndescription: Vermin is a full-featured backdoor capable of stealing credentials, keylogging and recording audio.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 028EBDBEBAC7239B41A1F4CE8D2CC61B1E09983B\r\n    - 07E1AF6D3F7B42D2E26DF12A217DEBACEDB8B1B9\r\n    - 09457ACB28C754AA419AB6A7E8B1940201EF3FFE\r\n    - 0EEE92EC2723ED9623F84082DAD962778F4CF776\r\n    - 10128AB8770FBDECD81B8894208A760A3C266D78\r\n    - 131F99A2E18A358B60F09FD61EE312E74B02C07C\r\n    - 14F69C7BFAF1DF16E755CCF754017089238B0E7B\r\n    - 1509F85DE302BE83A47D5AFAD9BEE2542BA317FC\r\n    - 170CEE6523B6620124F52201D943D7D9CA7B95E5\r\n    - 191159F855A0E580290871C945245E3597A5F25C\r\n    - 1F12C32A41D82E978DE333CD4E93FDAA1396BE94\r\n    - 22B17966B597568DB46B94B253CD37CBCF561321\r\n    - 2C7332D8247376842BD1B1BD5298844307649C99\r\n    - 2E08BA5DF30C0718C1733A7836B5F4D98D84905E\r\n    - 2EDF808F8252A4CBCB92F47A0AEDC1AAAE79A777\r\n    - 360F54B33AC960EE29CA0557A28F6BB8417EF409\r\n    - 431FCE6A47D0A48A57F699AA084C9FF175A9D15F\r\n    - 45438834FDC5C690DA3BC1F60722BE86B871280D\r\n    - 4A8A8188E3A7A137651B24780DF37CB6F610CC19\r\n    - 4C1E4E136B7922F9E28D1B38E9760E28929E4F0B\r\n    - 5B6EA57FFC09593C3B65D903368EA5F7FAA2EB68\r\n    - 61D366939FE36861B2FECB38A4DFF6D86C925A00\r\n    - 6A72366D8AE09F72F0466FB59E8ED372F8B460D7\r\n    - 6FECA622B0FB282064F7DE42BA472A8EC908D0D6\r\n    - 70A772485C5ED330C6876FA901BA722CD44CA05E\r\n    - 70D97367A3DBD5D45482B6AF8C78C58B64D3F3B3\r\n    - 7803FD9753930522705F2B6B4E73622887892C28\r\n    - 7B11A84B18DC4B5F1F2826E7925F0B2DC1B936AE\r\n    - 889FD0BEB3197DDD6C88F5C40D6B8E4D74A892CE\r\n    - 9B6FBABFA2A77FA633F7A2EB352979D5C68CEBC6\r\n    - A451291F17489E3A59F440A1B693D691B053C531\r\n    - A53D77E55A06CF131D670339BACEC5AC0F0C6D66\r\n    - A925D0AFB5D4F5FAC65543C993BE4172F1DBF329\r\n    - B5F81C804E47B76C74C38DF03A5CBE8A4FE69A9A\r\n    - B99DE55043099E9506B304660B8E1374787AB195\r\n    - C00C104FC3E9F5977D11C67EF0C8C671D4DFC412\r\n    - CA0296FA9F48E83EA3F26988401B3F4C4E655F7A\r\n    - D4C6540E789BD3839D65E7EDA5CCA8832493649E\r\n    - D5EDE1BBB9A12757E24BE283AFC8D746ADC4A0D4\r\n    - DEFBFD98C74BEFF839EEB189F0F6C385AD6BA19B\r\n    - ECF152EB6417A069573F2C7D9A35B9CC31EC8F56\r\n    - EE2D40825C77C8DFEF67999F0C521919E6672A10\r\n    - EF09AC6BA08A116F2C4080CBEE8CEF9523E21265\r\n    - F414C49CF502D1B6CC46E08F3AC97D7846B30732\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "YJ3knmUBtApo-eN_lOK5": {"category": 15, "updated": "2018-10-24T08:19:46.000Z", "hash": "bc2fdf186c142fe9c29738b87c20377cd8b3f76348d67e532b2835102f8309ae", "title": "Detection of PowerShell Execution via DLL", "permission_id": 3, "title_keyword": "Detection of PowerShell Execution via DLL", "released": "2018-08-25T14:33:54.000Z", "sigma_text": "title: Detection of PowerShell Execution via DLL\r\nstatus: experimental\r\ndescription: Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll\r\nreferences:\r\n- https://github.com/p3nt4/PowerShdll/blob/master/README.md\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Markus Neis\r\ndate: 2018/08/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\rundll32.exe'\r\n  selection2:\r\n    EventID: \"1\"\r\n    Description:\r\n    - '*Windows-Hostprozess (Rundll32)*'\r\n  selection3:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*Default.GetString*'\r\n    - '*FromBase64String*'\r\n  condition: (selection1 or selection2) and selection3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_powershell_DLL_execution.yml", "sigma_text_keyword": "title: Detection of PowerShell Execution via DLL\r\nstatus: experimental\r\ndescription: Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll\r\nreferences:\r\n- https://github.com/p3nt4/PowerShdll/blob/master/README.md\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Markus Neis\r\ndate: 2018/08/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\rundll32.exe'\r\n  selection2:\r\n    EventID: \"1\"\r\n    Description:\r\n    - '*Windows-Hostprozess (Rundll32)*'\r\n  selection3:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*Default.GetString*'\r\n    - '*FromBase64String*'\r\n  condition: (selection1 or selection2) and selection3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "zCVdc2cBqjf_D59H6sn4": {"category": 8, "updated": "2019-01-15T13:04:00.000Z", "hash": "1027513348e917df46e6d2276e5b07183990f3e4211f177aa7eac58b048ce3ec", "title": "APT28 Zekapab/Zebrocy/Cannon Implant (Sysmon/Firewall/Proxy). Part-2", "permission_id": 3, "title_keyword": "APT28 Zekapab/Zebrocy/Cannon Implant (Sysmon/Firewall/Proxy). Part-2", "released": "2018-12-03T09:19:53.000Z", "sigma_text": "title: APT28 Zekapab/Zebrocy/Cannon Implant (Sysmon/Firewall/Proxy). Part-2\r\ndescription: Part-2 of APT28 detection pack. (Part-1 https://tdm.socprime.com/tdm/info/1385/)\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://www.emanueledelucia.net/apt28-targeting-military-institutions/\r\n- https://twitter.com/r0ny_123/status/1070231914533990401\r\n- https://twitter.com/DrunkBinary/status/1069570803463794689\r\n- https://twitter.com/r0ny_123/status/1071041099404206081\r\n- https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28-zebrocy.html\r\n- https://twitter.com/DrunkBinary/status/1075065544544534530\r\n- https://twitter.com/DrunkBinary/status/1075064642140061696\r\n- https://twitter.com/DrunkBinary/status/1075820141164838913\r\n- https://twitter.com/DrunkBinary/status/1075849113709748225\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionSysmon3_emanueledelucia:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 185.99.133.72\r\n  selectionFirewall_emanueledelucia:\r\n    dst_ip:\r\n    - 185.99.133.72\r\n  selectionProxy_emanueledelucia1:\r\n    resource.URL:\r\n    - https://beatguitar.com/n2qqsy/hpse0/sy/yasfy8/msayzp/lw.sip/?n=vxl0bnijnmttnsficoq=\r\n  selectionProxy_emanueledelucia3:\r\n    resource.URL:\r\n    - beatguitar.com\r\n  selection_registry_emanueledelucia0:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - Software\\Microsoft\\Windows\\CurrentVersion\\Run\\UIMgr\r\n  selectionMD5_emanueledelucia1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 43d7ffd611932cf51d7150b176ecfc29\r\n  selectionMD5_emanueledelucia2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 549726b8bfb1919a343ac764d48fdc81\r\n  selectionMD5_r0ny_123:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 02c46f30f4c68a442cf7e13bebe8d3f8\r\n  selectionMD5_drunkbinary:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 1aedaa67e7613594c135177f2973e2c7\r\n  selectionMD5_drunkbinary2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 602d2901d55c2720f955503456ac2f68\r\n  selectionMD5_drunkbinary4:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 3eaf97b9c6b44f0447f2bd1c7acb8c96\r\n    - 6bc5f53d4082f12dd83aca45bae81e64\r\n    - 333d2b9e99b36fb42f9e79a2833fad9c\r\n  selectionMD5_drunkbinary5:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - ea553c3de3fffbfa047e8e0eb2557b8b\r\n    - 8da56a4b1a5ff8e4643421a5fefb5dc4\r\n    - a225d457c3396e647ffc710cd1edd4c74dc57152\r\n  selectionFirewall_r0ny_123_1:\r\n    dst_ip:\r\n    - 89.37.226.123\r\n  selectionProxy_r0ny_123_2:\r\n    resource.URL:\r\n    - /advance/portable_version/service.php\r\n  selectionProxy_vkremez:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 84352ccad3cfa152d98cf76b08623b92\r\n    - fe0da70a592d25ddbfbd47b22f88542f\r\n    - 4384c701308a9d3aa92f49615ec74b2d\r\n    - 26b213343bac2b4c69a261a2f5c00e89\r\n    - 47a026d93ae8e0cc292e8d7a71ddc89e\r\n  selectionProxy_vkremez_1:\r\n    event_id: \"11\"\r\n    event_data.TargetFilename:\r\n    - C:\\Users\\Public\\dset.ini\r\n    - C:\\Users\\Public\\boot.ini\r\n    - C:\\Users\\Public\\kla.bin\r\n    - C:\\Users\\Public\\officeexcp.bin\r\n    - C:\\Users\\Public\\dset.ini\r\n  condition: selectionProxy_emanueledelucia1 or selectionProxy_emanueledelucia3 or selectionFirewall_emanueledelucia or selectionMD5_emanueledelucia2 or selectionMD5_emanueledelucia1 or selectionSysmon3_emanueledelucia or selection_registry_emanueledelucia0 or selectionMD5_r0ny_123 or selectionMD5_drunkbinary or selectionMD5_drunkbinary2 or selectionMD5_drunkbinary2 or selectionMD5_drunkbinary4 or selectionFirewall_r0ny_123_1 or selectionProxy_r0ny_123_2 or selectionProxy_vkremez or selectionProxy_vkremez_1 or selectionMD5_drunkbinary5\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1085\r\n- attack.t1064\r\n- attack.Defense Evasion\r\n- attack.t1064\r\n- attack.t1085\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.Discovery\r\n- attack.t1012\r\n- attack.Command And Control\r\n- attack.t1043\r\n- attack.t1071\r\n- tool.zekapab\r\n- tool.zebrocy\r\n- tool.cannon", "git_filepath": "", "sigma_text_keyword": "title: APT28 Zekapab/Zebrocy/Cannon Implant (Sysmon/Firewall/Proxy). Part-2\r\ndescription: Part-2 of APT28 detection pack. (Part-1 https://tdm.socprime.com/tdm/info/1385/)\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://www.emanueledelucia.net/apt28-targeting-military-institutions/\r\n- https://twitter.com/r0ny_123/status/1070231914533990401\r\n- https://twitter.com/DrunkBinary/status/1069570803463794689\r\n- https://twitter.com/r0ny_123/status/1071041099404206081\r\n- https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28-zebrocy.html\r\n- https://twitter.com/DrunkBinary/status/1075065544544534530\r\n- https://twitter.com/DrunkBinary/status/1075064642140061696\r\n- https://twitter.com/DrunkBinary/status/1075820141164838913\r\n- https://twitter.com/DrunkBinary/status/1075849113709748225\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionSysmon3_emanueledelucia:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 185.99.133.72\r\n  selectionFirewall_emanueledelucia:\r\n    dst_ip:\r\n    - 185.99.133.72\r\n  selectionProxy_emanueledelucia1:\r\n    resource.URL:\r\n    - https://beatguitar.com/n2qqsy/hpse0/sy/yasfy8/msayzp/lw.sip/?n=vxl0bnijnmttnsficoq=\r\n  selectionProxy_emanueledelucia3:\r\n    resource.URL:\r\n    - beatguitar.com\r\n  selection_registry_emanueledelucia0:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - Software\\Microsoft\\Windows\\CurrentVersion\\Run\\UIMgr\r\n  selectionMD5_emanueledelucia1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 43d7ffd611932cf51d7150b176ecfc29\r\n  selectionMD5_emanueledelucia2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 549726b8bfb1919a343ac764d48fdc81\r\n  selectionMD5_r0ny_123:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 02c46f30f4c68a442cf7e13bebe8d3f8\r\n  selectionMD5_drunkbinary:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 1aedaa67e7613594c135177f2973e2c7\r\n  selectionMD5_drunkbinary2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 602d2901d55c2720f955503456ac2f68\r\n  selectionMD5_drunkbinary4:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 3eaf97b9c6b44f0447f2bd1c7acb8c96\r\n    - 6bc5f53d4082f12dd83aca45bae81e64\r\n    - 333d2b9e99b36fb42f9e79a2833fad9c\r\n  selectionMD5_drunkbinary5:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - ea553c3de3fffbfa047e8e0eb2557b8b\r\n    - 8da56a4b1a5ff8e4643421a5fefb5dc4\r\n    - a225d457c3396e647ffc710cd1edd4c74dc57152\r\n  selectionFirewall_r0ny_123_1:\r\n    dst_ip:\r\n    - 89.37.226.123\r\n  selectionProxy_r0ny_123_2:\r\n    resource.URL:\r\n    - /advance/portable_version/service.php\r\n  selectionProxy_vkremez:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 84352ccad3cfa152d98cf76b08623b92\r\n    - fe0da70a592d25ddbfbd47b22f88542f\r\n    - 4384c701308a9d3aa92f49615ec74b2d\r\n    - 26b213343bac2b4c69a261a2f5c00e89\r\n    - 47a026d93ae8e0cc292e8d7a71ddc89e\r\n  selectionProxy_vkremez_1:\r\n    event_id: \"11\"\r\n    event_data.TargetFilename:\r\n    - C:\\Users\\Public\\dset.ini\r\n    - C:\\Users\\Public\\boot.ini\r\n    - C:\\Users\\Public\\kla.bin\r\n    - C:\\Users\\Public\\officeexcp.bin\r\n    - C:\\Users\\Public\\dset.ini\r\n  condition: selectionProxy_emanueledelucia1 or selectionProxy_emanueledelucia3 or selectionFirewall_emanueledelucia or selectionMD5_emanueledelucia2 or selectionMD5_emanueledelucia1 or selectionSysmon3_emanueledelucia or selection_registry_emanueledelucia0 or selectionMD5_r0ny_123 or selectionMD5_drunkbinary or selectionMD5_drunkbinary2 or selectionMD5_drunkbinary2 or selectionMD5_drunkbinary4 or selectionFirewall_r0ny_123_1 or selectionProxy_r0ny_123_2 or selectionProxy_vkremez or selectionProxy_vkremez_1 or selectionMD5_drunkbinary5\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1085\r\n- attack.t1064\r\n- attack.Defense Evasion\r\n- attack.t1064\r\n- attack.t1085\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.Discovery\r\n- attack.t1012\r\n- attack.Command And Control\r\n- attack.t1043\r\n- attack.t1071\r\n- tool.zekapab\r\n- tool.zebrocy\r\n- tool.cannon"}, "vCUSdWcBqjf_D59H6syy": {"category": 8, "updated": "2019-01-14T15:07:33.000Z", "hash": "17f5ccb9767c7db90efd3b0540342987258e1625d49f50700c872a343b3f6844", "title": "FormBook Malware (Sysmon).", "permission_id": 3, "title_keyword": "FormBook Malware (Sysmon).", "released": "2018-12-03T17:18:03.000Z", "sigma_text": "title: FormBook Malware (Sysmon).\r\ndescription: FormBook Malware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.talosintelligence.com/2018/06/my-little-formbook.html\r\n- https://twitter.com/James_inthe_box/status/1082686700713783296\r\n- https://twitter.com/James_inthe_box/status/1083374707825565696\r\ndate: 2019/01/10\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - d7f0f3fea2f9935c1dd7bda343ec1e3fb77457e68b16b9d51516a3d8c651d14f\r\n    - 05a945fc7a9eb4c9a4db8eb974333b3938c06d9299976075b2fc00a79cf0a129\r\n    - 91a471ba534219f05c31d204b3c5217cde7c67f70600aa3abba334888f628376\r\n    - f7e97000615ee77093c4ec49f3cbe4b8cb3dc6feafc74ae8d59f01f05dc4280e\r\n    - 23c40f55797b07b2d9bf1e314ea928b1151af2b2e605aa520a715fe56e481528\r\n    - 1d706a3c85973fe96240a254abff52c0593b4aa0c283d3ecc28df6f8baed853b\r\n    - e8f0136abc46b668d44586a6b5a394b470af6af8e9d91bddca4b70e3e66768d1\r\n    - 958ee876ebaab71ea2ef9fcda6a08598319578ccc1f4bd9baa3a54114b88abdc\r\n    - b031075b8ad2558ee3ee7f0749c2b24484dd6fab7252fad71548276514b9b766\r\n    - 667cc420816fd71ae54869b4c0f05129cc5972dbc47f7a98776fc63a72d77691\r\n    - 7db8273fd25088900cffa036eb631ffcee40302dd7b33a7d4f3e653e7ab091c0\r\n    - 3efdc8b15e324cd9323cdbd34fbd19979d6eeb95fe1120ed3a95dc24fab67397\r\n    - 189e2494b19773f9b72072774891378f5809c7bfb121dcba2cee13e6f91ed619\r\n    - bd44861de18d5bbf71d2d64e29ff9f1d8495f97f5ba0b49eacb504b3768a89bb\r\n    - e0282f51ac3bfba5774893c8b70c31600d7e4bd7f6d7231fd33315396cd18b78\r\n    - 83fa11d8711ef22437681e09a4be500cfaf49ac7cb29837ff6a42fb46b09d789\r\n    - 14ce215b561dc43104e400c0eb877d876f6e9be77c5b2994b9b8745b2132d914\r\n    - 226d38382415b935d849539c0b6305a4259c26dfa7317b944f8498cd3e65850f\r\n    - dd1eeb128b1d1eb40e74281aec79828d7d7179a0375bda5e85ce5fd2fac064a2\r\n    - a7422eddb437a33d730ab70bd1267d815fc3761d5eda9781de91d0bdeeb823ff\r\n    - 2a21f728282b33b89e6cbd99db52651931b534be9837d99eacf87cfd748c3cba\r\n    - 91b6219f4a8903773492fd83fe02e6aa8729e378f559c5cc9f115a2304f89e57\r\n    - 4f73923c23354ac5050f012f607342362eaf1d691ce1b64ea1e831038cc4236c\r\n    - ebbed2fcd7fe4dc8a95cc60ab9c8e98609bcf3ba5696507252c65cc6be748b14\r\n    - d1f9549943b936ba54d87a5befd2d241fcddac6f0caf8c786f6034ab18b8e61d\r\n    - ae7cacc7a16cb48cb40473ad0269331c392f8eb0fef8ebe2d90f3592fccb306c\r\n    - 00cb817330768b33a30bcf7a6a67d0269aa32f8099aee3ecd18da0e31d096610\r\n    - e93994bf78b13d3bdee1682faf6c6544246fbd6d95a0aa043ac175ad0b905646\r\n    - 822c1239203db0bfdde3d0b65f50e53f7ee155638d4743b14f58267fa3e76531\r\n    - 5aac259cb807a4c8e4986dbc1354ef566a12ced381b702a96474c0f8ff45f825\r\n    - 8f6813634cb08d6df72e045294bf63732c0753f79293f1c9b2765f686f699a72\r\n    - 82ce499994e4b2ee46e887946ef43f18b046639e81dfe1d23537ce6a530d8794\r\n    - 4c16046966a5fd06c84213aa67bfa37949800980915e9b511384ec17dc7eb7b1\r\n    - 04f093a3b867918dce921fe2ba40dcdae769b35dbce3047aacdb151e2208ea5c\r\n    - 59cf77148cbbf24d395d09192ce43ac5395087f3e499cda350e3a93f13e37de1\r\n    - D83f874dda2fa3e4339399c786e9497c1b440019fa5ee5925738fc3afa67352c\r\n    - 35ea3d8272751d60bd3106e548444588b1959622dfdcf11be14b80786bdb25e6\r\n    - 5e9979a9676889a6656cbfa9ddc1aab2fa4b301155f5b55377a74257c9f9f583\r\n    - 0b0615eb8e4c91983fab37475ecc374f79c394768a33ea68c2208da1c03e5a43\r\n    - Fccc874f4f741231673f5a3c0bdc4c6bfd07f1b1e93f7c64e2015c393966216e\r\n    - 13ce56581c8ad851fc44ad6c6789829e7c250b2c8af465c4a163b9a28c9b8a41\r\n    - 541ea322a3a6385211566f95cef333580a62341dac397e044a04504625acdd0d\r\n    - 062ae7152d8e8f3abb093e55c5a90213134dd278ac28cfeb18e81132232dcbe8\r\n    - 0ddf7e87957932650679c99ff2e2380e2be8a203d1142f19a22ad602047f372e\r\n    - 1debc4e22a40f4f87142e7e40094ce1a9aa10462f0c6d1c29aa272d7d6849205\r\n    - 701b1549152e2c460c8c67008c3bcc0e\r\n    - 6badb8ff9a65ad709ef8674bb78a8ec0497de536b35fe6b8c6e6d76d17926d54\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: FormBook Malware (Sysmon).\r\ndescription: FormBook Malware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.talosintelligence.com/2018/06/my-little-formbook.html\r\n- https://twitter.com/James_inthe_box/status/1082686700713783296\r\n- https://twitter.com/James_inthe_box/status/1083374707825565696\r\ndate: 2019/01/10\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - d7f0f3fea2f9935c1dd7bda343ec1e3fb77457e68b16b9d51516a3d8c651d14f\r\n    - 05a945fc7a9eb4c9a4db8eb974333b3938c06d9299976075b2fc00a79cf0a129\r\n    - 91a471ba534219f05c31d204b3c5217cde7c67f70600aa3abba334888f628376\r\n    - f7e97000615ee77093c4ec49f3cbe4b8cb3dc6feafc74ae8d59f01f05dc4280e\r\n    - 23c40f55797b07b2d9bf1e314ea928b1151af2b2e605aa520a715fe56e481528\r\n    - 1d706a3c85973fe96240a254abff52c0593b4aa0c283d3ecc28df6f8baed853b\r\n    - e8f0136abc46b668d44586a6b5a394b470af6af8e9d91bddca4b70e3e66768d1\r\n    - 958ee876ebaab71ea2ef9fcda6a08598319578ccc1f4bd9baa3a54114b88abdc\r\n    - b031075b8ad2558ee3ee7f0749c2b24484dd6fab7252fad71548276514b9b766\r\n    - 667cc420816fd71ae54869b4c0f05129cc5972dbc47f7a98776fc63a72d77691\r\n    - 7db8273fd25088900cffa036eb631ffcee40302dd7b33a7d4f3e653e7ab091c0\r\n    - 3efdc8b15e324cd9323cdbd34fbd19979d6eeb95fe1120ed3a95dc24fab67397\r\n    - 189e2494b19773f9b72072774891378f5809c7bfb121dcba2cee13e6f91ed619\r\n    - bd44861de18d5bbf71d2d64e29ff9f1d8495f97f5ba0b49eacb504b3768a89bb\r\n    - e0282f51ac3bfba5774893c8b70c31600d7e4bd7f6d7231fd33315396cd18b78\r\n    - 83fa11d8711ef22437681e09a4be500cfaf49ac7cb29837ff6a42fb46b09d789\r\n    - 14ce215b561dc43104e400c0eb877d876f6e9be77c5b2994b9b8745b2132d914\r\n    - 226d38382415b935d849539c0b6305a4259c26dfa7317b944f8498cd3e65850f\r\n    - dd1eeb128b1d1eb40e74281aec79828d7d7179a0375bda5e85ce5fd2fac064a2\r\n    - a7422eddb437a33d730ab70bd1267d815fc3761d5eda9781de91d0bdeeb823ff\r\n    - 2a21f728282b33b89e6cbd99db52651931b534be9837d99eacf87cfd748c3cba\r\n    - 91b6219f4a8903773492fd83fe02e6aa8729e378f559c5cc9f115a2304f89e57\r\n    - 4f73923c23354ac5050f012f607342362eaf1d691ce1b64ea1e831038cc4236c\r\n    - ebbed2fcd7fe4dc8a95cc60ab9c8e98609bcf3ba5696507252c65cc6be748b14\r\n    - d1f9549943b936ba54d87a5befd2d241fcddac6f0caf8c786f6034ab18b8e61d\r\n    - ae7cacc7a16cb48cb40473ad0269331c392f8eb0fef8ebe2d90f3592fccb306c\r\n    - 00cb817330768b33a30bcf7a6a67d0269aa32f8099aee3ecd18da0e31d096610\r\n    - e93994bf78b13d3bdee1682faf6c6544246fbd6d95a0aa043ac175ad0b905646\r\n    - 822c1239203db0bfdde3d0b65f50e53f7ee155638d4743b14f58267fa3e76531\r\n    - 5aac259cb807a4c8e4986dbc1354ef566a12ced381b702a96474c0f8ff45f825\r\n    - 8f6813634cb08d6df72e045294bf63732c0753f79293f1c9b2765f686f699a72\r\n    - 82ce499994e4b2ee46e887946ef43f18b046639e81dfe1d23537ce6a530d8794\r\n    - 4c16046966a5fd06c84213aa67bfa37949800980915e9b511384ec17dc7eb7b1\r\n    - 04f093a3b867918dce921fe2ba40dcdae769b35dbce3047aacdb151e2208ea5c\r\n    - 59cf77148cbbf24d395d09192ce43ac5395087f3e499cda350e3a93f13e37de1\r\n    - D83f874dda2fa3e4339399c786e9497c1b440019fa5ee5925738fc3afa67352c\r\n    - 35ea3d8272751d60bd3106e548444588b1959622dfdcf11be14b80786bdb25e6\r\n    - 5e9979a9676889a6656cbfa9ddc1aab2fa4b301155f5b55377a74257c9f9f583\r\n    - 0b0615eb8e4c91983fab37475ecc374f79c394768a33ea68c2208da1c03e5a43\r\n    - Fccc874f4f741231673f5a3c0bdc4c6bfd07f1b1e93f7c64e2015c393966216e\r\n    - 13ce56581c8ad851fc44ad6c6789829e7c250b2c8af465c4a163b9a28c9b8a41\r\n    - 541ea322a3a6385211566f95cef333580a62341dac397e044a04504625acdd0d\r\n    - 062ae7152d8e8f3abb093e55c5a90213134dd278ac28cfeb18e81132232dcbe8\r\n    - 0ddf7e87957932650679c99ff2e2380e2be8a203d1142f19a22ad602047f372e\r\n    - 1debc4e22a40f4f87142e7e40094ce1a9aa10462f0c6d1c29aa272d7d6849205\r\n    - 701b1549152e2c460c8c67008c3bcc0e\r\n    - 6badb8ff9a65ad709ef8674bb78a8ec0497de536b35fe6b8c6e6d76d17926d54\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "IW2S9WcBFVBAemBcR2Cc": {"category": 8, "updated": "2019-01-30T09:34:20.000Z", "hash": "0cef57ac7e92267d99ec159fe4caebd64488916ebafaacad61df23adb864fbc4", "title": "Possible System Network Configuration Discovery (Sysmon/Windows Logs).", "permission_id": 3, "title_keyword": "Possible System Network Configuration Discovery (Sysmon/Windows Logs).", "released": "2019-01-30T09:34:20.000Z", "sigma_text": "title: Possible System Network Configuration Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1016/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: \"\"\r\ndetection:\r\n  selection1:\r\n    event_data.Image:\r\n    - net.exe\r\n  selection2:\r\n    event_data.CommandLine:\r\n    - net config\r\n  selection3:\r\n    event_data.Image:\r\n    - ipconfig.exe\r\n    - netsh.exe\r\n    - arp.exe\r\n    - nbtstat.exe\r\n    - systeminfo.exe\r\n  selection4:\r\n    event_id: 7\r\n  condition: (selection1 and selection2) or selection3 and not selection4\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1016", "git_filepath": "", "sigma_text_keyword": "title: Possible System Network Configuration Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1016/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: \"\"\r\ndetection:\r\n  selection1:\r\n    event_data.Image:\r\n    - net.exe\r\n  selection2:\r\n    event_data.CommandLine:\r\n    - net config\r\n  selection3:\r\n    event_data.Image:\r\n    - ipconfig.exe\r\n    - netsh.exe\r\n    - arp.exe\r\n    - nbtstat.exe\r\n    - systeminfo.exe\r\n  selection4:\r\n    event_id: 7\r\n  condition: (selection1 and selection2) or selection3 and not selection4\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1016"}, "B53knmUBtApo-eN_peUf": {"category": 11, "updated": "2018-08-31T16:18:41.000Z", "hash": "027f506eeeba324da0055822bf0a179e4aea3b41ba0cc85e07d007671b034592", "title": "Multiple Failed Logins with Different Accounts from Single Source System", "permission_id": 3, "title_keyword": "Multiple Failed Logins with Different Accounts from Single Source System", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system \nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529\n            - 4625\n        UserName: '*'\n        WorkstationName: '*'\n    selection2:\n        EventID: 4776\n        UserName: '*'\n        Workstation: '*'\n    timeframe: 24h \n    condition:\n        - selection1 | count(UserName) by WorkstationName > 3\n        - selection2 | count(UserName) by Workstation > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Other multiuser systems like Citrix server farms\n    - Workstations with frequently changing users \nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_failed_logons_single_source.yml", "sigma_text_keyword": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system \nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529\n            - 4625\n        UserName: '*'\n        WorkstationName: '*'\n    selection2:\n        EventID: 4776\n        UserName: '*'\n        Workstation: '*'\n    timeframe: 24h \n    condition:\n        - selection1 | count(UserName) by WorkstationName > 3\n        - selection2 | count(UserName) by Workstation > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Other multiuser systems like Citrix server farms\n    - Workstations with frequently changing users \nlevel: medium\n"}, "0273I2kBFVBAemBcX0vk": {"category": 11, "updated": "2019-02-26T13:30:27.000Z", "hash": "4348d90e119cdd06723f2a8bf63785ebb79d6c69046690c0593fb4d0f477a693", "title": "Malicious Base64 encoded PowerShell Keywords in command lines.", "permission_id": 3, "title_keyword": "Malicious Base64 encoded PowerShell Keywords in command lines.", "released": "2019-02-25T09:23:28.000Z", "sigma_text": "title: Malicious Base64 encoded PowerShell Keywords in command lines.\r\nstatus: experimental\r\ndescription: Detects base64 encoded strings used in hidden malicious PowerShell command lines.\r\nreferences:\r\n- http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/\r\nauthor: John Lambert\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  encoded:\r\n    EventID: 4688\r\n    Image: '*\\powershell.exe'\r\n    CommandLine: '* hidden *'\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*'\r\n    - '*aXRzYWRtaW4gL3RyYW5zZmVy*'\r\n    - '*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*'\r\n    - '*JpdHNhZG1pbiAvdHJhbnNmZX*'\r\n    - '*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*'\r\n    - '*Yml0c2FkbWluIC90cmFuc2Zlc*'\r\n    - '*AGMAaAB1AG4AawBfAHMAaQB6AGUA*'\r\n    - '*JABjAGgAdQBuAGsAXwBzAGkAegBlA*'\r\n    - '*JGNodW5rX3Npem*'\r\n    - '*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*'\r\n    - '*RjaHVua19zaXpl*'\r\n    - '*Y2h1bmtfc2l6Z*'\r\n    - '*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*'\r\n    - '*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*'\r\n    - '*lPLkNvbXByZXNzaW9u*'\r\n    - '*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*'\r\n    - '*SU8uQ29tcHJlc3Npb2*'\r\n    - '*Ty5Db21wcmVzc2lvb*'\r\n    - '*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*'\r\n    - '*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*'\r\n    - '*lPLk1lbW9yeVN0cmVhb*'\r\n    - '*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*'\r\n    - '*SU8uTWVtb3J5U3RyZWFt*'\r\n    - '*Ty5NZW1vcnlTdHJlYW*'\r\n    - '*4ARwBlAHQAQwBoAHUAbgBrA*'\r\n    - '*5HZXRDaHVua*'\r\n    - '*AEcAZQB0AEMAaAB1AG4Aaw*'\r\n    - '*LgBHAGUAdABDAGgAdQBuAGsA*'\r\n    - '*LkdldENodW5r*'\r\n    - '*R2V0Q2h1bm*'\r\n    - '*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*'\r\n    - '*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*'\r\n    - '*RIUkVBRF9JTkZPNj*'\r\n    - '*SFJFQURfSU5GTzY0*'\r\n    - '*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*'\r\n    - '*VEhSRUFEX0lORk82N*'\r\n    - '*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*'\r\n    - '*cmVhdGVSZW1vdGVUaHJlYW*'\r\n    - '*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*'\r\n    - '*NyZWF0ZVJlbW90ZVRocmVhZ*'\r\n    - '*Q3JlYXRlUmVtb3RlVGhyZWFk*'\r\n    - '*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*'\r\n    - '*0AZQBtAG0AbwB2AGUA*'\r\n    - '*1lbW1vdm*'\r\n    - '*AGUAbQBtAG8AdgBlA*'\r\n    - '*bQBlAG0AbQBvAHYAZQ*'\r\n    - '*bWVtbW92Z*'\r\n    - '*ZW1tb3Zl*'\r\n  condition: encoded and selection\r\nfalsepositives:\r\n- Penetration tests.\r\nlevel: high\r\ntags:\r\n- attack.execution\r\n- attack.t1086", "git_filepath": "/windows/builtin/win_susp_powershell_hidden_b64_cmd.yml", "sigma_text_keyword": "title: Malicious Base64 encoded PowerShell Keywords in command lines.\r\nstatus: experimental\r\ndescription: Detects base64 encoded strings used in hidden malicious PowerShell command lines.\r\nreferences:\r\n- http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/\r\nauthor: John Lambert\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  encoded:\r\n    EventID: 4688\r\n    Image: '*\\powershell.exe'\r\n    CommandLine: '* hidden *'\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*'\r\n    - '*aXRzYWRtaW4gL3RyYW5zZmVy*'\r\n    - '*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*'\r\n    - '*JpdHNhZG1pbiAvdHJhbnNmZX*'\r\n    - '*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*'\r\n    - '*Yml0c2FkbWluIC90cmFuc2Zlc*'\r\n    - '*AGMAaAB1AG4AawBfAHMAaQB6AGUA*'\r\n    - '*JABjAGgAdQBuAGsAXwBzAGkAegBlA*'\r\n    - '*JGNodW5rX3Npem*'\r\n    - '*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*'\r\n    - '*RjaHVua19zaXpl*'\r\n    - '*Y2h1bmtfc2l6Z*'\r\n    - '*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*'\r\n    - '*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*'\r\n    - '*lPLkNvbXByZXNzaW9u*'\r\n    - '*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*'\r\n    - '*SU8uQ29tcHJlc3Npb2*'\r\n    - '*Ty5Db21wcmVzc2lvb*'\r\n    - '*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*'\r\n    - '*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*'\r\n    - '*lPLk1lbW9yeVN0cmVhb*'\r\n    - '*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*'\r\n    - '*SU8uTWVtb3J5U3RyZWFt*'\r\n    - '*Ty5NZW1vcnlTdHJlYW*'\r\n    - '*4ARwBlAHQAQwBoAHUAbgBrA*'\r\n    - '*5HZXRDaHVua*'\r\n    - '*AEcAZQB0AEMAaAB1AG4Aaw*'\r\n    - '*LgBHAGUAdABDAGgAdQBuAGsA*'\r\n    - '*LkdldENodW5r*'\r\n    - '*R2V0Q2h1bm*'\r\n    - '*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*'\r\n    - '*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*'\r\n    - '*RIUkVBRF9JTkZPNj*'\r\n    - '*SFJFQURfSU5GTzY0*'\r\n    - '*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*'\r\n    - '*VEhSRUFEX0lORk82N*'\r\n    - '*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*'\r\n    - '*cmVhdGVSZW1vdGVUaHJlYW*'\r\n    - '*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*'\r\n    - '*NyZWF0ZVJlbW90ZVRocmVhZ*'\r\n    - '*Q3JlYXRlUmVtb3RlVGhyZWFk*'\r\n    - '*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*'\r\n    - '*0AZQBtAG0AbwB2AGUA*'\r\n    - '*1lbW1vdm*'\r\n    - '*AGUAbQBtAG8AdgBlA*'\r\n    - '*bQBlAG0AbQBvAHYAZQ*'\r\n    - '*bWVtbW92Z*'\r\n    - '*ZW1tb3Zl*'\r\n  condition: encoded and selection\r\nfalsepositives:\r\n- Penetration tests.\r\nlevel: high\r\ntags:\r\n- attack.execution\r\n- attack.t1086"}, "yZ3knmUBtApo-eN_keGP": {"category": 11, "updated": "2019-02-26T15:24:58.000Z", "hash": "b1d97812f4da1d2cb3bb6f830d761c2c8c9044e7143eae612d3b3380921a925e", "title": "Admin User Remote Logon", "permission_id": 3, "title_keyword": "Admin User Remote Logon", "released": "2017-10-29T18:30:11.000Z", "sigma_text": "title: Admin User Remote Logon\r\ndescription: Detect remote login by Administrator user depending on internal pattern\r\nreferences:\r\n- https://car.mitre.org/wiki/CAR-2016-04-005\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1078\r\nstatus: experimental\r\nauthor: juju4\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account'\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 10\r\n    AuthenticationPackageName: Negotiate\r\n    AccountName: Admin-*\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low", "git_filepath": "/windows/builtin/win_admin_rdp_login.yml", "sigma_text_keyword": "title: Admin User Remote Logon\r\ndescription: Detect remote login by Administrator user depending on internal pattern\r\nreferences:\r\n- https://car.mitre.org/wiki/CAR-2016-04-005\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1078\r\nstatus: experimental\r\nauthor: juju4\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account'\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 10\r\n    AuthenticationPackageName: Negotiate\r\n    AccountName: Admin-*\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low"}, "M53knmUBtApo-eN_peX2": {"category": 3, "updated": "2018-11-23T15:07:58.000Z", "hash": "3afd9e7ed486b817dec1dbd072d721edfe4bf9b0548717c2c11535d2b435a83b", "title": "SSHD Error Message CVE-2018-15473", "permission_id": 3, "title_keyword": "SSHD Error Message CVE-2018-15473", "released": "2018-08-24T14:40:41.000Z", "sigma_text": "title: SSHD Error Message CVE-2018-15473\r\ndescription: Detects exploitation attempt using public exploit code for CVE-2018-15473\r\nreferences:\r\n- https://github.com/Rhynorater/CVE-2018-15473-Exploit\r\nauthor: Florian Roth\r\ndate: 2017/08/24\r\nlogsource:\r\n  product: linux\r\n  service: sshd\r\ndetection:\r\n  keywords:\r\n  - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": "/linux/lnx_ssh_cve_2018_15473.yml", "sigma_text_keyword": "title: SSHD Error Message CVE-2018-15473\r\ndescription: Detects exploitation attempt using public exploit code for CVE-2018-15473\r\nreferences:\r\n- https://github.com/Rhynorater/CVE-2018-15473-Exploit\r\nauthor: Florian Roth\r\ndate: 2017/08/24\r\nlogsource:\r\n  product: linux\r\n  service: sshd\r\ndetection:\r\n  keywords:\r\n  - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059"}, "D24yJGkBFVBAemBcQkwW": {"category": 8, "updated": "2019-02-25T10:37:35.000Z", "hash": "b0b81876439f2a4b70f9f28c86773245be4518c6e071614c58be39dfd18cbb47", "title": "Add Programs To Firewall Exclusion From Temp Directory (Sysmon).", "permission_id": 3, "title_keyword": "Add Programs To Firewall Exclusion From Temp Directory (Sysmon).", "released": "2019-02-25T10:37:35.000Z", "sigma_text": "title: Add Programs To Firewall Exclusion From Temp Directory (Sysmon).\r\ndescription: Add Programs To Firewall Exclusion From Temp Directory.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\ndate: 2019/02/25\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\netsh.exe'\r\n    CommandLine:\r\n    - '*netsh firewall add allowedprogram \"C:\\Users\\admin\\AppData\\Local\\Temp\\*'\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\netsh.exe'\r\n    CommandLine:\r\n    - '*ENABLE'\r\n  condition: selection AND selection1\r\nfields:\r\n- Image\r\n- Commandline\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Add Programs To Firewall Exclusion From Temp Directory (Sysmon).\r\ndescription: Add Programs To Firewall Exclusion From Temp Directory.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\ndate: 2019/02/25\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\netsh.exe'\r\n    CommandLine:\r\n    - '*netsh firewall add allowedprogram \"C:\\Users\\admin\\AppData\\Local\\Temp\\*'\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\netsh.exe'\r\n    CommandLine:\r\n    - '*ENABLE'\r\n  condition: selection AND selection1\r\nfields:\r\n- Image\r\n- Commandline\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "BZ3knmUBtApo-eN_qua8": {"category": 15, "updated": "2018-10-24T12:10:49.000Z", "hash": "a2eed3ef261b4f6d304399d8b0f0539ee4d8c9a79da97f36b9f882e171abfc60", "title": "Suspicious Control Panel DLL Load", "permission_id": 3, "title_keyword": "Suspicious Control Panel DLL Load", "released": "2017-04-15T21:32:26.000Z", "sigma_text": "title: Suspicious Control Panel DLL Load\r\nstatus: experimental\r\ndescription: Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits\r\nauthor: Florian Roth\r\ndate: 2017/04/15\r\nreferences:\r\n- https://twitter.com/rikvduijn/status/853251879320662017\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\System32\\control.exe'\r\n    CommandLine: '*\\rundll32.exe *'\r\n  filter:\r\n    CommandLine: '*Shell32.dll*'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_control_dll_load.yml", "sigma_text_keyword": "title: Suspicious Control Panel DLL Load\r\nstatus: experimental\r\ndescription: Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits\r\nauthor: Florian Roth\r\ndate: 2017/04/15\r\nreferences:\r\n- https://twitter.com/rikvduijn/status/853251879320662017\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\System32\\control.exe'\r\n    CommandLine: '*\\rundll32.exe *'\r\n  filter:\r\n    CommandLine: '*Shell32.dll*'\r\n  condition: selection and not filter\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "BwIJ8mUBqfpvXJhT7RCb": {"category": 8, "updated": "2019-02-26T09:35:20.000Z", "hash": "271eaae7e9d3cd97eed5533adca5a309b4a067fa41be4f7672e75ccc7f3de342", "title": "Sysmon state and configuration changed.", "permission_id": 3, "title_keyword": "Sysmon state and configuration changed.", "released": "2018-09-19T13:40:03.000Z", "sigma_text": "title: Sysmon state and configuration changed.\r\ndescription: Detects sysmon state and configuration change.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 4\r\n  selection2:\r\n    EventID: 16\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1089", "git_filepath": null, "sigma_text_keyword": "title: Sysmon state and configuration changed.\r\ndescription: Detects sysmon state and configuration change.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 4\r\n  selection2:\r\n    EventID: 16\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1089"}, "YG0GDmgBFVBAemBcSmhA": {"category": 8, "updated": "2019-01-30T09:36:29.000Z", "hash": "848e51299eed42a6c9348e2f8bbbd1e1cec2da1fd87910a578b098e430aca95a", "title": "Possible System Network Connections Discovery (Sysmon/Windows Logs).", "permission_id": 3, "title_keyword": "Possible System Network Connections Discovery (Sysmon/Windows Logs).", "released": "2019-01-30T09:36:29.000Z", "sigma_text": "title: Possible System Network Connections Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1049/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - net config\r\n    - net use\r\n    - net sessions\r\n    - net file\r\n    - net1 config\r\n    - net1 use\r\n    - net1 sessions\r\n    - net1 file\r\n    - netstat\r\n    - Get-NetTCPConnection\r\n  condition: selection0\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1049", "git_filepath": "", "sigma_text_keyword": "title: Possible System Network Connections Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1049/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - net config\r\n    - net use\r\n    - net sessions\r\n    - net file\r\n    - net1 config\r\n    - net1 use\r\n    - net1 sessions\r\n    - net1 file\r\n    - netstat\r\n    - Get-NetTCPConnection\r\n  condition: selection0\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1049"}, "CZ3knmUBtApo-eN_jOHk": {"category": 5, "updated": "2019-02-26T14:21:13.000Z", "hash": "f70381c82500c910cdadc07ba6a3e21d2c5eaa2b0c28befc18d11cfe34c563cd", "title": "Hack Tool User Agent", "permission_id": 3, "title_keyword": "Hack Tool User Agent", "released": "2017-07-08T15:59:05.000Z", "sigma_text": "title: Hack Tool User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings user by hack tools in proxy logs\r\nreferences:\r\n- https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\r\n- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - '*(hydra)*'\r\n    - '* arachni/*'\r\n    - '* BFAC *'\r\n    - '* brutus *'\r\n    - '* cgichk *'\r\n    - '*core-project/1.0*'\r\n    - '* crimscanner/*'\r\n    - '*datacha0s*'\r\n    - '*dirbuster*'\r\n    - '*domino hunter*'\r\n    - '*dotdotpwn*'\r\n    - FHScan Core\r\n    - '*floodgate*'\r\n    - '*get-minimal*'\r\n    - '*gootkit auto-rooter scanner*'\r\n    - '*grendel-scan*'\r\n    - '* inspath *'\r\n    - '*internet ninja*'\r\n    - '*jaascois*'\r\n    - '* zmeu *'\r\n    - '*masscan*'\r\n    - '* metis *'\r\n    - '*morfeus fucking scanner*'\r\n    - '*n-stealth*'\r\n    - '*nsauditor*'\r\n    - '*pmafind*'\r\n    - '*security scan*'\r\n    - '*springenwerk*'\r\n    - '*teh forest lobster*'\r\n    - '*toata dragostea*'\r\n    - '* vega/*'\r\n    - '*voideye*'\r\n    - '*webshag*'\r\n    - '*webvulnscan*'\r\n    - '* whcc/*'\r\n    - '* Havij'\r\n    - '*absinthe*'\r\n    - '*bsqlbf*'\r\n    - '*mysqloit*'\r\n    - '*pangolin*'\r\n    - '*sql power injector*'\r\n    - '*sqlmap*'\r\n    - '*sqlninja*'\r\n    - '*uil2pn*'\r\n    - ruler\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/proxy/proxy_ua_hacktool.yml", "sigma_text_keyword": "title: Hack Tool User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings user by hack tools in proxy logs\r\nreferences:\r\n- https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\r\n- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - '*(hydra)*'\r\n    - '* arachni/*'\r\n    - '* BFAC *'\r\n    - '* brutus *'\r\n    - '* cgichk *'\r\n    - '*core-project/1.0*'\r\n    - '* crimscanner/*'\r\n    - '*datacha0s*'\r\n    - '*dirbuster*'\r\n    - '*domino hunter*'\r\n    - '*dotdotpwn*'\r\n    - FHScan Core\r\n    - '*floodgate*'\r\n    - '*get-minimal*'\r\n    - '*gootkit auto-rooter scanner*'\r\n    - '*grendel-scan*'\r\n    - '* inspath *'\r\n    - '*internet ninja*'\r\n    - '*jaascois*'\r\n    - '* zmeu *'\r\n    - '*masscan*'\r\n    - '* metis *'\r\n    - '*morfeus fucking scanner*'\r\n    - '*n-stealth*'\r\n    - '*nsauditor*'\r\n    - '*pmafind*'\r\n    - '*security scan*'\r\n    - '*springenwerk*'\r\n    - '*teh forest lobster*'\r\n    - '*toata dragostea*'\r\n    - '* vega/*'\r\n    - '*voideye*'\r\n    - '*webshag*'\r\n    - '*webvulnscan*'\r\n    - '* whcc/*'\r\n    - '* Havij'\r\n    - '*absinthe*'\r\n    - '*bsqlbf*'\r\n    - '*mysqloit*'\r\n    - '*pangolin*'\r\n    - '*sql power injector*'\r\n    - '*sqlmap*'\r\n    - '*sqlninja*'\r\n    - '*uil2pn*'\r\n    - ruler\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; pt-PT; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "2G0vDmgBFVBAemBckWgl": {"category": 8, "updated": "2019-01-25T12:26:31.000Z", "hash": "4598cffab292d55fc3ce98546a517df9896e8d218f08460fab4ea383f477249a", "title": "Possible System Time Discovery (Sysmon/Windows Logs).", "permission_id": 3, "title_keyword": "Possible System Time Discovery (Sysmon/Windows Logs).", "released": "2019-01-25T10:12:02.000Z", "sigma_text": "title: Possible System Time Discovery (Sysmon/Windows Logs).\r\ndescription: The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network. (use for Letheral Movement via task scheduler)\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1124/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - net time\r\n    - net1 time\r\n    - Get-Date\r\n  selection1:\r\n    event_data.Image:\r\n    - net.exe\r\n    - net1.exe\r\n    - w32tm.exe\r\n  condition: selection0 or selection1\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1124\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": "", "sigma_text_keyword": "title: Possible System Time Discovery (Sysmon/Windows Logs).\r\ndescription: The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network. (use for Letheral Movement via task scheduler)\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1124/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - net time\r\n    - net1 time\r\n    - Get-Date\r\n  selection1:\r\n    event_data.Image:\r\n    - net.exe\r\n    - net1.exe\r\n    - w32tm.exe\r\n  condition: selection0 or selection1\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1124\r\n- attack.Execution\r\n- attack.t1059"}, "jp3knmUBtApo-eN_g9-j": {"category": 8, "updated": "2018-10-31T11:05:01.000Z", "hash": "71cbec9d29c60eb3e36eafee0672c45ddf88f4ce9269db117b1489813d61e4b5", "title": "VPNFilter Destructive Malware detection (IP)", "permission_id": 3, "title_keyword": "VPNFilter Destructive Malware detection (IP)", "released": "2018-05-24T06:06:16.000Z", "sigma_text": "title: VPNFilter Destructive Malware detection (IP)\r\ndescription: This rule detects VPNFilter Destructive Malware  activity (IP)\r\nauthor: Rostyslav Hembus, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  incoming:\r\n    src:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  condition: outgoing or incoming\r\nfields:\r\n- DestinationIp\r\n- UserAgent\r\n- SourceIp\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ndate: 2018/05/24\r\nreference:\r\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\r\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\r\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\r\n- https://blogs.cisco.com/security/talos/vpnfilter\r\n- https://jask.com/from-russia-with-love/\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": null, "sigma_text_keyword": "title: VPNFilter Destructive Malware detection (IP)\r\ndescription: This rule detects VPNFilter Destructive Malware  activity (IP)\r\nauthor: Rostyslav Hembus, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  incoming:\r\n    src:\r\n    - 91.121.109.209\r\n    - 217.12.202.40\r\n    - 94.242.222.68\r\n    - 82.118.242.124\r\n    - 46.151.209.33\r\n    - 217.79.179.14\r\n    - 91.214.203.144\r\n    - 95.211.198.231\r\n    - 195.154.180.60\r\n    - 5.149.250.54\r\n    - 91.200.13.76\r\n    - 94.185.80.82\r\n    - 62.210.180.229\r\n    - 91.200.13.76\r\n    - 23.111.177.114\r\n    - 138.186.2.250\r\n    - 250.2.186.138\r\n    - 178.78.13.69\r\n    - 178.78.6.224\r\n    - 187.85.58.107\r\n    - 192.157.214.6\r\n    - 77.45.243.188\r\n    - 88.213.189.253\r\n    - 9.110.0.5\r\n  condition: outgoing or incoming\r\nfields:\r\n- DestinationIp\r\n- UserAgent\r\n- SourceIp\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ndate: 2018/05/24\r\nreference:\r\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\r\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\r\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\r\n- https://blogs.cisco.com/security/talos/vpnfilter\r\n- https://jask.com/from-russia-with-love/\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "KJ3knmUBtApo-eN_n-So": {"category": 3, "updated": "2018-10-25T09:43:40.000Z", "hash": "e146e8a85196ad5e8a8e97880ffeb0736c78c06569d565190733632c3bf6dcbb", "title": "Suspicious Named Error", "permission_id": 3, "title_keyword": "Suspicious Named Error", "released": "2018-02-20T13:56:28.000Z", "sigma_text": "title: Suspicious Named Error\r\nstatus: experimental\r\ndescription: Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml\r\nauthor: Florian Roth\r\ndate: 2018/02/20\r\nlogsource:\r\n  product: linux\r\n  service: syslog\r\ndetection:\r\n  keywords:\r\n  - '* dropping source port zero packet from *'\r\n  - '* denied AXFR from *'\r\n  - '* exiting (due to fatal error)*'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/linux/lnx_susp_named.yml", "sigma_text_keyword": "title: Suspicious Named Error\r\nstatus: experimental\r\ndescription: Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml\r\nauthor: Florian Roth\r\ndate: 2018/02/20\r\nlogsource:\r\n  product: linux\r\n  service: syslog\r\ndetection:\r\n  keywords:\r\n  - '* dropping source port zero packet from *'\r\n  - '* denied AXFR from *'\r\n  - '* exiting (due to fatal error)*'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "-p3knmUBtApo-eN_sOah": {"category": 15, "updated": "2019-02-26T15:11:24.000Z", "hash": "deb542ba3f0fef42271d5fa5b5bdcfe0f4a18b3457d1d10298a257f81bbd03c6", "title": "UAC Bypass via Event Viewer", "permission_id": 3, "title_keyword": "UAC Bypass via Event Viewer", "released": "2017-03-19T18:34:06.000Z", "sigma_text": "title: UAC Bypass via Event Viewer\r\nstatus: experimental\r\ndescription: Detects UAC bypass method using Windows event viewer\r\nreferences:\r\n- https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\r\n- https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  methregistry:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\\\*\\mscfile\\shell\\open\\command\r\n  methprocess:\r\n    EventID: 1\r\n    ParentImage: '*\\eventvwr.exe'\r\n  filterprocess:\r\n    Image: '*\\mmc.exe'\r\n  condition: methregistry or ( methprocess and not filterprocess )\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_uac_bypass_eventvwr.yml", "sigma_text_keyword": "title: UAC Bypass via Event Viewer\r\nstatus: experimental\r\ndescription: Detects UAC bypass method using Windows event viewer\r\nreferences:\r\n- https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\r\n- https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  methregistry:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\\\*\\mscfile\\shell\\open\\command\r\n  methprocess:\r\n    EventID: 1\r\n    ParentImage: '*\\eventvwr.exe'\r\n  filterprocess:\r\n    Image: '*\\mmc.exe'\r\n  condition: methregistry or ( methprocess and not filterprocess )\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: critical"}, "vm5hLmkBFVBAemBcAFZ-": {"category": 2, "updated": "2019-02-27T10:06:18.000Z", "hash": "8265e83a0084ff04ef1e73d7c3588d5477ac7292a9b89de54ced3e37aa2bff58", "title": "Turla PNG Dropper Service.", "permission_id": 3, "title_keyword": "Turla PNG Dropper Service.", "released": "2019-02-27T09:55:02.000Z", "sigma_text": "title: Turla PNG Dropper Service.\r\ndescription: This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018.\r\nreferences:\r\n- https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/november/turla-png-dropper-is-back/\r\nauthor: Florian Roth\r\ndate: 2018/11/23\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 7045\r\n    ServiceName: WerFaultSvc\r\n  condition: selection\r\nfalsepositives:\r\n- unlikely\r\nlevel: critical\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0016\r\n- attack.t1172", "git_filepath": "/apt/apt_turla_service_png.yml", "sigma_text_keyword": "title: Turla PNG Dropper Service.\r\ndescription: This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018.\r\nreferences:\r\n- https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/november/turla-png-dropper-is-back/\r\nauthor: Florian Roth\r\ndate: 2018/11/23\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 7045\r\n    ServiceName: WerFaultSvc\r\n  condition: selection\r\nfalsepositives:\r\n- unlikely\r\nlevel: critical\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0016\r\n- attack.t1172"}, "jp3knmUBtApo-eN_nONM": {"category": 11, "updated": "2018-10-25T10:07:46.000Z", "hash": "82a9592530efc330cf9f4c101780a82a074552da2b9218224d51354e921a86a3", "title": "Account Tampering - Suspicious Failed Logon Reasons", "permission_id": 3, "title_keyword": "Account Tampering - Suspicious Failed Logon Reasons", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Account Tampering - Suspicious Failed Logon Reasons\r\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1078\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4625\"\r\n    - \"4776\"\r\n    Status:\r\n    - \"0xC0000072\"\r\n    - \"0xC000006F\"\r\n    - \"0xC0000070\"\r\n    - \"0xC0000413\"\r\n    - \"0xC000018C\"\r\n  condition: selection\r\nfalsepositives:\r\n- User using a disabled account\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_failed_logon_reasons.yml", "sigma_text_keyword": "title: Account Tampering - Suspicious Failed Logon Reasons\r\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1078\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"4625\"\r\n    - \"4776\"\r\n    Status:\r\n    - \"0xC0000072\"\r\n    - \"0xC000006F\"\r\n    - \"0xC0000070\"\r\n    - \"0xC0000413\"\r\n    - \"0xC000018C\"\r\n  condition: selection\r\nfalsepositives:\r\n- User using a disabled account\r\nlevel: high"}, "_53knmUBtApo-eN_ht_V": {"category": 11, "updated": "2019-02-26T15:34:42.000Z", "hash": "16b44629bcb1925a8872dff17f7e29b8a05176308a0b1378cac6886ba67a5f44", "title": "Mimikatz Use", "permission_id": 3, "title_keyword": "Mimikatz Use", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Mimikatz Use\r\ndescription: This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)\r\nauthor: Florian Roth\r\ntags:\r\n- attack.s0002\r\n- attack.lateral_movement\r\n- attack.credential_access\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  keywords:\r\n  - mimikatz\r\n  - mimilib\r\n  - <3 eo.oe\r\n  - eo.oe.kiwi\r\n  - privilege::debug\r\n  - sekurlsa::logonpasswords\r\n  - lsadump::sam\r\n  - mimidrv.sys\r\n  condition: keywords\r\nfalsepositives:\r\n- Naughty administrators\r\n- Penetration test\r\nlevel: critical", "git_filepath": "/windows/builtin/win_alert_mimikatz_keywords.yml", "sigma_text_keyword": "title: Mimikatz Use\r\ndescription: This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)\r\nauthor: Florian Roth\r\ntags:\r\n- attack.s0002\r\n- attack.lateral_movement\r\n- attack.credential_access\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  keywords:\r\n  - mimikatz\r\n  - mimilib\r\n  - <3 eo.oe\r\n  - eo.oe.kiwi\r\n  - privilege::debug\r\n  - sekurlsa::logonpasswords\r\n  - lsadump::sam\r\n  - mimidrv.sys\r\n  condition: keywords\r\nfalsepositives:\r\n- Naughty administrators\r\n- Penetration test\r\nlevel: critical"}, "5J3knmUBtApo-eN_ht9K": {"category": 11, "updated": "2019-02-26T15:35:02.000Z", "hash": "8371b92a868576cf3db2c11e3b9f40849c6594138094357afe5b6aa0f93e35d3", "title": "Enabled User Right in AD to Control User Objects", "permission_id": 3, "title_keyword": "Enabled User Right in AD to Control User Objects", "released": "2017-04-03T19:58:23.000Z", "sigma_text": "title: Enabled User Right in AD to Control User Objects\r\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.t1078\r\nreferences:\r\n- https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\r\ndetection:\r\n  selection:\r\n    EventID: 4704\r\n  keywords:\r\n  - SeEnableDelegationPrivilege\r\n  condition: selection or keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/builtin/win_alert_active_directory_user_control.yml", "sigma_text_keyword": "title: Enabled User Right in AD to Control User Objects\r\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.t1078\r\nreferences:\r\n- https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\r\ndetection:\r\n  selection:\r\n    EventID: 4704\r\n  keywords:\r\n  - SeEnableDelegationPrivilege\r\n  condition: selection or keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "AJ3knmUBtApo-eN_kuLC": {"category": 14, "updated": "2019-02-26T13:38:52.000Z", "hash": "8800c8db874d64fec4d3344ebc07cdb533d71d507cf3292fd3636cb3bbfa8101", "title": "Malicious PowerShell Commandlets", "permission_id": 3, "title_keyword": "Malicious PowerShell Commandlets", "released": "2017-03-05T00:47:25.000Z", "sigma_text": "title: Malicious PowerShell Commandlets\r\nstatus: experimental\r\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keywords:\r\n  - Invoke-DllInjection\r\n  - Invoke-Shellcode\r\n  - Invoke-WmiCommand\r\n  - Get-GPPPassword\r\n  - Get-Keystrokes\r\n  - Get-TimedScreenshot\r\n  - Get-VaultCredential\r\n  - Invoke-CredentialInjection\r\n  - Invoke-Mimikatz\r\n  - Invoke-NinjaCopy\r\n  - Invoke-TokenManipulation\r\n  - Out-Minidump\r\n  - VolumeShadowCopyTools\r\n  - Invoke-ReflectivePEInjection\r\n  - Invoke-UserHunter\r\n  - Find-GPOLocation\r\n  - Invoke-ACLScanner\r\n  - Invoke-DowngradeAccount\r\n  - Get-ServiceUnquoted\r\n  - Get-ServiceFilePermission\r\n  - Get-ServicePermission\r\n  - Invoke-ServiceAbuse\r\n  - Install-ServiceBinary\r\n  - Get-RegAutoLogon\r\n  - Get-VulnAutoRun\r\n  - Get-VulnSchTask\r\n  - Get-UnattendedInstallFile\r\n  - Get-WebConfig\r\n  - Get-ApplicationHost\r\n  - Get-RegAlwaysInstallElevated\r\n  - Get-Unconstrained\r\n  - Add-RegBackdoor\r\n  - Add-ScrnSaveBackdoor\r\n  - Gupt-Backdoor\r\n  - Invoke-ADSBackdoor\r\n  - Enabled-DuplicateToken\r\n  - Invoke-PsUaCme\r\n  - Remove-Update\r\n  - Check-VM\r\n  - Get-LSASecret\r\n  - Get-PassHashes\r\n  - Invoke-Mimikatz\r\n  - Show-TargetScreen\r\n  - Port-Scan\r\n  - Invoke-PoshRatHttp\r\n  - Invoke-PowerShellTCP\r\n  - Invoke-PowerShellWMI\r\n  - Add-Exfiltration\r\n  - Add-Persistence\r\n  - Do-Exfiltration\r\n  - Start-CaptureServer\r\n  - Invoke-DllInjection\r\n  - Invoke-ReflectivePEInjection\r\n  - Invoke-ShellCode\r\n  - Get-ChromeDump\r\n  - Get-ClipboardContents\r\n  - Get-FoxDump\r\n  - Get-IndexedItem\r\n  - Get-Keystrokes\r\n  - Get-Screenshot\r\n  - Invoke-Inveigh\r\n  - Invoke-NetRipper\r\n  - Invoke-NinjaCopy\r\n  - Out-Minidump\r\n  - Invoke-EgressCheck\r\n  - Invoke-PostExfil\r\n  - Invoke-PSInject\r\n  - Invoke-RunAs\r\n  - MailRaider\r\n  - New-HoneyHash\r\n  - Set-MacAttribute\r\n  - Get-VaultCredential\r\n  - Invoke-DCSync\r\n  - Invoke-Mimikatz\r\n  - Invoke-PowerDump\r\n  - Invoke-TokenManipulation\r\n  - Exploit-Jboss\r\n  - Invoke-ThunderStruck\r\n  - Invoke-VoiceTroll\r\n  - Set-Wallpaper\r\n  - Invoke-InveighRelay\r\n  - Invoke-PsExec\r\n  - Invoke-SSHCommand\r\n  - Get-SecurityPackages\r\n  - Install-SSP\r\n  - Invoke-BackdoorLNK\r\n  - PowerBreach\r\n  - Get-GPPPassword\r\n  - Get-SiteListPassword\r\n  - Get-System\r\n  - Invoke-BypassUAC\r\n  - Invoke-Tater\r\n  - Invoke-WScriptBypassUAC\r\n  - PowerUp\r\n  - PowerView\r\n  - Get-RickAstley\r\n  - Find-Fruit\r\n  - HTTP-Login\r\n  - Find-TrustedDocuments\r\n  - Invoke-Paranoia\r\n  - Invoke-WinEnum\r\n  - Invoke-ARPScan\r\n  - Invoke-PortScan\r\n  - Invoke-ReverseDNSLookup\r\n  - Invoke-SMBScanner\r\n  - Invoke-Mimikittenz\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_malicious_commandlets.yml", "sigma_text_keyword": "title: Malicious PowerShell Commandlets\r\nstatus: experimental\r\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\r\nreferences:\r\n- https://adsecurity.org/?p=2921\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Sean Metcalf, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keywords:\r\n  - Invoke-DllInjection\r\n  - Invoke-Shellcode\r\n  - Invoke-WmiCommand\r\n  - Get-GPPPassword\r\n  - Get-Keystrokes\r\n  - Get-TimedScreenshot\r\n  - Get-VaultCredential\r\n  - Invoke-CredentialInjection\r\n  - Invoke-Mimikatz\r\n  - Invoke-NinjaCopy\r\n  - Invoke-TokenManipulation\r\n  - Out-Minidump\r\n  - VolumeShadowCopyTools\r\n  - Invoke-ReflectivePEInjection\r\n  - Invoke-UserHunter\r\n  - Find-GPOLocation\r\n  - Invoke-ACLScanner\r\n  - Invoke-DowngradeAccount\r\n  - Get-ServiceUnquoted\r\n  - Get-ServiceFilePermission\r\n  - Get-ServicePermission\r\n  - Invoke-ServiceAbuse\r\n  - Install-ServiceBinary\r\n  - Get-RegAutoLogon\r\n  - Get-VulnAutoRun\r\n  - Get-VulnSchTask\r\n  - Get-UnattendedInstallFile\r\n  - Get-WebConfig\r\n  - Get-ApplicationHost\r\n  - Get-RegAlwaysInstallElevated\r\n  - Get-Unconstrained\r\n  - Add-RegBackdoor\r\n  - Add-ScrnSaveBackdoor\r\n  - Gupt-Backdoor\r\n  - Invoke-ADSBackdoor\r\n  - Enabled-DuplicateToken\r\n  - Invoke-PsUaCme\r\n  - Remove-Update\r\n  - Check-VM\r\n  - Get-LSASecret\r\n  - Get-PassHashes\r\n  - Invoke-Mimikatz\r\n  - Show-TargetScreen\r\n  - Port-Scan\r\n  - Invoke-PoshRatHttp\r\n  - Invoke-PowerShellTCP\r\n  - Invoke-PowerShellWMI\r\n  - Add-Exfiltration\r\n  - Add-Persistence\r\n  - Do-Exfiltration\r\n  - Start-CaptureServer\r\n  - Invoke-DllInjection\r\n  - Invoke-ReflectivePEInjection\r\n  - Invoke-ShellCode\r\n  - Get-ChromeDump\r\n  - Get-ClipboardContents\r\n  - Get-FoxDump\r\n  - Get-IndexedItem\r\n  - Get-Keystrokes\r\n  - Get-Screenshot\r\n  - Invoke-Inveigh\r\n  - Invoke-NetRipper\r\n  - Invoke-NinjaCopy\r\n  - Out-Minidump\r\n  - Invoke-EgressCheck\r\n  - Invoke-PostExfil\r\n  - Invoke-PSInject\r\n  - Invoke-RunAs\r\n  - MailRaider\r\n  - New-HoneyHash\r\n  - Set-MacAttribute\r\n  - Get-VaultCredential\r\n  - Invoke-DCSync\r\n  - Invoke-Mimikatz\r\n  - Invoke-PowerDump\r\n  - Invoke-TokenManipulation\r\n  - Exploit-Jboss\r\n  - Invoke-ThunderStruck\r\n  - Invoke-VoiceTroll\r\n  - Set-Wallpaper\r\n  - Invoke-InveighRelay\r\n  - Invoke-PsExec\r\n  - Invoke-SSHCommand\r\n  - Get-SecurityPackages\r\n  - Install-SSP\r\n  - Invoke-BackdoorLNK\r\n  - PowerBreach\r\n  - Get-GPPPassword\r\n  - Get-SiteListPassword\r\n  - Get-System\r\n  - Invoke-BypassUAC\r\n  - Invoke-Tater\r\n  - Invoke-WScriptBypassUAC\r\n  - PowerUp\r\n  - PowerView\r\n  - Get-RickAstley\r\n  - Find-Fruit\r\n  - HTTP-Login\r\n  - Find-TrustedDocuments\r\n  - Invoke-Paranoia\r\n  - Invoke-WinEnum\r\n  - Invoke-ARPScan\r\n  - Invoke-PortScan\r\n  - Invoke-ReverseDNSLookup\r\n  - Invoke-SMBScanner\r\n  - Invoke-Mimikittenz\r\n  condition: keywords\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: high"}, "jiXhWmcBqjf_D59HXLpX": {"category": 8, "updated": "2019-01-02T14:46:23.000Z", "hash": "029ad49386b3a8befe592ad5259138a178fa06b18cd27200a64c5a411f35a331", "title": "APT28 Zekapab/Zebrocy Implant (Sysmon/Firewall/Proxy). Part-1", "permission_id": 3, "title_keyword": "APT28 Zekapab/Zebrocy Implant (Sysmon/Firewall/Proxy). Part-1", "released": "2018-11-28T15:30:27.000Z", "sigma_text": "title: APT28 Zekapab/Zebrocy Implant (Sysmon/Firewall/Proxy). Part-1\r\ndescription: Part-1 of APT28 detection pack. (Part-2 https://tdm.socprime.com/tdm/info/1393/)\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://twitter.com/DrunkBinary/status/1067796683768152064\r\n- https://twitter.com/r0ny_123/status/1067802500911325185\r\n- https://www.hybrid-analysis.com/sample/bfda3856d860d98ecffd3b627cd2ed743d6d64ee5c138b5e1db06b5282b4eb67?environmentId=120\r\n- https://twitter.com/r0ny_123/status/1068394684643389441\r\n- https://www.accenture.com/us-en/blogs/blogs-snakemackerel-delivers-zekapab-malware\r\n- https://analyze.intezer.com/#/analyses/6c14b47e-0417-4081-bcfe-6633d4e27fad\r\n- https://twitter.com/r0ny_123/status/1068579313153273856\r\ndate: 2018/11/17\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionMD5_dttcodexgigas:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 1fe6af243760ca287f80eafbb98ba1b0\r\n  selectionMD5_hybrid_analysis:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 445c84d3f3b26b4c254114db56849157\r\n  selectionMD5_DrunkBinary:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - e57a401e8f0943b703d975692fcfc0e8\r\n  selectionSysmon3:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 185.217.92.119\r\n  selectionSysmon3_accenture:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 109.248.148.42\r\n  selectionFirewall:\r\n    dst_ip:\r\n    - 185.217.92.119\r\n  selectionFirewall_accenture:\r\n    dst_ip:\r\n    - 109.248.148.42\r\n  selectionProxy:\r\n    resource.URL:\r\n    - http://185.217.92.119/db-module/version_1594/main.php?git=\r\n  selectionProxy_accenture_0:\r\n    resource.URL:\r\n    - http://109.248.148.42/officeDocument/2006/relationships/\r\n  selectionProxy_accenture_1:\r\n    resource.URL:\r\n    - http://109.248.148.42/office/thememl/2012/main/\r\n  selectionProxy_accenture_2:\r\n    resource.URL:\r\n    - /agr-enum/progress-inform/cube.php?res=\r\n  selectionMD5_accenture_0:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 7e67122d3a052e4755b02965e2e56a2e\r\n  selectionMD5_accenture_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a13c864980159cd9bdc94074b2389dda\r\n  selectionMD5_accenture_2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - f4cab3a393462a57639faa978a75d10a\r\n  selection_registry_accenture_0:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AudioMgr\r\n  selection_registry_accenture_1:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleIndexer\r\n  selectionMD5_intezer_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 604b3e7d9b11afbdf525336cefc97f88a85dd3a2f0801277d5c7619d6bceb605\r\n  selectionMD5_intezer_2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 87bffb0370c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef\r\n  selectionMD5_intezer_3:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a6576282d17cca390e35306a423dcb5ac9276c28eaba63f74001757edc3688df\r\n  selectionMD5_intezer_4:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6\r\n  selectionMD5_intezer_5:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 05fd4393288a8217243baf9c1bed942b219620b18487bc81fc6ced1238304f93\r\n  selectionMD5_intezer_6:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a15a4e21fe3b06870d52f7383ef45e4ac0dde727b02b3d340f0ba6346b43add1\r\n  selectionMD5_intezer_7:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 2b19497db8cb05cd3d22996efe5af8eac0f2ea51e80f606b7b8a79dfaa2f58e2\r\n  selectionMD5_intezer_8:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 6d70a54702f4456699d1f1d6c1835619c75f8f340ae95a21743b67123e88677e\r\n  selectionMD5_intezer_9:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 5223a45d8b08eb14e87a87edaa4b71593b4f9d2bdb6de1a5b6f3e77869eeca8a\r\n  selectionMD5_r0ny_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 6fdf33cc14672908bd7f25d3620417ee\r\n  condition: selectionMD5_dttcodexgigas or selectionMD5_accenture_0 or selectionMD5_accenture_1 or selectionMD5_accenture_2 or selectionMD5_DrunkBinary or selectionSysmon3 or selectionSysmon3_accenture or selectionFirewall or selectionFirewall_accenture or selectionProxy or selectionProxy_accenture_0 or selectionProxy_accenture_1 or selectionProxy_accenture_2 or selectionMD5_hybrid_analysis or selection_registry_accenture_0 or selection_registry_accenture_1 or selectionMD5_intezer_1 or selectionMD5_intezer_2 or selectionMD5_intezer_3 or selectionMD5_intezer_4 or selectionMD5_intezer_5 or selectionMD5_intezer_6 or selectionMD5_intezer_7 or selectionMD5_intezer_8 or selectionMD5_intezer_9 or selectionMD5_r0ny_1\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1085\r\n- attack.t1064\r\n- attack.Defense Evasion\r\n- attack.t1064\r\n- attack.t1085\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.Discovery\r\n- attack.t1012\r\n- attack.Command And Control\r\n- attack.1043\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: APT28 Zekapab/Zebrocy Implant (Sysmon/Firewall/Proxy). Part-1\r\ndescription: Part-1 of APT28 detection pack. (Part-2 https://tdm.socprime.com/tdm/info/1393/)\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://twitter.com/DrunkBinary/status/1067796683768152064\r\n- https://twitter.com/r0ny_123/status/1067802500911325185\r\n- https://www.hybrid-analysis.com/sample/bfda3856d860d98ecffd3b627cd2ed743d6d64ee5c138b5e1db06b5282b4eb67?environmentId=120\r\n- https://twitter.com/r0ny_123/status/1068394684643389441\r\n- https://www.accenture.com/us-en/blogs/blogs-snakemackerel-delivers-zekapab-malware\r\n- https://analyze.intezer.com/#/analyses/6c14b47e-0417-4081-bcfe-6633d4e27fad\r\n- https://twitter.com/r0ny_123/status/1068579313153273856\r\ndate: 2018/11/17\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionMD5_dttcodexgigas:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 1fe6af243760ca287f80eafbb98ba1b0\r\n  selectionMD5_hybrid_analysis:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 445c84d3f3b26b4c254114db56849157\r\n  selectionMD5_DrunkBinary:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - e57a401e8f0943b703d975692fcfc0e8\r\n  selectionSysmon3:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 185.217.92.119\r\n  selectionSysmon3_accenture:\r\n    event_id: \"3\"\r\n    event_data.DestinationIp:\r\n    - 109.248.148.42\r\n  selectionFirewall:\r\n    dst_ip:\r\n    - 185.217.92.119\r\n  selectionFirewall_accenture:\r\n    dst_ip:\r\n    - 109.248.148.42\r\n  selectionProxy:\r\n    resource.URL:\r\n    - http://185.217.92.119/db-module/version_1594/main.php?git=\r\n  selectionProxy_accenture_0:\r\n    resource.URL:\r\n    - http://109.248.148.42/officeDocument/2006/relationships/\r\n  selectionProxy_accenture_1:\r\n    resource.URL:\r\n    - http://109.248.148.42/office/thememl/2012/main/\r\n  selectionProxy_accenture_2:\r\n    resource.URL:\r\n    - /agr-enum/progress-inform/cube.php?res=\r\n  selectionMD5_accenture_0:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 7e67122d3a052e4755b02965e2e56a2e\r\n  selectionMD5_accenture_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a13c864980159cd9bdc94074b2389dda\r\n  selectionMD5_accenture_2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - f4cab3a393462a57639faa978a75d10a\r\n  selection_registry_accenture_0:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AudioMgr\r\n  selection_registry_accenture_1:\r\n    event_id: \"13\"\r\n    event_data.TargetObject:\r\n    - SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleIndexer\r\n  selectionMD5_intezer_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 604b3e7d9b11afbdf525336cefc97f88a85dd3a2f0801277d5c7619d6bceb605\r\n  selectionMD5_intezer_2:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 87bffb0370c9e14ed5d01d6cc0747cb30a544a71345ea68ef235320378f582ef\r\n  selectionMD5_intezer_3:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a6576282d17cca390e35306a423dcb5ac9276c28eaba63f74001757edc3688df\r\n  selectionMD5_intezer_4:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6\r\n  selectionMD5_intezer_5:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 05fd4393288a8217243baf9c1bed942b219620b18487bc81fc6ced1238304f93\r\n  selectionMD5_intezer_6:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - a15a4e21fe3b06870d52f7383ef45e4ac0dde727b02b3d340f0ba6346b43add1\r\n  selectionMD5_intezer_7:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 2b19497db8cb05cd3d22996efe5af8eac0f2ea51e80f606b7b8a79dfaa2f58e2\r\n  selectionMD5_intezer_8:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 6d70a54702f4456699d1f1d6c1835619c75f8f340ae95a21743b67123e88677e\r\n  selectionMD5_intezer_9:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 5223a45d8b08eb14e87a87edaa4b71593b4f9d2bdb6de1a5b6f3e77869eeca8a\r\n  selectionMD5_r0ny_1:\r\n    event_id: \"1\"\r\n    event_data.Hashes:\r\n    - 6fdf33cc14672908bd7f25d3620417ee\r\n  condition: selectionMD5_dttcodexgigas or selectionMD5_accenture_0 or selectionMD5_accenture_1 or selectionMD5_accenture_2 or selectionMD5_DrunkBinary or selectionSysmon3 or selectionSysmon3_accenture or selectionFirewall or selectionFirewall_accenture or selectionProxy or selectionProxy_accenture_0 or selectionProxy_accenture_1 or selectionProxy_accenture_2 or selectionMD5_hybrid_analysis or selection_registry_accenture_0 or selection_registry_accenture_1 or selectionMD5_intezer_1 or selectionMD5_intezer_2 or selectionMD5_intezer_3 or selectionMD5_intezer_4 or selectionMD5_intezer_5 or selectionMD5_intezer_6 or selectionMD5_intezer_7 or selectionMD5_intezer_8 or selectionMD5_intezer_9 or selectionMD5_r0ny_1\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1085\r\n- attack.t1064\r\n- attack.Defense Evasion\r\n- attack.t1064\r\n- attack.t1085\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.Discovery\r\n- attack.t1012\r\n- attack.Command And Control\r\n- attack.1043\r\n- attack.t1071"}, "Jp3knmUBtApo-eN_q-az": {"category": 3, "updated": "2018-10-25T09:42:15.000Z", "hash": "551ebcfe3c72cde5a860d79aa82a8a0c0e682eb5f54d2cf8ad5ec178ca07f8c9", "title": "Relevant ClamAV Message", "permission_id": 3, "title_keyword": "Relevant ClamAV Message", "released": "2017-03-01T09:00:17.000Z", "sigma_text": "title: Relevant ClamAV Message\r\ndescription: Detects relevant ClamAV messages\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml\r\nlogsource:\r\n  product: linux\r\n  service: clamav\r\ndetection:\r\n  keywords:\r\n  - Trojan*FOUND\r\n  - VirTool*FOUND\r\n  - Webshell*FOUND\r\n  - Rootkit*FOUND\r\n  - Htran*FOUND\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/linux/lnx_clamav.yml", "sigma_text_keyword": "title: Relevant ClamAV Message\r\ndescription: Detects relevant ClamAV messages\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml\r\nlogsource:\r\n  product: linux\r\n  service: clamav\r\ndetection:\r\n  keywords:\r\n  - Trojan*FOUND\r\n  - VirTool*FOUND\r\n  - Webshell*FOUND\r\n  - Rootkit*FOUND\r\n  - Htran*FOUND\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "H53knmUBtApo-eN_n-RE": {"category": 4, "updated": "2018-10-25T09:45:14.000Z", "hash": "911e7f23d75e68575b2e2dcac91478708373a9882df5de5448ec3869bb5ef7e7", "title": "Network Scans", "permission_id": 3, "title_keyword": "Network Scans", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Network Scans\r\ndescription: Detects many failed connection attempts to different ports or hosts\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  category: firewall\r\ndetection:\r\n  selection:\r\n    action: denied\r\n  timeframe: 24h\r\n  condition:\r\n  - selection | count(dst_port) by src_ip > 10\r\n  - selection | count(dst_ip) by src_ip > 10\r\nfields:\r\n- src_ip\r\n- dst_ip\r\n- dst_port\r\nfalsepositives:\r\n- Inventarization systems\r\n- Vulnerability scans\r\n- Penetration testing activity\r\nlevel: medium", "git_filepath": "/network/net_susp_network_scan.yml", "sigma_text_keyword": "title: Network Scans\r\ndescription: Detects many failed connection attempts to different ports or hosts\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  category: firewall\r\ndetection:\r\n  selection:\r\n    action: denied\r\n  timeframe: 24h\r\n  condition:\r\n  - selection | count(dst_port) by src_ip > 10\r\n  - selection | count(dst_ip) by src_ip > 10\r\nfields:\r\n- src_ip\r\n- dst_ip\r\n- dst_port\r\nfalsepositives:\r\n- Inventarization systems\r\n- Vulnerability scans\r\n- Penetration testing activity\r\nlevel: medium"}, "jW0SDmgBFVBAemBco2i5": {"category": 8, "updated": "2019-02-07T14:40:18.000Z", "hash": "ea2286381e74b3c27cd241afb502d6d78b5af75e4f792096677be224d86fe058", "title": "Possible System Owner/User Discovery (Sysmon/Windows Logs).", "permission_id": 3, "title_keyword": "Possible System Owner/User Discovery (Sysmon/Windows Logs).", "released": "2019-01-29T08:42:49.000Z", "sigma_text": "title: Possible System Owner/User Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1033/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - wmic\r\n    - useraccount get /ALL\r\n    - whoami\r\n  selection1:\r\n    event_data.Image:\r\n    - whoami.exe\r\n    - qwinsta.exe\r\n    - quser.exe\r\n  condition: selection0 or selection1\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1033", "git_filepath": "", "sigma_text_keyword": "title: Possible System Owner/User Discovery (Sysmon/Windows Logs).\r\ndescription: Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system.\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1033/\r\nauthor: Roman Ranskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection0:\r\n    event_data.CommandLine:\r\n    - wmic\r\n    - useraccount get /ALL\r\n    - whoami\r\n  selection1:\r\n    event_data.Image:\r\n    - whoami.exe\r\n    - qwinsta.exe\r\n    - quser.exe\r\n  condition: selection0 or selection1\r\nfalsepositives:\r\n- High\r\nlevel: medium\r\ntags:\r\n- attack.Discovery\r\n- attack.t1033"}, "q53knmUBtApo-eN_hN-p": {"category": 15, "updated": "2019-02-26T14:42:28.000Z", "hash": "5621532e422f4a8e8e6238f6cacd1505939d9109bcf16128db0ab5cb68e90491", "title": "Windows Shell Spawning Suspicious Program", "permission_id": 3, "title_keyword": "Windows Shell Spawning Suspicious Program", "released": "2018-04-09T06:37:30.000Z", "sigma_text": "title: Windows Shell Spawning Suspicious Program\r\nstatus: experimental\r\ndescription: Detects a suspicious child process of a Windows shell\r\nreferences:\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\nauthor: Florian Roth\r\ndate: 2018/04/06\r\nmodified: 2019/02/05\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\mshta.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\cmd.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\wmiprvse.exe'\r\n    Image:\r\n    - '*\\schtasks.exe'\r\n    - '*\\nslookup.exe'\r\n    - '*\\certutil.exe'\r\n    - '*\\bitsadmin.exe'\r\n    - '*\\mshta.exe'\r\n  falsepositives:\r\n    CurrentDirectory: '*\\ccmcache\\*'\r\n  condition: selection and not falsepositives\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative scripts\r\n- Microsoft SCCM\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_shell_spawn_susp_program.yml", "sigma_text_keyword": "title: Windows Shell Spawning Suspicious Program\r\nstatus: experimental\r\ndescription: Detects a suspicious child process of a Windows shell\r\nreferences:\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\nauthor: Florian Roth\r\ndate: 2018/04/06\r\nmodified: 2019/02/05\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\mshta.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\cmd.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\wmiprvse.exe'\r\n    Image:\r\n    - '*\\schtasks.exe'\r\n    - '*\\nslookup.exe'\r\n    - '*\\certutil.exe'\r\n    - '*\\bitsadmin.exe'\r\n    - '*\\mshta.exe'\r\n  falsepositives:\r\n    CurrentDirectory: '*\\ccmcache\\*'\r\n  condition: selection and not falsepositives\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative scripts\r\n- Microsoft SCCM\r\nlevel: high"}, "Op3knmUBtApo-eN_rOYh": {"category": 15, "updated": "2018-10-24T11:59:15.000Z", "hash": "aacf99bdb6f14fec0dc3e15d6cb774208e78df7f82efe3c00a7c68fd74fab508", "title": "Suspicious Reconnaissance Activity", "permission_id": 3, "title_keyword": "Suspicious Reconnaissance Activity", "released": "2017-03-16T17:59:17.000Z", "sigma_text": "title: Suspicious Reconnaissance Activity\r\nstatus: experimental\r\ndescription: Detects suspicious command line activity on Windows systems\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - net group \"domain admins\" /domain\r\n    - net localgroup administrators\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Inventory tool runs\r\n- Penetration tests\r\n- Administrative activity\r\nanalysis:\r\n  recommendation: Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_recon_activity.yml", "sigma_text_keyword": "title: Suspicious Reconnaissance Activity\r\nstatus: experimental\r\ndescription: Detects suspicious command line activity on Windows systems\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - net group \"domain admins\" /domain\r\n    - net localgroup administrators\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Inventory tool runs\r\n- Penetration tests\r\n- Administrative activity\r\nanalysis:\r\n  recommendation: Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\r\nlevel: medium"}, "u53knmUBtApo-eN_o-Qm": {"category": 8, "updated": "2019-02-26T13:21:36.000Z", "hash": "d517cf1ca2effc778790bdc7dfecb857a0589b7ff90313e2e7fab4694ba56021", "title": "DiskShadow and Vshadow launch detection", "permission_id": 3, "title_keyword": "DiskShadow and Vshadow launch detection", "released": "2018-04-26T07:37:02.000Z", "sigma_text": "title: DiskShadow and Vshadow launch detection\r\nstatus: stable\r\ndescription: This rule detects execution vshadow.exe and diskshadow.exe\r\nreferences:\r\n- https://bohops.com/2018/02/10/vshadow-abusing-the-volume-shadow-service-for-evasion-persistence-and-active-directory-database-extraction/\r\n- https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/04/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\vshadow.exe'\r\n    Image:\r\n    - '*\\notepad.exe'\r\n  selection2:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\diskshadow.exe'\r\n    Image:\r\n    - '*\\notepad.exe'\r\n  selection3:\r\n    EventID: 1\r\n    CommandLine:\r\n    - 'vshadow.exe -nw -exec=c:\\windows\\system32\\notepad.exe c:'\r\n    - diskshadow.exe /s c:\\*\r\n  condition:\r\n  - selection1 or selection2 or selection3\r\nfields:\r\n- ParentImage\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Administrative activity\r\n- User activity\r\nlevel: high\r\ntags:\r\n- attack.Credential Access\r\n- attack.t1003\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.t1053", "git_filepath": null, "sigma_text_keyword": "title: DiskShadow and Vshadow launch detection\r\nstatus: stable\r\ndescription: This rule detects execution vshadow.exe and diskshadow.exe\r\nreferences:\r\n- https://bohops.com/2018/02/10/vshadow-abusing-the-volume-shadow-service-for-evasion-persistence-and-active-directory-database-extraction/\r\n- https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/04/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\vshadow.exe'\r\n    Image:\r\n    - '*\\notepad.exe'\r\n  selection2:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\diskshadow.exe'\r\n    Image:\r\n    - '*\\notepad.exe'\r\n  selection3:\r\n    EventID: 1\r\n    CommandLine:\r\n    - 'vshadow.exe -nw -exec=c:\\windows\\system32\\notepad.exe c:'\r\n    - diskshadow.exe /s c:\\*\r\n  condition:\r\n  - selection1 or selection2 or selection3\r\nfields:\r\n- ParentImage\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Administrative activity\r\n- User activity\r\nlevel: high\r\ntags:\r\n- attack.Credential Access\r\n- attack.t1003\r\n- attack.Persistence\r\n- attack.t1060\r\n- attack.t1053"}, "bJ3knmUBtApo-eN_p-Ui": {"category": 11, "updated": "2019-02-26T15:15:16.000Z", "hash": "f9e495f72378a252cd98c8cf73cef005d0536beb31db0f2a46e09e96561d1816", "title": "SAM Dump to AppData", "permission_id": 3, "title_keyword": "SAM Dump to AppData", "released": "2017-03-27T13:20:50.000Z", "sigma_text": "title: SAM Dump to AppData\r\nstatus: experimental\r\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: system\r\n  description: The source of this type of event is Kernel-General\r\ndetection:\r\n  selection:\r\n    EventID: 16\r\n  keywords:\r\n  - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\r\n  condition: selection or keywords\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_sam_dump.yml", "sigma_text_keyword": "title: SAM Dump to AppData\r\nstatus: experimental\r\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: system\r\n  description: The source of this type of event is Kernel-General\r\ndetection:\r\n  selection:\r\n    EventID: 16\r\n  keywords:\r\n  - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\r\n  condition: selection or keywords\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: high"}, "DZ3knmUBtApo-eN_peVC": {"category": 11, "updated": "2018-10-23T12:03:26.000Z", "hash": "77e17d45b5094aaa42ee8c9e4d892ec6233b913f9840d9fbbaf82e5d499e47d9", "title": "LSASS Access Detected via Attack Surface Reduction", "permission_id": 3, "title_keyword": "LSASS Access Detected via Attack Surface Reduction", "released": "2018-08-27T08:38:45.000Z", "sigma_text": "title: LSASS Access Detected via Attack Surface Reduction\r\ndescription: Detects Access to LSASS Process\r\nstatus: experimental\r\nreferences:\r\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter\r\nauthor: Markus Neis\r\ndate: 2018/08/26\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nlogsource:\r\n  product: windows_defender\r\n  description: 'Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'\r\ndetection:\r\n  selection:\r\n    EventID: \"1121\"\r\n    Path: '*\\lsass.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Google Chrome GoogleUpdate.exe\r\n- Some Taskmgr.exe related activity\r\nlevel: high", "git_filepath": "/windows/builtin/win_alert_LSASS_access.yml", "sigma_text_keyword": "title: LSASS Access Detected via Attack Surface Reduction\r\ndescription: Detects Access to LSASS Process\r\nstatus: experimental\r\nreferences:\r\n- https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter\r\nauthor: Markus Neis\r\ndate: 2018/08/26\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nlogsource:\r\n  product: windows_defender\r\n  description: 'Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'\r\ndetection:\r\n  selection:\r\n    EventID: \"1121\"\r\n    Path: '*\\lsass.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Google Chrome GoogleUpdate.exe\r\n- Some Taskmgr.exe related activity\r\nlevel: high"}, "Kp3knmUBtApo-eN_peXM": {"category": 11, "updated": "2018-10-26T16:23:23.000Z", "hash": "59b4f963860fa7e9cb26da5125e9c590f9e1366cb31219d5216fdbe74ffbffd3", "title": "Hacktool Use", "permission_id": 3, "title_keyword": "Hacktool Use", "released": "2017-05-31T06:42:35.000Z", "sigma_text": "title: Hacktool Use\r\ndescription: This method detects well-known keywords, certain field combination that appear in Windows Eventlog when certain hack tools are used\r\nauthor: Florian Roth\r\ntags:\r\n- attack.discovery\r\n- attack.execution\r\n- attack.t1087\r\n- attack.t1075\r\n- attack.t1114\r\n- attack.t1059\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection1:\r\n    EventID:\r\n    - \"4776\"\r\n    - \"4624\"\r\n    - \"4625\"\r\n    WorkstationName: RULER\r\n  condition: selection1\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical", "git_filepath": "/windows/builtin/win_alert_hacktool_use.yml", "sigma_text_keyword": "title: Hacktool Use\r\ndescription: This method detects well-known keywords, certain field combination that appear in Windows Eventlog when certain hack tools are used\r\nauthor: Florian Roth\r\ntags:\r\n- attack.discovery\r\n- attack.execution\r\n- attack.t1087\r\n- attack.t1075\r\n- attack.t1114\r\n- attack.t1059\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection1:\r\n    EventID:\r\n    - \"4776\"\r\n    - \"4624\"\r\n    - \"4625\"\r\n    WorkstationName: RULER\r\n  condition: selection1\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical"}, "jp3knmUBtApo-eN_kOEA": {"category": 8, "updated": "2018-10-30T13:04:07.000Z", "hash": "610c7d5cc6f4e27ed77293b9c2391361b5a198fde646a255d503a78a5f231fd9", "title": "Schtask from User Profile (Sysmon).", "permission_id": 3, "title_keyword": "Schtask from User Profile (Sysmon).", "released": "2018-09-07T12:33:46.000Z", "sigma_text": "title: Schtask from User Profile (Sysmon).\r\ndescription: Detects usage of Powershell Download commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - schtask.exe\r\n    - schtasks.exe\r\n    CommandLine:\r\n    - '*\\appdata\\*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Should be limited in legitimate use.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Schtask from User Profile (Sysmon).\r\ndescription: Detects usage of Powershell Download commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - schtask.exe\r\n    - schtasks.exe\r\n    CommandLine:\r\n    - '*\\appdata\\*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Should be limited in legitimate use.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "_CWYX2cBqjf_D59Hy76d": {"category": 8, "updated": "2019-01-02T14:45:04.000Z", "hash": "4bd48facb601bec1b297196568886fbb608a558177b6bd282080fe37c038bc56", "title": "ZombieBoy CryptoMining Worm (Sysmon).", "permission_id": 3, "title_keyword": "ZombieBoy CryptoMining Worm (Sysmon).", "released": "2018-11-29T13:13:18.000Z", "sigma_text": "title: ZombieBoy CryptoMining Worm (Sysmon).\r\ndescription: ZombieBoy CryptoMining Worm Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://brica.de/alerts/alert/public/1221997/zombieboy-cryptomining-worm-addiotnal-iocs/\r\n- https://community.blueliv.com/#!/s/5b503c1282df417b6f04f9be\r\ndate: 2018/07/18\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 049fc01447f15e02fff88a2b10f1518c8489e97b2c26006b4962ff5005e460dc\r\n    - 22f105dc2e2574ba3ea2ac4152391ce3bbaaa415a9660c251638281bbc5e8f33\r\n    - 2628242abba9b99baf26dadc071739fed2559bb7251d69ab81edc404d4bae602\r\n    - 27c5e2f35a5fb9272c3ed7c746927ce8c61b3ce02fed7551129dc2a32bf20773\r\n    - 27d4684511314ef9631e162e1bdc5170185689abf16f7f28ba5ae397ba601197\r\n    - 38d7d4f6a712bff4ab212848802f5f9c\r\n    - 5d33434111ee36d754155c1d236e65aa78eaa605587715a5931b1c1ed3a54745\r\n    - 5ea00496a4073982855f81e463a887d6a8ef263c87bb203161e2db3f50cfc8c0\r\n    - 65cd6ab10712cfeb82872d6d3648a99636c9e0fff5728a0fc34497142c952173\r\n    - 673bb55f781aaef382f4f9c9a748690d8b1045864151adaf67a4c0ab669e4700\r\n    - 6de21f2fd11d68b305b5e10d97b3f27e\r\n    - 7327ef046fe62a26e5571c36b5c2c417\r\n    - 785a7f6e1cd40b50ad788e5d7d3c8465\r\n    - 79c6ead6fa4f4addd7f2f019716dd6ca\r\n    - 7bb89b498beab4402d5cc8602c484a309ece50aa94c14f0a43f091f43b09f88f\r\n    - 7bc7d0fafd40438989c0445db8b3886868847da88979e35feebea9ff1b0655cb\r\n    - 842133ddc2d57fd0f78491b7ba39a34d\r\n    - 865cea806bc95acd56d215b2c3c3b892d9715495bdcf272b2bf2106326c13a30\r\n    - 876c2c8a45414c143e2fc5622d6cfe84050a45ae052ca9263beab280778ae380\r\n    - 8b532b41c25958f04495ca43d1f2a57f6d11fd3d6401f8d971e1299683828e52\r\n    - 91ebe2de7fcb922c794a891ff8987124\r\n    - 9a46a3ae2c3762964c5cbb63b62d7dee\r\n    - a178196089fadecf8314e36fab17884f6894bdddd6e238652f99909a93db93a2\r\n    - a3ae8a77a1f238e7b5ebd3dd3953912d9e5ae8fdf5cee6a536e7eba658ee2e1e\r\n    - bb0a0a06f3bff97a1e7de8909d26c0ecb5161ea3882f587163d422042d9196a5\r\n    - cc4a5ed98d8f4074ee700f5762ee0745f365605b90c62746990566413a7bf63e\r\n    - dfc0ea5813e78492bc78d134d1d8372ca9d04ad563835d890614cd11b2555dd3\r\n    - f1e23e2428f0f162c05bd259be133a1957438901a10041c128c3f63b72dd91d6\r\n    - fd2c2cf66b166807470cbe2eafb3e0fab5947937f243fca87651d04bb6c9fd2d\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: ZombieBoy CryptoMining Worm (Sysmon).\r\ndescription: ZombieBoy CryptoMining Worm Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://brica.de/alerts/alert/public/1221997/zombieboy-cryptomining-worm-addiotnal-iocs/\r\n- https://community.blueliv.com/#!/s/5b503c1282df417b6f04f9be\r\ndate: 2018/07/18\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 049fc01447f15e02fff88a2b10f1518c8489e97b2c26006b4962ff5005e460dc\r\n    - 22f105dc2e2574ba3ea2ac4152391ce3bbaaa415a9660c251638281bbc5e8f33\r\n    - 2628242abba9b99baf26dadc071739fed2559bb7251d69ab81edc404d4bae602\r\n    - 27c5e2f35a5fb9272c3ed7c746927ce8c61b3ce02fed7551129dc2a32bf20773\r\n    - 27d4684511314ef9631e162e1bdc5170185689abf16f7f28ba5ae397ba601197\r\n    - 38d7d4f6a712bff4ab212848802f5f9c\r\n    - 5d33434111ee36d754155c1d236e65aa78eaa605587715a5931b1c1ed3a54745\r\n    - 5ea00496a4073982855f81e463a887d6a8ef263c87bb203161e2db3f50cfc8c0\r\n    - 65cd6ab10712cfeb82872d6d3648a99636c9e0fff5728a0fc34497142c952173\r\n    - 673bb55f781aaef382f4f9c9a748690d8b1045864151adaf67a4c0ab669e4700\r\n    - 6de21f2fd11d68b305b5e10d97b3f27e\r\n    - 7327ef046fe62a26e5571c36b5c2c417\r\n    - 785a7f6e1cd40b50ad788e5d7d3c8465\r\n    - 79c6ead6fa4f4addd7f2f019716dd6ca\r\n    - 7bb89b498beab4402d5cc8602c484a309ece50aa94c14f0a43f091f43b09f88f\r\n    - 7bc7d0fafd40438989c0445db8b3886868847da88979e35feebea9ff1b0655cb\r\n    - 842133ddc2d57fd0f78491b7ba39a34d\r\n    - 865cea806bc95acd56d215b2c3c3b892d9715495bdcf272b2bf2106326c13a30\r\n    - 876c2c8a45414c143e2fc5622d6cfe84050a45ae052ca9263beab280778ae380\r\n    - 8b532b41c25958f04495ca43d1f2a57f6d11fd3d6401f8d971e1299683828e52\r\n    - 91ebe2de7fcb922c794a891ff8987124\r\n    - 9a46a3ae2c3762964c5cbb63b62d7dee\r\n    - a178196089fadecf8314e36fab17884f6894bdddd6e238652f99909a93db93a2\r\n    - a3ae8a77a1f238e7b5ebd3dd3953912d9e5ae8fdf5cee6a536e7eba658ee2e1e\r\n    - bb0a0a06f3bff97a1e7de8909d26c0ecb5161ea3882f587163d422042d9196a5\r\n    - cc4a5ed98d8f4074ee700f5762ee0745f365605b90c62746990566413a7bf63e\r\n    - dfc0ea5813e78492bc78d134d1d8372ca9d04ad563835d890614cd11b2555dd3\r\n    - f1e23e2428f0f162c05bd259be133a1957438901a10041c128c3f63b72dd91d6\r\n    - fd2c2cf66b166807470cbe2eafb3e0fab5947937f243fca87651d04bb6c9fd2d\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "NW6cM2kBFVBAemBc1F1t": {"category": 2, "updated": "2019-02-28T10:19:32.000Z", "hash": "7d95e6c3934e622b11365202ffdf346e6e24d1fc2650282238ab01c7c03f9500", "title": "Chafer Activity.", "permission_id": 3, "title_keyword": "Chafer Activity.", "released": "2019-02-28T10:18:29.000Z", "sigma_text": "title: Chafer Activity.\r\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018.\r\nreferences:\r\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\r\ndate: 2018/03/23\r\nauthor: Florian Roth, Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection_service:\r\n    EventID: 7045\r\n    ServiceName:\r\n    - SC Scheduled Scan\r\n    - UpdatMachine\r\n  condition: selection_service\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_reg1:\r\n    EventID: 13\r\n    TargetObject:\r\n    - '*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UMe'\r\n    - '*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UT'\r\n    EventType: SetValue\r\n  selection_reg2:\r\n    EventID: 13\r\n    TargetObject: '*\\Control\\SecurityProviders\\WDigest\\UseLogonCredential'\r\n    EventType: SetValue\r\n    Details: DWORD (0x00000001)\r\n  selection_process1:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*\\Service.exe i'\r\n    - '*\\Service.exe u'\r\n    - '*\\microsoft\\Taskbar\\autoit3.exe'\r\n    - C:\\wsc.exe*\r\n  selection_process2:\r\n    EventID: 1\r\n    Image: '*\\Windows\\Temp\\DB\\\\*.exe'\r\n  selection_process3:\r\n    EventID: 1\r\n    CommandLine: '*\\nslookup.exe -q=TXT*'\r\n    ParentImage: '*\\Autoit*'\r\n  condition: selection_reg1 OR selection_reg2 OR selection_process1 OR selection_process2 OR selection_process3\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.g0049", "git_filepath": "/apt/apt_chafer_mar18.yml", "sigma_text_keyword": "title: Chafer Activity.\r\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018.\r\nreferences:\r\n- https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\r\ndate: 2018/03/23\r\nauthor: Florian Roth, Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection_service:\r\n    EventID: 7045\r\n    ServiceName:\r\n    - SC Scheduled Scan\r\n    - UpdatMachine\r\n  condition: selection_service\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_reg1:\r\n    EventID: 13\r\n    TargetObject:\r\n    - '*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UMe'\r\n    - '*SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\UT'\r\n    EventType: SetValue\r\n  selection_reg2:\r\n    EventID: 13\r\n    TargetObject: '*\\Control\\SecurityProviders\\WDigest\\UseLogonCredential'\r\n    EventType: SetValue\r\n    Details: DWORD (0x00000001)\r\n  selection_process1:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*\\Service.exe i'\r\n    - '*\\Service.exe u'\r\n    - '*\\microsoft\\Taskbar\\autoit3.exe'\r\n    - C:\\wsc.exe*\r\n  selection_process2:\r\n    EventID: 1\r\n    Image: '*\\Windows\\Temp\\DB\\\\*.exe'\r\n  selection_process3:\r\n    EventID: 1\r\n    CommandLine: '*\\nslookup.exe -q=TXT*'\r\n    ParentImage: '*\\Autoit*'\r\n  condition: selection_reg1 OR selection_reg2 OR selection_process1 OR selection_process2 OR selection_process3\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical\r\ntags:\r\n- attack.g0049"}, "Wp3knmUBtApo-eN_reY1": {"category": 9, "updated": "2018-10-23T15:37:19.000Z", "hash": "6be32f368b14a012207dcf0bbf301fb2b8ca51f093a1f9951ff00739c778891b", "title": "Program Executions in Suspicious Folders", "permission_id": 3, "title_keyword": "Program Executions in Suspicious Folders", "released": "2018-01-23T10:13:23.000Z", "sigma_text": "title: Program Executions in Suspicious Folders\r\nstatus: experimental\r\ndescription: Detects program executions in suspicious non-program folders related to malware or hacking activity\r\nreferences:\r\n- Internal Research\r\ndate: 2018/01/23\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\n  service: auditd\r\ndetection:\r\n  selection:\r\n    type: SYSCALL\r\n    exe:\r\n    - /tmp/*\r\n    - /var/www/*\r\n    - /usr/local/apache2/*\r\n    - /usr/local/httpd/*\r\n    - /var/apache/*\r\n    - /srv/www/*\r\n    - /home/httpd/html/*\r\n    - /var/lib/pgsql/data/*\r\n    - /usr/local/mysql/data/*\r\n    - /var/lib/mysql/*\r\n    - /var/vsftpd/*\r\n    - /etc/bind/*\r\n    - /var/named/*\r\n    - '*/public_html/*'\r\n  condition: selection\r\nfalsepositives:\r\n- Admin activity (especially in /tmp folders)\r\n- Crazy web applications\r\nlevel: medium", "git_filepath": "/linux/auditd/lnx_auditd_susp_exe_folders.yml", "sigma_text_keyword": "title: Program Executions in Suspicious Folders\r\nstatus: experimental\r\ndescription: Detects program executions in suspicious non-program folders related to malware or hacking activity\r\nreferences:\r\n- Internal Research\r\ndate: 2018/01/23\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\n  service: auditd\r\ndetection:\r\n  selection:\r\n    type: SYSCALL\r\n    exe:\r\n    - /tmp/*\r\n    - /var/www/*\r\n    - /usr/local/apache2/*\r\n    - /usr/local/httpd/*\r\n    - /var/apache/*\r\n    - /srv/www/*\r\n    - /home/httpd/html/*\r\n    - /var/lib/pgsql/data/*\r\n    - /usr/local/mysql/data/*\r\n    - /var/lib/mysql/*\r\n    - /var/vsftpd/*\r\n    - /etc/bind/*\r\n    - /var/named/*\r\n    - '*/public_html/*'\r\n  condition: selection\r\nfalsepositives:\r\n- Admin activity (especially in /tmp folders)\r\n- Crazy web applications\r\nlevel: medium"}, "1p3knmUBtApo-eN_r-bV": {"category": 14, "updated": "2019-02-26T13:39:32.000Z", "hash": "fb533b9abdb4c71ccbef123e69c9c2b56536e576baab4eaca0a37f44e99c842f", "title": "PowerShell Credential Prompt", "permission_id": 3, "title_keyword": "PowerShell Credential Prompt", "released": "2017-04-09T08:22:04.000Z", "sigma_text": "title: PowerShell Credential Prompt\r\nstatus: experimental\r\ndescription: Detects PowerShell calling a credential prompt\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/850381440629981184\r\n- https://t.co/ezOTGy1a1G\r\ntags:\r\n- attack.execution\r\n- attack.credential_access\r\n- attack.t1086\r\nauthor: John Lambert, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: Script block logging must be enabled\r\ndetection:\r\n  selection:\r\n    EventID: 4104\r\n  keyword:\r\n  - PromptForCredential\r\n  condition: selection and keyword\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_prompt_credentials.yml", "sigma_text_keyword": "title: PowerShell Credential Prompt\r\nstatus: experimental\r\ndescription: Detects PowerShell calling a credential prompt\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/850381440629981184\r\n- https://t.co/ezOTGy1a1G\r\ntags:\r\n- attack.execution\r\n- attack.credential_access\r\n- attack.t1086\r\nauthor: John Lambert, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: Script block logging must be enabled\r\ndetection:\r\n  selection:\r\n    EventID: 4104\r\n  keyword:\r\n  - PromptForCredential\r\n  condition: selection and keyword\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "PZ3knmUBtApo-eN_iOAs": {"category": 14, "updated": "2019-02-26T13:39:09.000Z", "hash": "8411c0aaa9f9273780394e820223cddea92cdd45c2e3e8cf35906232ca128aa4", "title": "Suspicious PowerShell Invocations - Generic", "permission_id": 3, "title_keyword": "Suspicious PowerShell Invocations - Generic", "released": "2017-03-12T16:06:53.000Z", "sigma_text": "title: Suspicious PowerShell Invocations - Generic\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation command parameters\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  encoded:\r\n  - ' -enc '\r\n  - ' -EncodedCommand '\r\n  hidden:\r\n  - ' -w hidden '\r\n  - ' -window hidden '\r\n  - ' - windowstyle hidden '\r\n  noninteractive:\r\n  - ' -noni '\r\n  - ' -noninteractive '\r\n  condition: all of them\r\nfalsepositives:\r\n- Penetration tests\r\n- Very special / sneaky PowerShell scripts\r\nlevel: high", "git_filepath": "/windows/powershell/powershell_suspicious_invocation_generic.yml", "sigma_text_keyword": "title: Suspicious PowerShell Invocations - Generic\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation command parameters\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  encoded:\r\n  - ' -enc '\r\n  - ' -EncodedCommand '\r\n  hidden:\r\n  - ' -w hidden '\r\n  - ' -window hidden '\r\n  - ' - windowstyle hidden '\r\n  noninteractive:\r\n  - ' -noni '\r\n  - ' -noninteractive '\r\n  condition: all of them\r\nfalsepositives:\r\n- Penetration tests\r\n- Very special / sneaky PowerShell scripts\r\nlevel: high"}, "Um6pKWkBFVBAemBclVKh": {"category": 14, "updated": "2019-02-26T13:30:13.000Z", "hash": "31effd6e24ecf19bb88181991ef2c5698a464ae235080a6b96634907efc5e55d", "title": "PowerShell ShellCode", "permission_id": 3, "title_keyword": "PowerShell ShellCode", "released": "2019-02-26T11:56:13.000Z", "sigma_text": "title: PowerShell ShellCode\r\ndescription: Detects Base64 encoded Shellcode.\r\nreferences:\r\n- https://twitter.com/cyb3rops/status/1063072865992523776\r\nauthor: David Ledbetter, Florian Roth\r\nstatus: experimental\r\ndate: 2018/11/17\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: Script block logging must be enabled\r\ndetection:\r\n  selection:\r\n    EventID: 4104\r\n  keyword1:\r\n  - '*AAAAYInlM*'\r\n  keyword2:\r\n  - '*OiCAAAAYInlM*'\r\n  - '*OiJAAAAYInlM*'\r\n  condition: selection and keyword1 and keyword2\r\nlevel: critical\r\nfalsepositives:\r\n- Unknown\r\ntags:\r\n- attack.execution", "git_filepath": "/windows/powershell/powershell_shellcode_b64.yml", "sigma_text_keyword": "title: PowerShell ShellCode\r\ndescription: Detects Base64 encoded Shellcode.\r\nreferences:\r\n- https://twitter.com/cyb3rops/status/1063072865992523776\r\nauthor: David Ledbetter, Florian Roth\r\nstatus: experimental\r\ndate: 2018/11/17\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: Script block logging must be enabled\r\ndetection:\r\n  selection:\r\n    EventID: 4104\r\n  keyword1:\r\n  - '*AAAAYInlM*'\r\n  keyword2:\r\n  - '*OiCAAAAYInlM*'\r\n  - '*OiJAAAAYInlM*'\r\n  condition: selection and keyword1 and keyword2\r\nlevel: critical\r\nfalsepositives:\r\n- Unknown\r\ntags:\r\n- attack.execution"}, "rZ3knmUBtApo-eN_kOHs": {"category": 3, "updated": "2018-10-25T09:44:29.000Z", "hash": "831b0e436919901c80c9aae431c5057a2605213dd364f4758ab847c7417d0573", "title": "Suspicious VSFTPD Error Messages", "permission_id": 3, "title_keyword": "Suspicious VSFTPD Error Messages", "released": "2017-07-06T00:59:51.000Z", "sigma_text": "title: Suspicious VSFTPD Error Messages\r\ndescription: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/dagwieers/vsftpd/\r\nauthor: Florian Roth\r\ndate: 2017/07/05\r\nlogsource:\r\n  product: linux\r\n  service: vsftpd\r\ndetection:\r\n  keywords:\r\n  - 'Connection refused: too many sessions for this address.'\r\n  - 'Connection refused: tcp_wrappers denial.'\r\n  - Bad HTTP verb.\r\n  - port and pasv both active\r\n  - pasv and port both active\r\n  - Transfer done (but failed to open directory).\r\n  - Could not set file modification time.\r\n  - 'bug: pid active in ptrace_sandbox_free'\r\n  - PTRACE_SETOPTIONS failure\r\n  - 'weird status:'\r\n  - couldn't handle sandbox event\r\n  - syscall * out of bounds\r\n  - 'syscall not permitted:'\r\n  - 'syscall validate failed:'\r\n  - Input line too long.\r\n  - poor buffer accounting in str_netfd_alloc\r\n  - vsf_sysutil_read_loop\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium", "git_filepath": "/linux/lnx_susp_vsftp.yml", "sigma_text_keyword": "title: Suspicious VSFTPD Error Messages\r\ndescription: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/dagwieers/vsftpd/\r\nauthor: Florian Roth\r\ndate: 2017/07/05\r\nlogsource:\r\n  product: linux\r\n  service: vsftpd\r\ndetection:\r\n  keywords:\r\n  - 'Connection refused: too many sessions for this address.'\r\n  - 'Connection refused: tcp_wrappers denial.'\r\n  - Bad HTTP verb.\r\n  - port and pasv both active\r\n  - pasv and port both active\r\n  - Transfer done (but failed to open directory).\r\n  - Could not set file modification time.\r\n  - 'bug: pid active in ptrace_sandbox_free'\r\n  - PTRACE_SETOPTIONS failure\r\n  - 'weird status:'\r\n  - couldn't handle sandbox event\r\n  - syscall * out of bounds\r\n  - 'syscall not permitted:'\r\n  - 'syscall validate failed:'\r\n  - Input line too long.\r\n  - poor buffer accounting in str_netfd_alloc\r\n  - vsf_sysutil_read_loop\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium"}, "oZ3knmUBtApo-eN_luJC": {"category": 15, "updated": "2018-10-24T09:40:55.000Z", "hash": "86b3b26fa9a3f1f581e201077374560c39414201320295c3fd47177c72a24118", "title": "Droppers exploiting CVE-2017-11882", "permission_id": 3, "title_keyword": "Droppers exploiting CVE-2017-11882", "released": "2017-11-22T23:58:31.000Z", "sigma_text": "title: Droppers exploiting CVE-2017-11882\r\nstatus: experimental\r\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\r\n- https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\r\nauthor: Florian Roth\r\ndate: 2017/11/23\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\EQNEDT32.EXE'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_11882.yml", "sigma_text_keyword": "title: Droppers exploiting CVE-2017-11882\r\nstatus: experimental\r\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\r\n- https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\r\nauthor: Florian Roth\r\ndate: 2017/11/23\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\EQNEDT32.EXE'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: critical"}, "6p3knmUBtApo-eN_pORu": {"category": 8, "updated": "2019-01-02T14:57:29.000Z", "hash": "88ade1488effc2f39781837336377205d7ceb10a8df48da96e425344375f9531", "title": "Quasar RAT detector (Sysmon).", "permission_id": 3, "title_keyword": "Quasar RAT detector (Sysmon).", "released": "2018-07-19T10:23:51.000Z", "sigma_text": "title: Quasar RAT detector (Sysmon).\r\ndescription: Quasar is an open-source RAT that is readily available on GitHub and has been used by the hackers as far back in October 2015..\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 0A4915B81D9A9ACF4E19181DEEEBBE244430C16B\r\n    - 323160C88A254127D9ADB2848AE044AFFF376A4D\r\n    - 395166835495B418773C9690227779D592F94F71\r\n    - 3EE410DD50FC64F39DFF0C4EE8CC676F0F7D5A74\r\n    - 5B665152F6596D4412267F9C490878455BA235F9\r\n    - 5FE8558EB8A3C244BE2DA8BE750221B9A9EE8539\r\n    - 61CB5E535F0AC90A1F904EC9937298F50E2B4974\r\n    - 6A1CD05F07B1024287CEA400237E1EA9D2FE1678\r\n    - 7676AFF05A3550E5BBFF78CF4D10C9E094447D72\r\n    - 86165F464EC1912A43445D80559D65C165E2CF76\r\n    - AB3CD05BE6B0BA8567B84D10EDE28ABF87E115AC\r\n    - BFD7158E1C2F6BA525E24F85ED8CCF8EF40FD370\r\n    - CFEBEFC92DCDF1687FD0BC1B50457EBDEA8672A2\r\n    - D21B8514990B0CEAC5EAE687DEAA60B447139B9D\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Quasar RAT detector (Sysmon).\r\ndescription: Quasar is an open-source RAT that is readily available on GitHub and has been used by the hackers as far back in October 2015..\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 0A4915B81D9A9ACF4E19181DEEEBBE244430C16B\r\n    - 323160C88A254127D9ADB2848AE044AFFF376A4D\r\n    - 395166835495B418773C9690227779D592F94F71\r\n    - 3EE410DD50FC64F39DFF0C4EE8CC676F0F7D5A74\r\n    - 5B665152F6596D4412267F9C490878455BA235F9\r\n    - 5FE8558EB8A3C244BE2DA8BE750221B9A9EE8539\r\n    - 61CB5E535F0AC90A1F904EC9937298F50E2B4974\r\n    - 6A1CD05F07B1024287CEA400237E1EA9D2FE1678\r\n    - 7676AFF05A3550E5BBFF78CF4D10C9E094447D72\r\n    - 86165F464EC1912A43445D80559D65C165E2CF76\r\n    - AB3CD05BE6B0BA8567B84D10EDE28ABF87E115AC\r\n    - BFD7158E1C2F6BA525E24F85ED8CCF8EF40FD370\r\n    - CFEBEFC92DCDF1687FD0BC1B50457EBDEA8672A2\r\n    - D21B8514990B0CEAC5EAE687DEAA60B447139B9D\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "IW1GE2gBFVBAemBcHG6g": {"category": 8, "updated": "2019-01-03T10:49:01.000Z", "hash": "cebb5d64b54c281aa87e86d73d602b50e2f34911ea32ffc8eb5ab52a13211979", "title": "Roma225 Campaign (Sysmon).", "permission_id": 3, "title_keyword": "Roma225 Campaign (Sysmon).", "released": "2019-01-03T10:49:01.000Z", "sigma_text": "title: Roma225 Campaign (Sysmon).\r\ndescription: Roma225 Campaign Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://securityaffairs.co/wordpress/79324/malware/roma225-campaign-italian-automotive.html?utm_source=dlvr.it&utm_medium=twitter\r\n- https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/\r\ndate: 2018/12/27\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 4211e091dfb33523d675d273bdc109ddecf4ee1c1f5f29e8c82b9d0344dbb6a1\r\n    - e8a765ec824881e1e78defd7c011da735f3e3b954aaf93a4282b6455a1b9afcc\r\n    - 702e5cc9462e464c8c29c832fe0d1ecd5cd7740cc2cbceecfd70e566da8194a1\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: Roma225 Campaign (Sysmon).\r\ndescription: Roma225 Campaign Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://securityaffairs.co/wordpress/79324/malware/roma225-campaign-italian-automotive.html?utm_source=dlvr.it&utm_medium=twitter\r\n- https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/\r\ndate: 2018/12/27\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 4211e091dfb33523d675d273bdc109ddecf4ee1c1f5f29e8c82b9d0344dbb6a1\r\n    - e8a765ec824881e1e78defd7c011da735f3e3b954aaf93a4282b6455a1b9afcc\r\n    - 702e5cc9462e464c8c29c832fe0d1ecd5cd7740cc2cbceecfd70e566da8194a1\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "t53knmUBtApo-eN_keEv": {"category": 5, "updated": "2019-02-26T14:08:23.000Z", "hash": "64d832f814c269b0ec27000edcad88f6f5175d35fb2eaa89c0ece29d106fd08a", "title": "APT User Agent", "permission_id": 3, "title_keyword": "APT User Agent", "released": "2017-07-08T15:59:05.000Z", "sigma_text": "title: APT User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used in APT malware in proxy logs\r\nreferences:\r\n- Internal Research\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - SJZJ (compatible; MSIE 6.0; Win32)\r\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0\r\n    - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC'\r\n    - Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\r\n    - webclient\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\r\n    - Mozilla/4.0 (compatible; MSI 6.0;\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\r\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\r\n    - Mozilla/4.0\r\n    - Netscape\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1\r\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\r\n    - Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Win32)\r\n    - Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1\r\n    - Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko\r\n    - Mozilla v5.1 *\r\n    - MSIE 8.0\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Old browsers\r\nlevel: high", "git_filepath": "/proxy/proxy_ua_apt.yml", "sigma_text_keyword": "title: APT User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used in APT malware in proxy logs\r\nreferences:\r\n- Internal Research\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - SJZJ (compatible; MSIE 6.0; Win32)\r\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0\r\n    - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC'\r\n    - Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\r\n    - webclient\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200\r\n    - Mozilla/4.0 (compatible; MSI 6.0;\r\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0\r\n    - Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\r\n    - Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\r\n    - Mozilla/4.0\r\n    - Netscape\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1\r\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\r\n    - Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Win32)\r\n    - Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1\r\n    - Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; InfoPath.1)\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko\r\n    - Mozilla v5.1 *\r\n    - MSIE 8.0\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Old browsers\r\nlevel: high"}, "am5FLmkBFVBAemBcIFbP": {"category": 8, "updated": "2019-02-27T13:35:50.000Z", "hash": "9989931ad7354af858eda293883fb1b4b4da30c6e2eeafc0d63b5e3489e71fb2", "title": "Empire User Agents (Proxy).", "permission_id": 3, "title_keyword": "Empire User Agents (Proxy).", "released": "2019-02-27T09:31:08.000Z", "sigma_text": "title: Empire User Agents (Proxy).\r\ndescription: Empire User Agents Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/AUPRqRe9\r\n- https://twitter.com/cyb3rops/status/1100668485770846210\r\ndate: 2019/02/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/6.0 (X11; Linux x86_64; rv:24.0) Gecko/20140205     Firefox/27.0 Iceweasel/25.3.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.0\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": null, "sigma_text_keyword": "title: Empire User Agents (Proxy).\r\ndescription: Empire User Agents Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/AUPRqRe9\r\n- https://twitter.com/cyb3rops/status/1100668485770846210\r\ndate: 2019/02/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\r\n    - Mozilla/6.0 (X11; Linux x86_64; rv:24.0) Gecko/20140205     Firefox/27.0 Iceweasel/25.3.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:36.0) Gecko/20100101 Firefox/36.0\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "np3knmUBtApo-eN_ouR1": {"category": 11, "updated": "2019-02-26T15:32:53.000Z", "hash": "b24a010fd8cf749f0b4d7568b44f4576d6ecbd65a6ed8decd6dbe8d7236bf4c6", "title": "PsExec Service Start", "permission_id": 3, "title_keyword": "PsExec Service Start", "released": "2017-04-12T20:15:41.000Z", "sigma_text": "title: PsExec Service Start\r\ndescription: Detects a PsExec service start\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\nmodified: 2012/12/11\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine: C:\\Windows\\PSEXESVC.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low", "git_filepath": "/windows/builtin/win_alert_ad_user_backdoors.yml", "sigma_text_keyword": "title: PsExec Service Start\r\ndescription: Detects a PsExec service start\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\nmodified: 2012/12/11\r\ntags:\r\n- attack.execution\r\n- attack.t1035\r\n- attack.s0029\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine: C:\\Windows\\PSEXESVC.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low"}, "sp3knmUBtApo-eN_neMY": {"category": 2, "updated": "2018-10-23T15:50:13.000Z", "hash": "3cd5974c86505ede2def837ee1c931b00e4d8a7ba7c1429fd47099cbf38fd2e9", "title": "WMIExec VBS Script", "permission_id": 3, "title_keyword": "WMIExec VBS Script", "released": "2017-04-07T15:41:53.000Z", "sigma_text": "title: WMIExec VBS Script\r\ndescription: Detects suspicious file execution by wscript and cscript\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\r\ntags:\r\n- attack.execution\r\n- attack.g0045\r\n- attack.t1064\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\cscript.exe'\r\n    CommandLine: '*.vbs /shell *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical", "git_filepath": "/apt/apt_cloudhopper.yml", "sigma_text_keyword": "title: WMIExec VBS Script\r\ndescription: Detects suspicious file execution by wscript and cscript\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\r\ntags:\r\n- attack.execution\r\n- attack.g0045\r\n- attack.t1064\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image: '*\\cscript.exe'\r\n    CommandLine: '*.vbs /shell *'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical"}, "S53knmUBtApo-eN_juFz": {"category": 15, "updated": "2018-10-24T12:04:27.000Z", "hash": "91ff6298441dfad1805c420336dba60630c9af66e481b5477d1c7f7a8598012f", "title": "Microsoft Outlook Spawning Windows Shell", "permission_id": 3, "title_keyword": "Microsoft Outlook Spawning Windows Shell", "released": "2018-03-10T08:04:11.000Z", "sigma_text": "title: Microsoft Outlook Spawning Windows Shell\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Outlook\r\nreferences:\r\n- https://www2.cybereason.com/asset/60:research-cobalt-kitty-attack-lifecycle\r\nauthor: Florian Roth\r\ndate: 2018/03/06\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\OUTLOOK.EXE'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\schtasks.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- False positives are possible, depends on organisation and processes\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_outlook_shell.yml", "sigma_text_keyword": "title: Microsoft Outlook Spawning Windows Shell\r\nstatus: experimental\r\ndescription: Detects a Windows command line executable started from Microsoft Outlook\r\nreferences:\r\n- https://www2.cybereason.com/asset/60:research-cobalt-kitty-attack-lifecycle\r\nauthor: Florian Roth\r\ndate: 2018/03/06\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\OUTLOOK.EXE'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\schtasks.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- False positives are possible, depends on organisation and processes\r\nlevel: high"}, "xp3knmUBtApo-eN_o-SI": {"category": 8, "updated": "2018-10-26T14:40:17.000Z", "hash": "9c3b6517a2733fce7ec4fd277785b64dff21e539f03d4a65c95135ad8ab3566f", "title": "Suspicious Svchost Process (Sysmon).", "permission_id": 3, "title_keyword": "Suspicious Svchost Process (Sysmon).", "released": "2018-09-07T12:33:05.000Z", "sigma_text": "title: Suspicious Svchost Process (Sysmon).\r\ndescription: Detects a suspicious svchost process start.\r\nauthor: Florian Roth, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - svchost.exe\r\n  filter:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Suspicious Svchost Process (Sysmon).\r\ndescription: Detects a suspicious svchost process start.\r\nauthor: Florian Roth, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - svchost.exe\r\n  filter:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1059"}, "Fp3knmUBtApo-eN_peVx": {"category": 11, "updated": "2018-10-25T10:01:41.000Z", "hash": "d96b1f924c1706399862a884df053cf3964a3769aaffff1546e424b5b7afca63", "title": "Malicious Service Installations", "permission_id": 3, "title_keyword": "Malicious Service Installations", "released": "2017-03-27T13:20:50.000Z", "sigma_text": "title: Malicious Service Installations\r\ndescription: Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n  malsvc_wce:\r\n    ServiceName:\r\n    - WCESERVICE\r\n    - WCE SERVICE\r\n  malsvc_paexec:\r\n    ServiceFileName: '*\\PAExec*'\r\n  malsvc_winexe:\r\n    ServiceFileName: winexesvc.exe*\r\n  malsvc_pwdumpx:\r\n    ServiceFileName: '*\\DumpSvc.exe'\r\n  malsvc_wannacry:\r\n    ServiceName: mssecsvc2.0\r\n  malsvc_persistence:\r\n    ServiceFileName: '* net user *'\r\n  malsvc_others:\r\n    ServiceName:\r\n    - pwdump*\r\n    - gsecdump*\r\n    - cachedump*\r\n  condition: selection and (malsvc_wce or malsvc_paexec or malsvc_winexe or malsvc_pwdumpx or malsvc_wannacry or malsvc_persistence or malsvc_others)\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: critical", "git_filepath": "/windows/builtin/win_mal_service_installs.yml", "sigma_text_keyword": "title: Malicious Service Installations\r\ndescription: Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity\r\nauthor: Florian Roth\r\ntags:\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- attack.t1050\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: \"7045\"\r\n  malsvc_wce:\r\n    ServiceName:\r\n    - WCESERVICE\r\n    - WCE SERVICE\r\n  malsvc_paexec:\r\n    ServiceFileName: '*\\PAExec*'\r\n  malsvc_winexe:\r\n    ServiceFileName: winexesvc.exe*\r\n  malsvc_pwdumpx:\r\n    ServiceFileName: '*\\DumpSvc.exe'\r\n  malsvc_wannacry:\r\n    ServiceName: mssecsvc2.0\r\n  malsvc_persistence:\r\n    ServiceFileName: '* net user *'\r\n  malsvc_others:\r\n    ServiceName:\r\n    - pwdump*\r\n    - gsecdump*\r\n    - cachedump*\r\n  condition: selection and (malsvc_wce or malsvc_paexec or malsvc_winexe or malsvc_pwdumpx or malsvc_wannacry or malsvc_persistence or malsvc_others)\r\nfalsepositives:\r\n- Penetration testing\r\nlevel: critical"}, "gp3knmUBtApo-eN_p-WY": {"category": 15, "updated": "2019-02-26T14:39:51.000Z", "hash": "6da30eff0bfaecc994333e103b99c39b8f39e43e9fe88a4186a99114c4e88c25", "title": "Rundll32 Internet Connection", "permission_id": 3, "title_keyword": "Rundll32 Internet Connection", "released": "2017-11-04T13:44:30.000Z", "sigma_text": "title: Rundll32 Internet Connection\r\nstatus: experimental\r\ndescription: Detects a rundll32 that communicates with public IP addresses\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2017/11/04\r\ntags:\r\n- attack.t1085\r\n- attack.defense_evasion\r\n- attack.execution\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image: '*\\rundll32.exe'\r\n  filter:\r\n    DestinationIp:\r\n    - 10.*\r\n    - 192.168.*\r\n    - 172.*\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Communication to other corporate systems that use IP addresses from public address spaces\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_rundll32_net_connections.yml", "sigma_text_keyword": "title: Rundll32 Internet Connection\r\nstatus: experimental\r\ndescription: Detects a rundll32 that communicates with public IP addresses\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100\r\nauthor: Florian Roth\r\ndate: 2017/11/04\r\ntags:\r\n- attack.t1085\r\n- attack.defense_evasion\r\n- attack.execution\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image: '*\\rundll32.exe'\r\n  filter:\r\n    DestinationIp:\r\n    - 10.*\r\n    - 192.168.*\r\n    - 172.*\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Communication to other corporate systems that use IP addresses from public address spaces\r\nlevel: medium"}, "oZ3knmUBtApo-eN_hN9n": {"category": 8, "updated": "2018-10-26T15:53:23.000Z", "hash": "07838cdb73904ef17cc7c82e7a5cc8df723f1bbd43c70c0c656c4a0d83e07d61", "title": "Sofacy - APT C2 Domain Communication.", "permission_id": 3, "title_keyword": "Sofacy - APT C2 Domain Communication.", "released": "2018-05-08T06:48:30.000Z", "sigma_text": "title: Sofacy - APT C2 Domain Communication.\r\ndescription: Sofacy, Fancy Bear, Pawn Storm, APT-28 domain communication detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\r\n- https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign\r\n- https://blog.trendmicro.com/trendlabs-security-intelligence/update-pawn-storm-new-targets-politically-motivated-campaigns\r\n- https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities\r\ndate: 2017/11/07\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    DestinationHostname:\r\n    - myinvestgroup.com\r\n    - netmediaresources.com\r\n    - webviewres.net\r\n    - adfs.senate.group\r\n    - adfs-senate.email\r\n    - adfs-senate.services\r\n    - adfs.senate.qov.info\r\n    - chmail.ir.udelivered.tk\r\n    - webmail-ibsf.org\r\n    - fil-luge.com\r\n    - biathlovvorld.com\r\n    - mail-ibu.eu\r\n    - fisski.ca\r\n    - iihf.eu\r\n    - Cdnverify.net\r\n    - osce-press.com\r\n    - electronicfrontierfoundation.org\r\n    - baltichost.org\r\n    - checkmalware.org\r\n    - kavkazcentr.info\r\n    - login-osce.org\r\n    - malwarecheck.info\r\n    - n0vinite.com\r\n    - nato.nshq.in\r\n    - natoexhibitionff14.com\r\n    - novinitie.com\r\n    - poczta.mon.q0v.pl\r\n    - q0v.pl\r\n    - qov.hu.com\r\n    - rnil.am\r\n    - scanmalware.info\r\n    - smigroup-online.co.uk\r\n    - standartnevvs.com\r\n    - updatecenter.name\r\n    - securitypractic.com\r\n    - drivers-update.info\r\n    - nato-press.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: Sofacy - APT C2 Domain Communication.\r\ndescription: Sofacy, Fancy Bear, Pawn Storm, APT-28 domain communication detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\r\n- https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign\r\n- https://blog.trendmicro.com/trendlabs-security-intelligence/update-pawn-storm-new-targets-politically-motivated-campaigns\r\n- https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities\r\ndate: 2017/11/07\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    DestinationHostname:\r\n    - myinvestgroup.com\r\n    - netmediaresources.com\r\n    - webviewres.net\r\n    - adfs.senate.group\r\n    - adfs-senate.email\r\n    - adfs-senate.services\r\n    - adfs.senate.qov.info\r\n    - chmail.ir.udelivered.tk\r\n    - webmail-ibsf.org\r\n    - fil-luge.com\r\n    - biathlovvorld.com\r\n    - mail-ibu.eu\r\n    - fisski.ca\r\n    - iihf.eu\r\n    - Cdnverify.net\r\n    - osce-press.com\r\n    - electronicfrontierfoundation.org\r\n    - baltichost.org\r\n    - checkmalware.org\r\n    - kavkazcentr.info\r\n    - login-osce.org\r\n    - malwarecheck.info\r\n    - n0vinite.com\r\n    - nato.nshq.in\r\n    - natoexhibitionff14.com\r\n    - novinitie.com\r\n    - poczta.mon.q0v.pl\r\n    - q0v.pl\r\n    - qov.hu.com\r\n    - rnil.am\r\n    - scanmalware.info\r\n    - smigroup-online.co.uk\r\n    - standartnevvs.com\r\n    - updatecenter.name\r\n    - securitypractic.com\r\n    - drivers-update.info\r\n    - nato-press.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "jG1Mo2gBFVBAemBc-d06": {"category": 8, "updated": "2019-01-31T09:45:56.000Z", "hash": "0ec3d8abef5721680db199b423cc94d79840e9ec82854f1f9f08bc8fe3bb090c", "title": "APT29", "permission_id": 3, "title_keyword": "APT29", "released": "2019-01-31T09:45:56.000Z", "sigma_text": "action: global\r\ntitle: APT29 \r\ndescription: 'This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks' \r\nreferences:\r\n    - https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\r\nlogsource:\r\n    product: windows\r\nauthor: Florian Roth\r\ndate: 2018/12/04 \r\ndetection:\r\n    condition: selection\r\nfalsepositives:\r\n    - unknown\r\nlevel: critical\r\n---\r\nlogsource:\r\n    product: windows\r\n    service: sysmon\r\ndetection:\r\n    selection:\r\n        EventID: 1\r\n        CommandLine: '*-noni -ep bypass $*'\r\n---\r\nlogsource:\r\n    product: windows\r\n    service: security\r\n    description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n    selection:\r\n        EventID: 4688\r\n        ProcessCommandLine: '*-noni -ep bypass $*'\r\ntags:\r\n- attack.Execution\r\n- attack.t1086", "git_filepath": "", "sigma_text_keyword": "action: global\r\ntitle: APT29 \r\ndescription: 'This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks' \r\nreferences:\r\n    - https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\r\nlogsource:\r\n    product: windows\r\nauthor: Florian Roth\r\ndate: 2018/12/04 \r\ndetection:\r\n    condition: selection\r\nfalsepositives:\r\n    - unknown\r\nlevel: critical\r\n---\r\nlogsource:\r\n    product: windows\r\n    service: sysmon\r\ndetection:\r\n    selection:\r\n        EventID: 1\r\n        CommandLine: '*-noni -ep bypass $*'\r\n---\r\nlogsource:\r\n    product: windows\r\n    service: security\r\n    description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n    selection:\r\n        EventID: 4688\r\n        ProcessCommandLine: '*-noni -ep bypass $*'\r\ntags:\r\n- attack.Execution\r\n- attack.t1086"}, "VSV4f2cBqjf_D59HANr2": {"category": 8, "updated": "2019-01-02T14:40:05.000Z", "hash": "5d001c2fec32a5e9e3690a73bf5fea0182284d69bac274db154b82fe5a71b99e", "title": "Possible Flash 0day execute embedded in Word document. (Sysmon)", "permission_id": 3, "title_keyword": "Possible Flash 0day execute embedded in Word document. (Sysmon)", "released": "2018-12-05T17:43:50.000Z", "sigma_text": "title: Possible Flash 0day execute embedded in Word document. (Sysmon)\r\ndescription: An active exploitation of a zero-day vulnerability in Adobe Flash via a Microsoft Office document.\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://ti.360.net/blog/articles/flash-0day-hacking-team-rat-activities-of-exploiting-latest-flash-0day-vulnerability-and-correlation-analysis/\r\n- https://atr-blog.gigamon.com/2018/12/05/adobe-flash-zero-day-exploited-in-the-wild/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.ParentImage:\r\n    - winword.exe\r\n    event_data.CommandLine:\r\n    - '&& cd /d %~dp0 & rar.exe e -o+ -r -inul *.rar scan042.jpg'\r\n    - '& rar.exe e -o+ -r -inul scan042.jpg backup.exe'\r\n    - .rar scan042.jpg\r\n  selection1:\r\n    event_data.CommandLine:\r\n    - '&& cd /d %~dp0 & rar.exe e -o+ -r -inul *.rar scan042.jpg'\r\n    - '& rar.exe e -o+ -r -inul scan042.jpg backup.exe'\r\n    - .rar scan042.jpg\r\n  selection3:\r\n    event_data.Image:\r\n    - backup.exe\r\n    event_id: \"3\"\r\n  condition: selection0 or selection1 or selection3\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1203", "git_filepath": "", "sigma_text_keyword": "title: Possible Flash 0day execute embedded in Word document. (Sysmon)\r\ndescription: An active exploitation of a zero-day vulnerability in Adobe Flash via a Microsoft Office document.\r\nauthor: Roman Ranskyi\r\nreferences:\r\n- https://ti.360.net/blog/articles/flash-0day-hacking-team-rat-activities-of-exploiting-latest-flash-0day-vulnerability-and-correlation-analysis/\r\n- https://atr-blog.gigamon.com/2018/12/05/adobe-flash-zero-day-exploited-in-the-wild/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_data.ParentImage:\r\n    - winword.exe\r\n    event_data.CommandLine:\r\n    - '&& cd /d %~dp0 & rar.exe e -o+ -r -inul *.rar scan042.jpg'\r\n    - '& rar.exe e -o+ -r -inul scan042.jpg backup.exe'\r\n    - .rar scan042.jpg\r\n  selection1:\r\n    event_data.CommandLine:\r\n    - '&& cd /d %~dp0 & rar.exe e -o+ -r -inul *.rar scan042.jpg'\r\n    - '& rar.exe e -o+ -r -inul scan042.jpg backup.exe'\r\n    - .rar scan042.jpg\r\n  selection3:\r\n    event_data.Image:\r\n    - backup.exe\r\n    event_id: \"3\"\r\n  condition: selection0 or selection1 or selection3\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1203"}, "jZ3knmUBtApo-eN_leKq": {"category": 15, "updated": "2018-10-24T12:47:38.000Z", "hash": "e34244884489e0db58c722779d352bd2ce7405c700b8ba7b0e6ffe856538bf99", "title": "WMI Persistence - Script Event Consumer File Write", "permission_id": 3, "title_keyword": "WMI Persistence - Script Event Consumer File Write", "released": "2018-03-20T14:04:11.000Z", "sigma_text": "title: WMI Persistence - Script Event Consumer File Write\r\nstatus: experimental\r\ndescription: Detects file writes of WMI script event consumer\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nauthor: Thomas Patzke\r\ndate: 2018/03/07\r\ntags:\r\n- attack.t1084\r\n- attack.persistence\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"11\"\r\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_wmi_persistence_script_event_consumer_write.yml", "sigma_text_keyword": "title: WMI Persistence - Script Event Consumer File Write\r\nstatus: experimental\r\ndescription: Detects file writes of WMI script event consumer\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nauthor: Thomas Patzke\r\ndate: 2018/03/07\r\ntags:\r\n- attack.t1084\r\n- attack.persistence\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"11\"\r\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high"}, "vyXQWWcBqjf_D59HI7em": {"category": 8, "updated": "2019-01-02T14:46:06.000Z", "hash": "ceab16cf94315cd36bc7effbc2522331a5a81bbfa8370a45e5a8448edab812f0", "title": "MuddyWater APT (Proxy).", "permission_id": 3, "title_keyword": "MuddyWater APT (Proxy).", "released": "2018-11-28T10:15:22.000Z", "sigma_text": "title: MuddyWater APT (Proxy).\r\ndescription: MuddyWater APT Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/cybsecbot/status/1067682170360274944\r\n- https://twitter.com/cybsecbot/status/1067470776809463810\r\ndate: 2018/11/28\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionURL:\r\n    resource.URL:\r\n    - https://savephotos.net/e6N0RQ80\r\n    - http://sagawa-zz.com/sagawa.apk\r\n    - http://59.105.6.230//servlet/*\r\n    - http://118.160.115.74/admin/index.jsp\r\n  condition: selectionURL\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: MuddyWater APT (Proxy).\r\ndescription: MuddyWater APT Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/cybsecbot/status/1067682170360274944\r\n- https://twitter.com/cybsecbot/status/1067470776809463810\r\ndate: 2018/11/28\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionURL:\r\n    resource.URL:\r\n    - https://savephotos.net/e6N0RQ80\r\n    - http://sagawa-zz.com/sagawa.apk\r\n    - http://59.105.6.230//servlet/*\r\n    - http://118.160.115.74/admin/index.jsp\r\n  condition: selectionURL\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "_p3knmUBtApo-eN_pOTn": {"category": 11, "updated": "2019-02-26T15:35:32.000Z", "hash": "0891a2bf8f68fabe0ac56b666d12a56888ff7557c2b045f344790e032eec14ca", "title": "Disabling Windows Event Auditing", "permission_id": 3, "title_keyword": "Disabling Windows Event Auditing", "released": "2017-11-19T21:49:40.000Z", "sigma_text": "title: Disabling Windows Event Auditing\r\ndescription: |\r\n  Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\". Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.\r\nreferences:\r\n- https://bit.ly/WinLogsZero2Hero\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1054\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change'\r\ndetection:\r\n  selection:\r\n    EventID: 4719\r\n    AuditPolicyChanges: removed\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/builtin/win_disable_event_logging.yml", "sigma_text_keyword": "title: Disabling Windows Event Auditing\r\ndescription: |\r\n  Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\". Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.\r\nreferences:\r\n- https://bit.ly/WinLogsZero2Hero\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1054\r\nauthor: '@neu5ron'\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change'\r\ndetection:\r\n  selection:\r\n    EventID: 4719\r\n    AuditPolicyChanges: removed\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "HZ3knmUBtApo-eN_meOR": {"category": 15, "updated": "2018-10-24T12:09:20.000Z", "hash": "4a8969cc464cb577ec0b14f8e7e15ab44490c07a059d18e62e23aadf9c5cd833", "title": "Taskmgr as LOCAL_SYSTEM", "permission_id": 3, "title_keyword": "Taskmgr as LOCAL_SYSTEM", "released": "2018-03-19T15:36:39.000Z", "sigma_text": "title: Taskmgr as LOCAL_SYSTEM\r\nstatus: experimental\r\ndescription: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM\r\nauthor: Florian Roth\r\ndate: 2018/03/18\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    User: NT AUTHORITY\\SYSTEM\r\n    Image: '*\\taskmgr.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_taskmgr_localsystem.yml", "sigma_text_keyword": "title: Taskmgr as LOCAL_SYSTEM\r\nstatus: experimental\r\ndescription: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM\r\nauthor: Florian Roth\r\ndate: 2018/03/18\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    User: NT AUTHORITY\\SYSTEM\r\n    Image: '*\\taskmgr.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high"}, "5G7_I2kBFVBAemBccUvi": {"category": 11, "updated": "2019-02-25T09:32:17.000Z", "hash": "c3255608830301fc6d14c724528c3430d350d0dc1938e62d14a554c8923cbeca", "title": "Suspicious Svchost Processes.", "permission_id": 3, "title_keyword": "Suspicious Svchost Processes.", "released": "2019-02-25T09:32:17.000Z", "sigma_text": "title: Suspicious Svchost Processes.\r\ndescription: Detects suspicious svchost processes with parent process that is not services.exe, command line missing -k parameter or running outside Windows folder.\r\nauthor: Florian Roth, @c_APT_ure\r\ndate: 2018/10/26\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/Moti_B/status/1002280132143394816\r\n- https://twitter.com/Moti_B/status/1002280287840153601\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\svchost.exe'\r\n  filter1:\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  filter2:\r\n    CommandLine: '* -k *'\r\n  filter3:\r\n    Image: C:\\Windows\\S*\r\n  condition: selection and not ( filter1 or filter2 or filter3 )\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    NewProcessName: '*\\svchost.exe'\r\n  filter3:\r\n    NewProcessName: C:\\Windows\\S*\r\n  condition: selection and not filter3\r\nlevel: high\r\nfalsepositives:\r\n- Renamed %SystemRoot%s", "git_filepath": "/windows/builtin/win_susp_svchost.yml", "sigma_text_keyword": "title: Suspicious Svchost Processes.\r\ndescription: Detects suspicious svchost processes with parent process that is not services.exe, command line missing -k parameter or running outside Windows folder.\r\nauthor: Florian Roth, @c_APT_ure\r\ndate: 2018/10/26\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/Moti_B/status/1002280132143394816\r\n- https://twitter.com/Moti_B/status/1002280287840153601\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\svchost.exe'\r\n  filter1:\r\n    ParentImage:\r\n    - '*\\services.exe'\r\n    - '*\\MsMpEng.exe'\r\n  filter2:\r\n    CommandLine: '* -k *'\r\n  filter3:\r\n    Image: C:\\Windows\\S*\r\n  condition: selection and not ( filter1 or filter2 or filter3 )\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    NewProcessName: '*\\svchost.exe'\r\n  filter3:\r\n    NewProcessName: C:\\Windows\\S*\r\n  condition: selection and not filter3\r\nlevel: high\r\nfalsepositives:\r\n- Renamed %SystemRoot%s"}, "RJ3knmUBtApo-eN_muOo": {"category": 15, "updated": "2019-02-26T15:08:26.000Z", "hash": "019241649addb2e8ea4294d97af34a389332d65bef72211227199c9face66247", "title": "Executables Started in Suspicious Folder", "permission_id": 3, "title_keyword": "Executables Started in Suspicious Folder", "released": "2017-10-14T21:22:20.000Z", "sigma_text": "title: Executables Started in Suspicious Folder\r\nstatus: experimental\r\ndescription: Detects process starts of binaries from a suspicious folder\r\nauthor: Florian Roth\r\ndate: 2017/10/14\r\nreferences:\r\n- https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt\r\n- https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - C:\\PerfLogs\\\\*\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Intel\\Logs\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\NetworkService\\\\*\r\n    - C:\\Windows\\Fonts\\\\*\r\n    - C:\\Windows\\Debug\\\\*\r\n    - C:\\Windows\\Media\\\\*\r\n    - C:\\Windows\\Help\\\\*\r\n    - C:\\Windows\\addins\\\\*\r\n    - C:\\Windows\\repair\\\\*\r\n    - C:\\Windows\\security\\\\*\r\n    - '*\\RSA\\MachineKeys\\\\*'\r\n    - C:\\Windows\\system32\\config\\systemprofile\\\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_exec_folder.yml", "sigma_text_keyword": "title: Executables Started in Suspicious Folder\r\nstatus: experimental\r\ndescription: Detects process starts of binaries from a suspicious folder\r\nauthor: Florian Roth\r\ndate: 2017/10/14\r\nreferences:\r\n- https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt\r\n- https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - C:\\PerfLogs\\\\*\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Intel\\Logs\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\NetworkService\\\\*\r\n    - C:\\Windows\\Fonts\\\\*\r\n    - C:\\Windows\\Debug\\\\*\r\n    - C:\\Windows\\Media\\\\*\r\n    - C:\\Windows\\Help\\\\*\r\n    - C:\\Windows\\addins\\\\*\r\n    - C:\\Windows\\repair\\\\*\r\n    - C:\\Windows\\security\\\\*\r\n    - '*\\RSA\\MachineKeys\\\\*'\r\n    - C:\\Windows\\system32\\config\\systemprofile\\\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "JW5cCmkBFVBAemBcAzw3": {"category": 11, "updated": "2019-02-20T10:03:15.000Z", "hash": "34baa844d6c22d62dd335746f6c1f7e209b6b6267d5007a748911bf67f2897d7", "title": "Mimikatz DC Sync", "permission_id": 3, "title_keyword": "Mimikatz DC Sync", "released": "2019-02-20T10:03:15.000Z", "sigma_text": "title: Mimikatz DC Sync\r\ndescription: Detects Mimikatz DC sync security events\r\nstatus: experimental\r\ndate: 2018/06/03\r\nauthor: Benjamin Delpy, Florian Roth\r\nreferences:\r\n- https://twitter.com/gentilkiwi/status/1003236624925413376\r\n- https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\r\ntags:\r\n- attack.credential_access\r\n- attack.s0002\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4662\r\n    Properties:\r\n    - '*Replicating Directory Changes All*'\r\n    - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical", "git_filepath": "/windows/builtin/win_dcsync.yml", "sigma_text_keyword": "title: Mimikatz DC Sync\r\ndescription: Detects Mimikatz DC sync security events\r\nstatus: experimental\r\ndate: 2018/06/03\r\nauthor: Benjamin Delpy, Florian Roth\r\nreferences:\r\n- https://twitter.com/gentilkiwi/status/1003236624925413376\r\n- https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\r\ntags:\r\n- attack.credential_access\r\n- attack.s0002\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4662\r\n    Properties:\r\n    - '*Replicating Directory Changes All*'\r\n    - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical"}, "6Z3knmUBtApo-eN_mOKU": {"category": 3, "updated": "2018-10-25T09:42:46.000Z", "hash": "708797f1ab13a9d9e29ba9377e632607ad8bc63e24baf10a3a000ee2692bb34a", "title": "Suspicious Log Entries", "permission_id": 3, "title_keyword": "Suspicious Log Entries", "released": "2017-03-25T18:59:45.000Z", "sigma_text": "title: Suspicious Log Entries\r\ndescription: Detects suspicious log entries in Linux log files\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - entered promiscuous mode\r\n  - Deactivating service\r\n  - Oversized packet received from\r\n  - imuxsock begins to drop messages\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium", "git_filepath": "/linux/lnx_shell_susp_log_entries.yml", "sigma_text_keyword": "title: Suspicious Log Entries\r\ndescription: Detects suspicious log entries in Linux log files\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - entered promiscuous mode\r\n  - Deactivating service\r\n  - Oversized packet received from\r\n  - imuxsock begins to drop messages\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium"}, "yW5kLmkBFVBAemBcvlYl": {"category": 2, "updated": "2019-02-27T09:59:07.000Z", "hash": "b8c0442b71704bd833e3e972dad86bc1677857b3d701aa7b501d4f35a0ccea2c", "title": "APT29.", "permission_id": 3, "title_keyword": "APT29.", "released": "2019-02-27T09:59:07.000Z", "sigma_text": "title: APT29.\r\ndescription: This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks.\r\nreferences:\r\n- https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\r\ndate: 2018/12/04\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine: '*-noni -ep bypass $*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine: '*-noni -ep bypass $*'\r\n  condition: selection\r\nlevel: critical\r\nfalsepositives:\r\n- unknown", "git_filepath": "/apt/apt_apt29_thinktanks.yml", "sigma_text_keyword": "title: APT29.\r\ndescription: This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks.\r\nreferences:\r\n- https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\r\ndate: 2018/12/04\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine: '*-noni -ep bypass $*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine: '*-noni -ep bypass $*'\r\n  condition: selection\r\nlevel: critical\r\nfalsepositives:\r\n- unknown"}, "7G5G3WgBFVBAemBc5Rdm": {"category": 8, "updated": "2019-02-11T16:35:12.000Z", "hash": "aafaa38cd7c57c1dcb9debce2fc59e93dc80c77876e5d82f168455d24bb77e1a", "title": "TROLDESH Ransomware Detector (Sysmon).", "permission_id": 3, "title_keyword": "TROLDESH Ransomware Detector (Sysmon).", "released": "2019-02-11T16:33:11.000Z", "sigma_text": "title: TROLDESH Ransomware Detector (Sysmon).\r\ndescription: TROLDESH Ransomware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/uxBHRS2J\r\n- https://app.any.run/tasks/6531498f-9ad9-471a-9143-8c32d3c01ca0\r\ndate: 2018/02/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    file_hash:\r\n    - e577944c48edfc65b6f59630b0b0ac625b997f26af3d4bdbe2f534be0fff6f34\r\n  selection2:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    CommandLine:\r\n    - '*/c C:\\Users\\admin\\AppData\\Local\\Temp\\rad*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- Hashes\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: TROLDESH Ransomware Detector (Sysmon).\r\ndescription: TROLDESH Ransomware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://pastebin.com/uxBHRS2J\r\n- https://app.any.run/tasks/6531498f-9ad9-471a-9143-8c32d3c01ca0\r\ndate: 2018/02/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    file_hash:\r\n    - e577944c48edfc65b6f59630b0b0ac625b997f26af3d4bdbe2f534be0fff6f34\r\n  selection2:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    CommandLine:\r\n    - '*/c C:\\Users\\admin\\AppData\\Local\\Temp\\rad*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- Hashes\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "L21ME2gBFVBAemBctG63": {"category": 8, "updated": "2019-01-03T10:50:04.000Z", "hash": "133584d32711b01f449d72218c3126633398b46e963b29651e11062d4f59f953", "title": "Roma225 Campaign (Firewall/Proxy).", "permission_id": 3, "title_keyword": "Roma225 Campaign (Firewall/Proxy).", "released": "2019-01-03T10:50:04.000Z", "sigma_text": "title: Roma225 Campaign (Firewall/Proxy).\r\ndescription: Roma225 Campaign Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://securityaffairs.co/wordpress/79324/malware/roma225-campaign-italian-automotive.html?utm_source=dlvr.it&utm_medium=twitter\r\n- https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/\r\ndate: 2018/12/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  SelectionSRC:\r\n    src_ip:\r\n    - 138.36.3.228\r\n    - 184.75.209.169\r\n    - 177.85.98.242\r\n  SelectionDST:\r\n    dst_ip:\r\n    - 138.36.3.228\r\n    - 184.75.209.169\r\n    - 177.85.98.242\r\n  SelectionURL:\r\n    resource.URL:\r\n    - https://minhacasaminhavidacdt.blogspot.com\r\n    - https://pocasideiascdt.blogspot.com/\r\n    - http://cdtmaster.com.br\r\n  SelectionD:\r\n    destination.domain:\r\n    - office365update.duckdns.org\r\n    - systen32.ddns.net\r\n  condition: SelectionSRC or SelectionDST or SelectionURL or SelectionD\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: Roma225 Campaign (Firewall/Proxy).\r\ndescription: Roma225 Campaign Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://securityaffairs.co/wordpress/79324/malware/roma225-campaign-italian-automotive.html?utm_source=dlvr.it&utm_medium=twitter\r\n- https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/\r\ndate: 2018/12/27\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  SelectionSRC:\r\n    src_ip:\r\n    - 138.36.3.228\r\n    - 184.75.209.169\r\n    - 177.85.98.242\r\n  SelectionDST:\r\n    dst_ip:\r\n    - 138.36.3.228\r\n    - 184.75.209.169\r\n    - 177.85.98.242\r\n  SelectionURL:\r\n    resource.URL:\r\n    - https://minhacasaminhavidacdt.blogspot.com\r\n    - https://pocasideiascdt.blogspot.com/\r\n    - http://cdtmaster.com.br\r\n  SelectionD:\r\n    destination.domain:\r\n    - office365update.duckdns.org\r\n    - systen32.ddns.net\r\n  condition: SelectionSRC or SelectionDST or SelectionURL or SelectionD\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "Tp3knmUBtApo-eN_lOJL": {"category": 15, "updated": "2019-02-26T15:07:40.000Z", "hash": "cba6183234976c6f6c4b511dcb592f9a40c6d4a85489d33b7a473764c51b475a", "title": "Mimikatz Detection LSASS Access", "permission_id": 3, "title_keyword": "Mimikatz Detection LSASS Access", "released": "2017-02-16T17:06:22.000Z", "sigma_text": "title: Mimikatz Detection LSASS Access\r\nstatus: experimental\r\ndescription: Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION, 0x0010 PROCESS_VM_READ)\r\nreferences:\r\n- https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\r\ntags:\r\n- attack.s0002\r\n- attack.lateral_movement\r\n- attack.credential_access\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 10\r\n    TargetImage: C:\\windows\\system32\\lsass.exe\r\n    GrantedAccess: \"0x1410\"\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_mimikatz_detection_lsass.yml", "sigma_text_keyword": "title: Mimikatz Detection LSASS Access\r\nstatus: experimental\r\ndescription: Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION, 0x0010 PROCESS_VM_READ)\r\nreferences:\r\n- https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\r\ntags:\r\n- attack.s0002\r\n- attack.lateral_movement\r\n- attack.credential_access\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 10\r\n    TargetImage: C:\\windows\\system32\\lsass.exe\r\n    GrantedAccess: \"0x1410\"\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "lJ3knmUBtApo-eN_p-X5": {"category": 15, "updated": "2019-02-26T15:12:06.000Z", "hash": "deb542ba3f0fef42271d5fa5b5bdcfe0f4a18b3457d1d10298a257f81bbd03c6", "title": "UAC Bypass via Event Viewer", "permission_id": 3, "title_keyword": "UAC Bypass via Event Viewer", "released": "2017-04-16T10:02:29.000Z", "sigma_text": "title: UAC Bypass via Event Viewer\r\nstatus: experimental\r\ndescription: Detects UAC bypass method using Windows event viewer\r\nreferences:\r\n- https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\r\n- https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  methregistry:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\\\*\\mscfile\\shell\\open\\command\r\n  methprocess:\r\n    EventID: 1\r\n    ParentImage: '*\\eventvwr.exe'\r\n  filterprocess:\r\n    Image: '*\\mmc.exe'\r\n  condition: methregistry or ( methprocess and not filterprocess )\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: critical", "git_filepath": "/windows/sysmon/sysmon_susp_regsvr32_anomalies.yml", "sigma_text_keyword": "title: UAC Bypass via Event Viewer\r\nstatus: experimental\r\ndescription: Detects UAC bypass method using Windows event viewer\r\nreferences:\r\n- https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\r\n- https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  methregistry:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\\\*\\mscfile\\shell\\open\\command\r\n  methprocess:\r\n    EventID: 1\r\n    ParentImage: '*\\eventvwr.exe'\r\n  filterprocess:\r\n    Image: '*\\mmc.exe'\r\n  condition: methregistry or ( methprocess and not filterprocess )\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: critical"}, "iJ3knmUBtApo-eN_ruY4": {"category": 15, "updated": "2018-10-24T11:40:47.000Z", "hash": "e4765c0dad793cbf5569b9ed240d69b713f85ff6beec57a55713f015efc5dc7a", "title": "Taskmgr as Parent", "permission_id": 3, "title_keyword": "Taskmgr as Parent", "released": "2018-03-15T18:54:03.000Z", "sigma_text": "title: Taskmgr as Parent\r\nstatus: experimental\r\ndescription: Detects the creation of a process from Windows task manager\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\taskmgr.exe'\r\n  filter:\r\n    Image:\r\n    - resmon.exe\r\n    - mmc.exe\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_susp_taskmgr_parent.yml", "sigma_text_keyword": "title: Taskmgr as Parent\r\nstatus: experimental\r\ndescription: Detects the creation of a process from Windows task manager\r\nauthor: Florian Roth\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\taskmgr.exe'\r\n  filter:\r\n    Image:\r\n    - resmon.exe\r\n    - mmc.exe\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: low"}, "IJ3knmUBtApo-eN_peWe": {"category": 2, "updated": "2018-10-24T09:00:09.000Z", "hash": "3bdf6c80e15f82ade4509c33987bb00424d4e9117f080814daccfeef61ed352b", "title": "Equation Group C2 Communication", "permission_id": 3, "title_keyword": "Equation Group C2 Communication", "released": "2017-04-15T09:32:56.000Z", "sigma_text": "title: Equation Group C2 Communication\r\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools\r\nreferences:\r\n- https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\r\n- https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0020\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 69.42.98.86\r\n    - 89.185.234.145\r\n  incoming:\r\n    src_ip:\r\n    - 69.42.98.86\r\n    - 89.185.234.145\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/apt/apt_equationgroup_c2.yml", "sigma_text_keyword": "title: Equation Group C2 Communication\r\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools\r\nreferences:\r\n- https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\r\n- https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195\r\ntags:\r\n- attack.command_and_control\r\n- attack.g0020\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 69.42.98.86\r\n    - 89.185.234.145\r\n  incoming:\r\n    src_ip:\r\n    - 69.42.98.86\r\n    - 89.185.234.145\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "UJ3knmUBtApo-eN_iOCW": {"category": 15, "updated": "2019-02-26T14:01:31.000Z", "hash": "6781254ecc8851c31a04b586400f806734b61f54c2bd9cb3d8aa06801f50ffdb", "title": "Hiding files with attrib.exe", "permission_id": 3, "title_keyword": "Hiding files with attrib.exe", "released": "2018-08-08T14:19:39.000Z", "sigma_text": "title: Hiding files with attrib.exe\r\nstatus: experimental\r\ndescription: Detects usage of attrib.exe to hide files from users.\r\nauthor: Sami Ruohonen\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\attrib.exe'\r\n    CommandLine: '* +h *'\r\n  ini:\r\n    CommandLine: '*\\desktop.ini *'\r\n  intel:\r\n    ParentImage: '*\\cmd.exe'\r\n    CommandLine: +R +H +S +A \\\\*.cui\r\n    ParentCommandLine: C:\\WINDOWS\\system32\\\\*.bat\r\n  condition: selection and not (ini or intel)\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- User\r\ntags:\r\n- attack.defense_evasion\r\n- attack.persistence\r\n- attack.t1158\r\nfalsepositives:\r\n- igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)\r\n- msiexec.exe hiding desktop.ini\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_attrib_hiding_files.yml", "sigma_text_keyword": "title: Hiding files with attrib.exe\r\nstatus: experimental\r\ndescription: Detects usage of attrib.exe to hide files from users.\r\nauthor: Sami Ruohonen\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\attrib.exe'\r\n    CommandLine: '* +h *'\r\n  ini:\r\n    CommandLine: '*\\desktop.ini *'\r\n  intel:\r\n    ParentImage: '*\\cmd.exe'\r\n    CommandLine: +R +H +S +A \\\\*.cui\r\n    ParentCommandLine: C:\\WINDOWS\\system32\\\\*.bat\r\n  condition: selection and not (ini or intel)\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- User\r\ntags:\r\n- attack.defense_evasion\r\n- attack.persistence\r\n- attack.t1158\r\nfalsepositives:\r\n- igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)\r\n- msiexec.exe hiding desktop.ini\r\nlevel: low"}, "zyUZdWcBqjf_D59H1czv": {"category": 8, "updated": "2019-01-25T16:20:55.000Z", "hash": "9dc10a2a5b2641b1fc1133e30f3d2157c755459abac472d02a6ab3665bbfcdf5", "title": "Pony Malware (Sysmon).", "permission_id": 3, "title_keyword": "Pony Malware (Sysmon).", "released": "2018-12-03T17:25:09.000Z", "sigma_text": "title: Pony Malware (Sysmon).\r\ndescription: Pony Malware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://malwarebreakdown.com/2018/03/19/malspam-delivers-pony-and-loki-bot/\r\n- https://blog.talosintelligence.com/2017/02/pony-pub-files.html\r\n- https://isc.sans.edu/forums/diary/HancitorPony+malspam/22053/\r\n- https://twitter.com/pollo290987/status/1088830050248675331\r\ndate: 2019/01/25\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    file_hash:\r\n    - 2fdc22d8926db1b04dc3d62ff6da72236cb1c052b23553b644c7f18ea8496d8a\r\n    - 6bfa353f905c0fc5ded87e7f35dc939e7b757ea3f2f8372f81f0ac40edadd619\r\n    - 3f5240c924074995651c4ccac15ddfd0070beff93625dcea9db118ab32bad61d\r\n    - 3cfd8919f095e048e0f24a41c2f132328f0d0efe19581b308d9d2d3ffad40c29\r\n    - 36baccd2a4fc4f683c839283123a75de61b01ce93205f4a34975263e9c66aaed\r\n    - 42d0990daba69fa5068a6910d0eac487f3d308ce7e28799a959dace8d84125d7\r\n    - d214c89af1929af1171ac40999b14a4f6fbcfd13b88cade392853a2c61057122\r\n    - c7ef89222d760fc915690e6394c61c84176e618f7c9508beca30aa9a0f1b1991\r\n    - 2c79954335b579309957c22b1b7976359fd067691626f8beb99779143edaa69\r\n    - 82d4b6676bbff17626aba1a65a9c6ec10ab036c101c8dc5e6e697693ec5a013f\r\n    - 5c46fb082a683144092793529a0d10b6\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: Pony Malware (Sysmon).\r\ndescription: Pony Malware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://malwarebreakdown.com/2018/03/19/malspam-delivers-pony-and-loki-bot/\r\n- https://blog.talosintelligence.com/2017/02/pony-pub-files.html\r\n- https://isc.sans.edu/forums/diary/HancitorPony+malspam/22053/\r\n- https://twitter.com/pollo290987/status/1088830050248675331\r\ndate: 2019/01/25\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    file_hash:\r\n    - 2fdc22d8926db1b04dc3d62ff6da72236cb1c052b23553b644c7f18ea8496d8a\r\n    - 6bfa353f905c0fc5ded87e7f35dc939e7b757ea3f2f8372f81f0ac40edadd619\r\n    - 3f5240c924074995651c4ccac15ddfd0070beff93625dcea9db118ab32bad61d\r\n    - 3cfd8919f095e048e0f24a41c2f132328f0d0efe19581b308d9d2d3ffad40c29\r\n    - 36baccd2a4fc4f683c839283123a75de61b01ce93205f4a34975263e9c66aaed\r\n    - 42d0990daba69fa5068a6910d0eac487f3d308ce7e28799a959dace8d84125d7\r\n    - d214c89af1929af1171ac40999b14a4f6fbcfd13b88cade392853a2c61057122\r\n    - c7ef89222d760fc915690e6394c61c84176e618f7c9508beca30aa9a0f1b1991\r\n    - 2c79954335b579309957c22b1b7976359fd067691626f8beb99779143edaa69\r\n    - 82d4b6676bbff17626aba1a65a9c6ec10ab036c101c8dc5e6e697693ec5a013f\r\n    - 5c46fb082a683144092793529a0d10b6\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "Xp3knmUBtApo-eN_juHd": {"category": 8, "updated": "2018-10-26T14:14:20.000Z", "hash": "066cfaf4df8497fa7485dbcd5b7aaf5db086c448a52e2d13eac4361b87f8d967", "title": "SquiblyTwo (Sysmon).", "permission_id": 3, "title_keyword": "SquiblyTwo (Sysmon).", "released": "2018-09-07T12:38:54.000Z", "sigma_text": "title: SquiblyTwo (Sysmon).\r\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash.\r\nauthor: Markus Neis, Florian Roth, Alexandr Yampolskyi\r\nreferences:\r\n- https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\r\n- https://twitter.com/mattifestation/status/986280382042595328\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - wmic.exe\r\n    CommandLine:\r\n    - wmic * *format:\\\"http*\r\n    - wmic * /format:'http\r\n    - wmic * /format:http*\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.1059", "git_filepath": null, "sigma_text_keyword": "title: SquiblyTwo (Sysmon).\r\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash.\r\nauthor: Markus Neis, Florian Roth, Alexandr Yampolskyi\r\nreferences:\r\n- https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\r\n- https://twitter.com/mattifestation/status/986280382042595328\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - wmic.exe\r\n    CommandLine:\r\n    - wmic * *format:\\\"http*\r\n    - wmic * /format:'http\r\n    - wmic * /format:http*\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.1059"}, "pp3knmUBtApo-eN_qOVT": {"category": 15, "updated": "2019-02-26T13:50:04.000Z", "hash": "2957294f42d8ed505c8d9d1764fdcd6b7463cbb39a444c9d754702a71c52f697", "title": "Microsoft Binary Suspicious Communication Endpoint", "permission_id": 3, "title_keyword": "Microsoft Binary Suspicious Communication Endpoint", "released": "2018-08-30T08:12:12.000Z", "sigma_text": "title: Microsoft Binary Suspicious Communication Endpoint\r\nstatus: experimental\r\ndescription: Detects an executable in the Windows folder accessing suspicious domains\r\nreferences:\r\n- https://twitter.com/M_haggis/status/900741347035889665\r\n- https://twitter.com/M_haggis/status/1032799638213066752\r\nauthor: Florian Roth\r\ndate: 2018/08/30\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationHostname:\r\n    - '*dl.dropboxusercontent.com'\r\n    - '*.pastebin.com'\r\n    Image: C:\\Windows\\\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_win_binary_susp_com.yml", "sigma_text_keyword": "title: Microsoft Binary Suspicious Communication Endpoint\r\nstatus: experimental\r\ndescription: Detects an executable in the Windows folder accessing suspicious domains\r\nreferences:\r\n- https://twitter.com/M_haggis/status/900741347035889665\r\n- https://twitter.com/M_haggis/status/1032799638213066752\r\nauthor: Florian Roth\r\ndate: 2018/08/30\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationHostname:\r\n    - '*dl.dropboxusercontent.com'\r\n    - '*.pastebin.com'\r\n    Image: C:\\Windows\\\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "aJ3knmUBtApo-eN_m-N4": {"category": 11, "updated": "2018-10-25T10:10:42.000Z", "hash": "0986555439aa89e954998a4dc3a21bc095b5340e5f1cd5f648a2e92b842763aa", "title": "DNS Server Error Failed Loading the ServerLevelPluginDLL", "permission_id": 3, "title_keyword": "DNS Server Error Failed Loading the ServerLevelPluginDLL", "released": "2017-05-15T18:58:31.000Z", "sigma_text": "title: DNS Server Error Failed Loading the ServerLevelPluginDLL\r\ndescription: This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded\r\nstatus: experimental\r\ndate: 2017/05/08\r\nreferences:\r\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\r\n- https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx\r\n- https://twitter.com/gentilkiwi/status/861641945944391680\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: dns-server\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"150\"\r\n    - \"770\"\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical", "git_filepath": "/windows/builtin/win_susp_dns_config.yml", "sigma_text_keyword": "title: DNS Server Error Failed Loading the ServerLevelPluginDLL\r\ndescription: This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded\r\nstatus: experimental\r\ndate: 2017/05/08\r\nreferences:\r\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\r\n- https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx\r\n- https://twitter.com/gentilkiwi/status/861641945944391680\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: dns-server\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - \"150\"\r\n    - \"770\"\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical"}, "T53knmUBtApo-eN_rObU": {"category": 5, "updated": "2019-02-26T14:23:36.000Z", "hash": "1757eea175957db52f5fcd08999fe4349f7f35d5343074a80205eb613ca00da3", "title": "Download from Suspicious TLD", "permission_id": 3, "title_keyword": "Download from Suspicious TLD", "released": "2017-11-07T13:03:16.000Z", "sigma_text": "title: Download from Suspicious TLD\r\nstatus: experimental\r\ndescription: Detects download of certain file types from hosts in suspicious TLDs\r\nreferences:\r\n- https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\r\n- https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\r\n- https://www.spamhaus.org/statistics/tlds/\r\n- https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\r\nauthor: Florian Roth\r\ndate: 2018/06/13\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n    r-dns:\r\n    - '*.country'\r\n    - '*.stream'\r\n    - '*.gdn'\r\n    - '*.mom'\r\n    - '*.xin'\r\n    - '*.kim'\r\n    - '*.men'\r\n    - '*.loan'\r\n    - '*.download'\r\n    - '*.racing'\r\n    - '*.online'\r\n    - '*.science'\r\n    - '*.ren'\r\n    - '*.gb'\r\n    - '*.win'\r\n    - '*.top'\r\n    - '*.review'\r\n    - '*.vip'\r\n    - '*.party'\r\n    - '*.tech'\r\n    - '*.xyz'\r\n    - '*.date'\r\n    - '*.faith'\r\n    - '*.zip'\r\n    - '*.cricket'\r\n    - '*.space'\r\n    - '*.info'\r\n    - '*.vn'\r\n    - '*.cm'\r\n    - '*.am'\r\n    - '*.cc'\r\n    - '*.asia'\r\n    - '*.ws'\r\n    - '*.tk'\r\n    - '*.biz'\r\n    - '*.su'\r\n    - '*.st'\r\n    - '*.ro'\r\n    - '*.ge'\r\n    - '*.ms'\r\n    - '*.pk'\r\n    - '*.nu'\r\n    - '*.me'\r\n    - '*.ph'\r\n    - '*.to'\r\n    - '*.tt'\r\n    - '*.name'\r\n    - '*.tv'\r\n    - '*.kz'\r\n    - '*.tc'\r\n    - '*.mobi'\r\n    - '*.study'\r\n    - '*.click'\r\n    - '*.link'\r\n    - '*.trade'\r\n    - '*.accountant'\r\n    - '*.cf'\r\n    - '*.gq'\r\n    - '*.ml'\r\n    - '*.ga'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\nfalsepositives:\r\n- All kinds of software downloads\r\nlevel: low", "git_filepath": "/proxy/proxy_download_susp_tlds_blacklist.yml", "sigma_text_keyword": "title: Download from Suspicious TLD\r\nstatus: experimental\r\ndescription: Detects download of certain file types from hosts in suspicious TLDs\r\nreferences:\r\n- https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\r\n- https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\r\n- https://www.spamhaus.org/statistics/tlds/\r\n- https://krebsonsecurity.com/2018/06/bad-men-at-work-please-dont-click/\r\nauthor: Florian Roth\r\ndate: 2018/06/13\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n    r-dns:\r\n    - '*.country'\r\n    - '*.stream'\r\n    - '*.gdn'\r\n    - '*.mom'\r\n    - '*.xin'\r\n    - '*.kim'\r\n    - '*.men'\r\n    - '*.loan'\r\n    - '*.download'\r\n    - '*.racing'\r\n    - '*.online'\r\n    - '*.science'\r\n    - '*.ren'\r\n    - '*.gb'\r\n    - '*.win'\r\n    - '*.top'\r\n    - '*.review'\r\n    - '*.vip'\r\n    - '*.party'\r\n    - '*.tech'\r\n    - '*.xyz'\r\n    - '*.date'\r\n    - '*.faith'\r\n    - '*.zip'\r\n    - '*.cricket'\r\n    - '*.space'\r\n    - '*.info'\r\n    - '*.vn'\r\n    - '*.cm'\r\n    - '*.am'\r\n    - '*.cc'\r\n    - '*.asia'\r\n    - '*.ws'\r\n    - '*.tk'\r\n    - '*.biz'\r\n    - '*.su'\r\n    - '*.st'\r\n    - '*.ro'\r\n    - '*.ge'\r\n    - '*.ms'\r\n    - '*.pk'\r\n    - '*.nu'\r\n    - '*.me'\r\n    - '*.ph'\r\n    - '*.to'\r\n    - '*.tt'\r\n    - '*.name'\r\n    - '*.tv'\r\n    - '*.kz'\r\n    - '*.tc'\r\n    - '*.mobi'\r\n    - '*.study'\r\n    - '*.click'\r\n    - '*.link'\r\n    - '*.trade'\r\n    - '*.accountant'\r\n    - '*.cf'\r\n    - '*.gq'\r\n    - '*.ml'\r\n    - '*.ga'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\nfalsepositives:\r\n- All kinds of software downloads\r\nlevel: low"}, "sJ3knmUBtApo-eN_ouTO": {"category": 3, "updated": "2018-10-25T09:44:52.000Z", "hash": "8514e2f23d57aba665a77bd1adb5fe45148de9ee4966499fc74a1674f1d5115c", "title": "Suspicious SSHD Error", "permission_id": 3, "title_keyword": "Suspicious SSHD Error", "released": "2017-06-30T06:47:56.000Z", "sigma_text": "title: Suspicious SSHD Error\r\ndescription: Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/openssh/openssh-portable/blob/master/ssherr.c\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml\r\nauthor: Florian Roth\r\ndate: 2017/06/30\r\nlogsource:\r\n  product: linux\r\n  service: sshd\r\ndetection:\r\n  keywords:\r\n  - '*unexpected internal error*'\r\n  - '*unknown or unsupported key type*'\r\n  - '*invalid certificate signing key*'\r\n  - '*invalid elliptic curve value*'\r\n  - '*incorrect signature*'\r\n  - '*error in libcrypto*'\r\n  - '*unexpected bytes remain after decoding*'\r\n  - '*fatal: buffer_get_string: bad string*'\r\n  - '*Local: crc32 compensation attack*'\r\n  - '*bad client public DH value*'\r\n  - '*Corrupted MAC on input*'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium", "git_filepath": "/linux/lnx_susp_ssh.yml", "sigma_text_keyword": "title: Suspicious SSHD Error\r\ndescription: Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts\r\nreferences:\r\n- https://github.com/openssh/openssh-portable/blob/master/ssherr.c\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml\r\nauthor: Florian Roth\r\ndate: 2017/06/30\r\nlogsource:\r\n  product: linux\r\n  service: sshd\r\ndetection:\r\n  keywords:\r\n  - '*unexpected internal error*'\r\n  - '*unknown or unsupported key type*'\r\n  - '*invalid certificate signing key*'\r\n  - '*invalid elliptic curve value*'\r\n  - '*incorrect signature*'\r\n  - '*error in libcrypto*'\r\n  - '*unexpected bytes remain after decoding*'\r\n  - '*fatal: buffer_get_string: bad string*'\r\n  - '*Local: crc32 compensation attack*'\r\n  - '*bad client public DH value*'\r\n  - '*Corrupted MAC on input*'\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium"}, "0SWILGcBqjf_D59HDoni": {"category": 8, "updated": "2019-01-02T14:53:09.000Z", "hash": "707fe71173f1cb33ba318c26c9d9fda5ac5be96156bba0ea21115911b8ac1278", "title": "DarkGate Cryptocurrency Mining and Ransomware Campaign (Sysmon).", "permission_id": 3, "title_keyword": "DarkGate Cryptocurrency Mining and Ransomware Campaign (Sysmon).", "released": "2018-11-19T15:14:50.000Z", "sigma_text": "title: DarkGate Cryptocurrency Mining and Ransomware Campaign (Sysmon).\r\ndescription: DarkGate Cryptocurrency Mining and Ransomware Campaign Detector.\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://blog.ensilo.com/darkgate-malware\r\ndate: 2018/11/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b\r\n    - 0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5\r\n    - 3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b\r\n    - 0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5\r\n    - 52c47a529e4ddd0778dde84b7f54e1aea326d9f8eeb4ba4961a87835a3d29866\r\n    - b0542a719c6b2fc575915e9e4c58920cf999ba5c3f5345617818a9dc14a378b4\r\n    - dadd0ec8806d506137889d7f1595b3b5447c1ea30159432b1952fa9551ecfba5\r\n    - c88eab30fa03c44b567bcb4e659a60ee0fe5d98664816c70e3b6e8d79169cbea\r\n    - 2264c2f2c2d5a0d6d62c33cadb848305a8fff81cdd79c4d7560021cfb304a121\r\n    - 3c68facf01aede7bcd8c2aea853324a2e6a0ec8b026d95c7f50a46d77334c2d2\r\n    - a146f84a0179124d96a707f192f4c06c07690e745cffaef521fcda9633766a44\r\n    - abc35bb943462312437f0c4275b012e8ec03899ab86d353143d92cbefedd7f9d\r\n    - 908f2dfed6c122b46e946fe8839feb9218cb095f180f86c43659448e2f709fc7\r\n    - 3491bc6df27858257db26b913da8c35c83a0e48cf80de701a45a30a30544706d\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: DarkGate Cryptocurrency Mining and Ransomware Campaign (Sysmon).\r\ndescription: DarkGate Cryptocurrency Mining and Ransomware Campaign Detector.\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://blog.ensilo.com/darkgate-malware\r\ndate: 2018/11/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b\r\n    - 0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5\r\n    - 3340013b0f00fe0c9e99411f722f8f3f0baf9ae4f40ac78796a6d4d694b46d7b\r\n    - 0c3ef20ede53efbe5eebca50171a589731a17037147102838bdb4a41c33f94e5\r\n    - 52c47a529e4ddd0778dde84b7f54e1aea326d9f8eeb4ba4961a87835a3d29866\r\n    - b0542a719c6b2fc575915e9e4c58920cf999ba5c3f5345617818a9dc14a378b4\r\n    - dadd0ec8806d506137889d7f1595b3b5447c1ea30159432b1952fa9551ecfba5\r\n    - c88eab30fa03c44b567bcb4e659a60ee0fe5d98664816c70e3b6e8d79169cbea\r\n    - 2264c2f2c2d5a0d6d62c33cadb848305a8fff81cdd79c4d7560021cfb304a121\r\n    - 3c68facf01aede7bcd8c2aea853324a2e6a0ec8b026d95c7f50a46d77334c2d2\r\n    - a146f84a0179124d96a707f192f4c06c07690e745cffaef521fcda9633766a44\r\n    - abc35bb943462312437f0c4275b012e8ec03899ab86d353143d92cbefedd7f9d\r\n    - 908f2dfed6c122b46e946fe8839feb9218cb095f180f86c43659448e2f709fc7\r\n    - 3491bc6df27858257db26b913da8c35c83a0e48cf80de701a45a30a30544706d\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.t1204"}, "-53knmUBtApo-eN_nuOP": {"category": 15, "updated": "2019-02-26T14:39:44.000Z", "hash": "3776d4ddeb12dca4d7e31206825d03934a60ebb4d18281fb22ac33b545464715", "title": "PowerShell Download from URL", "permission_id": 3, "title_keyword": "PowerShell Download from URL", "released": "2017-03-02T10:06:53.000Z", "sigma_text": "title: PowerShell Download from URL\r\nstatus: experimental\r\ndescription: Detects a Powershell process that contains download commands in its command line string\r\nauthor: Florian Roth\r\ntags:\r\n- attack.t1086\r\n- attack.execution\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\powershell.exe'\r\n    CommandLine:\r\n    - '*new-object system.net.webclient).downloadstring(*'\r\n    - '*new-object system.net.webclient).downloadfile(*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_powershell_download.yml", "sigma_text_keyword": "title: PowerShell Download from URL\r\nstatus: experimental\r\ndescription: Detects a Powershell process that contains download commands in its command line string\r\nauthor: Florian Roth\r\ntags:\r\n- attack.t1086\r\n- attack.execution\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\powershell.exe'\r\n    CommandLine:\r\n    - '*new-object system.net.webclient).downloadstring(*'\r\n    - '*new-object system.net.webclient).downloadfile(*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium"}, "x53knmUBtApo-eN_o-SV": {"category": 10, "updated": "2018-10-23T15:38:13.000Z", "hash": "80a7e9af8a9193bf2d8283763c0fff23478521facc0ff3d9a569f43edaa3fc63", "title": "Multiple Modsecurity Blocks", "permission_id": 3, "title_keyword": "Multiple Modsecurity Blocks", "released": "2017-02-28T16:53:32.000Z", "sigma_text": "title: Multiple Modsecurity Blocks\r\ndescription: Detects multiple blocks by the mod_security module (Web Application Firewall)\r\nlogsource:\r\n  product: linux\r\n  service: modsecurity\r\ndetection:\r\n  selection:\r\n  - 'mod_security: Access denied'\r\n  - 'ModSecurity: Access denied'\r\n  - 'mod_security-message: Access denied'\r\n  timeframe: 120m\r\n  condition: selection | count() > 6\r\nfalsepositives:\r\n- Vulnerability scanners\r\n- Frequent attacks if system faces Internet\r\nlevel: medium", "git_filepath": "/linux/modsecurity/modsec_mulitple_blocks.yml", "sigma_text_keyword": "title: Multiple Modsecurity Blocks\r\ndescription: Detects multiple blocks by the mod_security module (Web Application Firewall)\r\nlogsource:\r\n  product: linux\r\n  service: modsecurity\r\ndetection:\r\n  selection:\r\n  - 'mod_security: Access denied'\r\n  - 'ModSecurity: Access denied'\r\n  - 'mod_security-message: Access denied'\r\n  timeframe: 120m\r\n  condition: selection | count() > 6\r\nfalsepositives:\r\n- Vulnerability scanners\r\n- Frequent attacks if system faces Internet\r\nlevel: medium"}, "6Z3knmUBtApo-eN_i-Dt": {"category": 8, "updated": "2018-10-26T14:44:38.000Z", "hash": "1c9d44bee4f8c754005662d25cbe7425ce634a4dd18176b190d51716977f1376", "title": "Powershell Encoded Command (Sysmon).", "permission_id": 3, "title_keyword": "Powershell Encoded Command (Sysmon).", "released": "2018-09-07T12:34:41.000Z", "sigma_text": "title: Powershell Encoded Command (Sysmon).\r\ndescription: Detects usage of Powershell Encoded Commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - base64\r\n    - -enc\r\n    - -enco\r\n    - -encod\r\n    - -encode\r\n    - -encoded\r\n    - -ec\r\n    - -en\r\n    - -encodedC\r\n    - -encodedCo\r\n    - -encodedCom\r\n    - -encodedComm\r\n    - -encodedComma\r\n    - -encodedComman\r\n    - -encodedCommand\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Powershell Encoded Command (Sysmon).\r\ndescription: Detects usage of Powershell Encoded Commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - base64\r\n    - -enc\r\n    - -enco\r\n    - -encod\r\n    - -encode\r\n    - -encoded\r\n    - -ec\r\n    - -en\r\n    - -encodedC\r\n    - -encodedCo\r\n    - -encodedCom\r\n    - -encodedComm\r\n    - -encodedComma\r\n    - -encodedComman\r\n    - -encodedCommand\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "l53knmUBtApo-eN_leLp": {"category": 5, "updated": "2018-10-25T13:25:20.000Z", "hash": "46026757c1070542c3d8d8e74b3e9d67d227936ab11050f4206e13015c7c881d", "title": "Download EXE from Suspicious TLD", "permission_id": 3, "title_keyword": "Download EXE from Suspicious TLD", "released": "2017-11-07T13:02:56.000Z", "sigma_text": "title: Download EXE from Suspicious TLD\r\nstatus: experimental\r\ndescription: Detects executable downloads from suspicious remote systems\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n  filter:\r\n    r-dns:\r\n    - '*.com'\r\n    - '*.org'\r\n    - '*.net'\r\n    - '*.edu'\r\n    - '*.gov'\r\n    - '*.uk'\r\n    - '*.ca'\r\n    - '*.de'\r\n    - '*.jp'\r\n    - '*.fr'\r\n    - '*.au'\r\n    - '*.us'\r\n    - '*.ch'\r\n    - '*.it'\r\n    - '*.nl'\r\n    - '*.se'\r\n    - '*.no'\r\n    - '*.es'\r\n  condition: selection and not filter\r\nfields:\r\n- ClientIP\r\n- URL\r\nfalsepositives:\r\n- All kind of software downloads\r\nlevel: low", "git_filepath": "/proxy/proxy_download_susp_tlds_whitelist.yml", "sigma_text_keyword": "title: Download EXE from Suspicious TLD\r\nstatus: experimental\r\ndescription: Detects executable downloads from suspicious remote systems\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n  filter:\r\n    r-dns:\r\n    - '*.com'\r\n    - '*.org'\r\n    - '*.net'\r\n    - '*.edu'\r\n    - '*.gov'\r\n    - '*.uk'\r\n    - '*.ca'\r\n    - '*.de'\r\n    - '*.jp'\r\n    - '*.fr'\r\n    - '*.au'\r\n    - '*.us'\r\n    - '*.ch'\r\n    - '*.it'\r\n    - '*.nl'\r\n    - '*.se'\r\n    - '*.no'\r\n    - '*.es'\r\n  condition: selection and not filter\r\nfields:\r\n- ClientIP\r\n- URL\r\nfalsepositives:\r\n- All kind of software downloads\r\nlevel: low"}, "c53knmUBtApo-eN_m-O_": {"category": 15, "updated": "2018-10-24T09:40:04.000Z", "hash": "1c9067802cda9e0c08c31fb67cd00f86b75652d2dc88f22538e1c7c5e367e730", "title": "Ping Hex IP", "permission_id": 3, "title_keyword": "Ping Hex IP", "released": "2018-03-23T16:00:00.000Z", "sigma_text": "title: Ping Hex IP\r\ndescription: Detects a ping command that uses a hex encoded IP address\r\nreferences:\r\n- https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna\r\n- https://twitter.com/vysecurity/status/977198418354491392\r\nauthor: Florian Roth\r\ndate: 2018/03/23\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*\\ping.exe 0x*'\r\n    - '*\\ping 0x*'\r\n  condition: selection\r\nfields:\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely, because no sane admin pings IP addresses in a hexadecimal form\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_ping_hex_ip.yml", "sigma_text_keyword": "title: Ping Hex IP\r\ndescription: Detects a ping command that uses a hex encoded IP address\r\nreferences:\r\n- https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna\r\n- https://twitter.com/vysecurity/status/977198418354491392\r\nauthor: Florian Roth\r\ndate: 2018/03/23\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*\\ping.exe 0x*'\r\n    - '*\\ping 0x*'\r\n  condition: selection\r\nfields:\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely, because no sane admin pings IP addresses in a hexadecimal form\r\nlevel: high"}, "153knmUBtApo-eN_nePX": {"category": 15, "updated": "2019-02-26T13:43:43.000Z", "hash": "d436641b7f124e33e9039d155cfb965ee5b1600827895fbdc786f42afc0d2654", "title": "Net.exe Execution", "permission_id": 3, "title_keyword": "Net.exe Execution", "released": "2017-03-25T13:48:23.000Z", "sigma_text": "title: Net.exe Execution\r\nstatus: experimental\r\ndescription: Detects execution of Net.exe, whether suspicious or benign.\r\nreferences:\r\n- https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\r\nauthor: Michael Haag, Mark Woan\r\ntags:\r\n- attack.s0039\r\n- attack.lateral_movement\r\n- attack.discovery\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\net.exe'\r\n    - '*\\net1.exe'\r\n    CommandLine:\r\n    - '* group*'\r\n    - '* localgroup*'\r\n    - '* user*'\r\n    - '* view*'\r\n    - '* share'\r\n    - '* accounts*'\r\n    - '* use*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine.\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_susp_net_execution.yml", "sigma_text_keyword": "title: Net.exe Execution\r\nstatus: experimental\r\ndescription: Detects execution of Net.exe, whether suspicious or benign.\r\nreferences:\r\n- https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\r\nauthor: Michael Haag, Mark Woan\r\ntags:\r\n- attack.s0039\r\n- attack.lateral_movement\r\n- attack.discovery\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\net.exe'\r\n    - '*\\net1.exe'\r\n    CommandLine:\r\n    - '* group*'\r\n    - '* localgroup*'\r\n    - '* user*'\r\n    - '* view*'\r\n    - '* share'\r\n    - '* accounts*'\r\n    - '* use*'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine.\r\nlevel: low"}, "xJ3knmUBtApo-eN_qeVE": {"category": 8, "updated": "2018-10-26T15:53:15.000Z", "hash": "e361df0c48a5bf07a59ef62a1364c747e9fac63eb5c3813d98e9170a868a31a0", "title": "DualToy Trojan Detection.", "permission_id": 3, "title_keyword": "DualToy Trojan Detection.", "released": "2018-05-10T05:50:19.000Z", "sigma_text": "title: DualToy Trojan Detection.\r\ndescription: DualToy Trojan C2 Domains Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://researchcenter.paloaltonetworks.com/2016/09/dualtoy-new-windows-trojan-sideloads-risky-apps-to-android-and-ios-devices/\r\ndate: 2016/09/13\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - www.zaccl.com\r\n    - pack.1e5.com\r\n    - rsys.topfreeweb.net\r\n    - abc.yuedea.com\r\n    - report.boxlist.info\r\n    - tt.51wanyx.net\r\n    - hk.pk2012.info\r\n    - center.oldlist.info\r\n    - up.top258.cn\r\n    - dl.dswzd.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: DualToy Trojan Detection.\r\ndescription: DualToy Trojan C2 Domains Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://researchcenter.paloaltonetworks.com/2016/09/dualtoy-new-windows-trojan-sideloads-risky-apps-to-android-and-ios-devices/\r\ndate: 2016/09/13\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - www.zaccl.com\r\n    - pack.1e5.com\r\n    - rsys.topfreeweb.net\r\n    - abc.yuedea.com\r\n    - report.boxlist.info\r\n    - tt.51wanyx.net\r\n    - hk.pk2012.info\r\n    - center.oldlist.info\r\n    - up.top258.cn\r\n    - dl.dswzd.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "JW6SM2kBFVBAemBcaF00": {"category": 11, "updated": "2019-02-28T10:07:06.000Z", "hash": "70e1e007a1f73b9cfcab749fd23b1ccb91612a9d2b4683e18cb4c555298a9703", "title": "Eventlog Cleared Experimental", "permission_id": 3, "title_keyword": "Eventlog Cleared Experimental", "released": "2019-02-28T10:07:06.000Z", "sigma_text": "title: Eventlog Cleared Experimental\r\nstatus: experimental\r\ndescription: Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution\r\nauthor: Florian Roth\r\ndate: 2017/06/27\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 104\r\n    Source: Eventlog\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1070", "git_filepath": "/windows/builtin/win_eventlog_cleared.yml", "sigma_text_keyword": "title: Eventlog Cleared Experimental\r\nstatus: experimental\r\ndescription: Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution\r\nauthor: Florian Roth\r\ndate: 2017/06/27\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID: 104\r\n    Source: Eventlog\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1070"}, "KJ3knmUBtApo-eN_mePt": {"category": 5, "updated": "2019-02-26T14:35:03.000Z", "hash": "dcb20fa88863b4233cbeaa690c290dec430a0f9b6e2126cea86ab0f4fb51c39a", "title": "Download from Suspicious Dyndns Hosts", "permission_id": 3, "title_keyword": "Download from Suspicious Dyndns Hosts", "released": "2017-11-08T10:32:30.000Z", "sigma_text": "title: Download from Suspicious Dyndns Hosts\r\nstatus: experimental\r\ndescription: Detects download of certain file types from hosts with dynamic DNS names (selected list)\r\nreferences:\r\n- https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats\r\nauthor: Florian Roth\r\ndate: 2017/11/08\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n    r-dns:\r\n    - '*.hopto.org'\r\n    - '*.no-ip.org'\r\n    - '*.no-ip.info'\r\n    - '*.no-ip.biz'\r\n    - '*.no-ip.com'\r\n    - '*.noip.com'\r\n    - '*.ddns.name'\r\n    - '*.myftp.org'\r\n    - '*.myftp.biz'\r\n    - '*.serveblog.net'\r\n    - '*.servebeer.com'\r\n    - '*.servemp3.com'\r\n    - '*.serveftp.com'\r\n    - '*.servequake.com'\r\n    - '*.servehalflife.com'\r\n    - '*.servehttp.com'\r\n    - '*.servegame.com'\r\n    - '*.servepics.com'\r\n    - '*.myvnc.com'\r\n    - '*.ignorelist.com'\r\n    - '*.jkub.com'\r\n    - '*.dlinkddns.com'\r\n    - '*.jumpingcrab.com'\r\n    - '*.ddns.info'\r\n    - '*.mooo.com'\r\n    - '*.dns-dns.com'\r\n    - '*.strangled.net'\r\n    - '*.ddns.info'\r\n    - '*.adultdns.net'\r\n    - '*.craftx.biz'\r\n    - '*.ddns01.com'\r\n    - '*.dns53.biz'\r\n    - '*.dnsapi.info'\r\n    - '*.dnsd.info'\r\n    - '*.dnsdynamic.com'\r\n    - '*.dnsdynamic.net'\r\n    - '*.dnsget.org'\r\n    - '*.fe100.net'\r\n    - '*.flashserv.net'\r\n    - '*.ftp21.net'\r\n    - '*.http01.com'\r\n    - '*.http80.info'\r\n    - '*.https443.com'\r\n    - '*.imap01.com'\r\n    - '*.kadm5.com'\r\n    - '*.mysq1.net'\r\n    - '*.ns360.info'\r\n    - '*.ntdll.net'\r\n    - '*.ole32.com'\r\n    - '*.proxy8080.com'\r\n    - '*.sql01.com'\r\n    - '*.ssh01.com'\r\n    - '*.ssh22.net'\r\n    - '*.tempors.com'\r\n    - '*.tftpd.net'\r\n    - '*.ttl60.com'\r\n    - '*.ttl60.org'\r\n    - '*.user32.com'\r\n    - '*.voip01.com'\r\n    - '*.wow64.net'\r\n    - '*.x64.me'\r\n    - '*.xns01.com'\r\n    - '*.dyndns.org'\r\n    - '*.dyndns.info'\r\n    - '*.dyndns.tv'\r\n    - '*.dyndns-at-home.com'\r\n    - '*.dnsomatic.com'\r\n    - '*.zapto.org'\r\n    - '*.webhop.net'\r\n    - '*.25u.com'\r\n    - '*.slyip.net'\r\n  condition: selection\r\nfields:\r\n- cs-ip\r\n- c-uri\r\nfalsepositives:\r\n- Software downloads\r\nlevel: medium", "git_filepath": "/proxy/proxy_download_susp_dyndns.yml", "sigma_text_keyword": "title: Download from Suspicious Dyndns Hosts\r\nstatus: experimental\r\ndescription: Detects download of certain file types from hosts with dynamic DNS names (selected list)\r\nreferences:\r\n- https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats\r\nauthor: Florian Roth\r\ndate: 2017/11/08\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    c-uri-extension:\r\n    - exe\r\n    - vbs\r\n    - bat\r\n    - rar\r\n    - ps1\r\n    - doc\r\n    - docm\r\n    - xls\r\n    - xlsm\r\n    - pptm\r\n    - rtf\r\n    - hta\r\n    - dll\r\n    - ws\r\n    - wsf\r\n    - sct\r\n    - zip\r\n    r-dns:\r\n    - '*.hopto.org'\r\n    - '*.no-ip.org'\r\n    - '*.no-ip.info'\r\n    - '*.no-ip.biz'\r\n    - '*.no-ip.com'\r\n    - '*.noip.com'\r\n    - '*.ddns.name'\r\n    - '*.myftp.org'\r\n    - '*.myftp.biz'\r\n    - '*.serveblog.net'\r\n    - '*.servebeer.com'\r\n    - '*.servemp3.com'\r\n    - '*.serveftp.com'\r\n    - '*.servequake.com'\r\n    - '*.servehalflife.com'\r\n    - '*.servehttp.com'\r\n    - '*.servegame.com'\r\n    - '*.servepics.com'\r\n    - '*.myvnc.com'\r\n    - '*.ignorelist.com'\r\n    - '*.jkub.com'\r\n    - '*.dlinkddns.com'\r\n    - '*.jumpingcrab.com'\r\n    - '*.ddns.info'\r\n    - '*.mooo.com'\r\n    - '*.dns-dns.com'\r\n    - '*.strangled.net'\r\n    - '*.ddns.info'\r\n    - '*.adultdns.net'\r\n    - '*.craftx.biz'\r\n    - '*.ddns01.com'\r\n    - '*.dns53.biz'\r\n    - '*.dnsapi.info'\r\n    - '*.dnsd.info'\r\n    - '*.dnsdynamic.com'\r\n    - '*.dnsdynamic.net'\r\n    - '*.dnsget.org'\r\n    - '*.fe100.net'\r\n    - '*.flashserv.net'\r\n    - '*.ftp21.net'\r\n    - '*.http01.com'\r\n    - '*.http80.info'\r\n    - '*.https443.com'\r\n    - '*.imap01.com'\r\n    - '*.kadm5.com'\r\n    - '*.mysq1.net'\r\n    - '*.ns360.info'\r\n    - '*.ntdll.net'\r\n    - '*.ole32.com'\r\n    - '*.proxy8080.com'\r\n    - '*.sql01.com'\r\n    - '*.ssh01.com'\r\n    - '*.ssh22.net'\r\n    - '*.tempors.com'\r\n    - '*.tftpd.net'\r\n    - '*.ttl60.com'\r\n    - '*.ttl60.org'\r\n    - '*.user32.com'\r\n    - '*.voip01.com'\r\n    - '*.wow64.net'\r\n    - '*.x64.me'\r\n    - '*.xns01.com'\r\n    - '*.dyndns.org'\r\n    - '*.dyndns.info'\r\n    - '*.dyndns.tv'\r\n    - '*.dyndns-at-home.com'\r\n    - '*.dnsomatic.com'\r\n    - '*.zapto.org'\r\n    - '*.webhop.net'\r\n    - '*.25u.com'\r\n    - '*.slyip.net'\r\n  condition: selection\r\nfields:\r\n- cs-ip\r\n- c-uri\r\nfalsepositives:\r\n- Software downloads\r\nlevel: medium"}, "hZ3knmUBtApo-eN_j-HP": {"category": 8, "updated": "2018-10-26T15:53:09.000Z", "hash": "7c5c42e0af9c321c42d4a0ed2b4100c3a9315b8ce281546a062988ecff8d5ade", "title": "YiSpecter Malware Detection.", "permission_id": 3, "title_keyword": "YiSpecter Malware Detection.", "released": "2018-05-10T05:58:20.000Z", "sigma_text": "title: YiSpecter Malware Detection.\r\ndescription: YiSpecter Malware C2 Domains And Subdomains Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://researchcenter.paloaltonetworks.com/2015/10/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/\r\ndate: 2015/10/4\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - bb800.com\r\n    - ad.bb800.com\r\n    - down.bb800.com\r\n    - ty1.bb800.com\r\n    - iosnoico.bb800.com\r\n    - qvod.bb800.com\r\n    - qvios.od.bb800.com\r\n    - dp.bb800.com\r\n    - iosads.cdn.bb800.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: YiSpecter Malware Detection.\r\ndescription: YiSpecter Malware C2 Domains And Subdomains Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://researchcenter.paloaltonetworks.com/2015/10/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/\r\ndate: 2015/10/4\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selection:\r\n    r-dns:\r\n    - bb800.com\r\n    - ad.bb800.com\r\n    - down.bb800.com\r\n    - ty1.bb800.com\r\n    - iosnoico.bb800.com\r\n    - qvod.bb800.com\r\n    - qvios.od.bb800.com\r\n    - dp.bb800.com\r\n    - iosads.cdn.bb800.com\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "u53knmUBtApo-eN_neND": {"category": 3, "updated": "2018-10-25T09:43:02.000Z", "hash": "70390ef3c5a554157560d81aa81a0d97ad51304d7a0ed477f1895075420ae733", "title": "Buffer Overflow Attempts", "permission_id": 3, "title_keyword": "Buffer Overflow Attempts", "released": "2017-03-01T07:38:33.000Z", "sigma_text": "title: Buffer Overflow Attempts\r\ndescription: Detects buffer overflow attempts in Unix system log files\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml\r\nlogsource:\r\n  product: unix\r\ndetection:\r\n  keywords:\r\n  - attempt to execute code on stack by\r\n  - FTP LOGIN FROM .* 0bin0sh\r\n  - 'rpc.statd[\\d+]: gethostbyname error for'\r\n  - AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  condition: keywords\r\nfalsepositives:\r\n- Unkown\r\nlevel: high", "git_filepath": "/linux/lnx_buffer_overflows.yml", "sigma_text_keyword": "title: Buffer Overflow Attempts\r\ndescription: Detects buffer overflow attempts in Unix system log files\r\nreferences:\r\n- https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml\r\nlogsource:\r\n  product: unix\r\ndetection:\r\n  keywords:\r\n  - attempt to execute code on stack by\r\n  - FTP LOGIN FROM .* 0bin0sh\r\n  - 'rpc.statd[\\d+]: gethostbyname error for'\r\n  - AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n  condition: keywords\r\nfalsepositives:\r\n- Unkown\r\nlevel: high"}, "wJ3knmUBtApo-eN_keFj": {"category": 2, "updated": "2019-02-26T14:03:48.000Z", "hash": "6d1b2ac3093694e1cc3174a8f0a4198c439e050b4074297518fc4dc8902b8c79", "title": "Turla Group Named Pipes", "permission_id": 3, "title_keyword": "Turla Group Named Pipes", "released": "2017-11-06T13:22:09.000Z", "sigma_text": "title: Turla Group Named Pipes\r\nstatus: experimental\r\ndescription: Detects a named pipe used by Turla group samples\r\nreferences:\r\n- Internal Research\r\ndate: 2017/11/06\r\ntags:\r\n- attack.g0010\r\nauthor: Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: Note that you have to configure logging for PipeEvents in Symson config\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 17\r\n    - 18\r\n    PipeName:\r\n    - \\atctl\r\n    - \\userpipe\r\n    - \\iehelper\r\n    - \\sdlrpc\r\n    - \\comnap\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical", "git_filepath": "/apt/apt_turla_namedpipes.yml", "sigma_text_keyword": "title: Turla Group Named Pipes\r\nstatus: experimental\r\ndescription: Detects a named pipe used by Turla group samples\r\nreferences:\r\n- Internal Research\r\ndate: 2017/11/06\r\ntags:\r\n- attack.g0010\r\nauthor: Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: Note that you have to configure logging for PipeEvents in Symson config\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 17\r\n    - 18\r\n    PipeName:\r\n    - \\atctl\r\n    - \\userpipe\r\n    - \\iehelper\r\n    - \\sdlrpc\r\n    - \\comnap\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: critical"}, "ZSW1OmcBqjf_D59H4JX9": {"category": 8, "updated": "2019-02-26T12:21:43.000Z", "hash": "4d8099bcb0a740b9bed5399f65caf25cf9010bc9b4f9a1bc1b17c00d7a3255c6", "title": "Detecting Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)", "permission_id": 3, "title_keyword": "Detecting Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)", "released": "2018-11-22T09:17:37.000Z", "sigma_text": "title: Detecting Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)\r\ndescription: This rule detects malicious files loaded or executed on compromised machine in consequence of Malvertising Campaign related with distribution Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\n- https://twitter.com/DrunkBinary/status/1077896062214594560\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  hashes:\r\n  - a31cf8bc0753caf6cf6d3c3e5d2dd8bb\r\n  - c820ce29a6ab96e958e510e30275387c\r\n  - d0857776bb769d8777929496dfbed984\r\n  - 834c709455bfefb9b0e8976bad13a8f4\r\n  - e6fa8996d51426cec4e5006e5e527638\r\n  - 6fa05433c744d3f9a365d68d14ec32c1\r\n  - bfe9619b665d06327cd9bfbcea94ead4\r\n  - 420f4bc290b7a5becd8406843e74f013\r\n  - 51ab00c724a29198eed3cb9b50925046\r\n  - 369a82f8bb8c906b8cde4f688c08bd71\r\n  - 8f2b13948c7fda4a3f2f10b3446c0453\r\n  - 52815c0c8dd35e80f52576be8d02e620\r\n  - 3fc1cd6eade766fc989684dd1390d640\r\n  - 5725db132c2f90be2e04a48fb385a1b8\r\n  - A8734436C6948F6879BBA1DBA09D8810\r\n  - C29E524436EA9CB42F27134DE631432B\r\n  - 1118184D160F5F341A46130BDD2468F2\r\n  - 6623F573AB668B7DA9068A714968E8E9\r\n  - 8C4A0C394F83EDC9FF45EE77982A9904\r\n  - 372BF4C5942769F216316E315CC50C9D\r\n  - 7ACB1B099ADBE17A8D5194DA2637BE51\r\n  - 605fe3746f003bce8a18be1f216afb72\r\n  - 834c709455bfefb9b0e8976bad13a8f4\r\n  - e0dfc17c215b7b767370dabcb39abff8\r\n  - 8ae5f3d79c4da3741bf9388543fe7479\r\n  - 1e5446a3ee1d308a89338e18f24580bd\r\n  - d5146737484fc5f2abb02a28b5383b30\r\n  - 649e69583e86412115ecaf926b5d2b20\r\n  - f53abf8ec98d18088ae1e65c53a38320\r\n  - 31217903f050f4b05ab1c882e94d6668\r\n  - a6bac979ce2c89cdd14a51c0709ce537ad6ba0be68a01c00475d2610467fe864\r\n  - 8d46246696fc2bed3531aadc9e1bae4086bd32a39ed9d0cfb51e804a44337c38\r\n  - c4ceb4486f70c6ff244501bb727ae7c9b9a8468f4cd2ced36f0b2e11f275e8f2\r\n  - 9020402e49cb7d9dcc81b70297b1b102dca3df70ad1e50dad8814d8543990d6d\r\n  - f715505bce521c2d826f1e8237b582a2831082b5e2632600ad07c95072829a62\r\n  - a14f31e8a55d5f0b6e02a168e5561e7e402e22295edc6cf6118bb2634dcb8994\r\n  - 84db40763f9bd2de3ad90457ef9239fa325ff863cdb9d48263c5adb0cb109776\r\n  - 5f6642212d136066f89a48f13ae09a8b56a88ba3e0999e17c9d950c8eb43b800\r\n  - a866a2b490ac7215a041bf0497b75aa7dfe8f23bc8079d890cdfbf796acd2ead\r\n  - 8d10c38f77ad489f217519c6c21a74e19a047031c0148ea4e67c71065f7e6172\r\n  - 2188039c3dad554aa4a2f19b57be1a985637f4a7159dfb3e78ae30fb08f0fe7d\r\n  - 16d17d31c3937ed029ffb18beb896b2aada68130fa7e8a2127043ee72eba03e9\r\n  - 8b50e3ca06a22d0be6a71232b320137c776f80ac3f2c81b7440b43854b8a3bf0\r\n  - bb9c0df092f52d9fe3d17b4806c2c78d32fa9236a7dc70cdb6fbc3ea5c673720\r\n  - f69621f1e489c038132f0dc2861442eb469e063feaafb91c6f6ba4d84df6f011\r\n  - 47b39dbbe6f14712bee4fdff325950d7385b139b8c53a1305b6cd40a91c2512b\r\n  - 8f54983530a59da264d8b6b80048bfc321b10a101def9f4744d5aaafb7caea15\r\n  - 1b00cf03f26724d9e9cff35a8d3d2e42f2518827e9564513b348fc163de153b6\r\n  - 845f1bcb80321f9183258fdcd714a4ca61a26b02590dd02cf4bd4cb07c757cdd\r\n  - f34acc2dcdfa27eab7740cea8a6bd6e734ae75999b18f05a9b3f715347bbc5b5\r\n  - b02831824d9bf7f15f3e970111dcf9306c44122b1844f4f1da69836952a9c2a4\r\n  - 408e38b4d81de63e5762dcb8024f81360b426429821f9934b087aa0a6b44c56f\r\n  - 708f708aca99835709342b5106b6c53ad89ccafa7476243a98ae0b94a69d5d8a\r\n  - ca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc\r\n  - a6a44ee854c846f31d15b0ca2d6001fb0bdddc85f17e2e56abb2fa9373e8cfe7\r\n  - b5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13\r\n  - 3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b\r\n  - cfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31\r\n  - 8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845\r\n  - 3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9\r\n  - 598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824\r\n  - f2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd\r\n  - b2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875\r\n  - 400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501\r\n  - d01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726\r\n  - f2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126\r\n  - 2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20\r\n  - 46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d\r\n  - a972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b\r\n  - 37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac\r\n  - 90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd\r\n  - 002aff376ec452ec35ae2930dfbb51bd40229c258611d19b86863c3b0d156705\r\n  - 08e69f21c3c60a4a9b78f580c3a55d4cfb74729705b5b7d01c1aecfd58fc49e6\r\n  - 0c47cf984afe87a14d0d4c94557864ed19b4cb52783e49ce96ebf9c2f8b52d27\r\n  - 0dc1010c3d3766158e2347d10fc78d9223c6e0e3a44aa8a76622aeff7d429ab9\r\n  - 0f745512940e0efd8f09c6d862571cba2b98fac9a9f7cf30dedcc08ace43a494\r\n  - 145dab86a43835bb37734c16756d6d64d8e5ac6b87c491c57385e27b564136b8\r\n  - 222e85e6d07bdc3a2141cdd582d3f2ed4b1ce5285731cc3f54e6202a13737f8d\r\n  - 2f2b26f2f7d164ea1f529edbc3cb8a1063b39121dad4dd19d8ee4bbbaf25ed37\r\n  - 3242183b1f0176a2e3cfb6bfef96b9d55c5a59ea9614dbde4ef89979336b5a5d\r\n  - 3e5b1116b2dfd99652a001968a05fc962974931a0596153ab0dea8e4a9982f89\r\n  - 5b22ace98b57ed19d815c49983c96a3c6ff0b2701e8167d4422c6990982abcf9\r\n  - 5ec8b7ca4461720bd69fb49b3f6cae637d8ac3bbd675da938bc5a84e9b73b395\r\n  - 840b3d4cc95dbf311f792a9f50137056deb66bfdbb55eb9f54ff381a0df65656\r\n  - 97ebd7bfad63b36b4572132f6ece359ff9991f269048c0b145411699bfe3dc34\r\n  - 9a1fd88970da3809f45cef00360d1e54ea11a70035c277c130404a67371e142d\r\n  - 9cb64d3242d2b591bd2ff13b1aadef2e6b4bf9147f4a0926613b7c9343feb312\r\n  - a46508ec9e48c256261b2d1914532a36ac7da093253320135d77581051751b75\r\n  - a7e27ff0695a4bdf58c584f48664acd3a385ccebf3a542fdd6d7383f414aa83a\r\n  - a804beddd22bb76ea207a9607ed5c888f2f640cbd9ed9a32942fcd0b8a25c4d5\r\n  - ae5ab2e887a9b46ea7819b7ebbb8163028e66882c97e75b0698dc3a69a69d7da\r\n  - b9434e5a14159c49af2d1a5a11d570f195797d6b17aa560c3dde4a5b3486bf2a\r\n  - be2be662cc821a924d5641422dd1116e99188c6923da092ca3f0f8f862bd2d2d\r\n  - d1ba365e93ff0a4f3a2cb1d657568e583e3fbd7dbb1c2c52e28f16480324e3bb\r\n  - ddfc6bb4819527b2424d6e1a84f04b67adad79401e39efbffba5b7d727e732f0\r\n  - df434f54802a6814628f30cae335c302bae7085c4e8314d71a41a47d9c410c39\r\n  - e24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4\r\n  - 026be8a873560f1496c6961f6e36c312bdda01beacb17c4b744f35ee1923d061\r\n  - 03c943f5cba11b09b9c3afa0705d4a027e5a9d81b299711740cc5aedfe4b4aa1\r\n  - 03e5e99cc8280de4663c4b65bfd26782d4975258808a63a4b20bc068008df7f5\r\n  - 059e40ba91b2b2d827c200476fcbd0fad0d43ab198d0c206c996777d27e6de65\r\n  - 0669e61e51cf43daa431d52b5461c90bdce1b1bee03b087e4406c30264dcb9a4\r\n  - 068b9a9194efacc16cf142814e79b7041b6ab3d671a95bb508dbd30061c324aa\r\n  - 0b4a90b823a581311c4acb59f35e32f81f70ca16a2538f54f4dbe03db93350df\r\n  - 0b5316d723d1ebbec9aba0c9ff6761050305d644c3eeb5291b4e2c4de9e5fa15\r\n  - 0b8d59312699739b6e6cb7aeb0f22a2eaebbb0fd898a97ef9b83e8d8e9ce67a0\r\n  - 0dd13d2d0edbcf9d1825c2bfc165876ada2e4d04e2981a0003cb6503fad2287b\r\n  - 0ddb7867e31f3f30cd1cfe74393f8ac5bbdc61538278de9219a49345f0d3af7f\r\n  - 13fed3accac4f38f28e606b110a3b7924d9c7a1a911f8c0613d0bb791e715267\r\n  - 151cf4c83722ba171ae42640e5e13af67ca06ee0a06a74afa53931acf6ac1506\r\n  - 17006d77cc1459aa3d70e4e9377edb2547a7446647aa9872c9dd9ad860ed7e39\r\n  - 1ec7e595677038145991c6d84dc7808602142f258c1f90e9486cca0fe531d74f\r\n  - 208dc592111a8221a9c633efc120b890585f9a67ed340cbb5ec9db4cd5e164e4\r\n  - 2124adbee89f2c1cb65896bed26e7ffa8bf0fcbdfeb99a9e751fea9cca7a896b\r\n  - 22e97292671ada8deef4329eb115c52f6f1bc598bcf01a3961f1c35a2230a013\r\n  - 259a78122ef51ae503059143bf36941fc6090be83213d196ba3051ba36a0b2a1\r\n  - 26564c23530dd14e0042e074f4178a5b2ad6fc8f51f10138fc39941a6303bff9\r\n  - 29453fa1772b6d7d33842d6abbe0cb55c4a4b66a00f43284c8724d7c16749a7d\r\n  - 2a072d9ce63a94d2530cf9f18a232c6a09f6c7bdff9dbe27faceef53604145ea\r\n  - 2c02d3d3fadd76f9d21f5c093459ddc0045c94f17679269eb7a2990a1a88cb42\r\n  - 2d55000bb5cb9e3e1f137810c2e1eb899f68c40e4a6f6307f226c7b8af208abd\r\n  - 2e89436b355550ceb361fac1b03b78b71eda11d25f26223ac5c8c34ed8972a05\r\n  - 32b0e6394b110860371da5541946a6dcc85358a3951eddc86fdaf5794527c150\r\n  - 33934fcfae5760316b3f40e013cbb03d8086f8c30f9a4ba9bed3f9486a530796\r\n  - 34d86602882e86f8aaaeb7513126c8579a4489f2be31c279188e2f2ca8a0e141\r\n  - 390162dae62a0347e35cf5dad093cfc2f7d4ded62fba9d2df7af6133feb41ee0\r\n  - 3ef8602579c6b145fbaafc8970b4c9a6e7bebd11eb5e37eecaa67b4572c6038b\r\n  - 420acd7e8598fe994b59bf5d30f89e1c11b36cbef464a4786694cf9eada8dd4c\r\n  - 42b4c39179f76ea9eb5835b55a3cf4d8dbb29d42ee0622ad2e89ca48d01e8988\r\n  - 42eed03907c9dfa0e566fbe5968cdb5a1b7b5e18521f7327185ed2208c6c29b4\r\n  - 47d929c69bfd8d8efb9c280eabec2f73d4bddf1c3c30120c3fb6334623469888\r\n  - 505ef8cbc1271ce32f0c473468d75a1aba5073c37b2e6b49293ddc9efcb4ac96\r\n  - 5230453eeb98c5a183129ed8b918b429e96020887302ba30941c408108a1ab84\r\n  - 5363220b532d7da378b338e839a501ae5c006cc03c8b2d3627c480d64deb1221\r\n  - 558f33d478091993e5b5921604f8c3873efc87f551fddf61612b5c64d5b610f6\r\n  - 55c76f4f93f9e155fbb6a28447f97c1ccda0081061dc3cb9973d42c1686964b7\r\n  - 56c8246819f7de5cba91001793831441d4ce998ccb8237cb96c9f52e88ea384b\r\n  - 59bddb5ccdc1c37c838c8a3d96a865a28c75b5807415fd931eaff0af931d1820\r\n  - 5ac627f8964d3b9cad69f21e3b8f27305f1f68f49e4f4fae2c73949a04b32692\r\n  - 5ccc76ae1cdf668ba7f89c6cbd0bad44f148cbee736320ead237262ba170ffba\r\n  - 5cd4401c1dae9b9ecd75c96ab29dc64ce40bef3acc6faf7c001ff98ebd3b3413\r\n  - 5cd72eaf555813f1ee187def594584f5cfc6a5e83086f35e281327b5210adffb\r\n  - 5f8293eda9fb40684caddf576eba6c81f3a06911ca9e4ecf84ede3b2891cff5e\r\n  - 6c258151c593268c13c252d8f275192a6f7a74d5de5754f2cf20fb94be7ee6ea\r\n  - 0458e168baa4fa5942892065925ac82b12245551b539d54c2884b3a21c2699d8\r\n  - 877f1de209eb9d8b2a20a76f8773d12e5a1fcde4148868c7b73added392f62f6\r\n  - 29c728a169c5d18298e77db161dd5d2f6396ceca9ee7849b63ff8a8bc11f911e\r\n  - 98e092b7bfc3bbdaeb82e05de14ba5835c6ac626c17de9eef2049796a031dd10\r\n  - 27e08fb90ada2fd8ce6b6149786edd3b814dd0324257ebd919ed66ada0334b21\r\n  - 9f651ae6ea538238748614a7f86fe2b0f76e881d6c38da581f284e4b6f79b0ca\r\n  - f47115ea58615781e56dcac673c19edf7ce00defd7ada709ae97b0708d3eac1e\r\n  - b80719854f8744ba62e9f0e774c09e2e2ed79dd37f9f94ba3ed05ec8507d55e6\r\n  - 467f04914a1e6093bdaf5c28884bf95ec738234033b3292d289a0799de196d49\r\n  - 5c47d18b3f0e0274c6a66b2eab27d47c73a0105c263d41c6473aba9a28d0a4ba\r\n  - 01c5729ac1ae3928053c085fd616323a3715863ab3d7e9b8106c09e24df34183\r\n  - 5b6a691cf8faf238b27861941a1b667d889889cc9711a3e561403d6a6ed292c9\r\n  - e2688f72cc7ae836be19e765e39318873554ee194a09945eb3f3805d04f256ca\r\n  - 9f0228e3d1577ffb2533584c2b1d87ebee0c0d490f981e61d18bb27ab02e52cb\r\n  - 2617f9301869304b88d8a3a4f7b2eab6b0edf264cc1a28b99f5685959242ec39\r\n  - f3107a5a00f36e12be7cc2e37c35903ef855b8043492af374ea918385821443c\r\n  - 63fcfab8e9b97d9aec3d6f243003ea3e2bf955523f08e6f1c0d1e28c839ee3d5\r\n  - 05cbe01b1125897e0e982c587a10a72f4df795b844a4a2c4cec44aee7f30ce94\r\n  - 5a7da102c11960b9651650143a4a08ae4ce97d68dff999961f1ffc792531afeb\r\n  - df6112e6bad4125b80b8829c13a2ca523bb82cf303cf531389d8795e7512c7e6\r\n  - e79dbcc8b60da280e53d9cf818eee1de34251e0551b9947bb2b79a31b131417e\r\n  - a73eac15797130c381b5b4a65c3fb1cfc723b1586a1882c981211787bba285a6\r\n  - 550ee89d5df17f90ba7689d957cd067dcdbe3d957c5369ea28d925e02ccc8ce6\r\n  - f77d7940c51c2a1eab849dbd77e59c683ebf7820799ef349e7da2583e1aa11ae\r\n  - 2c5d55619d2f56dc5824a4845334e7804d6d306daac1c23bec6f078f30f1c825\r\n  - 7231177a115656041ba4e5b3cf0bf7a547b074f03592351484267e25cda7c899\r\n  - d5405f99cec0166857274b6c02a7ef52b36274fedb805a17d2089fd24ed133cf\r\n  - 81921b6a7eba39a3f73895a57892ed3a46ab6365ac97d550ca3b9bff46c7a1c2\r\n  - 1eef9f8d7d3099b87be7ac25121f9d2ccacfb5ccf02b508fb2036b6e059c525f\r\n  - 5255061c3600df1a94b376fca40f3ccb69d1cb6dd42aa744b20a643c7292d20c\r\n  - 5fb7f6f953be3b65d88bd86d1391ebc9f88fc10b0ef23541463ebf5b157f695c\r\n  - 6016cf9898d74e2e9030be7c987964d817ba28ad2253d1da54c81a1bf49db836\r\n  - 621e55421dffae981e3e933c65626314d5610c7c08f76f83a3d07f0ec6c36e2d\r\n  - 6ccc24971073d24d90c4cbaf83dfbae2969cbf527e319c7ee9a4babcbe88e456\r\n  - 6f8da9180eebe02ba35317cb8aee5c8df6ac29795af70eb9430c3588d457aad6\r\n  - 71c5b899a5187baeb8f605ca39ca56bf05a63025a8f9f84c45590d8345e5d349\r\n  - 725b7d92ed66be160f2e04395008a65c72814d5ddf842d9778396f6c6679d85e\r\n  - 72d4b780a90ede7ea152f5da0973965cab31d2813fa8c2fe0e1cb611f5ca257e\r\n  - 73670d06851f588c7df44dc478f49883406697c48c618438e0f249b7a916552e\r\n  - 74e017853fbc85ee77ca7476cd25423815602aaaa02b29e0003c95c9551b8890\r\n  - 75d2367dc79d9f8aed165729df90ed5d28fefe267778dbe4d3d74aafa75d66e0\r\n  - 7a5a1c6ea0c2f017df9f06975c93a356cac20b19031fcde96136fa5881e5ef3a\r\n  - 7adb049e0b49312aea904c70e16d0e7f03d01aae4bf8ac867e8219ced4e6e057\r\n  - 7bfa85bec239b6c4419b2d57149c5960263c80e493f888d03ceaaa3f945b1b25\r\n  - 7f324b658f587b3b27921ebeba5ac25aebd669b33e6801fa9581de8c2eb0df2e\r\n  - 7fee970748eb83045e36911dafdaee0d4069ebe72c059cc7de3d65539012c2e9\r\n  - 823793a37d748ffe708864c16c853c67a5db812712481da1d24790b455163940\r\n  - 8512aabfa0175684bdbb77481d6b272b63dbc4249b04a44e1003b7d8fdea0a89\r\n  - 86c81f03cf7d8f8af38c2559dbf506cccdc25579f3b29fb574f823a67f99a0a3\r\n  - 88ae7e60b9dd57fc6b2d667ce33fb29c0f75d37eb7c837ccf56cb7994386d5ef\r\n  - 8bd40e7fe6bbd4d5810db2c142186bb58da445a132fb6f9ff01c46947a532244\r\n  - 8d38726d674279705fe06b4b45bbbaef10756c547d560cea6998e23dba09f80c\r\n  - 8db47439685edc683765abb5e6d7d0d05479bf9ee164992db9e8ce97fe43ee2f\r\n  - 95de2e16f1b05d1b45b1d182c1503568c2e5fd4a81ac52fe1bc9e881d1a272b1\r\n  - 95e3204228341852b7c97f357f799e7ec9688abe1262436b569e56397f1fd864\r\n  - 98caf00760d772598386eb8d4f26caf92fb891915ac08da6bf830be5e45278d3\r\n  - 99c9440a84cdc428ce140de901452eb334faec49f1f6258acdde1ddcbb34376e\r\n  - 9a8776e4ae38cf529bab28947b31ade84301262b7996dc37ec47afa4fb4cf6e1\r\n  - 9beb1d2a03ff2d4c15913de0f87b72074155b44df791bd967dac8155e97a0e06\r\n  - 9c8d518fbbc8cbb25fa309f5396efa5749e57a3b0158779404c8d3e92baf6596\r\n  - a064a28e5e7409a96bba93fc57f44cadc3492bb0f49792c89c973e30b0f5d498\r\n  - a194b47043356fa365d98a5f7c582b6f87fac90acf0f469ed3651cfe2fd7b2c9\r\n  - a21dfb8e8b7c8dfbeeb4d72e6ef1f22c667b8968b3a3b1dcce99f44faab05903\r\n  - a2e0fe2d385dabcdfb024100216d259ddd1fa9907e982d297846fd29b8d4d415\r\n  - a48ad33695a44de887bba8f2f3174fd8fb01a46a19e3ec9078b0118647ccf599\r\n  - a595da9a2fa58d4f8be0bfbcf7f4c950435ff5289dd1ccf2c65eec73a0afe97f\r\n  - aa860d405746401ae4155485326fdeb39718832c77c73540d48f4fbb8e596215\r\n  - ab6832a4432b4bdaec0706f7b00a369c48175eac9abc3e537032b1f5d26a993b\r\n  - ada2f0703614b3447d427827777af5d4ee9ffe9179498970326926751a4f8d65\r\n  - b16d317c11228bd3573126a0e1bc0bbf35d84a4a1f47dfb06b70634a21fd9823\r\n  - b3665548cc0f2fce3593fb7139f49588faa1d327b6d23feb564ca4194053ae8a\r\n  - b5578c48a11533871ae91e6d5632aafc25d3976c0626d62abab306663566d024\r\n  - b67a6f87fc3fd7c5c3666acac5918c8c08a53ab6a966f4d1daf38105a566ede1\r\n  - b6abc8ab631dcf52e028ab26dbe3bb94022d69193c0acc8642cbd6329cbb23ef\r\n  - b7e117eb342b0d450095805073326989c792bf5ccbbdcd5f4a9ace50e517412e\r\n  - bb14abc9b0798c7756a6ed887308a3e6210cc08a5149dc1360fdd1f5bca27cca\r\n  - bdadb319f071f02462d107380102b669e407bb2a0b20e77a9a8a5726b4cbbc4b\r\n  - bf2383cfbee4cbb0bda2614839454ab1724c9bbfff8b4b48e0f48579ae220c10\r\n  - bf52b44168de1855d83186163a2d5f29e488ddafdfd5447e211aec4a769cf74a\r\n  - c0d5cf7a0035deda5646aaf520b3ff632aa6be76ddbc88f38ddc11e77ffb40b4\r\n  - c1a82a788df7418712664138c0fdb05232036a27ab0998479d60c656998849f1\r\n  - c63a523834ab59ab5621a0acb156a9b901befe806044642fe5fec8a0ba545e70\r\n  - d05d3f3582e13eaf5f39d7143ca1a4b1367cc5267bf9958a15e27cf53e059518\r\n  - d0e456cff03c2483ded9a0f8c1b99f9fefb6ba47dcaf949dae27abe940ee20e6\r\n  - d8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385\r\n  - dada74663e3e29ee26bfd03a888f0bda9fc81e148511fa98f73f8e8a915933cc\r\n  - db3ffcbf136e0268ec66f28b30fa8ba350f74e02e8e737e61cc6ef8d8258027e\r\n  - dd26b85b6568595b1d2bbc47ce47d071ede75665fbd779d637b74663ead5539e\r\n  - df9038660164623a827a8119d4cb3d71d0a5288b12bdfdd32c72769bf90a9ea0\r\n  - dfed16e9184a86e6fcd17a98f127410840d058db667e9975b43add100c33122e\r\n  - e0063d2524a89159cf5da12661225fbb27725bbd72acd9497b7207ecf2f3aeb6\r\n  - e00c55ddda9cbb82fb47924fafdf40c3394dc1127d9901c71a69ef3ef664b817\r\n  - e14a51d69211948163ab20b0cc68adf410bb821f2890f55d2d202c745f4ec1b8\r\n  - e2e3f243bbcad666852e64202d35f6dd88c58f5d24435d92975697b0efa8a775\r\n  - e37e25739e8bc4620d9d37d8f6b400cd82c85b89d206436ba35930ed96db6eb0\r\n  - e55b5ede808b6d491f18737d6a1cf34b5178f02e9ea01d7cff31a449888dbd73\r\n  - ed28d9207acac2afff817eaa56d1599422e23946dffa4f8bade376d52a6af7d4\r\n  - eda0853e814ee31a66c3b42af45cd66019ffd61eac30e97bd34c27d79253a1bb\r\n  - f1b3e58d060803b0ff6008386bab47fb8099ac75ee74f385ac34340a28bf716e\r\n  - f2091f71227180d74ba1ba4607635e623553b1826314dca91cb31839eb00c4ea\r\n  - f214d55ccb5db5edbaafe7d40b240c79f04c70d441adee01ef438f776eb37037\r\n  - f571ddc894915dee136cf24731ff3d79fe4f811b112d122a34a128628cb43c4a\r\n  - f7676d2a28992a382475af2ae0abca4794e1397ef3327f30f7d4cbdbc2ca0a68\r\n  - f8e20894c8c18d79e80b431008aa8bef46cc10a355a4934f9cc40ffd637b8890\r\n  - fa1bf7565352099b74624c8beeff6620411e1efe00e54f8b4190f69e243d5811\r\n  - fa784f69265ebe5e150cf5956a40d86335d1a5edc57fffcc7ce6eedc591c2751\r\n  condition: hashes\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: Detecting Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)\r\ndescription: This rule detects malicious files loaded or executed on compromised machine in consequence of Malvertising Campaign related with distribution Gamaredon Group's Pteranodon (also known as Pterodo) Malware Implants and other custom-developed malware samples (IoCs - Hashes)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\n- https://twitter.com/DrunkBinary/status/1077896062214594560\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  hashes:\r\n  - a31cf8bc0753caf6cf6d3c3e5d2dd8bb\r\n  - c820ce29a6ab96e958e510e30275387c\r\n  - d0857776bb769d8777929496dfbed984\r\n  - 834c709455bfefb9b0e8976bad13a8f4\r\n  - e6fa8996d51426cec4e5006e5e527638\r\n  - 6fa05433c744d3f9a365d68d14ec32c1\r\n  - bfe9619b665d06327cd9bfbcea94ead4\r\n  - 420f4bc290b7a5becd8406843e74f013\r\n  - 51ab00c724a29198eed3cb9b50925046\r\n  - 369a82f8bb8c906b8cde4f688c08bd71\r\n  - 8f2b13948c7fda4a3f2f10b3446c0453\r\n  - 52815c0c8dd35e80f52576be8d02e620\r\n  - 3fc1cd6eade766fc989684dd1390d640\r\n  - 5725db132c2f90be2e04a48fb385a1b8\r\n  - A8734436C6948F6879BBA1DBA09D8810\r\n  - C29E524436EA9CB42F27134DE631432B\r\n  - 1118184D160F5F341A46130BDD2468F2\r\n  - 6623F573AB668B7DA9068A714968E8E9\r\n  - 8C4A0C394F83EDC9FF45EE77982A9904\r\n  - 372BF4C5942769F216316E315CC50C9D\r\n  - 7ACB1B099ADBE17A8D5194DA2637BE51\r\n  - 605fe3746f003bce8a18be1f216afb72\r\n  - 834c709455bfefb9b0e8976bad13a8f4\r\n  - e0dfc17c215b7b767370dabcb39abff8\r\n  - 8ae5f3d79c4da3741bf9388543fe7479\r\n  - 1e5446a3ee1d308a89338e18f24580bd\r\n  - d5146737484fc5f2abb02a28b5383b30\r\n  - 649e69583e86412115ecaf926b5d2b20\r\n  - f53abf8ec98d18088ae1e65c53a38320\r\n  - 31217903f050f4b05ab1c882e94d6668\r\n  - a6bac979ce2c89cdd14a51c0709ce537ad6ba0be68a01c00475d2610467fe864\r\n  - 8d46246696fc2bed3531aadc9e1bae4086bd32a39ed9d0cfb51e804a44337c38\r\n  - c4ceb4486f70c6ff244501bb727ae7c9b9a8468f4cd2ced36f0b2e11f275e8f2\r\n  - 9020402e49cb7d9dcc81b70297b1b102dca3df70ad1e50dad8814d8543990d6d\r\n  - f715505bce521c2d826f1e8237b582a2831082b5e2632600ad07c95072829a62\r\n  - a14f31e8a55d5f0b6e02a168e5561e7e402e22295edc6cf6118bb2634dcb8994\r\n  - 84db40763f9bd2de3ad90457ef9239fa325ff863cdb9d48263c5adb0cb109776\r\n  - 5f6642212d136066f89a48f13ae09a8b56a88ba3e0999e17c9d950c8eb43b800\r\n  - a866a2b490ac7215a041bf0497b75aa7dfe8f23bc8079d890cdfbf796acd2ead\r\n  - 8d10c38f77ad489f217519c6c21a74e19a047031c0148ea4e67c71065f7e6172\r\n  - 2188039c3dad554aa4a2f19b57be1a985637f4a7159dfb3e78ae30fb08f0fe7d\r\n  - 16d17d31c3937ed029ffb18beb896b2aada68130fa7e8a2127043ee72eba03e9\r\n  - 8b50e3ca06a22d0be6a71232b320137c776f80ac3f2c81b7440b43854b8a3bf0\r\n  - bb9c0df092f52d9fe3d17b4806c2c78d32fa9236a7dc70cdb6fbc3ea5c673720\r\n  - f69621f1e489c038132f0dc2861442eb469e063feaafb91c6f6ba4d84df6f011\r\n  - 47b39dbbe6f14712bee4fdff325950d7385b139b8c53a1305b6cd40a91c2512b\r\n  - 8f54983530a59da264d8b6b80048bfc321b10a101def9f4744d5aaafb7caea15\r\n  - 1b00cf03f26724d9e9cff35a8d3d2e42f2518827e9564513b348fc163de153b6\r\n  - 845f1bcb80321f9183258fdcd714a4ca61a26b02590dd02cf4bd4cb07c757cdd\r\n  - f34acc2dcdfa27eab7740cea8a6bd6e734ae75999b18f05a9b3f715347bbc5b5\r\n  - b02831824d9bf7f15f3e970111dcf9306c44122b1844f4f1da69836952a9c2a4\r\n  - 408e38b4d81de63e5762dcb8024f81360b426429821f9934b087aa0a6b44c56f\r\n  - 708f708aca99835709342b5106b6c53ad89ccafa7476243a98ae0b94a69d5d8a\r\n  - ca87eb1a21c6d4ffd782b225b178ba65463f73de6f4c736eb135be5864f556dc\r\n  - a6a44ee854c846f31d15b0ca2d6001fb0bdddc85f17e2e56abb2fa9373e8cfe7\r\n  - b5199a302f053e5e9cb7e82cc1e502b5edbf04699c2839acb514592f2eeabb13\r\n  - 3ef3a06605b462ea31b821eb76b1ea0fdf664e17d010c1d5e57284632f339d4b\r\n  - cfb8216be1a50aa3d425072942ff70f92102d4f4b155ab2cf1e7059244b99d31\r\n  - 8c9d690e765c7656152ad980edd2200b81d2afceef882ed81287fe212249f845\r\n  - 3773ddd462b01f9272656f3150f2c3de19e77199cf5fac1f44287d11593614f9\r\n  - 598c55b89e819b23eac34547ad02e5cd59e1b8fcb23b5063a251d8e8fae8b824\r\n  - f2355a66af99db5f856ebfcfeb2b9e67e5e83fff9b04cdc09ac0fabb4af556bd\r\n  - b2fb7d2977f42698ea92d1576fdd4da7ad7bb34f52a63e4066f158a4b1ffb875\r\n  - 400f53a89d08d47f608e1288d9873bf8d421fc7cd642c5e821674f38e07a1501\r\n  - d01df47b6187631c9a93bdad1298439ab1a1c5529b3319f3614b6ec2455e5726\r\n  - f2296bcb6be68dfb330baec2091fb11a42a51928ba057164213580e6ff0e1126\r\n  - 2ded2f3b5b5b6155ce818893c67887cbfa8b539be6c983e314ccf2177552da20\r\n  - 46a39da996b01e26ddd71d51c9704de2aa641cd3443f6fe0e5c485f1cd9fa65d\r\n  - a972ad0ddc00d5c04d9fe26f1748e12008efdd6524c9d2ea4e6c2d3e42d82b7b\r\n  - 37c78ee7826d63bb9219de594ed6693f18da5db60e3cbc86795bd10b296f12ac\r\n  - 90ba0f95896736b799f8651ef0600d4fa85c6c3e056e54eab5bb216327912edd\r\n  - 002aff376ec452ec35ae2930dfbb51bd40229c258611d19b86863c3b0d156705\r\n  - 08e69f21c3c60a4a9b78f580c3a55d4cfb74729705b5b7d01c1aecfd58fc49e6\r\n  - 0c47cf984afe87a14d0d4c94557864ed19b4cb52783e49ce96ebf9c2f8b52d27\r\n  - 0dc1010c3d3766158e2347d10fc78d9223c6e0e3a44aa8a76622aeff7d429ab9\r\n  - 0f745512940e0efd8f09c6d862571cba2b98fac9a9f7cf30dedcc08ace43a494\r\n  - 145dab86a43835bb37734c16756d6d64d8e5ac6b87c491c57385e27b564136b8\r\n  - 222e85e6d07bdc3a2141cdd582d3f2ed4b1ce5285731cc3f54e6202a13737f8d\r\n  - 2f2b26f2f7d164ea1f529edbc3cb8a1063b39121dad4dd19d8ee4bbbaf25ed37\r\n  - 3242183b1f0176a2e3cfb6bfef96b9d55c5a59ea9614dbde4ef89979336b5a5d\r\n  - 3e5b1116b2dfd99652a001968a05fc962974931a0596153ab0dea8e4a9982f89\r\n  - 5b22ace98b57ed19d815c49983c96a3c6ff0b2701e8167d4422c6990982abcf9\r\n  - 5ec8b7ca4461720bd69fb49b3f6cae637d8ac3bbd675da938bc5a84e9b73b395\r\n  - 840b3d4cc95dbf311f792a9f50137056deb66bfdbb55eb9f54ff381a0df65656\r\n  - 97ebd7bfad63b36b4572132f6ece359ff9991f269048c0b145411699bfe3dc34\r\n  - 9a1fd88970da3809f45cef00360d1e54ea11a70035c277c130404a67371e142d\r\n  - 9cb64d3242d2b591bd2ff13b1aadef2e6b4bf9147f4a0926613b7c9343feb312\r\n  - a46508ec9e48c256261b2d1914532a36ac7da093253320135d77581051751b75\r\n  - a7e27ff0695a4bdf58c584f48664acd3a385ccebf3a542fdd6d7383f414aa83a\r\n  - a804beddd22bb76ea207a9607ed5c888f2f640cbd9ed9a32942fcd0b8a25c4d5\r\n  - ae5ab2e887a9b46ea7819b7ebbb8163028e66882c97e75b0698dc3a69a69d7da\r\n  - b9434e5a14159c49af2d1a5a11d570f195797d6b17aa560c3dde4a5b3486bf2a\r\n  - be2be662cc821a924d5641422dd1116e99188c6923da092ca3f0f8f862bd2d2d\r\n  - d1ba365e93ff0a4f3a2cb1d657568e583e3fbd7dbb1c2c52e28f16480324e3bb\r\n  - ddfc6bb4819527b2424d6e1a84f04b67adad79401e39efbffba5b7d727e732f0\r\n  - df434f54802a6814628f30cae335c302bae7085c4e8314d71a41a47d9c410c39\r\n  - e24715900aa5c9de807b0c8f6ba8015683af26c42c66f94bee38e50a34e034c4\r\n  - 026be8a873560f1496c6961f6e36c312bdda01beacb17c4b744f35ee1923d061\r\n  - 03c943f5cba11b09b9c3afa0705d4a027e5a9d81b299711740cc5aedfe4b4aa1\r\n  - 03e5e99cc8280de4663c4b65bfd26782d4975258808a63a4b20bc068008df7f5\r\n  - 059e40ba91b2b2d827c200476fcbd0fad0d43ab198d0c206c996777d27e6de65\r\n  - 0669e61e51cf43daa431d52b5461c90bdce1b1bee03b087e4406c30264dcb9a4\r\n  - 068b9a9194efacc16cf142814e79b7041b6ab3d671a95bb508dbd30061c324aa\r\n  - 0b4a90b823a581311c4acb59f35e32f81f70ca16a2538f54f4dbe03db93350df\r\n  - 0b5316d723d1ebbec9aba0c9ff6761050305d644c3eeb5291b4e2c4de9e5fa15\r\n  - 0b8d59312699739b6e6cb7aeb0f22a2eaebbb0fd898a97ef9b83e8d8e9ce67a0\r\n  - 0dd13d2d0edbcf9d1825c2bfc165876ada2e4d04e2981a0003cb6503fad2287b\r\n  - 0ddb7867e31f3f30cd1cfe74393f8ac5bbdc61538278de9219a49345f0d3af7f\r\n  - 13fed3accac4f38f28e606b110a3b7924d9c7a1a911f8c0613d0bb791e715267\r\n  - 151cf4c83722ba171ae42640e5e13af67ca06ee0a06a74afa53931acf6ac1506\r\n  - 17006d77cc1459aa3d70e4e9377edb2547a7446647aa9872c9dd9ad860ed7e39\r\n  - 1ec7e595677038145991c6d84dc7808602142f258c1f90e9486cca0fe531d74f\r\n  - 208dc592111a8221a9c633efc120b890585f9a67ed340cbb5ec9db4cd5e164e4\r\n  - 2124adbee89f2c1cb65896bed26e7ffa8bf0fcbdfeb99a9e751fea9cca7a896b\r\n  - 22e97292671ada8deef4329eb115c52f6f1bc598bcf01a3961f1c35a2230a013\r\n  - 259a78122ef51ae503059143bf36941fc6090be83213d196ba3051ba36a0b2a1\r\n  - 26564c23530dd14e0042e074f4178a5b2ad6fc8f51f10138fc39941a6303bff9\r\n  - 29453fa1772b6d7d33842d6abbe0cb55c4a4b66a00f43284c8724d7c16749a7d\r\n  - 2a072d9ce63a94d2530cf9f18a232c6a09f6c7bdff9dbe27faceef53604145ea\r\n  - 2c02d3d3fadd76f9d21f5c093459ddc0045c94f17679269eb7a2990a1a88cb42\r\n  - 2d55000bb5cb9e3e1f137810c2e1eb899f68c40e4a6f6307f226c7b8af208abd\r\n  - 2e89436b355550ceb361fac1b03b78b71eda11d25f26223ac5c8c34ed8972a05\r\n  - 32b0e6394b110860371da5541946a6dcc85358a3951eddc86fdaf5794527c150\r\n  - 33934fcfae5760316b3f40e013cbb03d8086f8c30f9a4ba9bed3f9486a530796\r\n  - 34d86602882e86f8aaaeb7513126c8579a4489f2be31c279188e2f2ca8a0e141\r\n  - 390162dae62a0347e35cf5dad093cfc2f7d4ded62fba9d2df7af6133feb41ee0\r\n  - 3ef8602579c6b145fbaafc8970b4c9a6e7bebd11eb5e37eecaa67b4572c6038b\r\n  - 420acd7e8598fe994b59bf5d30f89e1c11b36cbef464a4786694cf9eada8dd4c\r\n  - 42b4c39179f76ea9eb5835b55a3cf4d8dbb29d42ee0622ad2e89ca48d01e8988\r\n  - 42eed03907c9dfa0e566fbe5968cdb5a1b7b5e18521f7327185ed2208c6c29b4\r\n  - 47d929c69bfd8d8efb9c280eabec2f73d4bddf1c3c30120c3fb6334623469888\r\n  - 505ef8cbc1271ce32f0c473468d75a1aba5073c37b2e6b49293ddc9efcb4ac96\r\n  - 5230453eeb98c5a183129ed8b918b429e96020887302ba30941c408108a1ab84\r\n  - 5363220b532d7da378b338e839a501ae5c006cc03c8b2d3627c480d64deb1221\r\n  - 558f33d478091993e5b5921604f8c3873efc87f551fddf61612b5c64d5b610f6\r\n  - 55c76f4f93f9e155fbb6a28447f97c1ccda0081061dc3cb9973d42c1686964b7\r\n  - 56c8246819f7de5cba91001793831441d4ce998ccb8237cb96c9f52e88ea384b\r\n  - 59bddb5ccdc1c37c838c8a3d96a865a28c75b5807415fd931eaff0af931d1820\r\n  - 5ac627f8964d3b9cad69f21e3b8f27305f1f68f49e4f4fae2c73949a04b32692\r\n  - 5ccc76ae1cdf668ba7f89c6cbd0bad44f148cbee736320ead237262ba170ffba\r\n  - 5cd4401c1dae9b9ecd75c96ab29dc64ce40bef3acc6faf7c001ff98ebd3b3413\r\n  - 5cd72eaf555813f1ee187def594584f5cfc6a5e83086f35e281327b5210adffb\r\n  - 5f8293eda9fb40684caddf576eba6c81f3a06911ca9e4ecf84ede3b2891cff5e\r\n  - 6c258151c593268c13c252d8f275192a6f7a74d5de5754f2cf20fb94be7ee6ea\r\n  - 0458e168baa4fa5942892065925ac82b12245551b539d54c2884b3a21c2699d8\r\n  - 877f1de209eb9d8b2a20a76f8773d12e5a1fcde4148868c7b73added392f62f6\r\n  - 29c728a169c5d18298e77db161dd5d2f6396ceca9ee7849b63ff8a8bc11f911e\r\n  - 98e092b7bfc3bbdaeb82e05de14ba5835c6ac626c17de9eef2049796a031dd10\r\n  - 27e08fb90ada2fd8ce6b6149786edd3b814dd0324257ebd919ed66ada0334b21\r\n  - 9f651ae6ea538238748614a7f86fe2b0f76e881d6c38da581f284e4b6f79b0ca\r\n  - f47115ea58615781e56dcac673c19edf7ce00defd7ada709ae97b0708d3eac1e\r\n  - b80719854f8744ba62e9f0e774c09e2e2ed79dd37f9f94ba3ed05ec8507d55e6\r\n  - 467f04914a1e6093bdaf5c28884bf95ec738234033b3292d289a0799de196d49\r\n  - 5c47d18b3f0e0274c6a66b2eab27d47c73a0105c263d41c6473aba9a28d0a4ba\r\n  - 01c5729ac1ae3928053c085fd616323a3715863ab3d7e9b8106c09e24df34183\r\n  - 5b6a691cf8faf238b27861941a1b667d889889cc9711a3e561403d6a6ed292c9\r\n  - e2688f72cc7ae836be19e765e39318873554ee194a09945eb3f3805d04f256ca\r\n  - 9f0228e3d1577ffb2533584c2b1d87ebee0c0d490f981e61d18bb27ab02e52cb\r\n  - 2617f9301869304b88d8a3a4f7b2eab6b0edf264cc1a28b99f5685959242ec39\r\n  - f3107a5a00f36e12be7cc2e37c35903ef855b8043492af374ea918385821443c\r\n  - 63fcfab8e9b97d9aec3d6f243003ea3e2bf955523f08e6f1c0d1e28c839ee3d5\r\n  - 05cbe01b1125897e0e982c587a10a72f4df795b844a4a2c4cec44aee7f30ce94\r\n  - 5a7da102c11960b9651650143a4a08ae4ce97d68dff999961f1ffc792531afeb\r\n  - df6112e6bad4125b80b8829c13a2ca523bb82cf303cf531389d8795e7512c7e6\r\n  - e79dbcc8b60da280e53d9cf818eee1de34251e0551b9947bb2b79a31b131417e\r\n  - a73eac15797130c381b5b4a65c3fb1cfc723b1586a1882c981211787bba285a6\r\n  - 550ee89d5df17f90ba7689d957cd067dcdbe3d957c5369ea28d925e02ccc8ce6\r\n  - f77d7940c51c2a1eab849dbd77e59c683ebf7820799ef349e7da2583e1aa11ae\r\n  - 2c5d55619d2f56dc5824a4845334e7804d6d306daac1c23bec6f078f30f1c825\r\n  - 7231177a115656041ba4e5b3cf0bf7a547b074f03592351484267e25cda7c899\r\n  - d5405f99cec0166857274b6c02a7ef52b36274fedb805a17d2089fd24ed133cf\r\n  - 81921b6a7eba39a3f73895a57892ed3a46ab6365ac97d550ca3b9bff46c7a1c2\r\n  - 1eef9f8d7d3099b87be7ac25121f9d2ccacfb5ccf02b508fb2036b6e059c525f\r\n  - 5255061c3600df1a94b376fca40f3ccb69d1cb6dd42aa744b20a643c7292d20c\r\n  - 5fb7f6f953be3b65d88bd86d1391ebc9f88fc10b0ef23541463ebf5b157f695c\r\n  - 6016cf9898d74e2e9030be7c987964d817ba28ad2253d1da54c81a1bf49db836\r\n  - 621e55421dffae981e3e933c65626314d5610c7c08f76f83a3d07f0ec6c36e2d\r\n  - 6ccc24971073d24d90c4cbaf83dfbae2969cbf527e319c7ee9a4babcbe88e456\r\n  - 6f8da9180eebe02ba35317cb8aee5c8df6ac29795af70eb9430c3588d457aad6\r\n  - 71c5b899a5187baeb8f605ca39ca56bf05a63025a8f9f84c45590d8345e5d349\r\n  - 725b7d92ed66be160f2e04395008a65c72814d5ddf842d9778396f6c6679d85e\r\n  - 72d4b780a90ede7ea152f5da0973965cab31d2813fa8c2fe0e1cb611f5ca257e\r\n  - 73670d06851f588c7df44dc478f49883406697c48c618438e0f249b7a916552e\r\n  - 74e017853fbc85ee77ca7476cd25423815602aaaa02b29e0003c95c9551b8890\r\n  - 75d2367dc79d9f8aed165729df90ed5d28fefe267778dbe4d3d74aafa75d66e0\r\n  - 7a5a1c6ea0c2f017df9f06975c93a356cac20b19031fcde96136fa5881e5ef3a\r\n  - 7adb049e0b49312aea904c70e16d0e7f03d01aae4bf8ac867e8219ced4e6e057\r\n  - 7bfa85bec239b6c4419b2d57149c5960263c80e493f888d03ceaaa3f945b1b25\r\n  - 7f324b658f587b3b27921ebeba5ac25aebd669b33e6801fa9581de8c2eb0df2e\r\n  - 7fee970748eb83045e36911dafdaee0d4069ebe72c059cc7de3d65539012c2e9\r\n  - 823793a37d748ffe708864c16c853c67a5db812712481da1d24790b455163940\r\n  - 8512aabfa0175684bdbb77481d6b272b63dbc4249b04a44e1003b7d8fdea0a89\r\n  - 86c81f03cf7d8f8af38c2559dbf506cccdc25579f3b29fb574f823a67f99a0a3\r\n  - 88ae7e60b9dd57fc6b2d667ce33fb29c0f75d37eb7c837ccf56cb7994386d5ef\r\n  - 8bd40e7fe6bbd4d5810db2c142186bb58da445a132fb6f9ff01c46947a532244\r\n  - 8d38726d674279705fe06b4b45bbbaef10756c547d560cea6998e23dba09f80c\r\n  - 8db47439685edc683765abb5e6d7d0d05479bf9ee164992db9e8ce97fe43ee2f\r\n  - 95de2e16f1b05d1b45b1d182c1503568c2e5fd4a81ac52fe1bc9e881d1a272b1\r\n  - 95e3204228341852b7c97f357f799e7ec9688abe1262436b569e56397f1fd864\r\n  - 98caf00760d772598386eb8d4f26caf92fb891915ac08da6bf830be5e45278d3\r\n  - 99c9440a84cdc428ce140de901452eb334faec49f1f6258acdde1ddcbb34376e\r\n  - 9a8776e4ae38cf529bab28947b31ade84301262b7996dc37ec47afa4fb4cf6e1\r\n  - 9beb1d2a03ff2d4c15913de0f87b72074155b44df791bd967dac8155e97a0e06\r\n  - 9c8d518fbbc8cbb25fa309f5396efa5749e57a3b0158779404c8d3e92baf6596\r\n  - a064a28e5e7409a96bba93fc57f44cadc3492bb0f49792c89c973e30b0f5d498\r\n  - a194b47043356fa365d98a5f7c582b6f87fac90acf0f469ed3651cfe2fd7b2c9\r\n  - a21dfb8e8b7c8dfbeeb4d72e6ef1f22c667b8968b3a3b1dcce99f44faab05903\r\n  - a2e0fe2d385dabcdfb024100216d259ddd1fa9907e982d297846fd29b8d4d415\r\n  - a48ad33695a44de887bba8f2f3174fd8fb01a46a19e3ec9078b0118647ccf599\r\n  - a595da9a2fa58d4f8be0bfbcf7f4c950435ff5289dd1ccf2c65eec73a0afe97f\r\n  - aa860d405746401ae4155485326fdeb39718832c77c73540d48f4fbb8e596215\r\n  - ab6832a4432b4bdaec0706f7b00a369c48175eac9abc3e537032b1f5d26a993b\r\n  - ada2f0703614b3447d427827777af5d4ee9ffe9179498970326926751a4f8d65\r\n  - b16d317c11228bd3573126a0e1bc0bbf35d84a4a1f47dfb06b70634a21fd9823\r\n  - b3665548cc0f2fce3593fb7139f49588faa1d327b6d23feb564ca4194053ae8a\r\n  - b5578c48a11533871ae91e6d5632aafc25d3976c0626d62abab306663566d024\r\n  - b67a6f87fc3fd7c5c3666acac5918c8c08a53ab6a966f4d1daf38105a566ede1\r\n  - b6abc8ab631dcf52e028ab26dbe3bb94022d69193c0acc8642cbd6329cbb23ef\r\n  - b7e117eb342b0d450095805073326989c792bf5ccbbdcd5f4a9ace50e517412e\r\n  - bb14abc9b0798c7756a6ed887308a3e6210cc08a5149dc1360fdd1f5bca27cca\r\n  - bdadb319f071f02462d107380102b669e407bb2a0b20e77a9a8a5726b4cbbc4b\r\n  - bf2383cfbee4cbb0bda2614839454ab1724c9bbfff8b4b48e0f48579ae220c10\r\n  - bf52b44168de1855d83186163a2d5f29e488ddafdfd5447e211aec4a769cf74a\r\n  - c0d5cf7a0035deda5646aaf520b3ff632aa6be76ddbc88f38ddc11e77ffb40b4\r\n  - c1a82a788df7418712664138c0fdb05232036a27ab0998479d60c656998849f1\r\n  - c63a523834ab59ab5621a0acb156a9b901befe806044642fe5fec8a0ba545e70\r\n  - d05d3f3582e13eaf5f39d7143ca1a4b1367cc5267bf9958a15e27cf53e059518\r\n  - d0e456cff03c2483ded9a0f8c1b99f9fefb6ba47dcaf949dae27abe940ee20e6\r\n  - d8a01f69840c07ace6ae33e2f76e832c22d4513c07e252b6730b6de51c2e4385\r\n  - dada74663e3e29ee26bfd03a888f0bda9fc81e148511fa98f73f8e8a915933cc\r\n  - db3ffcbf136e0268ec66f28b30fa8ba350f74e02e8e737e61cc6ef8d8258027e\r\n  - dd26b85b6568595b1d2bbc47ce47d071ede75665fbd779d637b74663ead5539e\r\n  - df9038660164623a827a8119d4cb3d71d0a5288b12bdfdd32c72769bf90a9ea0\r\n  - dfed16e9184a86e6fcd17a98f127410840d058db667e9975b43add100c33122e\r\n  - e0063d2524a89159cf5da12661225fbb27725bbd72acd9497b7207ecf2f3aeb6\r\n  - e00c55ddda9cbb82fb47924fafdf40c3394dc1127d9901c71a69ef3ef664b817\r\n  - e14a51d69211948163ab20b0cc68adf410bb821f2890f55d2d202c745f4ec1b8\r\n  - e2e3f243bbcad666852e64202d35f6dd88c58f5d24435d92975697b0efa8a775\r\n  - e37e25739e8bc4620d9d37d8f6b400cd82c85b89d206436ba35930ed96db6eb0\r\n  - e55b5ede808b6d491f18737d6a1cf34b5178f02e9ea01d7cff31a449888dbd73\r\n  - ed28d9207acac2afff817eaa56d1599422e23946dffa4f8bade376d52a6af7d4\r\n  - eda0853e814ee31a66c3b42af45cd66019ffd61eac30e97bd34c27d79253a1bb\r\n  - f1b3e58d060803b0ff6008386bab47fb8099ac75ee74f385ac34340a28bf716e\r\n  - f2091f71227180d74ba1ba4607635e623553b1826314dca91cb31839eb00c4ea\r\n  - f214d55ccb5db5edbaafe7d40b240c79f04c70d441adee01ef438f776eb37037\r\n  - f571ddc894915dee136cf24731ff3d79fe4f811b112d122a34a128628cb43c4a\r\n  - f7676d2a28992a382475af2ae0abca4794e1397ef3327f30f7d4cbdbc2ca0a68\r\n  - f8e20894c8c18d79e80b431008aa8bef46cc10a355a4934f9cc40ffd637b8890\r\n  - fa1bf7565352099b74624c8beeff6620411e1efe00e54f8b4190f69e243d5811\r\n  - fa784f69265ebe5e150cf5956a40d86335d1a5edc57fffcc7ce6eedc591c2751\r\n  condition: hashes\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "TZ3knmUBtApo-eN_muPY": {"category": 5, "updated": "2018-10-25T12:40:07.000Z", "hash": "e613ce73545ae45209c30b012a77d0fcd86026c94be2f276ea70bc369b44a42b", "title": "Windows PowerShell WebDav User Agent", "permission_id": 3, "title_keyword": "Windows PowerShell WebDav User Agent", "released": "2018-04-09T06:37:30.000Z", "sigma_text": "title: Windows PowerShell WebDav User Agent\r\nstatus: experimental\r\ndescription: Detects Windows PowerShell Web Access\r\nreferences:\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\nauthor: Florian Roth\r\ndate: 2018/04/06\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: Microsoft-WebDAV-MiniRedir/*\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Administrative scripts that download files from the Internet\r\n- Administrative scripts that retrieve certain website contents\r\nlevel: high", "git_filepath": "/proxy/proxy_powershell_download_webdav.yml", "sigma_text_keyword": "title: Windows PowerShell WebDav User Agent\r\nstatus: experimental\r\ndescription: Detects Windows PowerShell Web Access\r\nreferences:\r\n- https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\r\nauthor: Florian Roth\r\ndate: 2018/04/06\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: Microsoft-WebDAV-MiniRedir/*\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Administrative scripts that download files from the Internet\r\n- Administrative scripts that retrieve certain website contents\r\nlevel: high"}, "R53knmUBtApo-eN_oORg": {"category": 8, "updated": "2018-10-26T14:40:07.000Z", "hash": "63492ecf077e4fec098172045038fd365bd77beeb07a2c9739079f249c7e8df9", "title": "Suspicious Reconnaissance Activity (Sysmon).", "permission_id": 3, "title_keyword": "Suspicious Reconnaissance Activity (Sysmon).", "released": "2018-09-07T12:33:34.000Z", "sigma_text": "title: Suspicious Reconnaissance Activity (Sysmon).\r\ndescription: Detects suspicious command line activity on Windows systems.\r\nauthor: Florian Roth, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - net group \"domain admins\" /domain\r\n    - net localgroup administrators\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- Inventory tool runs\r\n- Penetration tests\r\n- Administrative activity\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Suspicious Reconnaissance Activity (Sysmon).\r\ndescription: Detects suspicious command line activity on Windows systems.\r\nauthor: Florian Roth, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - net group \"domain admins\" /domain\r\n    - net localgroup administrators\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\nfalsepositives:\r\n- Inventory tool runs\r\n- Penetration tests\r\n- Administrative activity\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059"}, "vZ3knmUBtApo-eN_iuDd": {"category": 5, "updated": "2019-02-26T14:33:49.000Z", "hash": "066e6e35fc60560b8c5a33fa071cd11887e94c9264aabfaabb7ebce47d6ce1d6", "title": "Exploit Framework User Agent", "permission_id": 3, "title_keyword": "Exploit Framework User Agent", "released": "2017-07-08T15:59:05.000Z", "sigma_text": "title: Exploit Framework User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs\r\nreferences:\r\n- https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Internet Explorer *\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)\r\n    - Mozilla/4.0 (compatible; Metasploit RSPEC)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13\r\n    - Mozilla/5.0\r\n    - Mozilla/4.0 (compatible; SPIPE/1.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0\r\n    - Sametime Community Agent\r\n    - X-FORWARDED-FOR\r\n    - DotDotPwn v2.1\r\n    - SIPDROID\r\n    - Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)\r\n    - '*wordpress hash grabber*'\r\n    - '*exploit*'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/proxy/proxy_ua_frameworks.yml", "sigma_text_keyword": "title: Exploit Framework User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs\r\nreferences:\r\n- https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - Internet Explorer *\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)\r\n    - Mozilla/4.0 (compatible; Metasploit RSPEC)\r\n    - Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\r\n    - Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\r\n    - Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)\r\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N\r\n    - Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\r\n    - Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13\r\n    - Mozilla/5.0\r\n    - Mozilla/4.0 (compatible; SPIPE/1.0\r\n    - Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0\r\n    - Sametime Community Agent\r\n    - X-FORWARDED-FOR\r\n    - DotDotPwn v2.1\r\n    - SIPDROID\r\n    - Mozilla/5.0 (Windows NT 10.0; Win32; x32; rv:60.0)\r\n    - '*wordpress hash grabber*'\r\n    - '*exploit*'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "d21Jo2gBFVBAemBceN3V": {"category": 8, "updated": "2019-01-31T09:42:07.000Z", "hash": "8a9f07a586bb4d3e162570b9e253541a419ec5d979955cc831bfc35a8778c5a2", "title": "Rubeus Hack Tool (Windows Security)", "permission_id": 3, "title_keyword": "Rubeus Hack Tool (Windows Security)", "released": "2019-01-31T09:42:07.000Z", "sigma_text": "title: Rubeus Hack Tool (Windows Security)\r\nstatus: experimental\r\ndescription: Detects command line parameters used by Rubeus hack tool\r\nreferences:\r\n- https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/\r\ntags:\r\n- attack.t1003\r\n- attack.Credential Access\r\n- attack.Lateral Movement\r\n- attack.t1075\r\n- attack.t1097\r\nauthor: Florian Roth, Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '* asreproast *'\r\n    - '* dump /service:krbtgt *'\r\n    - '* kerberoast *'\r\n    - '* createnetonly /program:*'\r\n    - '* ptt /ticket:*'\r\n    - '* /impersonateuser:*'\r\n    - '* renew /ticket:*'\r\n    - '* asktgt /user:*'\r\n    - '* harvest /interval:*'\r\n  condition: selection\r\nlevel: high", "git_filepath": "", "sigma_text_keyword": "title: Rubeus Hack Tool (Windows Security)\r\nstatus: experimental\r\ndescription: Detects command line parameters used by Rubeus hack tool\r\nreferences:\r\n- https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/\r\ntags:\r\n- attack.t1003\r\n- attack.Credential Access\r\n- attack.Lateral Movement\r\n- attack.t1075\r\n- attack.t1097\r\nauthor: Florian Roth, Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '* asreproast *'\r\n    - '* dump /service:krbtgt *'\r\n    - '* kerberoast *'\r\n    - '* createnetonly /program:*'\r\n    - '* ptt /ticket:*'\r\n    - '* /impersonateuser:*'\r\n    - '* renew /ticket:*'\r\n    - '* asktgt /user:*'\r\n    - '* harvest /interval:*'\r\n  condition: selection\r\nlevel: high"}, "4J3knmUBtApo-eN_nuMF": {"category": 11, "updated": "2019-02-26T15:22:06.000Z", "hash": "f6a0afcbede2f5f5fcfd7c372dbecbaa55127777ef47fd922d16f89531eb670d", "title": "Microsoft Malware Protection Engine Crash", "permission_id": 3, "title_keyword": "Microsoft Malware Protection Engine Crash", "released": "2017-05-09T20:46:57.000Z", "sigma_text": "title: Microsoft Malware Protection Engine Crash\r\ndescription: This rule detects a suspicious crash of the Microsoft Malware Protection Engine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1211\r\nstatus: experimental\r\ndate: 2017/05/09\r\nreferences:\r\n- https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5\r\n- https://technet.microsoft.com/en-us/library/security/4022344\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  selection1:\r\n    Source: Application Error\r\n    EventID: 1000\r\n  selection2:\r\n    Source: Windows Error Reporting\r\n    EventID: 1001\r\n  keywords:\r\n  - MsMpEng.exe\r\n  - mpengine.dll\r\n  condition: selection1 or selection2 and keywords\r\nfalsepositives:\r\n- MsMpEng.exe can crash when C:\\ is full\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_msmpeng_crash.yml", "sigma_text_keyword": "title: Microsoft Malware Protection Engine Crash\r\ndescription: This rule detects a suspicious crash of the Microsoft Malware Protection Engine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1211\r\nstatus: experimental\r\ndate: 2017/05/09\r\nreferences:\r\n- https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5\r\n- https://technet.microsoft.com/en-us/library/security/4022344\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  selection1:\r\n    Source: Application Error\r\n    EventID: 1000\r\n  selection2:\r\n    Source: Windows Error Reporting\r\n    EventID: 1001\r\n  keywords:\r\n  - MsMpEng.exe\r\n  - mpengine.dll\r\n  condition: selection1 or selection2 and keywords\r\nfalsepositives:\r\n- MsMpEng.exe can crash when C:\\ is full\r\nlevel: high"}, "xp3knmUBtApo-eN_i-AJ": {"category": 15, "updated": "2018-10-25T13:31:43.000Z", "hash": "38dbe2201855d1130f45e1b05210bb8f5e576a17b9d9586e4eac6761fe8de47d", "title": "Password Dumper Remote Thread in LSASS", "permission_id": 3, "title_keyword": "Password Dumper Remote Thread in LSASS", "released": "2017-02-12T14:50:39.000Z", "sigma_text": "title: Password Dumper Remote Thread in LSASS\r\ndescription: Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundrets of events.\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"8\"\r\n    TargetImage: C:\\Windows\\System32\\lsass.exe\r\n    StartModule: \"\"\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_password_dumper_lsass.yml", "sigma_text_keyword": "title: Password Dumper Remote Thread in LSASS\r\ndescription: Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundrets of events.\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"8\"\r\n    TargetImage: C:\\Windows\\System32\\lsass.exe\r\n    StartModule: \"\"\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "aZ3knmUBtApo-eN_lOLu": {"category": 15, "updated": "2019-02-26T13:36:51.000Z", "hash": "a3ff5555d6c2e60534c2367969b40257e10699789b4ca979aac3e366d20da0f0", "title": "Suspicious PowerShell Parameter Substring", "permission_id": 3, "title_keyword": "Suspicious PowerShell Parameter Substring", "released": "2017-03-13T16:23:25.000Z", "sigma_text": "title: Suspicious PowerShell Parameter Substring\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation with a parameter substring\r\nreferences:\r\n- http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth, Daniel Bohannon\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  keywords:\r\n    Image: '*\\powershell.exe'\r\n  substrings:\r\n  - ' -windowstyle h '\r\n  - ' -windowstyl h'\r\n  - ' -windowsty h'\r\n  - ' -windowst h'\r\n  - ' -windows h'\r\n  - ' -windo h'\r\n  - ' -wind h'\r\n  - ' -win h'\r\n  - ' -wi h'\r\n  - ' -win h '\r\n  - ' -win hi '\r\n  - ' -win hid '\r\n  - ' -win hidd '\r\n  - ' -win hidde '\r\n  - ' -NoPr '\r\n  - ' -NoPro '\r\n  - ' -NoProf '\r\n  - ' -NoProfi '\r\n  - ' -NoProfil '\r\n  - ' -nonin '\r\n  - ' -nonint '\r\n  - ' -noninte '\r\n  - ' -noninter '\r\n  - ' -nonintera '\r\n  - ' -noninterac '\r\n  - ' -noninteract '\r\n  - ' -noninteracti '\r\n  - ' -noninteractiv '\r\n  - ' -ec '\r\n  - ' -encodedComman '\r\n  - ' -encodedComma '\r\n  - ' -encodedComm '\r\n  - ' -encodedCom '\r\n  - ' -encodedCo '\r\n  - ' -encodedC '\r\n  - ' -encoded '\r\n  - ' -encode '\r\n  - ' -encod '\r\n  - ' -enco '\r\n  - ' -en '\r\n  condition: keywords and substrings\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_powershell_suspicious_parameter_variation.yml", "sigma_text_keyword": "title: Suspicious PowerShell Parameter Substring\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell invocation with a parameter substring\r\nreferences:\r\n- http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth, Daniel Bohannon\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  keywords:\r\n    Image: '*\\powershell.exe'\r\n  substrings:\r\n  - ' -windowstyle h '\r\n  - ' -windowstyl h'\r\n  - ' -windowsty h'\r\n  - ' -windowst h'\r\n  - ' -windows h'\r\n  - ' -windo h'\r\n  - ' -wind h'\r\n  - ' -win h'\r\n  - ' -wi h'\r\n  - ' -win h '\r\n  - ' -win hi '\r\n  - ' -win hid '\r\n  - ' -win hidd '\r\n  - ' -win hidde '\r\n  - ' -NoPr '\r\n  - ' -NoPro '\r\n  - ' -NoProf '\r\n  - ' -NoProfi '\r\n  - ' -NoProfil '\r\n  - ' -nonin '\r\n  - ' -nonint '\r\n  - ' -noninte '\r\n  - ' -noninter '\r\n  - ' -nonintera '\r\n  - ' -noninterac '\r\n  - ' -noninteract '\r\n  - ' -noninteracti '\r\n  - ' -noninteractiv '\r\n  - ' -ec '\r\n  - ' -encodedComman '\r\n  - ' -encodedComma '\r\n  - ' -encodedComm '\r\n  - ' -encodedCom '\r\n  - ' -encodedCo '\r\n  - ' -encodedC '\r\n  - ' -encoded '\r\n  - ' -encode '\r\n  - ' -encod '\r\n  - ' -enco '\r\n  - ' -en '\r\n  condition: keywords and substrings\r\nfalsepositives:\r\n- Penetration tests\r\nlevel: high"}, "E53knmUBtApo-eN_k-Il": {"category": 14, "updated": "2019-02-26T13:37:21.000Z", "hash": "c18b896c05f31ebc459311064dffb626a04271252e00e6a929f8fca406db2b0a", "title": "PowerShell Downgrade Attack", "permission_id": 3, "title_keyword": "PowerShell Downgrade Attack", "released": "2017-03-22T10:17:46.000Z", "sigma_text": "title: PowerShell Downgrade Attack\r\nstatus: experimental\r\ndescription: Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0\r\nreferences:\r\n- http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth, Lee Holmes\r\nlogsource:\r\n  product: windows\r\n  service: powershell-classic\r\ndetection:\r\n  selection:\r\n    EventID: 400\r\n    EngineVersion: 2.*\r\n  filter:\r\n    HostVersion: 2.*\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Penetration Test\r\n- Unknown\r\nlevel: medium", "git_filepath": "/windows/powershell/powershell_downgrade_attack.yml", "sigma_text_keyword": "title: PowerShell Downgrade Attack\r\nstatus: experimental\r\ndescription: Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0\r\nreferences:\r\n- http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth, Lee Holmes\r\nlogsource:\r\n  product: windows\r\n  service: powershell-classic\r\ndetection:\r\n  selection:\r\n    EventID: 400\r\n    EngineVersion: 2.*\r\n  filter:\r\n    HostVersion: 2.*\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Penetration Test\r\n- Unknown\r\nlevel: medium"}, "9G4PJGkBFVBAemBcx0vi": {"category": 11, "updated": "2019-02-26T12:12:36.000Z", "hash": "8e09524076e5794d035b4561232913807c3633f948014f48c4e41059546e8b6e", "title": "WMI Persistence - Script Event Consumer.", "permission_id": 3, "title_keyword": "WMI Persistence - Script Event Consumer.", "released": "2019-02-25T09:50:07.000Z", "sigma_text": "title: WMI Persistence - Script Event Consumer.\r\ndescription: Detects WMI script event consumers.\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nstatus: experimental\r\nauthor: Thomas Patzke, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/03/07\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n    ParentImage: C:\\Windows\\System32\\svchost.exe\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    New Process Name: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n    Creator Process Name: C:\\Windows\\System32\\svchost.exe\r\n  condition: selection\r\nlevel: high\r\nfalsepositives:\r\n- Legitimate event consumers\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.t1047", "git_filepath": "/windows/builtin/win_wmi_persistence_script_event_consumer.yml", "sigma_text_keyword": "title: WMI Persistence - Script Event Consumer.\r\ndescription: Detects WMI script event consumers.\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nstatus: experimental\r\nauthor: Thomas Patzke, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/03/07\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n    ParentImage: C:\\Windows\\System32\\svchost.exe\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    New Process Name: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\r\n    Creator Process Name: C:\\Windows\\System32\\svchost.exe\r\n  condition: selection\r\nlevel: high\r\nfalsepositives:\r\n- Legitimate event consumers\r\ntags:\r\n- attack.execution\r\n- attack.persistence\r\n- attack.t1047"}, "UCWCK2cBqjf_D59H8Yfp": {"category": 8, "updated": "2019-01-02T14:53:40.000Z", "hash": "817f2542a24238016eda5656d132900e5cb75495787b2f8fd750e37150058af9", "title": "HIDDEN COBRA FASTCash Malware (Sysmon).", "permission_id": 3, "title_keyword": "HIDDEN COBRA FASTCash Malware (Sysmon).", "released": "2018-11-19T13:57:34.000Z", "sigma_text": "title: HIDDEN COBRA FASTCash Malware (Sysmon).\r\ndescription: HIDDEN COBRA FASTCash Malware Detector for Sysmon.\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://www.us-cert.gov/ncas/analysis-reports/AR18-275A\r\ndate: 2018/10/02\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba\r\n    - 3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c\r\n    - 4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756\r\n    - 820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6\r\n    - a9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc\r\n    - ab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\r\n    - ca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c\r\n    - d465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\r\n    - e03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\r\n    - f3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2\r\n    - 1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d\r\n    - 9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1035\r\n- attack.t1177", "git_filepath": "", "sigma_text_keyword": "title: HIDDEN COBRA FASTCash Malware (Sysmon).\r\ndescription: HIDDEN COBRA FASTCash Malware Detector for Sysmon.\r\nstatus: stable\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://www.us-cert.gov/ncas/analysis-reports/AR18-275A\r\ndate: 2018/10/02\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 10ac312c8dd02e417dd24d53c99525c29d74dcbc84730351ad7a4e0a4b1a0eba\r\n    - 3a5ba44f140821849de2d82d5a137c3bb5a736130dddb86b296d94e6b421594c\r\n    - 4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756\r\n    - 820ca1903a30516263d630c7c08f2b95f7b65dffceb21129c51c9e21cf9551c6\r\n    - a9bc09a17d55fc790568ac864e3885434a43c33834551e027adb1896a463aafc\r\n    - ab88f12f0a30b4601dc26dbae57646efb77d5c6382fb25522c529437e5428629\r\n    - ca9ab48d293cc84092e8db8f0ca99cb155b30c61d32a1da7cd3687de454fe86c\r\n    - d465637518024262c063f4a82d799a4e40ff3381014972f24ea18bc23c3b27ee\r\n    - e03dc5f1447f243cf1f305c58d95000ef4e7dbcc5c4e91154daa5acd83fea9a8\r\n    - f3e521996c85c0cdb2bfb3a0fd91eb03e25ba6feef2ba3a1da844f1b17278dd2\r\n    - 1f2cd2bc23556fb84a51467fedb89cbde7a5883f49e3cfd75a241a6f08a42d6d\r\n    - 9ddacbcd0700dc4b9babcd09ac1cebe23a0035099cb612e6c85ff4dffd087a26\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1035\r\n- attack.t1177"}, "JZ3knmUBtApo-eN_q-am": {"category": 8, "updated": "2018-10-26T14:45:47.000Z", "hash": "b329074e884eeb780ace42fea802ed61d0ade387de237ee5150caf517d960085", "title": "bcdedit off (Sysmon).", "permission_id": 3, "title_keyword": "bcdedit off (Sysmon).", "released": "2018-09-07T12:39:31.000Z", "sigma_text": "title: bcdedit off (Sysmon).\r\ndescription: Detects usage of bcdedit off.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - bcdedit.exe\r\n    Command_Line:\r\n    - '*off'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: bcdedit off (Sysmon).\r\ndescription: Detects usage of bcdedit off.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - bcdedit.exe\r\n    Command_Line:\r\n    - '*off'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "OG57D2kBFVBAemBcW0Cn": {"category": 2, "updated": "2019-02-26T12:11:33.000Z", "hash": "684f09a5c1ae9e9f4e6228f55d1a2c522b4d124b928debf4de464d0f35ce62b0", "title": "TropicTrooper Campaign November 2018.", "permission_id": 3, "title_keyword": "TropicTrooper Campaign November 2018.", "released": "2019-02-21T09:55:36.000Z", "sigma_text": "title: TropicTrooper Campaign November 2018.\r\ndescription: Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia.\r\nreferences:\r\n- https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/\r\nauthor: 41thexplorer, Windows Defender ATP, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/12/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    ProcessCommandLine: '*abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc*'\r\n    Description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '*abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc*'\r\n    Description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1085", "git_filepath": "/apt/apt_tropictrooper.yml", "sigma_text_keyword": "title: TropicTrooper Campaign November 2018.\r\ndescription: Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia.\r\nreferences:\r\n- https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/\r\nauthor: 41thexplorer, Windows Defender ATP, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/12/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 4688\r\n    ProcessCommandLine: '*abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc*'\r\n    Description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '*abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc*'\r\n    Description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1085"}, "RJ3knmUBtApo-eN_lOIc": {"category": 8, "updated": "2018-10-23T11:51:57.000Z", "hash": "eb4769d254dbab712b9e26382baaa398d5cca57dadac1fe239b0c6eab19adc69", "title": "NTFS Alternate Data Stream", "permission_id": 3, "title_keyword": "NTFS Alternate Data Stream", "released": "2018-08-31T16:19:04.000Z", "sigma_text": "title: NTFS Alternate Data Stream\r\nstatus: experimental\r\ndescription: Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.\r\nreferences:\r\n- http://www.powertheshell.com/ntfsstreams/\r\ntags:\r\n- attack.defense_Evasion\r\n- attack.t1096\r\nauthor: Sami Ruohonen\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keyword1:\r\n  - set-content\r\n  keyword2:\r\n  - -stream\r\n  condition: keyword1 and keyword2\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": null, "sigma_text_keyword": "title: NTFS Alternate Data Stream\r\nstatus: experimental\r\ndescription: Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.\r\nreferences:\r\n- http://www.powertheshell.com/ntfsstreams/\r\ntags:\r\n- attack.defense_Evasion\r\n- attack.t1096\r\nauthor: Sami Ruohonen\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\n  description: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\r\ndetection:\r\n  keyword1:\r\n  - set-content\r\n  keyword2:\r\n  - -stream\r\n  condition: keyword1 and keyword2\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "Mp3knmUBtApo-eN_k-LE": {"category": 15, "updated": "2019-02-26T13:56:52.000Z", "hash": "8337fbe683786dc2c50f9f4838b227145345e43aecf035519aec888dd325e023", "title": "Detection of SafetyKatz", "permission_id": 3, "title_keyword": "Detection of SafetyKatz", "released": "2018-07-24T21:51:46.000Z", "sigma_text": "title: Detection of SafetyKatz\r\nstatus: experimental\r\ndescription: Detects possible SafetyKatz Behaviour\r\nreferences:\r\n- https://github.com/GhostPack/SafetyKatz\r\ntags:\r\n- attack.credential_access\r\n- attack.T1003\r\nauthor: Markus Neis\r\ndate: 2018/07/24\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 11\r\n    TargetFilename: '*\\Temp\\debug.bin'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_ghostpack_safetykatz.yml", "sigma_text_keyword": "title: Detection of SafetyKatz\r\nstatus: experimental\r\ndescription: Detects possible SafetyKatz Behaviour\r\nreferences:\r\n- https://github.com/GhostPack/SafetyKatz\r\ntags:\r\n- attack.credential_access\r\n- attack.T1003\r\nauthor: Markus Neis\r\ndate: 2018/07/24\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 11\r\n    TargetFilename: '*\\Temp\\debug.bin'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "KSXgZGcBqjf_D59HIsVA": {"category": 8, "updated": "2019-01-02T14:41:16.000Z", "hash": "e401b9673560052e2df4e0725ccafaf90dd5a4ed30dee6a18a2d8018511faeed", "title": "Possible \"NoPowershell\" execution (execute-assembly via Cobalt Strike)", "permission_id": 3, "title_keyword": "Possible \"NoPowershell\" execution (execute-assembly via Cobalt Strike)", "released": "2018-11-30T13:57:13.000Z", "sigma_text": "title: Possible \"NoPowershell\" execution (execute-assembly via Cobalt Strike)\r\ndescription: NoPowerShell is a tool implemented in C# which supports executing PowerShell-like commands while remaining invisible to any PowerShell logging mechanisms.\r\nreferences:\r\n- https://github.com/bitsadmin/nopowershell\r\nauthor: Roman Ranskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_id: \"8\"\r\n  selection1:\r\n    event_data.StartAddress: \\*0B80\r\n  condition: selection0 and selection1\r\nfalsepositives:\r\n- low\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1086\r\n- attack.Defense Evasion\r\n- attack.t1055", "git_filepath": "", "sigma_text_keyword": "title: Possible \"NoPowershell\" execution (execute-assembly via Cobalt Strike)\r\ndescription: NoPowerShell is a tool implemented in C# which supports executing PowerShell-like commands while remaining invisible to any PowerShell logging mechanisms.\r\nreferences:\r\n- https://github.com/bitsadmin/nopowershell\r\nauthor: Roman Ranskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    event_id: \"8\"\r\n  selection1:\r\n    event_data.StartAddress: \\*0B80\r\n  condition: selection0 and selection1\r\nfalsepositives:\r\n- low\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1086\r\n- attack.Defense Evasion\r\n- attack.t1055"}, "cp3knmUBtApo-eN_leIf": {"category": 15, "updated": "2019-02-26T13:53:38.000Z", "hash": "6e8acce4f58a91c8e050f5bf152f11bcbd3d47892d8e7e763eb97d38d0ddfcb5", "title": "Registry Persistence via Explorer Run Key", "permission_id": 3, "title_keyword": "Registry Persistence via Explorer Run Key", "released": "2018-07-19T22:27:19.000Z", "sigma_text": "title: Registry Persistence via Explorer Run Key\r\nstatus: experimental\r\ndescription: Detects a possible persistence mechanism using RUN key for Windows Explorer and poiting to a suspicious folder\r\nauthor: Florian Roth\r\ndate: 2018/07/18\r\nreferences:\r\n- https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject: '*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run'\r\n    Details:\r\n    - C:\\Windows\\Temp\\\\*\r\n    - C:\\ProgramData\\\\*\r\n    - '*\\AppData\\\\*'\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Temp\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n  condition: selection\r\ntags:\r\n- attack.persistence\r\n- attack.t1060\r\n- capec.270\r\nfields:\r\n- Image\r\n- ParentImage\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_reg_persist_explorer_run.yml", "sigma_text_keyword": "title: Registry Persistence via Explorer Run Key\r\nstatus: experimental\r\ndescription: Detects a possible persistence mechanism using RUN key for Windows Explorer and poiting to a suspicious folder\r\nauthor: Florian Roth\r\ndate: 2018/07/18\r\nreferences:\r\n- https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject: '*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run'\r\n    Details:\r\n    - C:\\Windows\\Temp\\\\*\r\n    - C:\\ProgramData\\\\*\r\n    - '*\\AppData\\\\*'\r\n    - C:\\$Recycle.bin\\\\*\r\n    - C:\\Temp\\\\*\r\n    - C:\\Users\\Public\\\\*\r\n    - C:\\Users\\Default\\\\*\r\n  condition: selection\r\ntags:\r\n- attack.persistence\r\n- attack.t1060\r\n- capec.270\r\nfields:\r\n- Image\r\n- ParentImage\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "bG1Ho2gBFVBAemBcoN1a": {"category": 8, "updated": "2019-01-31T09:40:06.000Z", "hash": "ff859c59c5ddc4d210c1fee9ac0400ca7882ac9251e799a84c0c984fae720168", "title": "Rubeus Hack Tool (Sysmon)", "permission_id": 3, "title_keyword": "Rubeus Hack Tool (Sysmon)", "released": "2019-01-31T09:40:06.000Z", "sigma_text": "title: Rubeus Hack Tool (Sysmon)\r\nstatus: experimental\r\ndescription: Detects command line parameters used by Rubeus hack tool\r\nreferences:\r\n- https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/\r\ntags:\r\n- attack.t1003\r\n- attack.Credential Access\r\n- attack.Lateral Movement\r\n- attack.t1075\r\n- attack.t1097\r\nauthor: Florian Roth, Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* asreproast *'\r\n    - '* dump /service:krbtgt *'\r\n    - '* kerberoast *'\r\n    - '* createnetonly /program:*'\r\n    - '* ptt /ticket:*'\r\n    - '* /impersonateuser:*'\r\n    - '* renew /ticket:*'\r\n    - '* asktgt /user:*'\r\n    - '* harvest /interval:*'\r\n  condition: selection\r\nlevel: high", "git_filepath": "", "sigma_text_keyword": "title: Rubeus Hack Tool (Sysmon)\r\nstatus: experimental\r\ndescription: Detects command line parameters used by Rubeus hack tool\r\nreferences:\r\n- https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/\r\ntags:\r\n- attack.t1003\r\n- attack.Credential Access\r\n- attack.Lateral Movement\r\n- attack.t1075\r\n- attack.t1097\r\nauthor: Florian Roth, Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* asreproast *'\r\n    - '* dump /service:krbtgt *'\r\n    - '* kerberoast *'\r\n    - '* createnetonly /program:*'\r\n    - '* ptt /ticket:*'\r\n    - '* /impersonateuser:*'\r\n    - '* renew /ticket:*'\r\n    - '* asktgt /user:*'\r\n    - '* harvest /interval:*'\r\n  condition: selection\r\nlevel: high"}, "aZ3knmUBtApo-eN_j-Ep": {"category": 15, "updated": "2018-10-26T16:48:08.000Z", "hash": "57cdc908498a7d8fd726fababc756da090880f18dc78bbb9faca394d52083474", "title": "Processes created by MMC", "permission_id": 3, "title_keyword": "Processes created by MMC", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Processes created by MMC\r\nstatus: experimental\r\ndescription: Processes started by MMC could by a sign of lateral movement using MMC application COM object\r\nreferences:\r\n- https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\mmc.exe'\r\n    Image: '*\\cmd.exe'\r\n  exclusion:\r\n    CommandLine: '*\\RunCmd.cmd'\r\n  condition: selection and not exclusion\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_mmc_source.yml", "sigma_text_keyword": "title: Processes created by MMC\r\nstatus: experimental\r\ndescription: Processes started by MMC could by a sign of lateral movement using MMC application COM object\r\nreferences:\r\n- https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage: '*\\mmc.exe'\r\n    Image: '*\\cmd.exe'\r\n  exclusion:\r\n    CommandLine: '*\\RunCmd.cmd'\r\n  condition: selection and not exclusion\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- unknown\r\nlevel: medium"}, "jJ3knmUBtApo-eN_ouQO": {"category": 8, "updated": "2018-11-26T10:42:01.000Z", "hash": "25b377cba69962788755a619ccd4fae88ca93e8c66ceb0d4bd096c3021034cce", "title": "FlawedAmmyy RAT Detection (Proxy).", "permission_id": 3, "title_keyword": "FlawedAmmyy RAT Detection (Proxy).", "released": "2018-06-06T09:06:13.000Z", "sigma_text": "title: FlawedAmmyy RAT Detection (Proxy).\r\ndescription: FlawedAmmyy RAT Detection Through Proxy.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://fortiguard.com/resources/threat-brief/2018/03/16/fortiguard-threat-intelligence-brief-march-16-2018\r\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\r\n- https://www.welivesecurity.com/2018/07/11/ammyy-admin-compromised-malware-world-cup-cover/\r\ndate: 2018/07/11\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionSRC:\r\n    src_ip:\r\n    - 179.60.146.3:443\r\n    - 185.176.221.54\r\n    - 179.60.146.3:443\r\n    - 194.165.16.11:443\r\n  selectionDST:\r\n    dst_ip:\r\n    - 179.60.146.3:443\r\n    - 185.176.221.54\r\n    - 179.60.146.3:443\r\n    - 194.165.16.11:443\r\n  selectionURL:\r\n    resource.URL:\r\n    - chimachinenow.com\r\n    - highlandfamily.org\r\n    - intra.cfecgcaquitaine.com\r\n    - motifahsap.com\r\n    - sittalhaphedver.com\r\n    - wassronledorhad.in\r\n    - balzantruck.com\r\n    - buyviagraoverthecounterusabb.net\r\n    - fifa2018start.info\r\n    - buyviagraoverthecounterusabb.net/documents/B123456789012.js\r\n    - chimachinenow.com/kjdhc783\r\n    - highlandfamily.org/kjdhc783\r\n    - intra.cfecgcaquitaine.com/kjdhc783\r\n    - motifahsap.com/kjdhc783\r\n    - sittalhaphedver.com/p66/kjdhc783\r\n    - wassronledorhad.in/q2/index.php\r\n    - balzantruck.com/45rt.exe\r\n  condition: selectionURL or selectionSRC or selectionDST\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": null, "sigma_text_keyword": "title: FlawedAmmyy RAT Detection (Proxy).\r\ndescription: FlawedAmmyy RAT Detection Through Proxy.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://fortiguard.com/resources/threat-brief/2018/03/16/fortiguard-threat-intelligence-brief-march-16-2018\r\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\r\n- https://www.welivesecurity.com/2018/07/11/ammyy-admin-compromised-malware-world-cup-cover/\r\ndate: 2018/07/11\r\nstatus: stable\r\nlogsource:\r\n  product: proxy\r\ndetection:\r\n  selectionSRC:\r\n    src_ip:\r\n    - 179.60.146.3:443\r\n    - 185.176.221.54\r\n    - 179.60.146.3:443\r\n    - 194.165.16.11:443\r\n  selectionDST:\r\n    dst_ip:\r\n    - 179.60.146.3:443\r\n    - 185.176.221.54\r\n    - 179.60.146.3:443\r\n    - 194.165.16.11:443\r\n  selectionURL:\r\n    resource.URL:\r\n    - chimachinenow.com\r\n    - highlandfamily.org\r\n    - intra.cfecgcaquitaine.com\r\n    - motifahsap.com\r\n    - sittalhaphedver.com\r\n    - wassronledorhad.in\r\n    - balzantruck.com\r\n    - buyviagraoverthecounterusabb.net\r\n    - fifa2018start.info\r\n    - buyviagraoverthecounterusabb.net/documents/B123456789012.js\r\n    - chimachinenow.com/kjdhc783\r\n    - highlandfamily.org/kjdhc783\r\n    - intra.cfecgcaquitaine.com/kjdhc783\r\n    - motifahsap.com/kjdhc783\r\n    - sittalhaphedver.com/p66/kjdhc783\r\n    - wassronledorhad.in/q2/index.php\r\n    - balzantruck.com/45rt.exe\r\n  condition: selectionURL or selectionSRC or selectionDST\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "bJ3knmUBtApo-eN_reae": {"category": 9, "updated": "2018-10-23T15:37:46.000Z", "hash": "03eb91500e5ea7cf9790a4b3b47895e54b556b171cd0abb6852f8f1d27745804", "title": "Detects Suspicious Commands on Linux systems", "permission_id": 3, "title_keyword": "Detects Suspicious Commands on Linux systems", "released": "2018-01-23T10:13:23.000Z", "sigma_text": "title: Detects Suspicious Commands on Linux systems\r\nstatus: experimental\r\ndescription: Detects relevant commands often related to malware or hacking activity. Modified by SOC Prime, replaced condition \"1 of cmds\" with \"cmds\"\r\nreferences:\r\n- Internal Research - mostly derived from exploit code including code in MSF\r\ndate: 2017/12/12\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\n  service: auditd\r\ndetection:\r\n  cmds:\r\n  - type: EXECVE\r\n    a0: chmod\r\n    a1: \"777\"\r\n  - type: EXECVE\r\n    a0: chmod\r\n    a1: u+s\r\n  - type: EXECVE\r\n    a0: cp\r\n    a1: /bin/ksh\r\n  - type: EXECVE\r\n    a0: cp\r\n    a1: /bin/sh\r\n  condition: cmds\r\nfalsepositives:\r\n- Admin activity\r\nlevel: medium", "git_filepath": "/linux/auditd/lnx_auditd_susp_cmds.yml", "sigma_text_keyword": "title: Detects Suspicious Commands on Linux systems\r\nstatus: experimental\r\ndescription: Detects relevant commands often related to malware or hacking activity. Modified by SOC Prime, replaced condition \"1 of cmds\" with \"cmds\"\r\nreferences:\r\n- Internal Research - mostly derived from exploit code including code in MSF\r\ndate: 2017/12/12\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\n  service: auditd\r\ndetection:\r\n  cmds:\r\n  - type: EXECVE\r\n    a0: chmod\r\n    a1: \"777\"\r\n  - type: EXECVE\r\n    a0: chmod\r\n    a1: u+s\r\n  - type: EXECVE\r\n    a0: cp\r\n    a1: /bin/ksh\r\n  - type: EXECVE\r\n    a0: cp\r\n    a1: /bin/sh\r\n  condition: cmds\r\nfalsepositives:\r\n- Admin activity\r\nlevel: medium"}, "CSUeVGcBqjf_D59HXasD": {"category": 8, "updated": "2019-01-02T14:46:10.000Z", "hash": "2cf060ab99c6ef7eee1e97ff2dd19a5cd6f4dbb46e40750127fca913899ad090", "title": "Spear phishing attack on GOV in Poland APT28? (Sysmon).", "permission_id": 3, "title_keyword": "Spear phishing attack on GOV in Poland APT28? (Sysmon).", "released": "2018-11-27T07:46:20.000Z", "sigma_text": "title: Spear phishing attack on GOV in Poland APT28? (Sysmon).\r\ndescription: Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- http://malware.prevenity.com/2018/11/spear-phishing-attack-on-gov-in-poland.html\r\ndate: 2018/11/17\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionHash:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - D7BC8E19721FDD0EEA29DE2B0F17504C7C2F62AD\r\n    - 8FB0124DEF0E5A7A12495EDE2A20A9C48A7929A6\r\n    - D14A360FFA7645693EE6E19BC2B64CF7707504C8\r\n    - 777DB69F7C22F6481FD2246A0FE444D410281270\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AudioMgr'\r\n  condition: selectionHash or selection_registry\r\nfields:\r\n- Hashes\r\n- TargetObject\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.Persistence\r\n- attack.t1060", "git_filepath": "", "sigma_text_keyword": "title: Spear phishing attack on GOV in Poland APT28? (Sysmon).\r\ndescription: Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- http://malware.prevenity.com/2018/11/spear-phishing-attack-on-gov-in-poland.html\r\ndate: 2018/11/17\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selectionHash:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - D7BC8E19721FDD0EEA29DE2B0F17504C7C2F62AD\r\n    - 8FB0124DEF0E5A7A12495EDE2A20A9C48A7929A6\r\n    - D14A360FFA7645693EE6E19BC2B64CF7707504C8\r\n    - 777DB69F7C22F6481FD2246A0FE444D410281270\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AudioMgr'\r\n  condition: selectionHash or selection_registry\r\nfields:\r\n- Hashes\r\n- TargetObject\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.Persistence\r\n- attack.t1060"}, "1W6nFGkBFVBAemBcQ0Sd": {"category": 11, "updated": "2019-02-26T12:10:46.000Z", "hash": "3f2ea77efdedf2c85ac8995e68397e73cfb8fe8215671172e3545e7bfea94c3f", "title": "Suspicious Rundll32 Activity.", "permission_id": 3, "title_keyword": "Suspicious Rundll32 Activity.", "released": "2019-02-22T10:01:39.000Z", "sigma_text": "title: Suspicious Rundll32 Activity.\r\ndescription: Detects suspicious process related to rundll32 based on arguments.\r\nreferences:\r\n- http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/\r\n- https://twitter.com/Hexacorn/status/885258886428725250\r\n- https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52\r\nstatus: experimental\r\nauthor: juju4, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\rundll32.exe* url.dll,*OpenURL *'\r\n    - '*\\rundll32.exe* url.dll,*OpenURLA *'\r\n    - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\r\n    - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\r\n    - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\r\n    - '*\\rundll32.exe javascript:*'\r\n    - '* url.dll,*OpenURL *'\r\n    - '* url.dll,*OpenURLA *'\r\n    - '* url.dll,*FileProtocolHandler *'\r\n    - '* zipfldr.dll,*RouteTheCall *'\r\n    - '* Shell32.dll,*Control_RunDLL *'\r\n    - '* javascript:*'\r\n    - '*.RegisterXLL*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ProcessCommandLine:\r\n    - '*\\rundll32.exe* url.dll,*OpenURL *'\r\n    - '*\\rundll32.exe* url.dll,*OpenURLA *'\r\n    - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\r\n    - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\r\n    - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\r\n    - '*\\rundll32.exe javascript:*'\r\n    - '* url.dll,*OpenURL *'\r\n    - '* url.dll,*OpenURLA *'\r\n    - '* url.dll,*FileProtocolHandler *'\r\n    - '* zipfldr.dll,*RouteTheCall *'\r\n    - '* Shell32.dll,*Control_RunDLL *'\r\n    - '* javascript:*'\r\n    - '*.RegisterXLL*'\r\n  condition: selection\r\nfalsepositives:\r\n- False positives depend on scripts and administrative tools used in the monitored environment.\r\nlevel: medium\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1085", "git_filepath": "/windows/builtin/win_susp_rundll32_activity.yml", "sigma_text_keyword": "title: Suspicious Rundll32 Activity.\r\ndescription: Detects suspicious process related to rundll32 based on arguments.\r\nreferences:\r\n- http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/\r\n- https://twitter.com/Hexacorn/status/885258886428725250\r\n- https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52\r\nstatus: experimental\r\nauthor: juju4, Alexandr Yampolskyi, SOC Prime\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    CommandLine:\r\n    - '*\\rundll32.exe* url.dll,*OpenURL *'\r\n    - '*\\rundll32.exe* url.dll,*OpenURLA *'\r\n    - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\r\n    - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\r\n    - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\r\n    - '*\\rundll32.exe javascript:*'\r\n    - '* url.dll,*OpenURL *'\r\n    - '* url.dll,*OpenURLA *'\r\n    - '* url.dll,*FileProtocolHandler *'\r\n    - '* zipfldr.dll,*RouteTheCall *'\r\n    - '* Shell32.dll,*Control_RunDLL *'\r\n    - '* javascript:*'\r\n    - '*.RegisterXLL*'\r\n  condition: selection\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ProcessCommandLine:\r\n    - '*\\rundll32.exe* url.dll,*OpenURL *'\r\n    - '*\\rundll32.exe* url.dll,*OpenURLA *'\r\n    - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\r\n    - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\r\n    - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\r\n    - '*\\rundll32.exe javascript:*'\r\n    - '* url.dll,*OpenURL *'\r\n    - '* url.dll,*OpenURLA *'\r\n    - '* url.dll,*FileProtocolHandler *'\r\n    - '* zipfldr.dll,*RouteTheCall *'\r\n    - '* Shell32.dll,*Control_RunDLL *'\r\n    - '* javascript:*'\r\n    - '*.RegisterXLL*'\r\n  condition: selection\r\nfalsepositives:\r\n- False positives depend on scripts and administrative tools used in the monitored environment.\r\nlevel: medium\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1085"}, "M53knmUBtApo-eN_n-Tq": {"category": 15, "updated": "2019-02-26T15:16:31.000Z", "hash": "814565b51a4af9663d06ad96f7375a7553fe46868084b6b8b96c1eeee49e1fea", "title": "Suspicious Driver Load from Temp", "permission_id": 3, "title_keyword": "Suspicious Driver Load from Temp", "released": "2017-02-12T14:50:39.000Z", "sigma_text": "title: Suspicious Driver Load from Temp\r\ndescription: Detects a driver load from a temporary directory\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 6\r\n    ImageLoaded: '*\\Temp\\\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- there is a relevant set of false positives depending on applications in the environment\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_driver_load.yml", "sigma_text_keyword": "title: Suspicious Driver Load from Temp\r\ndescription: Detects a driver load from a temporary directory\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 6\r\n    ImageLoaded: '*\\Temp\\\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- there is a relevant set of false positives depending on applications in the environment\r\nlevel: medium"}, "wJ3knmUBtApo-eN_hd81": {"category": 8, "updated": "2019-01-02T14:57:17.000Z", "hash": "f3ad19e8200eaaceae6d6bddab36f506b5a9deef1d6bbe5832fadd9bc6211cb0", "title": "Keylogger detector (Sysmon).", "permission_id": 3, "title_keyword": "Keylogger detector (Sysmon).", "released": "2018-07-19T10:45:36.000Z", "sigma_text": "title: Keylogger detector (Sysmon).\r\ndescription: keylogger is a simple standalone executable that sets global keyboard hooks and writes all keystrokes into a file in an encrypted form.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 21921864D2F1AB2761C36031A2E1D2C00C9B304A\r\n    - 3C2D0615BEF6F88FED6E308D4F45B6133080C74F\r\n    - 91E8346910E0E6783ACFC4F2B9A745C81BD7573A\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Keylogger detector (Sysmon).\r\ndescription: keylogger is a simple standalone executable that sets global keyboard hooks and writes all keystrokes into a file in an encrypted form.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/wp-content/uploads/2018/07/ESET_Quasar_Sobaken_Vermin.pdf#page15\r\ndate: 2018/06/01\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 21921864D2F1AB2761C36031A2E1D2C00C9B304A\r\n    - 3C2D0615BEF6F88FED6E308D4F45B6133080C74F\r\n    - 91E8346910E0E6783ACFC4F2B9A745C81BD7573A\r\n  condition: selection\r\nfields:\r\n- Image\r\n- TargetObject\r\n- Hashes\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "9p3knmUBtApo-eN_ht-q": {"category": 11, "updated": "2018-10-25T12:00:56.000Z", "hash": "e91442d64bf14225998c9aa69f6180b44962c4624a48bc9fe3b8bd03a024acfc", "title": "smbexec.py Service Installation", "permission_id": 3, "title_keyword": "smbexec.py Service Installation", "released": "2018-03-21T09:44:37.000Z", "sigma_text": "title: smbexec.py Service Installation\r\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\r\nauthor: Omer Faruk Celik\r\ndate: 2018/03/20\r\nreferences:\r\n- https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\r\ntags:\r\n- attack.lateral_movement\r\n- attack.execution\r\n- attack.t1077\r\n- attack.t1035\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  service_installation:\r\n    EventID: \"7045\"\r\n    ServiceName: BTOBTO\r\n    ServiceFileName: '*\\execute.bat'\r\n  condition: service_installation\r\nfields:\r\n- ServiceName\r\n- ServiceFileName\r\nfalsepositives:\r\n- Penetration Test\r\n- Unknown\r\nlevel: critical", "git_filepath": "/windows/builtin/win_hack_smbexec.yml", "sigma_text_keyword": "title: smbexec.py Service Installation\r\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\r\nauthor: Omer Faruk Celik\r\ndate: 2018/03/20\r\nreferences:\r\n- https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\r\ntags:\r\n- attack.lateral_movement\r\n- attack.execution\r\n- attack.t1077\r\n- attack.t1035\r\nlogsource:\r\n  product: windows\r\ndetection:\r\n  service_installation:\r\n    EventID: \"7045\"\r\n    ServiceName: BTOBTO\r\n    ServiceFileName: '*\\execute.bat'\r\n  condition: service_installation\r\nfields:\r\n- ServiceName\r\n- ServiceFileName\r\nfalsepositives:\r\n- Penetration Test\r\n- Unknown\r\nlevel: critical"}, "tJ3knmUBtApo-eN_iuCl": {"category": 5, "updated": "2018-10-25T12:41:08.000Z", "hash": "8b2973a229d4808db0691879e902f97875fec13714f5228dc70c3aa7e665e793", "title": "Windows PowerShell User Agent", "permission_id": 3, "title_keyword": "Windows PowerShell User Agent", "released": "2017-03-13T12:51:32.000Z", "sigma_text": "title: Windows PowerShell User Agent\r\nstatus: experimental\r\ndescription: Detects Windows PowerShell Web Access\r\nreferences:\r\n- https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: '* WindowsPowerShell/*'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Administrative scripts that download files from the Internet\r\n- Administrative scripts that retrieve certain website contents\r\nlevel: medium", "git_filepath": "/proxy/proxy_powershell_ua.yml", "sigma_text_keyword": "title: Windows PowerShell User Agent\r\nstatus: experimental\r\ndescription: Detects Windows PowerShell Web Access\r\nreferences:\r\n- https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent: '* WindowsPowerShell/*'\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Administrative scripts that download files from the Internet\r\n- Administrative scripts that retrieve certain website contents\r\nlevel: medium"}, "zp3knmUBtApo-eN_neOo": {"category": 15, "updated": "2019-02-26T15:00:05.000Z", "hash": "243664088afec3d236df9dbe0541a0c742f8556ae1b6631a5afb77f3f8f79a12", "title": "Suspicious Certutil Command", "permission_id": 3, "title_keyword": "Suspicious Certutil Command", "released": "2017-07-20T18:38:10.000Z", "sigma_text": "action: global\r\ntitle: Suspicious Certutil Command\r\nstatus: experimental\r\ndescription: Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility\r\nauthor: Florian Roth, juju4, keepwatch\r\nmodified: 2019/01/22\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/835149808817991680\r\n- https://twitter.com/subTee/status/888102593838362624\r\n- https://twitter.com/subTee/status/888071631528235010\r\n- https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\r\n- https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\r\n- https://twitter.com/egre55/status/1087685529016193025\r\n- https://lolbas-project.github.io/lolbas/Binaries/Certutil/\r\ndetection:\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1140\r\n- attack.t1105\r\n- attack.s0189\r\n- attack.g0007\r\nfalsepositives:\r\n- False positives depend on scripts and administrative tools used in the monitored environment\r\nlevel: high\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* -decode *'\r\n    - '* /decode *'\r\n    - '* -decodehex *'\r\n    - '* /decodehex *'\r\n    - '* -urlcache *'\r\n    - '* /urlcache *'\r\n    - '* -verifyctl *'\r\n    - '* /verifyctl *'\r\n    - '* -encode *'\r\n    - '* /encode *'\r\n    - '*certutil* -URL*'\r\n    - '*certutil* /URL*'\r\n    - '*certutil* -ping*'\r\n    - '*certutil* /ping*'\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '* -decode *'\r\n    - '* /decode *'\r\n    - '* -decodehex *'\r\n    - '* /decodehex *'\r\n    - '* -urlcache *'\r\n    - '* /urlcache *'\r\n    - '* -verifyctl *'\r\n    - '* /verifyctl *'\r\n    - '* -encode *'\r\n    - '* /encode *'\r\n    - '*certutil* -URL*'\r\n    - '*certutil* /URL*'\r\n    - '*certutil* -ping*'\r\n    - '*certutil* /ping*'", "git_filepath": "/windows/sysmon/sysmon_susp_certutil_command.yml", "sigma_text_keyword": "action: global\r\ntitle: Suspicious Certutil Command\r\nstatus: experimental\r\ndescription: Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility\r\nauthor: Florian Roth, juju4, keepwatch\r\nmodified: 2019/01/22\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/835149808817991680\r\n- https://twitter.com/subTee/status/888102593838362624\r\n- https://twitter.com/subTee/status/888071631528235010\r\n- https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\r\n- https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\r\n- https://twitter.com/egre55/status/1087685529016193025\r\n- https://lolbas-project.github.io/lolbas/Binaries/Certutil/\r\ndetection:\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1140\r\n- attack.t1105\r\n- attack.s0189\r\n- attack.g0007\r\nfalsepositives:\r\n- False positives depend on scripts and administrative tools used in the monitored environment\r\nlevel: high\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '* -decode *'\r\n    - '* /decode *'\r\n    - '* -decodehex *'\r\n    - '* /decodehex *'\r\n    - '* -urlcache *'\r\n    - '* /urlcache *'\r\n    - '* -verifyctl *'\r\n    - '* /verifyctl *'\r\n    - '* -encode *'\r\n    - '* /encode *'\r\n    - '*certutil* -URL*'\r\n    - '*certutil* /URL*'\r\n    - '*certutil* -ping*'\r\n    - '*certutil* /ping*'\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n    ProcessCommandLine:\r\n    - '* -decode *'\r\n    - '* /decode *'\r\n    - '* -decodehex *'\r\n    - '* /decodehex *'\r\n    - '* -urlcache *'\r\n    - '* /urlcache *'\r\n    - '* -verifyctl *'\r\n    - '* /verifyctl *'\r\n    - '* -encode *'\r\n    - '* /encode *'\r\n    - '*certutil* -URL*'\r\n    - '*certutil* /URL*'\r\n    - '*certutil* -ping*'\r\n    - '*certutil* /ping*'"}, "7W1xM2gBFVBAemBcgodR": {"category": 8, "updated": "2019-01-09T16:29:46.000Z", "hash": "1856ddf393116a2277f7742f4379b3f6e0dcf69b10c010651bf90712e010fa0d", "title": "DanaBot Trojan (Sysmon).", "permission_id": 3, "title_keyword": "DanaBot Trojan (Sysmon).", "released": "2019-01-09T16:28:23.000Z", "sigma_text": "title: DanaBot Trojan (Sysmon).\r\ndescription: DanaBot, a stealthy banking Trojan.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/pollo290987/status/1083019976628494336\r\ndate: 2019/01/09\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 76A64FD17CD1E7C59B8BDE7AA9209854\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: DanaBot Trojan (Sysmon).\r\ndescription: DanaBot, a stealthy banking Trojan.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://twitter.com/pollo290987/status/1083019976628494336\r\ndate: 2019/01/09\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 76A64FD17CD1E7C59B8BDE7AA9209854\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "cp3knmUBtApo-eN_m-Ow": {"category": 8, "updated": "2018-10-26T14:45:32.000Z", "hash": "5db7c21235cea20552a349c3c388f9268766831857eb45fb7d925d17c493b91a", "title": "Powershell Download (Sysmon).", "permission_id": 3, "title_keyword": "Powershell Download (Sysmon).", "released": "2018-09-07T12:34:55.000Z", "sigma_text": "title: Powershell Download (Sysmon).\r\ndescription: Detects usage of Powershell Download commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - '*DownloadFile*'\r\n    - '*invoke-webrequest*'\r\n    - '*iwr'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Powershell Download (Sysmon).\r\ndescription: Detects usage of Powershell Download commands.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - '*DownloadFile*'\r\n    - '*invoke-webrequest*'\r\n    - '*iwr'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some legitimate apps use this, but limited.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "zZ3knmUBtApo-eN_r-ak": {"category": 2, "updated": "2018-11-07T14:02:39.000Z", "hash": "a78309e31e54a6565ea9c11f5e21d02b7d3257f41a6a38f378a55e7ac7d21ede", "title": "Fireball Archer Install", "permission_id": 3, "title_keyword": "Fireball Archer Install", "released": "2017-06-03T12:49:06.000Z", "sigma_text": "title: Fireball Archer Install\r\nstatus: experimental\r\ndescription: Detects Archer malware invocation via rundll32\r\nauthor: Florian Roth\r\ndate: 2017/06/03\r\nreferences:\r\n- https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\r\n- https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1085", "git_filepath": "/apt/crime_fireball.yml", "sigma_text_keyword": "title: Fireball Archer Install\r\nstatus: experimental\r\ndescription: Detects Archer malware invocation via rundll32\r\nauthor: Florian Roth\r\ndate: 2017/06/03\r\nreferences:\r\n- https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\r\n- https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1085"}, "8p3knmUBtApo-eN_nuNh": {"category": 11, "updated": "2018-10-23T14:48:03.000Z", "hash": "1df15f6c7493f32e2b8096f5d275c3ba59aee55052fb37cdfd2ee9e32799acef", "title": "User Added to Local Administrators", "permission_id": 3, "title_keyword": "User Added to Local Administrators", "released": "2017-03-14T11:51:50.000Z", "sigma_text": "title: User Added to Local Administrators\r\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity\r\nstatus: stable\r\nauthor: Florian Roth\r\ntags:\r\n- attack.privilege_escalation\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4732\"\r\n    GroupName: Administrators\r\n  filter:\r\n    SubjectUserName: '*$'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low", "git_filepath": "/windows/builtin/win_user_added_to_local_administrators.yml", "sigma_text_keyword": "title: User Added to Local Administrators\r\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity\r\nstatus: stable\r\nauthor: Florian Roth\r\ntags:\r\n- attack.privilege_escalation\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4732\"\r\n    GroupName: Administrators\r\n  filter:\r\n    SubjectUserName: '*$'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Legitimate administrative activity\r\nlevel: low"}, "3W5kKWkBFVBAemBc5VHg": {"category": 15, "updated": "2019-02-26T12:32:25.000Z", "hash": "ae14c1fd66dcdea253df10832c376435ec06a1292fa55285d71bd8866d0c47b2", "title": "Executable in ADS.", "permission_id": 3, "title_keyword": "Executable in ADS.", "released": "2019-02-26T10:41:11.000Z", "sigma_text": "title: Executable in ADS.\r\ndescription: Detects the creation of an ADS data stream that contains an executable (non-empty imphash).\r\nreferences:\r\n- https://twitter.com/0xrawsec/status/1002478725605273600?s=21\r\nauthor: Florian Roth, @0xrawsec\r\nstatus: experimental\r\ndate: 2018/06/03\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  definition: 'Requirements: Sysmon config with Imphash logging activated'\r\ndetection:\r\n  selection:\r\n    EventID: 15\r\n  filter:\r\n    Imphash: \"00000000000000000000000000000000\"\r\n  condition: selection and not filter\r\nfields:\r\n- TargetFilename\r\n- Image\r\nfalsepositives:\r\n- unknown\r\nlevel: critical\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1027\r\n- attack.s0139", "git_filepath": "/windows/sysmon/sysmon_ads_executable.yml", "sigma_text_keyword": "title: Executable in ADS.\r\ndescription: Detects the creation of an ADS data stream that contains an executable (non-empty imphash).\r\nreferences:\r\n- https://twitter.com/0xrawsec/status/1002478725605273600?s=21\r\nauthor: Florian Roth, @0xrawsec\r\nstatus: experimental\r\ndate: 2018/06/03\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  definition: 'Requirements: Sysmon config with Imphash logging activated'\r\ndetection:\r\n  selection:\r\n    EventID: 15\r\n  filter:\r\n    Imphash: \"00000000000000000000000000000000\"\r\n  condition: selection and not filter\r\nfields:\r\n- TargetFilename\r\n- Image\r\nfalsepositives:\r\n- unknown\r\nlevel: critical\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1027\r\n- attack.s0139"}, "3Z3knmUBtApo-eN_mOIO": {"category": 15, "updated": "2019-02-26T15:03:59.000Z", "hash": "7a96502c8683b53907fb9bfb1e3069d01f86d5372eeaf6f1c45cc3398114f1d4", "title": "Suspicious Program Location with Network Connections", "permission_id": 3, "title_keyword": "Suspicious Program Location with Network Connections", "released": "2017-03-19T14:22:27.000Z", "sigma_text": "title: Suspicious Program Location with Network Connections\r\nstatus: experimental\r\ndescription: Detects programs with network connections running in suspicious files system locations\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2017/03/19\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  definition: Use the following config to generate the necessary Event ID 3 Network Connection events\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\All Users\\\\*'\r\n    - '*\\Users\\Default\\\\*'\r\n    - '*\\Users\\Public\\\\*'\r\n    - C:\\Perflogs\\\\*\r\n    - '*\\config\\systemprofile\\\\*'\r\n    - '*\\Windows\\Fonts\\\\*'\r\n    - '*\\Windows\\IME\\\\*'\r\n    - '*\\Windows\\addins\\\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_prog_location_network_connection.yml", "sigma_text_keyword": "title: Suspicious Program Location with Network Connections\r\nstatus: experimental\r\ndescription: Detects programs with network connections running in suspicious files system locations\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2017/03/19\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  definition: Use the following config to generate the necessary Event ID 3 Network Connection events\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    Image:\r\n    - '*\\$Recycle.bin'\r\n    - '*\\Users\\All Users\\\\*'\r\n    - '*\\Users\\Default\\\\*'\r\n    - '*\\Users\\Public\\\\*'\r\n    - C:\\Perflogs\\\\*\r\n    - '*\\config\\systemprofile\\\\*'\r\n    - '*\\Windows\\Fonts\\\\*'\r\n    - '*\\Windows\\IME\\\\*'\r\n    - '*\\Windows\\addins\\\\*'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "fp3knmUBtApo-eN_reb9": {"category": 5, "updated": "2019-02-26T14:15:32.000Z", "hash": "816c2c4e712ea6494c2bd62ab11b4914b2dff59ee3204970f437fba3e8830e40", "title": "Suspicious User Agent", "permission_id": 3, "title_keyword": "Suspicious User Agent", "released": "2017-07-08T15:59:05.000Z", "sigma_text": "title: Suspicious User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious malformed user agent strings in proxy logs\r\nreferences:\r\n- https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - user-agent\r\n    - '* (compatible;MSIE *'\r\n    - '*.0;Windows NT *'\r\n    - Mozilla/3.0 *\r\n    - Mozilla/2.0 *\r\n    - Mozilla/1.0 *\r\n    - Mozilla *\r\n    - ' Mozilla/*'\r\n    - Mozila/*\r\n    - _\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/proxy/proxy_ua_suspicious.yml", "sigma_text_keyword": "title: Suspicious User Agent\r\nstatus: experimental\r\ndescription: Detects suspicious malformed user agent strings in proxy logs\r\nreferences:\r\n- https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: proxy\r\ndetection:\r\n  selection:\r\n    UserAgent:\r\n    - user-agent\r\n    - '* (compatible;MSIE *'\r\n    - '*.0;Windows NT *'\r\n    - Mozilla/3.0 *\r\n    - Mozilla/2.0 *\r\n    - Mozilla/1.0 *\r\n    - Mozilla *\r\n    - ' Mozilla/*'\r\n    - Mozila/*\r\n    - _\r\n  condition: selection\r\nfields:\r\n- ClientIP\r\n- URL\r\n- UserAgent\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "fG1yxmcBFVBAemBcdkMD": {"category": 8, "updated": "2019-01-02T14:37:53.000Z", "hash": "71475764546d47b6794bd4cd89a68c0bc3bf9354186a9d9f54d6e15057912316", "title": "Zebrocy Tool APT28 (Sysmon).", "permission_id": 3, "title_keyword": "Zebrocy Tool APT28 (Sysmon).", "released": "2018-12-19T12:30:49.000Z", "sigma_text": "title: Zebrocy Tool APT28 (Sysmon).\r\ndescription: Zebrocy Tool Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/2018/11/20/sednit-whats-going-zebrocy/\r\n- https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/\r\n- https://twitter.com/VK_Intel/status/1075307666434600960\r\n- https://twitter.com/r0ny_123/status/1073613315450929152\r\n- https://twitter.com/DrunkBinary/status/1073227146833866752\r\n- https://twitter.com/r0ny_123/status/1071736798101954565\r\n- https://twitter.com/r0ny_123/status/1070231914533990401\r\n- https://twitter.com/VK_Intel/status/1076912689119748096\r\n- https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28sofacy.html\r\ndate: 2018/12/23\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 7768fd2812ceff05db8f969a7bed1de5615bfc5a\r\n    - da70c54a8b9fd236793bb2ab3f8a50e6cd37e2df\r\n    - a225d457c3396e647ffc710cd1edd4c74dc57152\r\n    - a659a765536d2099ecbde988d6763028ff92752e\r\n    - 20954fe36388ae8b1174424c8e4996ea2689f747\r\n    - e0d8829d2e76e9bb02e3b375981181ae02462c43\r\n    - d697160aecf152a81a89a6b5a7d9e1b8b5e121724038c676157ac72f20364edc\r\n    - cba5ab65a24be52214736bc1a5bc984953a9c15d0a3826d5b15e94036e5497df\r\n    - 25f0d1cbcc53d8cfd6d848e12895ce376fbbfaf279be591774b28f70852a4fd8\r\n    - 115fd8c619fa173622c7a1e84efdf6fed08a25d3ca3095404dcbd5ac3deb1f03\r\n    - f27836430742c9e014e1b080d89c47e43db299c2e00d0c0801a2830b41b57bc1\r\n    - 5b5e80f63c04402d0b282e95e32155b2f86cf604a6837853ab467111d4ac15e2\r\n    - dd7e69e14c88972ac173132b90b3f4bfb2d1faec15cca256a256dd3a12b6e75d\r\n    - 15a866c3c18046022a810aa97eaf2e20f942b8293b9cb6b4d5fb7746242c25b7\r\n    - 602d2901d55c2720f955503456ac2f68\r\n    - 47a026d93ae8e0cc292e8d7a71ddc89e\r\n    - 26b213343bac2b4c69a261a2f5c00e89\r\n    - 672f85ee2031c1ff6295b17058e30e07\r\n    - e49728cee1fdbbb957f657361fba3c9f\r\n    - 02c46f30f4c68a442cf7e13bebe8d3f8\r\n    - 6bc5f53d4082f12dd83aca45bae81e64\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- tool.zebrocy", "git_filepath": "", "sigma_text_keyword": "title: Zebrocy Tool APT28 (Sysmon).\r\ndescription: Zebrocy Tool Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.welivesecurity.com/2018/11/20/sednit-whats-going-zebrocy/\r\n- https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/\r\n- https://twitter.com/VK_Intel/status/1075307666434600960\r\n- https://twitter.com/r0ny_123/status/1073613315450929152\r\n- https://twitter.com/DrunkBinary/status/1073227146833866752\r\n- https://twitter.com/r0ny_123/status/1071736798101954565\r\n- https://twitter.com/r0ny_123/status/1070231914533990401\r\n- https://twitter.com/VK_Intel/status/1076912689119748096\r\n- https://www.vkremez.com/2018/12/lets-learn-dissecting-apt28sofacy.html\r\ndate: 2018/12/23\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 7768fd2812ceff05db8f969a7bed1de5615bfc5a\r\n    - da70c54a8b9fd236793bb2ab3f8a50e6cd37e2df\r\n    - a225d457c3396e647ffc710cd1edd4c74dc57152\r\n    - a659a765536d2099ecbde988d6763028ff92752e\r\n    - 20954fe36388ae8b1174424c8e4996ea2689f747\r\n    - e0d8829d2e76e9bb02e3b375981181ae02462c43\r\n    - d697160aecf152a81a89a6b5a7d9e1b8b5e121724038c676157ac72f20364edc\r\n    - cba5ab65a24be52214736bc1a5bc984953a9c15d0a3826d5b15e94036e5497df\r\n    - 25f0d1cbcc53d8cfd6d848e12895ce376fbbfaf279be591774b28f70852a4fd8\r\n    - 115fd8c619fa173622c7a1e84efdf6fed08a25d3ca3095404dcbd5ac3deb1f03\r\n    - f27836430742c9e014e1b080d89c47e43db299c2e00d0c0801a2830b41b57bc1\r\n    - 5b5e80f63c04402d0b282e95e32155b2f86cf604a6837853ab467111d4ac15e2\r\n    - dd7e69e14c88972ac173132b90b3f4bfb2d1faec15cca256a256dd3a12b6e75d\r\n    - 15a866c3c18046022a810aa97eaf2e20f942b8293b9cb6b4d5fb7746242c25b7\r\n    - 602d2901d55c2720f955503456ac2f68\r\n    - 47a026d93ae8e0cc292e8d7a71ddc89e\r\n    - 26b213343bac2b4c69a261a2f5c00e89\r\n    - 672f85ee2031c1ff6295b17058e30e07\r\n    - e49728cee1fdbbb957f657361fba3c9f\r\n    - 02c46f30f4c68a442cf7e13bebe8d3f8\r\n    - 6bc5f53d4082f12dd83aca45bae81e64\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- tool.zebrocy"}, "X53knmUBtApo-eN_m-NF": {"category": 8, "updated": "2018-10-26T15:12:57.000Z", "hash": "ffe358ac5fbf25fe0a97ebfcf615876867de728360abd339b4731726d4a27d42", "title": "FlawedAmmyy RAT Detection (Hashes).", "permission_id": 3, "title_keyword": "FlawedAmmyy RAT Detection (Hashes).", "released": "2018-06-06T09:11:39.000Z", "sigma_text": "title: FlawedAmmyy RAT Detection (Hashes).\r\ndescription: FlawedAmmyy RAT Detection Through Hashes.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\r\n- https://www.welivesecurity.com/2018/07/11/ammyy-admin-compromised-malware-world-cup-cover/\r\ndate: 2018/07/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 18436342cab7f1d078354e86cb749b1de388dcb4d1e22c959de91619947dfd63\r\n    - d82ca606007be9c988a5f961315c3eed1b12725c6a39aa13888e693dc3b9a975\r\n    - 8903d514549aa9568c7fea0123758b954b9703c301b5e4941acb33cccd0d7c57\r\n    - 2b53466eebd2c65f81004c567df9025ce68017241e421abcf33799bd3e827900\r\n    - 0d100ff26a764c65f283742b9ec9014f4fd64df4f1e586b57f3cdce6eadeedcd\r\n    - 9a7fb98dd4c83f1b4995b9b358fa236969e826e4cb84f63f4f9881387bc88ccf\r\n    - b0ad80bf5e28e81ad8a7b13eec9c5c206f412870814d492b78f7ce4d574413d2\r\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\r\n    - 404d3d65430fbbdadedb206a29e6158c66a8efa2edccb7e648c1dd017de47572\r\n    - cc0205845562e017ff8b3aafb17de167529d113fc680e07ee9d8753d81487b2f\r\n    - 790e7dc8b2544f1c76ff95e56315fee7ef3fe623975c37d049cc47f82f18e4f2\r\n    - 2d19c42f753dcee5b46344f352c11a1c645f0b77e205c218c985bd1eb988c7ce\r\n    - 6e701670350b4aea3d2ead4b929317b0a6d835aa4c0331b25d65ecbfbf8cb500\r\n    - 3cd39abdbeb171d713ee8367ab60909f72da865dbb3bd858e4f6d31fd9c930d0\r\n    - 1f5d31d41ebb417d161bc49d1c50533fcbff523bb583883b10b14974a3de8984\r\n    - 6877ac35a3085d6c10fa48655cf9c2399bd96c3924273515eaf89b511bbe356a\r\n    - 059c0588902be3e8a5d747df9e91f65cc50d908540bdeb08acf15242cc9a25b5\r\n    - c8b202e5a737b8b5902e852de730dbd170893f146ab9bbc9c06b0d93a7625e85\r\n    - 927fa5fea13f8f3c28e307ffea127fb3511b32024349b39bbaee63fac8dcded7\r\n    - 6048a55de1350238dfc0dd6ebed12ddfeb0a1f3788c1dc772801170756bf15c7\r\n    - adfdead4419c134f0ab2951f22cfd4d5a1d83c0abfe328ae456321fccf241eb6\r\n    - 022f662903c6626fb81e844f7761f6f1cbaa6339e391468b5fbfb6d0a1ebf8cb\r\n    - 3f5f5050adcf0d0894db64940299ac07994c4501b361dce179e3d45d9d155adf\r\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\r\n    - 6D11EA2D7DC9304E8E28E418B1DACFF7809BDC27\r\n    - 6FB4212B81CD9917293523F9E0C716D2CA4693D4\r\n    - 675ACA2C0A3E1EEB08D5919F2C866059798E6E93\r\n    - EFE562F61BE0B5D497F3AA9CF27C03EA212A53C9\r\n    - 9F9B8A102DD84ABF1349A82E4021884842DC22DD\r\n    - 4B4498B5AFDAA4B9A2A2195B8B7E376BE10C903E\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: FlawedAmmyy RAT Detection (Hashes).\r\ndescription: FlawedAmmyy RAT Detection Through Hashes.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\r\n- https://www.welivesecurity.com/2018/07/11/ammyy-admin-compromised-malware-world-cup-cover/\r\ndate: 2018/07/11\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 18436342cab7f1d078354e86cb749b1de388dcb4d1e22c959de91619947dfd63\r\n    - d82ca606007be9c988a5f961315c3eed1b12725c6a39aa13888e693dc3b9a975\r\n    - 8903d514549aa9568c7fea0123758b954b9703c301b5e4941acb33cccd0d7c57\r\n    - 2b53466eebd2c65f81004c567df9025ce68017241e421abcf33799bd3e827900\r\n    - 0d100ff26a764c65f283742b9ec9014f4fd64df4f1e586b57f3cdce6eadeedcd\r\n    - 9a7fb98dd4c83f1b4995b9b358fa236969e826e4cb84f63f4f9881387bc88ccf\r\n    - b0ad80bf5e28e81ad8a7b13eec9c5c206f412870814d492b78f7ce4d574413d2\r\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\r\n    - 404d3d65430fbbdadedb206a29e6158c66a8efa2edccb7e648c1dd017de47572\r\n    - cc0205845562e017ff8b3aafb17de167529d113fc680e07ee9d8753d81487b2f\r\n    - 790e7dc8b2544f1c76ff95e56315fee7ef3fe623975c37d049cc47f82f18e4f2\r\n    - 2d19c42f753dcee5b46344f352c11a1c645f0b77e205c218c985bd1eb988c7ce\r\n    - 6e701670350b4aea3d2ead4b929317b0a6d835aa4c0331b25d65ecbfbf8cb500\r\n    - 3cd39abdbeb171d713ee8367ab60909f72da865dbb3bd858e4f6d31fd9c930d0\r\n    - 1f5d31d41ebb417d161bc49d1c50533fcbff523bb583883b10b14974a3de8984\r\n    - 6877ac35a3085d6c10fa48655cf9c2399bd96c3924273515eaf89b511bbe356a\r\n    - 059c0588902be3e8a5d747df9e91f65cc50d908540bdeb08acf15242cc9a25b5\r\n    - c8b202e5a737b8b5902e852de730dbd170893f146ab9bbc9c06b0d93a7625e85\r\n    - 927fa5fea13f8f3c28e307ffea127fb3511b32024349b39bbaee63fac8dcded7\r\n    - 6048a55de1350238dfc0dd6ebed12ddfeb0a1f3788c1dc772801170756bf15c7\r\n    - adfdead4419c134f0ab2951f22cfd4d5a1d83c0abfe328ae456321fccf241eb6\r\n    - 022f662903c6626fb81e844f7761f6f1cbaa6339e391468b5fbfb6d0a1ebf8cb\r\n    - 3f5f5050adcf0d0894db64940299ac07994c4501b361dce179e3d45d9d155adf\r\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\r\n    - 6D11EA2D7DC9304E8E28E418B1DACFF7809BDC27\r\n    - 6FB4212B81CD9917293523F9E0C716D2CA4693D4\r\n    - 675ACA2C0A3E1EEB08D5919F2C866059798E6E93\r\n    - EFE562F61BE0B5D497F3AA9CF27C03EA212A53C9\r\n    - 9F9B8A102DD84ABF1349A82E4021884842DC22DD\r\n    - 4B4498B5AFDAA4B9A2A2195B8B7E376BE10C903E\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "O53knmUBtApo-eN_muN0": {"category": 8, "updated": "2018-11-30T12:44:06.000Z", "hash": "bfbd4b470499072b2a95b350dae814408901bf7dc40d5f1d10daa85db782d8cc", "title": "InvisiMole SpyWare Detector.", "permission_id": 3, "title_keyword": "InvisiMole SpyWare Detector.", "released": "2018-06-12T08:28:03.000Z", "sigma_text": "title: InvisiMole SpyWare Detector.\r\ndescription: InvisiMole SpyWare Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://github.com/eset/malware-ioc/tree/master/invisimole\r\ndate: 2018/06/07\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 5EE6E0410052029EAFA10D1669AE3AA04B508BF9\r\n    - 2FCC87AB226F4A1CC713B13A12421468C82CD586\r\n    - B6BA65A48FFEB800C29822265190B8EAEA3935B1\r\n    - C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F\r\n    - A5A20BC333F22FD89C34A532680173CBCD287FF8\r\n  selection_registry1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\IE\\Cache'\r\n    keywords:\r\n    - Index\r\n  selection_registry2:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Console'\r\n    - '*\\Software\\Microsoft\\Direct3D'\r\n    keywords:\r\n    - Settings\r\n    - Type\r\n  selection_registry3:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\OLE'\r\n    - '*\\Software\\Microsoft\\Direct3D'\r\n    keywords:\r\n    - Common\r\n    - Current\r\n    - ENC\r\n    - FFLT\r\n    - Flag1\r\n    - FlagLF\r\n    - FlagLF2\r\n    - IfData\r\n    - INFO\r\n    - InstallA\r\n    - InstallB\r\n    - LegacyImpersonationNumber\r\n    - LM\r\n    - MachineAccessStateData\r\n    - MachineState*\r\n    - RPT\r\n    - SP2\r\n    - SP3\r\n    - SettingsMC\r\n    - SettingsSR1\r\n    - SettingsSR2\r\n    EventType: SetValue\r\n  condition: selection or selection_registry1 or selection_registry2 or selection_registry3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: InvisiMole SpyWare Detector.\r\ndescription: InvisiMole SpyWare Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://github.com/eset/malware-ioc/tree/master/invisimole\r\ndate: 2018/06/07\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 5EE6E0410052029EAFA10D1669AE3AA04B508BF9\r\n    - 2FCC87AB226F4A1CC713B13A12421468C82CD586\r\n    - B6BA65A48FFEB800C29822265190B8EAEA3935B1\r\n    - C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F\r\n    - A5A20BC333F22FD89C34A532680173CBCD287FF8\r\n  selection_registry1:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\IE\\Cache'\r\n    keywords:\r\n    - Index\r\n  selection_registry2:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Console'\r\n    - '*\\Software\\Microsoft\\Direct3D'\r\n    keywords:\r\n    - Settings\r\n    - Type\r\n  selection_registry3:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\SOFTWARE\\Microsoft\\OLE'\r\n    - '*\\Software\\Microsoft\\Direct3D'\r\n    keywords:\r\n    - Common\r\n    - Current\r\n    - ENC\r\n    - FFLT\r\n    - Flag1\r\n    - FlagLF\r\n    - FlagLF2\r\n    - IfData\r\n    - INFO\r\n    - InstallA\r\n    - InstallB\r\n    - LegacyImpersonationNumber\r\n    - LM\r\n    - MachineAccessStateData\r\n    - MachineState*\r\n    - RPT\r\n    - SP2\r\n    - SP3\r\n    - SettingsMC\r\n    - SettingsSR1\r\n    - SettingsSR2\r\n    EventType: SetValue\r\n  condition: selection or selection_registry1 or selection_registry2 or selection_registry3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1204"}, "V53knmUBtApo-eN_lOJ9": {"category": 15, "updated": "2018-08-31T16:19:33.000Z", "hash": "3de9c8e1ca83af9cd83af43627f736aacd25b2998edbddc3e945bf9939ef4bc0", "title": "MSHTA Spawning Windows Shell", "permission_id": 3, "title_keyword": "MSHTA Spawning Windows Shell", "released": "2017-03-04T22:33:09.000Z", "sigma_text": "title: MSHTA Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from MSHTA.\nreferences:\n    - https://www.trustedsec.com/july-2015/malicious-htas/\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mshta.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    filter:\n        CommandLine:\n            - '*/HP/HP*'\n            - '*\\HP\\HP*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1170\nfalsepositives:\n    - Printer software / driver installations\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_mshta_spawn_shell.yml", "sigma_text_keyword": "title: MSHTA Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from MSHTA.\nreferences:\n    - https://www.trustedsec.com/july-2015/malicious-htas/\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mshta.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    filter:\n        CommandLine:\n            - '*/HP/HP*'\n            - '*\\HP\\HP*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1170\nfalsepositives:\n    - Printer software / driver installations\nlevel: high\n"}, "Vp3knmUBtApo-eN_m-MM": {"category": 8, "updated": "2018-11-30T12:34:50.000Z", "hash": "f857429eb4b0ce2ee261521b319845b10e5a6ebc7a8f6594d19be23de70f291a", "title": "Olympic Destroyer Detector.", "permission_id": 3, "title_keyword": "Olympic Destroyer Detector.", "released": "2018-06-20T11:36:01.000Z", "sigma_text": "title: Olympic Destroyer Detector.\r\ndescription: Olympic Destroyer Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://securelist.com/olympic-destroyer-is-still-alive/86169/\r\ndate: 2018/06/19\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 9bc365a16c63f25dfddcbe11da042974\r\n    - da93e6651c5ba3e3e96f4ae2dd763d94\r\n    - 6ccd8133f250d4babefbd66b898739b9\r\n    - abe771f280cdea6e7eaf19a26b1a9488\r\n    - b60da65b8d3627a89481efb23d59713a\r\n    - b94bdb63f0703d32c20f4b2e5500dbbe\r\n    - bb5e8733a940fedfb1ef6b0e0ec3635c\r\n    - 97ddc336d7d92b7db17d098ec2ee6092\r\n    - 1d0cf431e623b21aeae8f2b8414d2a73\r\n    - 0e7b32d23fbd6d62a593c234bafa2311\r\n    - e2e102291d259f054625cc85318b7ef5\r\n    - 0c6ddc3a722b865cc2d1185e27cef9b8\r\n    - 54b06b05b6b92a8f2ff02fdf47baad0e\r\n    - 4247901eca6d87f5f3af7df8249ea825\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging'\r\n    Details:\r\n    - \"0\"\r\n    EventType: SetValue\r\n  condition: selection or selection_registry\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: Olympic Destroyer Detector.\r\ndescription: Olympic Destroyer Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://securelist.com/olympic-destroyer-is-still-alive/86169/\r\ndate: 2018/06/19\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 9bc365a16c63f25dfddcbe11da042974\r\n    - da93e6651c5ba3e3e96f4ae2dd763d94\r\n    - 6ccd8133f250d4babefbd66b898739b9\r\n    - abe771f280cdea6e7eaf19a26b1a9488\r\n    - b60da65b8d3627a89481efb23d59713a\r\n    - b94bdb63f0703d32c20f4b2e5500dbbe\r\n    - bb5e8733a940fedfb1ef6b0e0ec3635c\r\n    - 97ddc336d7d92b7db17d098ec2ee6092\r\n    - 1d0cf431e623b21aeae8f2b8414d2a73\r\n    - 0e7b32d23fbd6d62a593c234bafa2311\r\n    - e2e102291d259f054625cc85318b7ef5\r\n    - 0c6ddc3a722b865cc2d1185e27cef9b8\r\n    - 54b06b05b6b92a8f2ff02fdf47baad0e\r\n    - 4247901eca6d87f5f3af7df8249ea825\r\n  selection_registry:\r\n    EventID: \"13\"\r\n    TargetObject:\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging'\r\n    - '*\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging'\r\n    Details:\r\n    - \"0\"\r\n    EventType: SetValue\r\n  condition: selection or selection_registry\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1112\r\n- attack.Execution\r\n- attack.t1204"}, "yp3knmUBtApo-eN_hd9y": {"category": 3, "updated": "2018-04-20T10:12:53.000Z", "hash": "d60ee696488c98a137a13df338b1644923e1f6c4d25d9f81b813385cfdf7d887", "title": "Multiple Failed Logins with Different Accounts from Single Source System", "permission_id": 3, "title_keyword": "Multiple Failed Logins with Different Accounts from Single Source System", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nlogsource:\n    product: linux\n    service: auth\ndetection:\n    selection:\n        pam_message: \"authentication failure\"\n        pam_user: not null\n        pam_rhost: not null\n    timeframe: 24h \n    condition: selection | count(pam_user) by pam_rhost > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Workstations with frequently changing users \nlevel: medium\n", "git_filepath": "/linux/lnx_susp_failed_logons_single_source.yml", "sigma_text_keyword": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nlogsource:\n    product: linux\n    service: auth\ndetection:\n    selection:\n        pam_message: \"authentication failure\"\n        pam_user: not null\n        pam_rhost: not null\n    timeframe: 24h \n    condition: selection | count(pam_user) by pam_rhost > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Workstations with frequently changing users \nlevel: medium\n"}, "jp3knmUBtApo-eN_ieDY": {"category": 15, "updated": "2019-02-26T15:14:26.000Z", "hash": "c52ffc34392f0293f0d15e6cf5f5af7652129d9567071d0b340804ab906baec2", "title": "System File Execution Location Anomaly", "permission_id": 3, "title_keyword": "System File Execution Location Anomaly", "released": "2017-11-27T13:09:22.000Z", "sigma_text": "title: System File Execution Location Anomaly\r\nstatus: experimental\r\ndescription: Detects a Windows program executable started in a suspicious folder\r\nreferences:\r\n- https://twitter.com/GelosSnake/status/934900723426439170\r\nauthor: Florian Roth\r\ndate: 2017/11/27\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\svchost.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\services.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\regsvr32.exe'\r\n    - '*\\spoolsv.exe'\r\n    - '*\\lsass.exe'\r\n    - '*\\smss.exe'\r\n    - '*\\csrss.exe'\r\n    - '*\\conhost.exe'\r\n  filter:\r\n    Image:\r\n    - '*\\System32\\\\*'\r\n    - '*\\SysWow64\\\\*'\r\n  condition: selection and not filter\r\ntags:\r\n- attack.defense_evasion\r\nfalsepositives:\r\n- Exotic software\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_system_exe_anomaly.yml", "sigma_text_keyword": "title: System File Execution Location Anomaly\r\nstatus: experimental\r\ndescription: Detects a Windows program executable started in a suspicious folder\r\nreferences:\r\n- https://twitter.com/GelosSnake/status/934900723426439170\r\nauthor: Florian Roth\r\ndate: 2017/11/27\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\svchost.exe'\r\n    - '*\\rundll32.exe'\r\n    - '*\\services.exe'\r\n    - '*\\powershell.exe'\r\n    - '*\\regsvr32.exe'\r\n    - '*\\spoolsv.exe'\r\n    - '*\\lsass.exe'\r\n    - '*\\smss.exe'\r\n    - '*\\csrss.exe'\r\n    - '*\\conhost.exe'\r\n  filter:\r\n    Image:\r\n    - '*\\System32\\\\*'\r\n    - '*\\SysWow64\\\\*'\r\n  condition: selection and not filter\r\ntags:\r\n- attack.defense_evasion\r\nfalsepositives:\r\n- Exotic software\r\nlevel: high"}, "i53knmUBtApo-eN_p-XG": {"category": 15, "updated": "2019-02-26T13:55:29.000Z", "hash": "41cb16daea626ca1cdce63da4e448faf96dc12b7699595f966114b9655b5d926", "title": "Possible Shim Database Persistence via sdbinst.exe", "permission_id": 3, "title_keyword": "Possible Shim Database Persistence via sdbinst.exe", "released": "2018-08-05T11:55:04.000Z", "sigma_text": "title: Possible Shim Database Persistence via sdbinst.exe\r\nstatus: experimental\r\ndescription: Detects execution of sdbinst writing to default shim database path C:\\Windows\\AppPatch\\*\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\r\ntags:\r\n- attack.persistence\r\n- attack.t1138\r\nauthor: Markus Neis\r\ndate: 2018/08/03\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\sdbinst.exe'\r\n    CommandLine:\r\n    - '*\\AppPatch\\\\*}.sdb*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_sdbinst_shim_persistence.yml", "sigma_text_keyword": "title: Possible Shim Database Persistence via sdbinst.exe\r\nstatus: experimental\r\ndescription: Detects execution of sdbinst writing to default shim database path C:\\Windows\\AppPatch\\*\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\r\ntags:\r\n- attack.persistence\r\n- attack.t1138\r\nauthor: Markus Neis\r\ndate: 2018/08/03\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\sdbinst.exe'\r\n    CommandLine:\r\n    - '*\\AppPatch\\\\*}.sdb*'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "BJ3knmUBtApo-eN_nuS8": {"category": 15, "updated": "2019-02-26T13:52:21.000Z", "hash": "7ae9cd046f0f4a1ffd0eacb8ada72e2b1664d8e23f546d78b4f7dfaf79910f9b", "title": "Usage of Sysinternals Tools", "permission_id": 3, "title_keyword": "Usage of Sysinternals Tools", "released": "2018-08-30T11:16:28.000Z", "sigma_text": "title: Usage of Sysinternals Tools\r\nstatus: experimental\r\ndescription: Detects the usage of Sysinternals Tools due to accepteula key beeing added to Registry\r\nreferences:\r\n- https://twitter.com/Moti_B/status/1008587936735035392\r\ndate: 2017/08/28\r\nauthor: Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 13\r\n    TargetObject: '*\\EulaAccepted'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '* -accepteula*'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Legitimate use of SysInternals tools\r\n- Programs that use the same Registry Key\r\nlevel: low", "git_filepath": "/windows/sysmon/sysmon_sysinternals_eula_accepted.yml", "sigma_text_keyword": "title: Usage of Sysinternals Tools\r\nstatus: experimental\r\ndescription: Detects the usage of Sysinternals Tools due to accepteula key beeing added to Registry\r\nreferences:\r\n- https://twitter.com/Moti_B/status/1008587936735035392\r\ndate: 2017/08/28\r\nauthor: Markus Neis\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 13\r\n    TargetObject: '*\\EulaAccepted'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine: '* -accepteula*'\r\n  condition: selection1 or selection2\r\nfalsepositives:\r\n- Legitimate use of SysInternals tools\r\n- Programs that use the same Registry Key\r\nlevel: low"}, "6p3knmUBtApo-eN_i-D7": {"category": 8, "updated": "2018-10-26T14:14:04.000Z", "hash": "94fc57a70d1e8c5454e042770943ddf0596e5f43aff7726d69da6595cd5e7a36", "title": "Net IPC Share (Sysmon).", "permission_id": 3, "title_keyword": "Net IPC Share (Sysmon).", "released": "2018-09-07T12:38:17.000Z", "sigma_text": "title: Net IPC Share (Sysmon).\r\ndescription: Detects net usage accessing IPC$.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - net.exe\r\n    CommandLine:\r\n    - '*ipc$*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some admins use it, mostly bad things.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.1059", "git_filepath": null, "sigma_text_keyword": "title: Net IPC Share (Sysmon).\r\ndescription: Detects net usage accessing IPC$.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - net.exe\r\n    CommandLine:\r\n    - '*ipc$*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Some admins use it, mostly bad things.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.1059"}, "DZ3knmUBtApo-eN_nuTq": {"category": 11, "updated": "2018-10-23T14:45:42.000Z", "hash": "4a5d3199ef7273478f4e4aa1d839da873119165fe066d35169ac44ef6b64c6b1", "title": "Password Dumper Activity on LSASS", "permission_id": 3, "title_keyword": "Password Dumper Activity on LSASS", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Password Dumper Activity on LSASS\r\ndescription: Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/jackcr/status/807385668833968128\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4656\"\r\n    ProcessName: C:\\Windows\\System32\\lsass.exe\r\n    AccessMask: \"0x705\"\r\n    ObjectType: SAM_DOMAIN\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high", "git_filepath": "/windows/builtin/win_susp_lsass_dump.yml", "sigma_text_keyword": "title: Password Dumper Activity on LSASS\r\ndescription: Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/jackcr/status/807385668833968128\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: \"4656\"\r\n    ProcessName: C:\\Windows\\System32\\lsass.exe\r\n    AccessMask: \"0x705\"\r\n    ObjectType: SAM_DOMAIN\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high"}, "v53knmUBtApo-eN_l-Iq": {"category": 8, "updated": "2019-02-26T13:23:01.000Z", "hash": "f86de25384f15ea5ba24079f486c71da3fb21e17b305af4f2ef36c3dab5e3404", "title": "Detects malware AcroRD32.exe execution process", "permission_id": 3, "title_keyword": "Detects malware AcroRD32.exe execution process", "released": "2018-04-25T10:58:59.000Z", "sigma_text": "title: Detects malware AcroRD32.exe execution process\r\nstatus: stable\r\ndescription: Masquerading malware with the name of a legitimate process name for Adobe's Acrobat Reader\r\nreferences:\r\n- https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report-appendix.zip\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\AcroRD32.exe'\r\n  filter:\r\n    Image:\r\n    - '*\\Adobe\\Acrobat Reader DC\\Reader\\AcroRD32.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\n- Legitimate process\r\n- User's destination folder\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1036", "git_filepath": null, "sigma_text_keyword": "title: Detects malware AcroRD32.exe execution process\r\nstatus: stable\r\ndescription: Masquerading malware with the name of a legitimate process name for Adobe's Acrobat Reader\r\nreferences:\r\n- https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report-appendix.zip\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/03/13\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\AcroRD32.exe'\r\n  filter:\r\n    Image:\r\n    - '*\\Adobe\\Acrobat Reader DC\\Reader\\AcroRD32.exe'\r\n  condition: selection and not filter\r\nfields:\r\n- Image\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Administrative activity\r\n- Legitimate process\r\n- User's destination folder\r\nlevel: high\r\ntags:\r\n- attack.Defense Evasion\r\n- attack.t1036"}, "dW0Ko2gBFVBAemBcLNzV": {"category": 8, "updated": "2019-01-31T08:40:30.000Z", "hash": "33a9624adf632fc3893af2c8055d43f89596c095ec11d03fedc4a742716b834d", "title": "RDP Login from localhost", "permission_id": 3, "title_keyword": "RDP Login from localhost", "released": "2019-01-31T08:32:59.000Z", "sigma_text": "title: RDP Login from localhost\r\ndescription: RDP login with localhost source address may be a tunnelled login\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html\r\ntags:\r\n- attack.Lateral Movement\r\n- attack.t1076\r\n- attack.Command And Control\r\n- attack.t1071\r\n- attack.t1043\r\nstatus: experimental\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 10\r\n    IpAddress:\r\n    - ::1\r\n    - 127.0.0.1\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administration\r\nlevel: low", "git_filepath": "", "sigma_text_keyword": "title: RDP Login from localhost\r\ndescription: RDP login with localhost source address may be a tunnelled login\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html\r\ntags:\r\n- attack.Lateral Movement\r\n- attack.t1076\r\n- attack.Command And Control\r\n- attack.t1071\r\n- attack.t1043\r\nstatus: experimental\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4624\r\n    LogonType: 10\r\n    IpAddress:\r\n    - ::1\r\n    - 127.0.0.1\r\n  condition: selection\r\nfalsepositives:\r\n- Legitimate administration\r\nlevel: low"}, "z53knmUBtApo-eN_hd-R": {"category": 8, "updated": "2018-10-26T14:39:20.000Z", "hash": "82bf7d3a23288dbdfe38dcc307e5cbaf17bf911f754edd95fa7d0e6f5a685c70", "title": "WSF/JSE/JS/VBA/VBE File Execution (Sysmon).", "permission_id": 3, "title_keyword": "WSF/JSE/JS/VBA/VBE File Execution (Sysmon).", "released": "2018-09-07T12:33:21.000Z", "sigma_text": "title: WSF/JSE/JS/VBA/VBE File Execution (Sysmon).\r\ndescription: Detects suspicious file execution by wscript and cscript.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - wscript.exe\r\n    - cscript.exe\r\n    CommandLine:\r\n    - '*.jse'\r\n    - '*.vbe'\r\n    - '*.js'\r\n    - '*.vba'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059\r\n- attack.t1204", "git_filepath": null, "sigma_text_keyword": "title: WSF/JSE/JS/VBA/VBE File Execution (Sysmon).\r\ndescription: Detects suspicious file execution by wscript and cscript.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - wscript.exe\r\n    - cscript.exe\r\n    CommandLine:\r\n    - '*.jse'\r\n    - '*.vbe'\r\n    - '*.js'\r\n    - '*.vba'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1059\r\n- attack.t1204"}, "kZ3knmUBtApo-eN_ruZq": {"category": 12, "updated": "2019-02-26T14:35:10.000Z", "hash": "0d98a5aa8f4e01ccd51b2b10ba3a1299207da8ae12fab0ec862b11636f05fe5f", "title": "NotPetya Ransomware Activity", "permission_id": 3, "title_keyword": "NotPetya Ransomware Activity", "released": "2017-06-28T07:09:12.000Z", "sigma_text": "title: NotPetya Ransomware Activity\r\nstatus: experimental\r\ndescription: Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil\r\nauthor: Florian Roth, Tom Ueltschi\r\nreferences:\r\n- https://securelist.com/schroedingers-petya/78870/\r\n- https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100\r\ntags:\r\n- attack.execution\r\n- attack.credential_access\r\n- attack.defense_evasion\r\n- attack.t1085\r\n- attack.t1070\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  fsutil_clean_journal:\r\n    EventID: 1\r\n    Image: '*\\fsutil.exe'\r\n    CommandLine: '* deletejournal *'\r\n  pipe_com:\r\n    EventID: 1\r\n    CommandLine: '*\\AppData\\Local\\Temp\\* \\\\.\\pipe\\*'\r\n  event_clean:\r\n    EventID: 1\r\n    Image: '*\\wevtutil.exe'\r\n    CommandLine: '* cl *'\r\n  rundll32_dash1:\r\n    EventID: 1\r\n    Image: '*\\rundll32.exe'\r\n    CommandLine: '*.dat,#1'\r\n  perfc_keyword:\r\n  - '*\\perfc.dat*'\r\n  condition: fsutil_clean_journal or  pipe_com or event_clean or rundll32_dash1 or perfc_keyword\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Admin activity\r\nlevel: critical", "git_filepath": "/windows/malware/sysmon_malware_notpetya.yml", "sigma_text_keyword": "title: NotPetya Ransomware Activity\r\nstatus: experimental\r\ndescription: Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil\r\nauthor: Florian Roth, Tom Ueltschi\r\nreferences:\r\n- https://securelist.com/schroedingers-petya/78870/\r\n- https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100\r\ntags:\r\n- attack.execution\r\n- attack.credential_access\r\n- attack.defense_evasion\r\n- attack.t1085\r\n- attack.t1070\r\n- attack.t1003\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  fsutil_clean_journal:\r\n    EventID: 1\r\n    Image: '*\\fsutil.exe'\r\n    CommandLine: '* deletejournal *'\r\n  pipe_com:\r\n    EventID: 1\r\n    CommandLine: '*\\AppData\\Local\\Temp\\* \\\\.\\pipe\\*'\r\n  event_clean:\r\n    EventID: 1\r\n    Image: '*\\wevtutil.exe'\r\n    CommandLine: '* cl *'\r\n  rundll32_dash1:\r\n    EventID: 1\r\n    Image: '*\\rundll32.exe'\r\n    CommandLine: '*.dat,#1'\r\n  perfc_keyword:\r\n  - '*\\perfc.dat*'\r\n  condition: fsutil_clean_journal or  pipe_com or event_clean or rundll32_dash1 or perfc_keyword\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Admin activity\r\nlevel: critical"}, "gp3knmUBtApo-eN_oeTa": {"category": 8, "updated": "2019-02-26T13:19:04.000Z", "hash": "310bbcabc6e464a6bdff3ac826757a92021e58cb3a33d09972d364bb9d7d0f21", "title": "Suspicious PowerShell ZIPing activity", "permission_id": 3, "title_keyword": "Suspicious PowerShell ZIPing activity", "released": "2018-05-03T06:14:53.000Z", "sigma_text": "title: Suspicious PowerShell ZIPing activity\r\ndescription: Detects PowerShell commands used for creation/updating ZIP archives\r\nreference:\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive?view=powershell-6\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-6\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/05/03\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keyword1:\r\n  - Compress-Archive\r\n  keyword2:\r\n  - Expand-Archive\r\n  keyword3:\r\n  - Microsoft.PowerShell.Archive\r\n  condition: (keyword1 or keyword2) and keyword3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Collection\r\n- attack.t1074\r\n- attack.Execution\r\n- attack.t1002", "git_filepath": null, "sigma_text_keyword": "title: Suspicious PowerShell ZIPing activity\r\ndescription: Detects PowerShell commands used for creation/updating ZIP archives\r\nreference:\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive?view=powershell-6\r\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-6\r\nauthor: Eugene Nechiporenko, SOC Prime\r\ndate: 2018/05/03\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keyword1:\r\n  - Compress-Archive\r\n  keyword2:\r\n  - Expand-Archive\r\n  keyword3:\r\n  - Microsoft.PowerShell.Archive\r\n  condition: (keyword1 or keyword2) and keyword3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Collection\r\n- attack.t1074\r\n- attack.Execution\r\n- attack.t1002"}, "4J3knmUBtApo-eN_pOQs": {"category": 15, "updated": "2019-02-26T14:54:05.000Z", "hash": "9367985194b994bab3c689fcf592142a209d6a2652afa69f94286c246ae2790b", "title": "Suspicious Typical Malware Back Connect Ports", "permission_id": 3, "title_keyword": "Suspicious Typical Malware Back Connect Ports", "released": "2017-03-19T14:22:27.000Z", "sigma_text": "title: Suspicious Typical Malware Back Connect Ports\r\nstatus: experimental\r\ndescription: Detects programs that connect to typical malware back connetc ports based on statistical analysis from two different sandbox system databases\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2017/03/19\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationPort:\r\n    - 4443\r\n    - 2448\r\n    - 8143\r\n    - 1777\r\n    - 1443\r\n    - 243\r\n    - 65535\r\n    - 13506\r\n    - 3360\r\n    - 200\r\n    - 198\r\n    - 49180\r\n    - 13507\r\n    - 6625\r\n    - 4444\r\n    - 4438\r\n    - 1904\r\n    - 13505\r\n    - 13504\r\n    - 12102\r\n    - 9631\r\n    - 5445\r\n    - 2443\r\n    - 777\r\n    - 13394\r\n    - 13145\r\n    - 12103\r\n    - 5552\r\n    - 3939\r\n    - 3675\r\n    - 666\r\n    - 473\r\n    - 5649\r\n    - 4455\r\n    - 4433\r\n    - 1817\r\n    - 100\r\n    - 65520\r\n    - 1960\r\n    - 1515\r\n    - 743\r\n    - 700\r\n    - 14154\r\n    - 14103\r\n    - 14102\r\n    - 12322\r\n    - 10101\r\n    - 7210\r\n    - 4040\r\n    - 9943\r\n  filter:\r\n    Image: '*\\Program Files*'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- unknown\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_malware_backconnect_ports.yml", "sigma_text_keyword": "title: Suspicious Typical Malware Back Connect Ports\r\nstatus: experimental\r\ndescription: Detects programs that connect to typical malware back connetc ports based on statistical analysis from two different sandbox system databases\r\nreferences:\r\n- https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\r\nauthor: Florian Roth\r\ndate: 2017/03/19\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\n  description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationPort:\r\n    - 4443\r\n    - 2448\r\n    - 8143\r\n    - 1777\r\n    - 1443\r\n    - 243\r\n    - 65535\r\n    - 13506\r\n    - 3360\r\n    - 200\r\n    - 198\r\n    - 49180\r\n    - 13507\r\n    - 6625\r\n    - 4444\r\n    - 4438\r\n    - 1904\r\n    - 13505\r\n    - 13504\r\n    - 12102\r\n    - 9631\r\n    - 5445\r\n    - 2443\r\n    - 777\r\n    - 13394\r\n    - 13145\r\n    - 12103\r\n    - 5552\r\n    - 3939\r\n    - 3675\r\n    - 666\r\n    - 473\r\n    - 5649\r\n    - 4455\r\n    - 4433\r\n    - 1817\r\n    - 100\r\n    - 65520\r\n    - 1960\r\n    - 1515\r\n    - 743\r\n    - 700\r\n    - 14154\r\n    - 14103\r\n    - 14102\r\n    - 12322\r\n    - 10101\r\n    - 7210\r\n    - 4040\r\n    - 9943\r\n  filter:\r\n    Image: '*\\Program Files*'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- unknown\r\nlevel: medium"}, "JZ3knmUBtApo-eN_k-J-": {"category": 11, "updated": "2018-10-25T10:04:27.000Z", "hash": "0756412ef3962fd137af348e49dbf536f9fee3554471dd1ec989261c6007d44d", "title": "Possible Remote Password Change Through SAMR", "permission_id": 3, "title_keyword": "Possible Remote Password Change Through SAMR", "released": "2017-06-09T12:05:40.000Z", "sigma_text": "title: Possible Remote Password Change Through SAMR\r\ndescription: Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\r\nauthor: Dimitrios Slamaris\r\ntags:\r\n- attack.credential_access\r\n- attack.t1212\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  samrpipe:\r\n    EventID: \"5145\"\r\n    RelativeTargetName: samr\r\n  passwordchanged:\r\n    EventID: \"4738\"\r\n  passwordchanged_filter:\r\n    PasswordLastSet: \"\"\r\n  timeframe: 15s\r\n  condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_samr_pwset.yml", "sigma_text_keyword": "title: Possible Remote Password Change Through SAMR\r\ndescription: Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\r\nauthor: Dimitrios Slamaris\r\ntags:\r\n- attack.credential_access\r\n- attack.t1212\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  samrpipe:\r\n    EventID: \"5145\"\r\n    RelativeTargetName: samr\r\n  passwordchanged:\r\n    EventID: \"4738\"\r\n  passwordchanged_filter:\r\n    PasswordLastSet: \"\"\r\n  timeframe: 15s\r\n  condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\r\nlevel: medium"}, "FG6JM2kBFVBAemBcEF2A": {"category": 15, "updated": "2019-02-28T09:56:54.000Z", "hash": "73c6bf83ca4bf1df9aee8e40b61b6e3206f0c5dbab442a15932ce1e977de3e3d", "title": "CobaltStrike Process Injection", "permission_id": 3, "title_keyword": "CobaltStrike Process Injection", "released": "2019-02-28T09:56:54.000Z", "sigma_text": "title: CobaltStrike Process Injection\r\ndescription: Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons\r\nreferences:\r\n- https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f\r\nstatus: experimental\r\nauthor: Olaf Hartong, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 8\r\n    TargetProcessAddress: '*0B80'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.process_injection\r\n- attack.t1055", "git_filepath": "/windows/sysmon/sysmon_cobaltstrike_process_injection.yml", "sigma_text_keyword": "title: CobaltStrike Process Injection\r\ndescription: Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons\r\nreferences:\r\n- https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f\r\nstatus: experimental\r\nauthor: Olaf Hartong, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 8\r\n    TargetProcessAddress: '*0B80'\r\n  condition: selection\r\nfalsepositives:\r\n- unknown\r\nlevel: high\r\ntags:\r\n- attack.process_injection\r\n- attack.t1055"}, "OiVTiWcBqjf_D59H4ebt": {"category": 8, "updated": "2019-01-02T14:39:35.000Z", "hash": "efa19bb4e37997fb3d33723731fe4531472dfda4861e7811ba1dc441aaf49cfa", "title": "TA505 Group targets the US retail industry (Sysmon).", "permission_id": 3, "title_keyword": "TA505 Group targets the US retail industry (Sysmon).", "released": "2018-12-07T15:40:35.000Z", "sigma_text": "title: TA505 Group targets the US retail industry (Sysmon).\r\ndescription: TA505 Group targets the US retail industry.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments\r\ndate: 2018/12/06\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 9206f08916ab6f9708d81a6cf2f916e2f606fd048a6b2355a39db97e258d0883\r\n    - 06c637ac62cab511c5c42e142855ba0447a1c8ac8ee4b0f1f8b00faa5310fe9f\r\n    - 609b0a416f9b16a6df9b967dc32cd739402af31566e019a8fb8abdf3cb573e30\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: TA505 Group targets the US retail industry (Sysmon).\r\ndescription: TA505 Group targets the US retail industry.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments\r\ndate: 2018/12/06\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 9206f08916ab6f9708d81a6cf2f916e2f606fd048a6b2355a39db97e258d0883\r\n    - 06c637ac62cab511c5c42e142855ba0447a1c8ac8ee4b0f1f8b00faa5310fe9f\r\n    - 609b0a416f9b16a6df9b967dc32cd739402af31566e019a8fb8abdf3cb573e30\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "IG0ro2gBFVBAemBcRt3y": {"category": 8, "updated": "2019-01-31T09:09:08.000Z", "hash": "29a63661ed104306ef64e0927d411e983e781f11bbd6bc76de8060d1273496fb", "title": "Renamed Powershell.exe", "permission_id": 3, "title_keyword": "Renamed Powershell.exe", "released": "2019-01-31T09:09:08.000Z", "sigma_text": "title: Renamed Powershell.exe\r\nstatus: experimental\r\ndescription: Detects copying and renaming of powershell.exe before execution (RETEFE malware DOC/macro starting Sept 2018)\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1086/\r\n- https://isc.sans.edu/forums/diary/Maldoc+Duplicating+PowerShell+Prior+to+Use/24254/\r\ntags:\r\n- attack.t1086\r\n- attack.execution\r\nauthor: Tom Ueltschi (@c_APT_ure), Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    EventID: 1\r\n    Description: Windows PowerShell\r\n  selection1:\r\n    EventID: 1\r\n    Description: Windows PowerShell ISE\r\n  exclusion_1:\r\n    Image:\r\n    - powershell.exe\r\n    - powershell_ise.exe\r\n  condition: (selection0 or selection1) and not exclusion_1\r\nfalsepositives:\r\n- penetration tests, red teaming\r\nlevel: high", "git_filepath": "", "sigma_text_keyword": "title: Renamed Powershell.exe\r\nstatus: experimental\r\ndescription: Detects copying and renaming of powershell.exe before execution (RETEFE malware DOC/macro starting Sept 2018)\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1086/\r\n- https://isc.sans.edu/forums/diary/Maldoc+Duplicating+PowerShell+Prior+to+Use/24254/\r\ntags:\r\n- attack.t1086\r\n- attack.execution\r\nauthor: Tom Ueltschi (@c_APT_ure), Roman Ranskyi\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection0:\r\n    EventID: 1\r\n    Description: Windows PowerShell\r\n  selection1:\r\n    EventID: 1\r\n    Description: Windows PowerShell ISE\r\n  exclusion_1:\r\n    Image:\r\n    - powershell.exe\r\n    - powershell_ise.exe\r\n  condition: (selection0 or selection1) and not exclusion_1\r\nfalsepositives:\r\n- penetration tests, red teaming\r\nlevel: high"}, "A53knmUBtApo-eN_sOfM": {"category": 15, "updated": "2019-02-26T14:54:19.000Z", "hash": "ebcb6a52631eaf0217c25239acedc3f3993c6d7ecbe501e0ff84ccea9614105c", "title": "UAC Bypass via sdclt", "permission_id": 3, "title_keyword": "UAC Bypass via sdclt", "released": "2017-03-19T18:34:06.000Z", "sigma_text": "title: UAC Bypass via sdclt\r\nstatus: experimental\r\ndescription: Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\r\nreferences:\r\n- https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/\r\nauthor: Omer Yampel\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_uac_bypass_sdclt.yml", "sigma_text_keyword": "title: UAC Bypass via sdclt\r\nstatus: experimental\r\ndescription: Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\r\nreferences:\r\n- https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/\r\nauthor: Omer Yampel\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 13\r\n    TargetObject: HKEY_USERS\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.t1088\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "vp3knmUBtApo-eN_r-ZX": {"category": 13, "updated": "2018-08-31T16:18:59.000Z", "hash": "476df58e23ad12f31c12b536b02c1e5e09329d0a3c19fbbc608b9bab13d64e6b", "title": "Rare Scheduled Task Creations", "permission_id": 3, "title_keyword": "Rare Scheduled Task Creations", "released": "2017-03-17T07:41:27.000Z", "sigma_text": "title: Rare Scheduled Task Creations\nstatus: experimental\ndescription: This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names. \ntags:\n    - attack.t1053\n    - attack.s0111\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: taskscheduler\ndetection:\n    selection:\n        EventID: 106\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5 \nfalsepositives:\n    - Software installation\nlevel: low\n", "git_filepath": "/windows/other/win_rare_schtask_creation.yml", "sigma_text_keyword": "title: Rare Scheduled Task Creations\nstatus: experimental\ndescription: This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names. \ntags:\n    - attack.t1053\n    - attack.s0111\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: taskscheduler\ndetection:\n    selection:\n        EventID: 106\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5 \nfalsepositives:\n    - Software installation\nlevel: low\n"}, "OSUPX2cBqjf_D59HNr6h": {"category": 8, "updated": "2019-01-02T14:45:39.000Z", "hash": "6a2e747fce11f6eccea868bb1dea8ba55f4f7b9238e0a8b710915145a60b54e5", "title": "HWorm and NjRAT Rat/Backdoor (Sysmon).", "permission_id": 3, "title_keyword": "HWorm and NjRAT Rat/Backdoor (Sysmon).", "released": "2018-11-29T10:41:31.000Z", "sigma_text": "title: HWorm and NjRAT Rat/Backdoor (Sysmon).\r\ndescription: HWorm and NjRAT Rat/Backdoor Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.trendmicro.com/trendlabs-security-intelligence/autoit-compiled-worm-affecting-removable-media-delivers-fileless-version-of-bladabindi-njrat-backdoor/\r\n- http://malwarenailed.blogspot.com/2017/05/revisiting-hworm-and-njrat.html\r\n- https://www.fidelissecurity.com/sites/default/files/TA_Fidelis_H-W0rm_1611.pdf\r\n- https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html\r\ndate: 2018/11/27\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 00df326eee18617fae2fdd3684ac1546\r\n    - 1488cdc5c5c9c87b4e0dae27ba3511cb\r\n    - 4543daa6936dde54dda8782b89d5daf1\r\n    - 80b1f909d1217313c14ea6d4d0b003dc\r\n    - 81c153256efd9161f4d89fe5fd7015bc\r\n    - c6b53fc46427527a0739e6b6443ef72d\r\n    - 9e273220eb71f849ea99b923cbc1fae3\r\n    - 43309710ab8f87dc5d9842a5bca85f80\r\n    - a40faab2f3f546aeb29aaefcb0f751d8\r\n    - 617a128b44671ac88df0b7180d9d0135\r\n    - ae5c8ad09954a56f348a3b72ed824363\r\n    - da3e2eeffd78d8c5ef472b8a09e9d325\r\n    - 0de41aef336f40a07ed6984db61b52ab\r\n    - e081a42d6e09a3fcf049a33b2ecf0412\r\n    - 361c9d44809f788b92023b762e363449\r\n    - c46a631f0bc82d8c2d46e9d8634cc50242987fa7749cac097439298d1d0c1d6e\r\n    - 25bc108a683d25a77efcac89b45f0478d9ddd281a9a2fb1f55fc6992a93aa830\r\n    - b957911d7d5865e91851ab402189ae86\r\n    - 0ab40f5c7d9151742ec29d53fb224ad8\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204", "git_filepath": "", "sigma_text_keyword": "title: HWorm and NjRAT Rat/Backdoor (Sysmon).\r\ndescription: HWorm and NjRAT Rat/Backdoor Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://blog.trendmicro.com/trendlabs-security-intelligence/autoit-compiled-worm-affecting-removable-media-delivers-fileless-version-of-bladabindi-njrat-backdoor/\r\n- http://malwarenailed.blogspot.com/2017/05/revisiting-hworm-and-njrat.html\r\n- https://www.fidelissecurity.com/sites/default/files/TA_Fidelis_H-W0rm_1611.pdf\r\n- https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html\r\ndate: 2018/11/27\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - 00df326eee18617fae2fdd3684ac1546\r\n    - 1488cdc5c5c9c87b4e0dae27ba3511cb\r\n    - 4543daa6936dde54dda8782b89d5daf1\r\n    - 80b1f909d1217313c14ea6d4d0b003dc\r\n    - 81c153256efd9161f4d89fe5fd7015bc\r\n    - c6b53fc46427527a0739e6b6443ef72d\r\n    - 9e273220eb71f849ea99b923cbc1fae3\r\n    - 43309710ab8f87dc5d9842a5bca85f80\r\n    - a40faab2f3f546aeb29aaefcb0f751d8\r\n    - 617a128b44671ac88df0b7180d9d0135\r\n    - ae5c8ad09954a56f348a3b72ed824363\r\n    - da3e2eeffd78d8c5ef472b8a09e9d325\r\n    - 0de41aef336f40a07ed6984db61b52ab\r\n    - e081a42d6e09a3fcf049a33b2ecf0412\r\n    - 361c9d44809f788b92023b762e363449\r\n    - c46a631f0bc82d8c2d46e9d8634cc50242987fa7749cac097439298d1d0c1d6e\r\n    - 25bc108a683d25a77efcac89b45f0478d9ddd281a9a2fb1f55fc6992a93aa830\r\n    - b957911d7d5865e91851ab402189ae86\r\n    - 0ab40f5c7d9151742ec29d53fb224ad8\r\n  condition: selection\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204"}, "7Z3knmUBtApo-eN_kuFQ": {"category": 2, "updated": "2018-10-23T15:51:01.000Z", "hash": "8eba4b5d71c61de32ca8c30bd5580001df3bc7a00e02b6318e3466fb0ae0cbe5", "title": "ZxShell Malware", "permission_id": 3, "title_keyword": "ZxShell Malware", "released": "2017-07-20T18:36:24.000Z", "sigma_text": "title: ZxShell Malware\r\ndescription: Detects a ZxShell start by the called and well-known function name\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\r\ntags:\r\n- attack.g0001\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Command:\r\n    - rundll32.exe *,zxFunction*\r\n    - rundll32.exe *,RemoteDiskXXXXX\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical", "git_filepath": "/apt/apt_zxshell.yml", "sigma_text_keyword": "title: ZxShell Malware\r\ndescription: Detects a ZxShell start by the called and well-known function name\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\r\ntags:\r\n- attack.g0001\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Command:\r\n    - rundll32.exe *,zxFunction*\r\n    - rundll32.exe *,RemoteDiskXXXXX\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unlikely\r\nlevel: critical"}, "dZ3knmUBtApo-eN_rebQ": {"category": 8, "updated": "2019-02-26T13:15:49.000Z", "hash": "646d0d5a282e914245ba9166fcd4dd4d0bb508855fe74bf0c9bcf8bcc2d9d196", "title": "Detection MavInject32.exe (Microsoft Corp Signed) execution", "permission_id": 3, "title_keyword": "Detection MavInject32.exe (Microsoft Corp Signed) execution", "released": "2018-05-23T11:59:13.000Z", "sigma_text": "title: Detection MavInject32.exe (Microsoft Corp Signed) execution\r\ndescription: This rule detects execution and usage MavInject32.exe (Microsoft Corp Signed) that allows to load any dll in a running process.\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\cmd.exe'\r\n    Image:\r\n    - C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\MavInject32.exe\r\n  selection2:\r\n    EventID: 1\r\n    ParentCommandLine:\r\n    - '*\\cmd.exe'\r\n    CommandLine:\r\n    - '*\\MavInject32.exe*'\r\n  keyword:\r\n  - INJECTRUNNING\r\n  condition: selection1 or (selection2 and keyword)\r\nfields:\r\n- ParentCommandLine\r\n- ParentImage\r\n- CommandLine\r\n- Image\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ndate: 2018/05/31\r\nreference:\r\n- https://twitter.com/gn3mes1s/status/941315826107510784\r\ntags:\r\n- attack.Privilege Escalation\r\n- attack.t1055\r\n- attack.t1038\r\n- attack.Defense Evasion\r\n- attack.t1055", "git_filepath": null, "sigma_text_keyword": "title: Detection MavInject32.exe (Microsoft Corp Signed) execution\r\ndescription: This rule detects execution and usage MavInject32.exe (Microsoft Corp Signed) that allows to load any dll in a running process.\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentImage:\r\n    - '*\\cmd.exe'\r\n    Image:\r\n    - C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\MavInject32.exe\r\n  selection2:\r\n    EventID: 1\r\n    ParentCommandLine:\r\n    - '*\\cmd.exe'\r\n    CommandLine:\r\n    - '*\\MavInject32.exe*'\r\n  keyword:\r\n  - INJECTRUNNING\r\n  condition: selection1 or (selection2 and keyword)\r\nfields:\r\n- ParentCommandLine\r\n- ParentImage\r\n- CommandLine\r\n- Image\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ndate: 2018/05/31\r\nreference:\r\n- https://twitter.com/gn3mes1s/status/941315826107510784\r\ntags:\r\n- attack.Privilege Escalation\r\n- attack.t1055\r\n- attack.t1038\r\n- attack.Defense Evasion\r\n- attack.t1055"}, "PZ3knmUBtApo-eN_puUo": {"category": 15, "updated": "2019-02-26T13:58:51.000Z", "hash": "56e8e66bb416f5e8252d7f7a1449938c3575c1749097c0aef0c909576e756453", "title": "CMSTP UAC Bypass via COM Object Access", "permission_id": 3, "title_keyword": "CMSTP UAC Bypass via COM Object Access", "released": "2018-07-27T07:28:28.000Z", "sigma_text": "title: CMSTP UAC Bypass via COM Object Access\r\nstatus: stable\r\ndescription: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.execution\r\n- attack.t1088\r\n- attack.t1191\r\n- attack.g0069\r\nauthor: Nik Seetharaman\r\nreferences:\r\n- http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\r\n- https://twitter.com/hFireF0X/status/897640081053364225\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentCommandLine: '*\\DllHost.exe'\r\n  selection2:\r\n    ParentCommandLine:\r\n    - '*\\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'\r\n    - '*\\{3E000D72-A845-4CD9-BD83-80C07C3B881F}'\r\n  condition: selection1 and selection2\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- Hashes\r\nfalsepositives:\r\n- Legitimate CMSTP use (unlikely in modern enterprise environments)\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_cmstp_com_object_access.yml", "sigma_text_keyword": "title: CMSTP UAC Bypass via COM Object Access\r\nstatus: stable\r\ndescription: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects\r\ntags:\r\n- attack.defense_evasion\r\n- attack.privilege_escalation\r\n- attack.execution\r\n- attack.t1088\r\n- attack.t1191\r\n- attack.g0069\r\nauthor: Nik Seetharaman\r\nreferences:\r\n- http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\r\n- https://twitter.com/hFireF0X/status/897640081053364225\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    ParentCommandLine: '*\\DllHost.exe'\r\n  selection2:\r\n    ParentCommandLine:\r\n    - '*\\{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'\r\n    - '*\\{3E000D72-A845-4CD9-BD83-80C07C3B881F}'\r\n  condition: selection1 and selection2\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\n- Hashes\r\nfalsepositives:\r\n- Legitimate CMSTP use (unlikely in modern enterprise environments)\r\nlevel: high"}, "hJ3knmUBtApo-eN_leJ9": {"category": 15, "updated": "2018-10-24T09:39:32.000Z", "hash": "d6d9e5cdc8395db6e7a9143d05174f832fa9d38498f8489458892f5c099f5077", "title": "Webshell Detection With Command Line Keywords", "permission_id": 3, "title_keyword": "Webshell Detection With Command Line Keywords", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Webshell Detection With Command Line Keywords\r\ndescription: Detects certain command line parameters often used during reconnaissance activity via web shells\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\apache*'\r\n    - '*\\tomcat*'\r\n    - '*\\w3wp.exe'\r\n    - '*\\php-cgi.exe'\r\n    - '*\\nginx.exe'\r\n    - '*\\httpd.exe'\r\n    CommandLine:\r\n    - whoami\r\n    - net user\r\n    - ping -n\r\n    - systeminfo\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1100\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_webshell_detection.yml", "sigma_text_keyword": "title: Webshell Detection With Command Line Keywords\r\ndescription: Detects certain command line parameters often used during reconnaissance activity via web shells\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\apache*'\r\n    - '*\\tomcat*'\r\n    - '*\\w3wp.exe'\r\n    - '*\\php-cgi.exe'\r\n    - '*\\nginx.exe'\r\n    - '*\\httpd.exe'\r\n    CommandLine:\r\n    - whoami\r\n    - net user\r\n    - ping -n\r\n    - systeminfo\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1100\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "3m5qLmkBFVBAemBcN1a2": {"category": 11, "updated": "2019-02-27T10:05:06.000Z", "hash": "377f9cdd7d32fb5bf4dbe4eb7469200d62d591d3afa8967f2c4cd174000e272c", "title": "Suspicious Use of Procdump.", "permission_id": 3, "title_keyword": "Suspicious Use of Procdump.", "released": "2019-02-27T10:05:06.000Z", "sigma_text": "title: Suspicious Use of Procdump.\r\ndescription: Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.\r\nreferences:\r\n- Internal Research\r\nauthor: Florian Roth\r\ndate: 2018/10/30\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n  selection1:\r\n    ProcessCommandLine:\r\n    - '* -ma *'\r\n  selection2:\r\n    ProcessCommandLine:\r\n    - '* lsass.exe*'\r\n  condition: selection and selection1 and selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n  selection1:\r\n    CommandLine:\r\n    - '* -ma *'\r\n  selection2:\r\n    CommandLine:\r\n    - '* lsass.exe*'\r\n  condition: selection and selection1 and selection2\r\nfalsepositives:\r\n- Unlikely, because no one should dump an lsass process memory\r\n- Another tool that uses the command line switches of Procdump\r\nlevel: medium\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1036\r\n- attack.credential_access\r\n- attack.t1003", "git_filepath": "/windows/builtin/win_susp_procdump.yml", "sigma_text_keyword": "title: Suspicious Use of Procdump.\r\ndescription: Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.\r\nreferences:\r\n- Internal Research\r\nauthor: Florian Roth\r\ndate: 2018/10/30\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\r\ndetection:\r\n  selection:\r\n    EventID: 4688\r\n  selection1:\r\n    ProcessCommandLine:\r\n    - '* -ma *'\r\n  selection2:\r\n    ProcessCommandLine:\r\n    - '* lsass.exe*'\r\n  condition: selection and selection1 and selection2\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n  selection1:\r\n    CommandLine:\r\n    - '* -ma *'\r\n  selection2:\r\n    CommandLine:\r\n    - '* lsass.exe*'\r\n  condition: selection and selection1 and selection2\r\nfalsepositives:\r\n- Unlikely, because no one should dump an lsass process memory\r\n- Another tool that uses the command line switches of Procdump\r\nlevel: medium\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1036\r\n- attack.credential_access\r\n- attack.t1003"}, "l53knmUBtApo-eN_iuAM": {"category": 15, "updated": "2019-02-26T13:37:06.000Z", "hash": "1d6f342d411f38a64d6abf2c449287b24f5879fc6f8e3a443a4d77aaf6b82e62", "title": "Microsoft Binary Github Communication", "permission_id": 3, "title_keyword": "Microsoft Binary Github Communication", "released": "2017-08-24T16:27:40.000Z", "sigma_text": "title: Microsoft Binary Github Communication\r\nstatus: experimental\r\ndescription: Detects an executable in the Windows folder accessing github.com\r\nreferences:\r\n- https://twitter.com/M_haggis/status/900741347035889665\r\n- https://twitter.com/M_haggis/status/1032799638213066752\r\nauthor: Michael Haag, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationHostname:\r\n    - '*.github.com'\r\n    - '*.githubusercontent.com'\r\n    Image: C:\\Windows\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\n- '@subTee in your network'\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_win_binary_github_com.yml", "sigma_text_keyword": "title: Microsoft Binary Github Communication\r\nstatus: experimental\r\ndescription: Detects an executable in the Windows folder accessing github.com\r\nreferences:\r\n- https://twitter.com/M_haggis/status/900741347035889665\r\n- https://twitter.com/M_haggis/status/1032799638213066752\r\nauthor: Michael Haag, Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 3\r\n    DestinationHostname:\r\n    - '*.github.com'\r\n    - '*.githubusercontent.com'\r\n    Image: C:\\Windows\\*\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\n- '@subTee in your network'\r\nlevel: high"}, "453knmUBtApo-eN_i-DL": {"category": 6, "updated": "2018-10-23T16:22:28.000Z", "hash": "7a64ea073fd28818a1ef03a14ad65716d6ba76ce955d9df7f0b8e46a740a59fa", "title": "Multiple suspicious Response Codes caused by Single Client", "permission_id": 3, "title_keyword": "Multiple suspicious Response Codes caused by Single Client", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Multiple suspicious Response Codes caused by Single Client\r\ndescription: Detects possible exploitation activity or bugs in a web application\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  selection:\r\n    response:\r\n    - \"400\"\r\n    - \"401\"\r\n    - \"403\"\r\n    - \"500\"\r\n  timeframe: 10m\r\n  condition: selection | count() by clientip > 10\r\nfields:\r\n- client_ip\r\n- vhost\r\n- url\r\n- response\r\nfalsepositives:\r\n- Unstable application\r\n- Application that misuses the response codes\r\nlevel: medium", "git_filepath": "/web/web_multiple_suspicious_resp_codes_single_source.yml", "sigma_text_keyword": "title: Multiple suspicious Response Codes caused by Single Client\r\ndescription: Detects possible exploitation activity or bugs in a web application\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  selection:\r\n    response:\r\n    - \"400\"\r\n    - \"401\"\r\n    - \"403\"\r\n    - \"500\"\r\n  timeframe: 10m\r\n  condition: selection | count() by clientip > 10\r\nfields:\r\n- client_ip\r\n- vhost\r\n- url\r\n- response\r\nfalsepositives:\r\n- Unstable application\r\n- Application that misuses the response codes\r\nlevel: medium"}, "Fp3knmUBtApo-eN_n-QX": {"category": 15, "updated": "2018-10-24T13:13:23.000Z", "hash": "a5b6aced295d5b24e5e7309f0ed1add8eafee079a92902a309d397b2d9702b91", "title": "WMI Persistence - Command Line Event Consumer", "permission_id": 3, "title_keyword": "WMI Persistence - Command Line Event Consumer", "released": "2018-03-07T22:05:10.000Z", "sigma_text": "title: WMI Persistence - Command Line Event Consumer\r\nstatus: experimental\r\ndescription: Detects WMI command line event consumers\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nauthor: Thomas Patzke\r\ndate: 2018/03/07\r\ntags:\r\n- attack.t1084\r\n- attack.persistence\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"7\"\r\n    Image: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\r\n    ImageLoaded: wbemcons.dll\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_wmi_persistence_commandline_event_consumer.yml", "sigma_text_keyword": "title: WMI Persistence - Command Line Event Consumer\r\nstatus: experimental\r\ndescription: Detects WMI command line event consumers\r\nreferences:\r\n- https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\r\nauthor: Thomas Patzke\r\ndate: 2018/03/07\r\ntags:\r\n- attack.t1084\r\n- attack.persistence\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"7\"\r\n    Image: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\r\n    ImageLoaded: wbemcons.dll\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown (data set is too small; further testing needed)\r\nlevel: high"}, "riXvOmcBqjf_D59HPZUI": {"category": 8, "updated": "2019-01-02T15:14:38.000Z", "hash": "22b82cfad8708bcaaf0d9c5d5a537e0f963c672c16aaa554d2c596f4c5c395ea", "title": "Detecting Gamaredon Group's C&C servers IP addresses (Firewall)", "permission_id": 3, "title_keyword": "Detecting Gamaredon Group's C&C servers IP addresses (Firewall)", "released": "2018-11-22T10:20:16.000Z", "sigma_text": "title: Detecting Gamaredon Group's C&C servers IP addresses (Firewall)\r\ndescription: This rule detects network connections to compromised IPs related with Gamaredon Group activity (Firewall - IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  selection1:\r\n    src_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection2:\r\n    dst_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  condition: selection1 or selection2\r\nfields:\r\n- source.ip\r\n- destination.ip\r\nfalsepositives:\r\n- Clean URLs related to mentioned IPs.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071", "git_filepath": "", "sigma_text_keyword": "title: Detecting Gamaredon Group's C&C servers IP addresses (Firewall)\r\ndescription: This rule detects network connections to compromised IPs related with Gamaredon Group activity (Firewall - IP)\r\nauthor: Eugene Nechiporenko, SOC Prime\r\nreferences:\r\n- https://twitter.com/ClearskySec/status/1065267790943268865\r\n- https://twitter.com/DrunkBinary/status/1059454646220218368\r\n- https://researchcenter.paloaltonetworks.com/2017/02/unit-42-title-gamaredon-group-toolset-evolution/\r\n- https://cert.gov.ua/news/42\r\n- https://cert.gov.ua/news/46\r\ndate: 2018/11/22\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  selection1:\r\n    src_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  selection2:\r\n    dst_ip:\r\n    - 95.142.45.86\r\n    - 95.142.45.58\r\n    - 95.142.45.57\r\n    - 95.142.45.48\r\n    - 95.142.45.44\r\n    - 95.142.45.185\r\n    - 95.142.45.142\r\n    - 95.142.45.13\r\n    - 95.142.45.118\r\n    - 94.130.217.187\r\n    - 80.211.167.231\r\n    - 5.23.55.212\r\n    - 46.148.20.31\r\n    - 185.231.155.12\r\n    - 185.231.154.25\r\n    - 185.231.154.154\r\n    - 185.158.115.137\r\n  condition: selection1 or selection2\r\nfields:\r\n- source.ip\r\n- destination.ip\r\nfalsepositives:\r\n- Clean URLs related to mentioned IPs.\r\nlevel: high\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071"}, "xZ3knmUBtApo-eN_neN4": {"category": 15, "updated": "2019-02-26T14:55:53.000Z", "hash": "db4c46845d5f6966b48cc31f914f8bcb32ec650da76ccb0f965075c4c4b97c55", "title": "Activity Related to NTDS.dit Domain Hash Retrieval", "permission_id": 3, "title_keyword": "Activity Related to NTDS.dit Domain Hash Retrieval", "released": "2017-03-16T23:23:55.000Z", "sigma_text": "title: Activity Related to NTDS.dit Domain Hash Retrieval\r\nstatus: experimental\r\ndescription: Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely\r\nauthor: Florian Roth, Michael Haag\r\nreferences:\r\n- https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\r\n- https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/\r\n- https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/\r\n- https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - vssadmin.exe Delete Shadows\r\n    - 'vssadmin create shadow /for=C:'\r\n    - copy \\\\?\\GLOBALROOT\\Device\\\\*\\windows\\ntds\\ntds.dit\r\n    - copy \\\\?\\GLOBALROOT\\Device\\\\*\\config\\SAM\r\n    - 'vssadmin delete shadows /for=C:'\r\n    - 'reg SAVE HKLM\\SYSTEM '\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_vssadmin_ntds_activity.yml", "sigma_text_keyword": "title: Activity Related to NTDS.dit Domain Hash Retrieval\r\nstatus: experimental\r\ndescription: Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely\r\nauthor: Florian Roth, Michael Haag\r\nreferences:\r\n- https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\r\n- https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/\r\n- https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/\r\n- https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    CommandLine:\r\n    - vssadmin.exe Delete Shadows\r\n    - 'vssadmin create shadow /for=C:'\r\n    - copy \\\\?\\GLOBALROOT\\Device\\\\*\\windows\\ntds\\ntds.dit\r\n    - copy \\\\?\\GLOBALROOT\\Device\\\\*\\config\\SAM\r\n    - 'vssadmin delete shadows /for=C:'\r\n    - 'reg SAVE HKLM\\SYSTEM '\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.credential_access\r\n- attack.t1003\r\nfalsepositives:\r\n- Administrative activity\r\nlevel: high"}, "-iUAUGcBqjf_D59HwaJT": {"category": 8, "updated": "2019-01-03T10:33:21.000Z", "hash": "0f35657439ad0f2f3d90188d11d5152ee5b51af76a356a5b7405b9b3825b85b5", "title": "Ryuk Ransomware (Sysmon).", "permission_id": 3, "title_keyword": "Ryuk Ransomware (Sysmon).", "released": "2018-11-26T13:43:42.000Z", "sigma_text": "title: Ryuk Ransomware (Sysmon).\r\ndescription: Ryuk Ransomware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/\r\n- https://otx.alienvault.com/pulse/5b7b53caac373e795cccd7d0\r\n- https://otx.alienvault.com/pulse/5b7c1550ac373e4716155955\r\n- https://any.run/report/965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26/6e9f7068-0a96-466d-8bbf-78259fcdc177\r\n- https://app.any.run/tasks/b135f551-ca2f-4d3f-a0cc-3b6d37d07b8f\r\n- https://twitter.com/petrovic082/status/1080741550857031680\r\ndate: 2019/01/03\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - c0202cf6aeab8437c638533d14563d35\r\n    - d348f536e214a47655af387408b4fca5\r\n    - 958c594909933d4c82e93c22850194aa\r\n    - 86c314bc2dc37ba84f7364acd5108c2b\r\n    - 29340643ca2e6677c19e1d3bf351d654\r\n    - cb0c1248d3899358a375888bb4e8f3fe\r\n    - 1354ac0d5be0c8d03f4e3aba78d2223e\r\n    - 5ac0f050f93f86e69026faea1fbb4450\r\n    - 965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26\r\n    - b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d\r\n    - 795db7bdad1befdd3ad942be79715f6b0c5083d859901b81657b590c9628790f\r\n  selection2:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*REG ADD \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"svchos\" /t REG_SZ /d \"C:\\Users\\admin\\AppData\\Local\\*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- Hashes\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.Defense Evasion\r\n- attack.t1112", "git_filepath": "", "sigma_text_keyword": "title: Ryuk Ransomware (Sysmon).\r\ndescription: Ryuk Ransomware Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/\r\n- https://otx.alienvault.com/pulse/5b7b53caac373e795cccd7d0\r\n- https://otx.alienvault.com/pulse/5b7c1550ac373e4716155955\r\n- https://any.run/report/965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26/6e9f7068-0a96-466d-8bbf-78259fcdc177\r\n- https://app.any.run/tasks/b135f551-ca2f-4d3f-a0cc-3b6d37d07b8f\r\n- https://twitter.com/petrovic082/status/1080741550857031680\r\ndate: 2019/01/03\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - c0202cf6aeab8437c638533d14563d35\r\n    - d348f536e214a47655af387408b4fca5\r\n    - 958c594909933d4c82e93c22850194aa\r\n    - 86c314bc2dc37ba84f7364acd5108c2b\r\n    - 29340643ca2e6677c19e1d3bf351d654\r\n    - cb0c1248d3899358a375888bb4e8f3fe\r\n    - 1354ac0d5be0c8d03f4e3aba78d2223e\r\n    - 5ac0f050f93f86e69026faea1fbb4450\r\n    - 965884f19026913b2c57b8cd4a86455a61383de01dabb69c557f45bb848f6c26\r\n    - b8fcd4a3902064907fb19e0da3ca7aed72a7e6d1f94d971d1ee7a4d3af6a800d\r\n    - 795db7bdad1befdd3ad942be79715f6b0c5083d859901b81657b590c9628790f\r\n  selection2:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - '*REG ADD \"HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"svchos\" /t REG_SZ /d \"C:\\Users\\admin\\AppData\\Local\\*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- Hashes\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.Defense Evasion\r\n- attack.t1112"}, "s53knmUBtApo-eN_luKs": {"category": 3, "updated": "2019-02-26T15:36:26.000Z", "hash": "4e48c186b32cc56a179334af9f0581cf0e84855546a2ce293ec497f2b7d3168a", "title": "Suspicious Activity in Shell Commands", "permission_id": 3, "title_keyword": "Suspicious Activity in Shell Commands", "released": "2017-03-25T18:59:45.000Z", "sigma_text": "title: Suspicious Activity in Shell Commands\r\ndescription: Detects suspicious shell commands used in various exploit codes (see references)\r\nreferences:\r\n- http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html\r\n- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121\r\n- http://pastebin.com/FtygZ1cg\r\n- https://artkond.com/2017/03/23/pivoting-guide/\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - wget * - http* | perl\r\n  - wget * - http* | sh\r\n  - wget * - http* | bash\r\n  - python -m SimpleHTTPServer\r\n  - import pty; pty.spawn\r\n  - '*wget *; chmod +x*'\r\n  - '*wget *; chmod 777 *'\r\n  - '*cd /tmp || cd /var/run || cd /mnt*'\r\n  - stop;service iptables stop;\r\n  - stop;SuSEfirewall2 stop;\r\n  - chmod 777 2020\r\n  - '\">>/etc/rc.local;'\r\n  - wget -c *;chmod 777\r\n  - base64 -d /tmp/\r\n  - ' | base64 -d'\r\n  - /bin/chmod u+s\r\n  - chmod +s /tmp/\r\n  - chmod u+s /tmp/\r\n  - /tmp/haxhax\r\n  - /tmp/ns_sploit\r\n  - 'nc -l -p '\r\n  - 'cp /bin/ksh '\r\n  - 'cp /bin/sh '\r\n  - ' /tmp/*.b64 '\r\n  - /tmp/ysocereal.jar\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/linux/lnx_shell_susp_commands.yml", "sigma_text_keyword": "title: Suspicious Activity in Shell Commands\r\ndescription: Detects suspicious shell commands used in various exploit codes (see references)\r\nreferences:\r\n- http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html\r\n- https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121\r\n- http://pastebin.com/FtygZ1cg\r\n- https://artkond.com/2017/03/23/pivoting-guide/\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: linux\r\ndetection:\r\n  keywords:\r\n  - wget * - http* | perl\r\n  - wget * - http* | sh\r\n  - wget * - http* | bash\r\n  - python -m SimpleHTTPServer\r\n  - import pty; pty.spawn\r\n  - '*wget *; chmod +x*'\r\n  - '*wget *; chmod 777 *'\r\n  - '*cd /tmp || cd /var/run || cd /mnt*'\r\n  - stop;service iptables stop;\r\n  - stop;SuSEfirewall2 stop;\r\n  - chmod 777 2020\r\n  - '\">>/etc/rc.local;'\r\n  - wget -c *;chmod 777\r\n  - base64 -d /tmp/\r\n  - ' | base64 -d'\r\n  - /bin/chmod u+s\r\n  - chmod +s /tmp/\r\n  - chmod u+s /tmp/\r\n  - /tmp/haxhax\r\n  - /tmp/ns_sploit\r\n  - 'nc -l -p '\r\n  - 'cp /bin/ksh '\r\n  - 'cp /bin/sh '\r\n  - ' /tmp/*.b64 '\r\n  - /tmp/ysocereal.jar\r\n  condition: keywords\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "-W5ECmkBFVBAemBcsTta": {"category": 15, "updated": "2019-02-20T09:37:47.000Z", "hash": "95e0d6a8b0bcf30005812418bb60dc0ddf9339a369775d041b83f72796e7abb1", "title": "MSHTA spwaned by SVCHOST as seen in LethalHTA", "permission_id": 3, "title_keyword": "MSHTA spwaned by SVCHOST as seen in LethalHTA", "released": "2019-02-20T09:37:47.000Z", "sigma_text": "title: MSHTA spwaned by SVCHOST as seen in LethalHTA\r\nstatus: experimental\r\ndescription: Detects MSHTA.EXE spwaned by SVCHOST described in report\r\nreferences:\r\n- https://codewhitesec.blogspot.com/2018/07/lethalhta.html\r\nauthor: Markus Neis\r\ndate: 2018/06/07\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage: '*\\svchost.exe'\r\n    Image: '*\\mshta.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_lethalhta.yml", "sigma_text_keyword": "title: MSHTA spwaned by SVCHOST as seen in LethalHTA\r\nstatus: experimental\r\ndescription: Detects MSHTA.EXE spwaned by SVCHOST described in report\r\nreferences:\r\n- https://codewhitesec.blogspot.com/2018/07/lethalhta.html\r\nauthor: Markus Neis\r\ndate: 2018/06/07\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    ParentImage: '*\\svchost.exe'\r\n    Image: '*\\mshta.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: high"}, "HJ3knmUBtApo-eN_q-Z8": {"category": 11, "updated": "2019-02-26T15:22:14.000Z", "hash": "342757ae4f36947d3d7336d35121c0b4d081cf20392d6a98999a5b3e8b7d951b", "title": "DHCP Server Error Failed Loading the CallOut DLL", "permission_id": 3, "title_keyword": "DHCP Server Error Failed Loading the CallOut DLL", "released": "2017-05-15T18:58:31.000Z", "sigma_text": "title: DHCP Server Error Failed Loading the CallOut DLL\r\ndescription: This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded\r\nstatus: experimental\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 1031\r\n    - 1032\r\n    - 1034\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical", "git_filepath": "/windows/builtin/win_susp_dhcp_config_failed.yml", "sigma_text_keyword": "title: DHCP Server Error Failed Loading the CallOut DLL\r\ndescription: This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded\r\nstatus: experimental\r\nreferences:\r\n- https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\r\n- https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\r\n- https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\r\ndate: 2017/05/15\r\nauthor: Dimitrios Slamaris\r\nlogsource:\r\n  product: windows\r\n  service: system\r\ndetection:\r\n  selection:\r\n    EventID:\r\n    - 1031\r\n    - 1032\r\n    - 1034\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: critical"}, "y26cFGkBFVBAemBc0USF": {"category": 11, "updated": "2019-02-22T09:50:15.000Z", "hash": "3e3a14cc918620f25c3883be6b42cfc7969992054e8262d96a3df2fa9ff802e6", "title": "Access to ADMIN$ Share.", "permission_id": 3, "title_keyword": "Access to ADMIN$ Share.", "released": "2019-02-22T09:50:15.000Z", "sigma_text": "title: Access to ADMIN$ Share.\r\ndescription: Detects access to $ADMIN share.\r\nstatus: experimental\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: The advanced audit policy setting \"Object Access > Audit File Share\" must be configured for Success/Failure\r\ndetection:\r\n  selection:\r\n    EventID: 5140\r\n    ShareName: Admin$\r\n  filter:\r\n    SubjectUserName: '*$'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Legitimate administrative activity.\r\nlevel: low\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1077", "git_filepath": "/windows/builtin/win_admin_share_access.yml", "sigma_text_keyword": "title: Access to ADMIN$ Share.\r\ndescription: Detects access to $ADMIN share.\r\nstatus: experimental\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: security\r\n  definition: The advanced audit policy setting \"Object Access > Audit File Share\" must be configured for Success/Failure\r\ndetection:\r\n  selection:\r\n    EventID: 5140\r\n    ShareName: Admin$\r\n  filter:\r\n    SubjectUserName: '*$'\r\n  condition: selection and not filter\r\nfalsepositives:\r\n- Legitimate administrative activity.\r\nlevel: low\r\ntags:\r\n- attack.lateral_movement\r\n- attack.t1077"}, "RG59D2kBFVBAemBct0Dp": {"category": 15, "updated": "2019-02-21T09:58:47.000Z", "hash": "f0cfedabefa25296ee51ceba673590c1dab43171aaee37e0ecf6a17f69d40bbf", "title": "Suspicious Parent of Csc.exe", "permission_id": 3, "title_keyword": "Suspicious Parent of Csc.exe", "released": "2019-02-21T09:58:47.000Z", "sigma_text": "title: Suspicious Parent of Csc.exe\r\ndescription: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/SBousseaden/status/1094924091256176641\r\nauthor: Florian Roth\r\ndate: 2019/02/11\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1036\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\csc.exe*'\r\n    ParentImage:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\mshta.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_csc.yml", "sigma_text_keyword": "title: Suspicious Parent of Csc.exe\r\ndescription: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery\r\nstatus: experimental\r\nreferences:\r\n- https://twitter.com/SBousseaden/status/1094924091256176641\r\nauthor: Florian Roth\r\ndate: 2019/02/11\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1036\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 1\r\n    Image: '*\\csc.exe*'\r\n    ParentImage:\r\n    - '*\\wscript.exe'\r\n    - '*\\cscript.exe'\r\n    - '*\\mshta.exe'\r\n  condition: selection\r\nfalsepositives:\r\n- Unkown\r\nlevel: high"}, "aZ3knmUBtApo-eN_ieAX": {"category": 11, "updated": "2019-02-26T15:23:01.000Z", "hash": "0f979920399f8f6add8dda03f4e8da2279e541a0f7e417e5c4c842616a9cafd0", "title": "Suspicious Kerberos RC4 Ticket Encryption", "permission_id": 3, "title_keyword": "Suspicious Kerberos RC4 Ticket Encryption", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Suspicious Kerberos RC4 Ticket Encryption\r\nstatus: experimental\r\nreferences:\r\n- https://adsecurity.org/?p=3458\r\n- https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\r\ntags:\r\n- attack.credential_access\r\n- attack.t1208\r\ndescription: Detects service ticket requests using RC4 encryption type\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4769\r\n    FailureCode: \"0x0\"\r\n    TicketOptions: \"0x40810000\"\r\n    TicketEncryptionType: \"0x17\"\r\n  reduction:\r\n    ServiceName:\r\n    - $*\r\n    - krbtgt\r\n    AccountName: $@*\r\n  condition: selection and not reduction\r\nfalsepositives:\r\n- Service accounts used on legacy systems (e.g. NetApp)\r\n- Windows Domains with DFL 2003 and legacy systems\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_rc4_kerberos.yml", "sigma_text_keyword": "title: Suspicious Kerberos RC4 Ticket Encryption\r\nstatus: experimental\r\nreferences:\r\n- https://adsecurity.org/?p=3458\r\n- https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\r\ntags:\r\n- attack.credential_access\r\n- attack.t1208\r\ndescription: Detects service ticket requests using RC4 encryption type\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection:\r\n    EventID: 4769\r\n    FailureCode: \"0x0\"\r\n    TicketOptions: \"0x40810000\"\r\n    TicketEncryptionType: \"0x17\"\r\n  reduction:\r\n    ServiceName:\r\n    - $*\r\n    - krbtgt\r\n    AccountName: $@*\r\n  condition: selection and not reduction\r\nfalsepositives:\r\n- Service accounts used on legacy systems (e.g. NetApp)\r\n- Windows Domains with DFL 2003 and legacy systems\r\nlevel: medium"}, "eJ3knmUBtApo-eN_oeSo": {"category": 6, "updated": "2019-02-26T14:04:12.000Z", "hash": "14f6141afbe7a98649f59f17cfd9115d854ce8ece5bc692691e8b37dc071abec", "title": "Webshell Detection by Keyword", "permission_id": 3, "title_keyword": "Webshell Detection by Keyword", "released": "2017-02-10T18:17:02.000Z", "sigma_text": "title: Webshell Detection by Keyword\r\ndescription: Detects webshells that use GET requests by keyword sarches in URL strings\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  keywords:\r\n  - =whoami\r\n  - =net%20user\r\n  - =cmd%20/c%20\r\n  condition: keywords\r\nfields:\r\n- client_ip\r\n- vhost\r\n- url\r\n- response\r\nfalsepositives:\r\n- Web sites like wikis with articles on os commands and pages that include the os commands in the URLs\r\n- User searches in search boxes of the respective website\r\nlevel: high", "git_filepath": "/web/web_webshell_keyword.yml", "sigma_text_keyword": "title: Webshell Detection by Keyword\r\ndescription: Detects webshells that use GET requests by keyword sarches in URL strings\r\nauthor: Florian Roth\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  keywords:\r\n  - =whoami\r\n  - =net%20user\r\n  - =cmd%20/c%20\r\n  condition: keywords\r\nfields:\r\n- client_ip\r\n- vhost\r\n- url\r\n- response\r\nfalsepositives:\r\n- Web sites like wikis with articles on os commands and pages that include the os commands in the URLs\r\n- User searches in search boxes of the respective website\r\nlevel: high"}, "W53knmUBtApo-eN_oOT8": {"category": 8, "updated": "2018-10-26T16:01:25.000Z", "hash": "a734dbb98603f56bad0f073ec46bd3538e7d34ca80da40237f889e243abe721f", "title": "OrangeWorm C2 Communication", "permission_id": 3, "title_keyword": "OrangeWorm C2 Communication", "released": "2018-04-26T09:25:12.000Z", "sigma_text": "title: OrangeWorm C2 Communication\r\ndescription: OrangeWorm C2 Communication detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\r\nstatus: testing\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 65.116.107.24\r\n    - 13.44.61.126\r\n    - 56.28.111.63\r\n    - 118.71.138.69\r\n    - 117.32.65.101\r\n    - 18.25.62.70\r\n    - 92.137.43.17\r\n    - 33.25.72.21\r\n    - 16.48.37.37\r\n    - 91.29.51.11\r\n  incoming:\r\n    src_ip:\r\n    - 65.116.107.24\r\n    - 13.44.61.126\r\n    - 56.28.111.63\r\n    - 118.71.138.69\r\n    - 117.32.65.101\r\n    - 18.25.62.70\r\n    - 92.137.43.17\r\n    - 33.25.72.21\r\n    - 16.48.37.37\r\n    - 91.29.51.11\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: OrangeWorm C2 Communication\r\ndescription: OrangeWorm C2 Communication detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\r\nstatus: testing\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 65.116.107.24\r\n    - 13.44.61.126\r\n    - 56.28.111.63\r\n    - 118.71.138.69\r\n    - 117.32.65.101\r\n    - 18.25.62.70\r\n    - 92.137.43.17\r\n    - 33.25.72.21\r\n    - 16.48.37.37\r\n    - 91.29.51.11\r\n  incoming:\r\n    src_ip:\r\n    - 65.116.107.24\r\n    - 13.44.61.126\r\n    - 56.28.111.63\r\n    - 118.71.138.69\r\n    - 117.32.65.101\r\n    - 18.25.62.70\r\n    - 92.137.43.17\r\n    - 33.25.72.21\r\n    - 16.48.37.37\r\n    - 91.29.51.11\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "hZ3knmUBtApo-eN_nOMf": {"category": 11, "updated": "2019-02-26T13:42:09.000Z", "hash": "6de516ee66ad7a45b042da49b73cd4b8881f60d0f72d571555e1cd21a4afae2f", "title": "Backup Catalog Deleted", "permission_id": 3, "title_keyword": "Backup Catalog Deleted", "released": "2017-05-12T21:00:56.000Z", "sigma_text": "title: Backup Catalog Deleted\r\nstatus: experimental\r\ndescription: Detects backup catalog deletions\r\nreferences:\r\n- https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\r\nauthor: Florian Roth, Tom U. @c_APT_ure\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1107\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  selection:\r\n    EventID: 524\r\n    Source: Backup\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium", "git_filepath": "/windows/builtin/win_susp_backup_delete.yml", "sigma_text_keyword": "title: Backup Catalog Deleted\r\nstatus: experimental\r\ndescription: Detects backup catalog deletions\r\nreferences:\r\n- https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\r\nauthor: Florian Roth, Tom U. @c_APT_ure\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1107\r\nlogsource:\r\n  product: windows\r\n  service: application\r\ndetection:\r\n  selection:\r\n    EventID: 524\r\n    Source: Backup\r\n  condition: selection\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium"}, "Jp3knmUBtApo-eN_jeGt": {"category": 12, "updated": "2019-02-26T13:30:35.000Z", "hash": "2c21f3771e5979ce98665bf0edea4635dd9fc5b88613a21765fc936c4bbad032", "title": "WannaCry Ransomware via Sysmon", "permission_id": 3, "title_keyword": "WannaCry Ransomware via Sysmon", "released": "2017-06-28T07:08:53.000Z", "sigma_text": "title: WannaCry Ransomware via Sysmon\r\nstatus: experimental\r\ndescription: Detects WannaCry ransomware activity via Sysmon. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\r\nauthor: Florian Roth, Tom U. @c_APT_ure\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\@WanaDecryptor@*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n    - '*@Please_Read_Me@.txt*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Diskpart.exe usage to manage partitions on the local hard drive\r\nlevel: critical", "git_filepath": "/windows/malware/sysmon_malware_wannacry.yml", "sigma_text_keyword": "title: WannaCry Ransomware via Sysmon\r\nstatus: experimental\r\ndescription: Detects WannaCry ransomware activity via Sysmon. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\r\nauthor: Florian Roth, Tom U. @c_APT_ure\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\tasksche.exe'\r\n    - '*\\mssecsvc.exe'\r\n    - '*\\taskdl.exe'\r\n    - '*\\@WanaDecryptor@*'\r\n    - '*\\taskhsvc.exe'\r\n    - '*\\taskse.exe'\r\n    - '*\\111.exe'\r\n    - '*\\lhdfrgui.exe'\r\n    - '*\\diskpart.exe'\r\n    - '*\\linuxnew.exe'\r\n    - '*\\wannacry.exe'\r\n  selection2:\r\n    EventID: 1\r\n    CommandLine:\r\n    - '*vssadmin delete shadows*'\r\n    - '*icacls * /grant Everyone:F /T /C /Q*'\r\n    - '*bcdedit /set {default} recoveryenabled no*'\r\n    - '*wbadmin delete catalog -quiet*'\r\n    - '*@Please_Read_Me@.txt*'\r\n  condition: selection1 or selection2\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- Diskpart.exe usage to manage partitions on the local hard drive\r\nlevel: critical"}, "M25iCmkBFVBAemBcjDyO": {"category": 15, "updated": "2019-02-20T10:19:39.000Z", "hash": "ad4c3ddff327cc6630000dbc9da52fb0aa41d001d6b934e3c8840d85be18383e", "title": "PowerShell Rundll32 Remote Thread Creation", "permission_id": 3, "title_keyword": "PowerShell Rundll32 Remote Thread Creation", "released": "2019-02-20T10:10:24.000Z", "sigma_text": "title: PowerShell Rundll32 Remote Thread Creation\r\nstatus: experimental\r\ndescription: Detects PowerShell remote thread creation in Rundll32.exe\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html\r\ndate: 2018/06/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 8\r\n    SourceImage: '*\\powershell.exe'\r\n    TargetImage: '*\\rundll32.exe'\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1085\r\n- attack.t1086\r\nfalsepositives:\r\n- Unkown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_powershell_rundll32.yml", "sigma_text_keyword": "title: PowerShell Rundll32 Remote Thread Creation\r\nstatus: experimental\r\ndescription: Detects PowerShell remote thread creation in Rundll32.exe\r\nauthor: Florian Roth\r\nreferences:\r\n- https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html\r\ndate: 2018/06/25\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: 8\r\n    SourceImage: '*\\powershell.exe'\r\n    TargetImage: '*\\rundll32.exe'\r\n  condition: selection\r\ntags:\r\n- attack.defense_evasion\r\n- attack.execution\r\n- attack.t1085\r\n- attack.t1086\r\nfalsepositives:\r\n- Unkown\r\nlevel: high"}, "uG7qD2kBFVBAemBcRUB8": {"category": 11, "updated": "2019-02-26T12:11:20.000Z", "hash": "1a22ae52f46961053768919d84da0eed03888930934b46853b55ec2b6e88d92b", "title": "Possible SPN Enumeration.", "permission_id": 3, "title_keyword": "Possible SPN Enumeration.", "released": "2019-02-21T13:26:41.000Z", "sigma_text": "title: Possible SPN Enumeration.\r\ndescription: Detects Service Principal Name Enumeration used for Kerberoasting\r\nreferences:\r\n- https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation\r\nstatus: experimental\r\nauthor: Markus Neis\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/11/14\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\setspn.exe'\r\n  selection2:\r\n    EventID: 1\r\n    Description: '*Query or reset the computer* SPN attribute*'\r\n  cmd:\r\n    EventID: 1\r\n    CommandLine: '*-q*'\r\n  condition: (selection1 or selection2) and cmd\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\setspn.exe'\r\n  selection2:\r\n    EventID: 1\r\n    Description: '*Query or reset the computer* SPN attribute*'\r\n  cmd:\r\n    EventID: 1\r\n    ProcessCommandLine: '*-q*'\r\n  condition: (selection1 or selection2) and cmd\r\nfalsepositives:\r\n- Administrator Activity\r\nlevel: medium\r\ntags:\r\n- attack.credential_access\r\n- attack.t1208", "git_filepath": "/windows/builtin/win_spn_enum.yml", "sigma_text_keyword": "title: Possible SPN Enumeration.\r\ndescription: Detects Service Principal Name Enumeration used for Kerberoasting\r\nreferences:\r\n- https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation\r\nstatus: experimental\r\nauthor: Markus Neis\r\nmodify: Alexandr Yampolskyi, SOC Prime\r\ndate: 2018/11/14\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\setspn.exe'\r\n  selection2:\r\n    EventID: 1\r\n    Description: '*Query or reset the computer* SPN attribute*'\r\n  cmd:\r\n    EventID: 1\r\n    CommandLine: '*-q*'\r\n  condition: (selection1 or selection2) and cmd\r\n---\r\nlogsource:\r\n  product: windows\r\n  service: security\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image: '*\\setspn.exe'\r\n  selection2:\r\n    EventID: 1\r\n    Description: '*Query or reset the computer* SPN attribute*'\r\n  cmd:\r\n    EventID: 1\r\n    ProcessCommandLine: '*-q*'\r\n  condition: (selection1 or selection2) and cmd\r\nfalsepositives:\r\n- Administrator Activity\r\nlevel: medium\r\ntags:\r\n- attack.credential_access\r\n- attack.t1208"}, "LG0to2gBFVBAemBcB91h": {"category": 8, "updated": "2019-01-31T09:11:03.000Z", "hash": "a7b9f44129cc6df726be5e1f26d37f559ca43fae4396e3f5753725c3843009c3", "title": "Logon Scripts (UserInitMprLogonScript)", "permission_id": 3, "title_keyword": "Logon Scripts (UserInitMprLogonScript)", "released": "2019-01-31T09:11:03.000Z", "sigma_text": "title: Logon Scripts (UserInitMprLogonScript)\r\nstatus: experimental\r\ndescription: Detects creation or execution of UserInitMprLogonScript persistence method\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1037/\r\ntags:\r\n- attack.t1037\r\n- attack.persistence\r\n- attack.lateral_movement\r\nauthor: Tom Ueltschi (@c_APT_ure)\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  exec_selection:\r\n    EventID: 1\r\n    ParentImage: userinit.exe\r\n  exec_exclusion:\r\n    Image: explorer.exe\r\n    CommandLine: netlogon.bat\r\n  create_selection:\r\n    EventID:\r\n    - 1\r\n    - 11\r\n    - 12\r\n    - 13\r\n    - 14\r\n  create_keywords:\r\n  - UserInitMprLogonScript\r\n  condition: (exec_selection and not exec_exclusion) or (create_selection and create_keywords)\r\nfalsepositives:\r\n- exclude legitimate logon scripts\r\n- penetration tests, red teaming\r\nlevel: high", "git_filepath": "", "sigma_text_keyword": "title: Logon Scripts (UserInitMprLogonScript)\r\nstatus: experimental\r\ndescription: Detects creation or execution of UserInitMprLogonScript persistence method\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1037/\r\ntags:\r\n- attack.t1037\r\n- attack.persistence\r\n- attack.lateral_movement\r\nauthor: Tom Ueltschi (@c_APT_ure)\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  exec_selection:\r\n    EventID: 1\r\n    ParentImage: userinit.exe\r\n  exec_exclusion:\r\n    Image: explorer.exe\r\n    CommandLine: netlogon.bat\r\n  create_selection:\r\n    EventID:\r\n    - 1\r\n    - 11\r\n    - 12\r\n    - 13\r\n    - 14\r\n  create_keywords:\r\n  - UserInitMprLogonScript\r\n  condition: (exec_selection and not exec_exclusion) or (create_selection and create_keywords)\r\nfalsepositives:\r\n- exclude legitimate logon scripts\r\n- penetration tests, red teaming\r\nlevel: high"}, "yJ3knmUBtApo-eN_l-Jb": {"category": 8, "updated": "2019-02-05T18:05:40.000Z", "hash": "42d604de70882c96ffb18dab62fbffcf9981bd5e9231da7efaf6153c7aec1498", "title": "LokiBot Trojan Detector (Sysmon).", "permission_id": 3, "title_keyword": "LokiBot Trojan Detector (Sysmon).", "released": "2018-06-08T08:49:25.000Z", "sigma_text": "title: LokiBot Trojan Detector (Sysmon).\r\ndescription: LokiBot Trojan Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html\r\n- https://exchange.xforce.ibmcloud.com/botnet/lokibot\r\n- https://malwarebreakdown.com/2018/04/01/malspam-delivers-loki-bot/\r\n- https://twitter.com/pollo290987/status/1073250445404094464\r\n- https://twitter.com/pollo290987/status/1074693229700898816\r\n- https://twitter.com/pollo290987/status/1072245210556579845\r\n- https://twitter.com/pollo290987/status/1075452219305193472\r\n- https://twitter.com/pollo290987/status/1077280688259416070\r\n- https://twitter.com/pollo290987/status/1077992939270389760\r\n- https://twitter.com/pancak3lullz/status/1083020769305808897\r\n- https://app.any.run/tasks/8faf8635-dcc5-4827-a838-f3b66d3bd05c\r\n- https://app.any.run/tasks/df44e5cb-5a4f-4d56-9602-a3a67989d9ec\r\n- https://app.any.run/tasks/9bcf20d1-ed11-4403-ac7e-cbb3b800a75c\r\n- https://twitter.com/pancak3lullz/status/1092536733093253121\r\ndate: 2019/02/04\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    CommandLine:\r\n    - GET /bobby/\r\n    - POST /bobby/Panel/\r\n  selection2:\r\n    EventID: 1\r\n    file_hash:\r\n    - 3C4BE617FDA78DA05B38F4EE52121E99\r\n    - 7FB5A88768D7ECE242DBD4B30EDEFF0C\r\n    - 14A4DFFE0105A7DEF2A1EFF32899A9AC\r\n    - E69245E9685CB204105E69C424F304CC\r\n    - 75CCD03BB4934490A9F599A15381F43D\r\n    - 68BEFE15006189CE8215371935F8E720\r\n    - 05869152534B238D25051F7718FDB382\r\n    - 3DFA31D85482009479FEAFD5AF7E818A\r\n    - f9b5535bffd5c0525cb1e59bf79f06d925448b12f106fe1e972473fab4f082fa\r\n    - 4bf2658e0f69865c977cabd24b8dccca38ffc09a17b3367e5f702d2993cf00f7\r\n    - ed5550d3047903d3e09363f90b6d49f519d1484af4e528fd95f1e5f3e5a008b2\r\n    - 5b1b12f580dcc0219e88887cbe5af7f2\r\n    - 51c86d4fe87f490e4da5e8035645e548\r\n    - c94d4d0a893a786d51e4acbb66c3cd29\r\n    - 007b3818d95f328376d73f3714c49154\r\n    - D3E758016C147B5035E20D22E6888E6F\r\n    - 09ef7c56d36365fd24d45660c3246a0a\r\n    - 42844D8957C46DD47EFFEC1C54273EFC\r\n    - D4BBE7685E53F6B788F65268BEA485C3\r\n    - B18F0AD651B48B3DEC184B4F95BFCAE3\r\n  selection3:\r\n    EventID: 11\r\n    TargetObject:\r\n    - '*F63AAA'\r\n  condition: selection1 or selection2 or selection3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: LokiBot Trojan Detector (Sysmon).\r\ndescription: LokiBot Trojan Detector.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences:\r\n- https://www.threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html\r\n- https://exchange.xforce.ibmcloud.com/botnet/lokibot\r\n- https://malwarebreakdown.com/2018/04/01/malspam-delivers-loki-bot/\r\n- https://twitter.com/pollo290987/status/1073250445404094464\r\n- https://twitter.com/pollo290987/status/1074693229700898816\r\n- https://twitter.com/pollo290987/status/1072245210556579845\r\n- https://twitter.com/pollo290987/status/1075452219305193472\r\n- https://twitter.com/pollo290987/status/1077280688259416070\r\n- https://twitter.com/pollo290987/status/1077992939270389760\r\n- https://twitter.com/pancak3lullz/status/1083020769305808897\r\n- https://app.any.run/tasks/8faf8635-dcc5-4827-a838-f3b66d3bd05c\r\n- https://app.any.run/tasks/df44e5cb-5a4f-4d56-9602-a3a67989d9ec\r\n- https://app.any.run/tasks/9bcf20d1-ed11-4403-ac7e-cbb3b800a75c\r\n- https://twitter.com/pancak3lullz/status/1092536733093253121\r\ndate: 2019/02/04\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    CommandLine:\r\n    - GET /bobby/\r\n    - POST /bobby/Panel/\r\n  selection2:\r\n    EventID: 1\r\n    file_hash:\r\n    - 3C4BE617FDA78DA05B38F4EE52121E99\r\n    - 7FB5A88768D7ECE242DBD4B30EDEFF0C\r\n    - 14A4DFFE0105A7DEF2A1EFF32899A9AC\r\n    - E69245E9685CB204105E69C424F304CC\r\n    - 75CCD03BB4934490A9F599A15381F43D\r\n    - 68BEFE15006189CE8215371935F8E720\r\n    - 05869152534B238D25051F7718FDB382\r\n    - 3DFA31D85482009479FEAFD5AF7E818A\r\n    - f9b5535bffd5c0525cb1e59bf79f06d925448b12f106fe1e972473fab4f082fa\r\n    - 4bf2658e0f69865c977cabd24b8dccca38ffc09a17b3367e5f702d2993cf00f7\r\n    - ed5550d3047903d3e09363f90b6d49f519d1484af4e528fd95f1e5f3e5a008b2\r\n    - 5b1b12f580dcc0219e88887cbe5af7f2\r\n    - 51c86d4fe87f490e4da5e8035645e548\r\n    - c94d4d0a893a786d51e4acbb66c3cd29\r\n    - 007b3818d95f328376d73f3714c49154\r\n    - D3E758016C147B5035E20D22E6888E6F\r\n    - 09ef7c56d36365fd24d45660c3246a0a\r\n    - 42844D8957C46DD47EFFEC1C54273EFC\r\n    - D4BBE7685E53F6B788F65268BEA485C3\r\n    - B18F0AD651B48B3DEC184B4F95BFCAE3\r\n  selection3:\r\n    EventID: 11\r\n    TargetObject:\r\n    - '*F63AAA'\r\n  condition: selection1 or selection2 or selection3\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "SJ3knmUBtApo-eN_puVr": {"category": 15, "updated": "2019-02-12T14:54:04.000Z", "hash": "c94f43cb5681767da8fc107ac2ed7c5ba38bee3a259cc58dd280ecb0f247749b", "title": "SquiblyTwo", "permission_id": 3, "title_keyword": "SquiblyTwo", "released": "2018-04-18T14:53:11.000Z", "sigma_text": "title: SquiblyTwo\r\nstatus: experimental\r\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash\r\nreferences:\r\n- https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\r\n- https://twitter.com/mattifestation/status/986280382042595328\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1047\r\nauthor: Markus Neis / Florian Roth\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wmic.exe'\r\n    CommandLine:\r\n    - wmic * *format:\\\"http*\r\n    - wmic * /format:'http\r\n    - wmic * /format:http*\r\n  selection2:\r\n    EventID: 1\r\n    Imphash:\r\n    - 1B1A3F43BF37B5BFE60751F2EE2F326E\r\n    - 37777A96245A3C74EB217308F3546F4C\r\n    - 9D87C9D67CE724033C0B40CC4CA1B206\r\n    CommandLine:\r\n    - '* *format:\\\"http*'\r\n    - '* /format:''http'\r\n    - '* /format:http*'\r\n  condition: selection1 or selection2", "git_filepath": "/windows/sysmon/sysmon_bypass_squiblytwo.yml", "sigma_text_keyword": "title: SquiblyTwo\r\nstatus: experimental\r\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash\r\nreferences:\r\n- https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\r\n- https://twitter.com/mattifestation/status/986280382042595328\r\ntags:\r\n- attack.defense_evasion\r\n- attack.t1047\r\nauthor: Markus Neis / Florian Roth\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection1:\r\n    EventID: 1\r\n    Image:\r\n    - '*\\wmic.exe'\r\n    CommandLine:\r\n    - wmic * *format:\\\"http*\r\n    - wmic * /format:'http\r\n    - wmic * /format:http*\r\n  selection2:\r\n    EventID: 1\r\n    Imphash:\r\n    - 1B1A3F43BF37B5BFE60751F2EE2F326E\r\n    - 37777A96245A3C74EB217308F3546F4C\r\n    - 9D87C9D67CE724033C0B40CC4CA1B206\r\n    CommandLine:\r\n    - '* *format:\\\"http*'\r\n    - '* /format:''http'\r\n    - '* /format:http*'\r\n  condition: selection1 or selection2"}, "yZ3knmUBtApo-eN_hd9k": {"category": 8, "updated": "2018-10-26T14:44:28.000Z", "hash": "a098727a149239d37022267a84cab3c014790171ca044ff9677bfa62c15f6226", "title": "Default PowerSploit Schtasks Persistence (Sysmon).", "permission_id": 3, "title_keyword": "Default PowerSploit Schtasks Persistence (Sysmon).", "released": "2018-09-07T12:34:27.000Z", "sigma_text": "title: Default PowerSploit Schtasks Persistence (Sysmon).\r\ndescription: Detects the creation of a schtask via PowerSploit Default Configuration.\r\nreferences:\r\n- https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1\r\nauthor: Markus Neis, Alexandr Yampolskyi\r\ndate: 2018/03/06\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*ONLOGON*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*DAILY*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*ONIDLE*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*HOURLY*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Possible, depends on organisation and processes.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Default PowerSploit Schtasks Persistence (Sysmon).\r\ndescription: Detects the creation of a schtask via PowerSploit Default Configuration.\r\nreferences:\r\n- https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1\r\nauthor: Markus Neis, Alexandr Yampolskyi\r\ndate: 2018/03/06\r\nstatus: experimental\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - powershell.exe\r\n    CommandLine:\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*ONLOGON*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*DAILY*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*ONIDLE*'\r\n    - '*\\schtasks.exe*/Create*/RU*system*/SC*HOURLY*'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- CommandLine\r\nfalsepositives:\r\n- Possible, depends on organisation and processes.\r\nlevel: medium\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}, "_J3knmUBtApo-eN_quWP": {"category": 8, "updated": "2018-10-23T12:21:27.000Z", "hash": "e625ebf4a842b4d492ad7105f16481746af1387b948fd7dd6759466d718b9529", "title": "Oracle WebLogic Exploit", "permission_id": 3, "title_keyword": "Oracle WebLogic Exploit", "released": "2018-07-23T08:21:57.000Z", "sigma_text": "title: Oracle WebLogic Exploit\r\ndescription: Detects access to a webshell droped into a keytore folder on the WebLogic server\r\nauthor: Florian Roth\r\ndate: 2018/07/22\r\nstatus: experimental\r\nreferences:\r\n- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\r\n- https://twitter.com/pyn3rd/status/1020620932967223296\r\n- https://github.com/LandGrey/CVE-2018-2894\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  selection:\r\n    c-uri-path: '*/config/keystore/*.jsp'\r\n  condition: selection\r\nfields:\r\n- c-ip\r\n- c-dns\r\nfalsepositives:\r\n- Unknown\r\ntags:\r\n- attack.t1100\r\n- attack.web_shell\r\n- attack.t1190\r\n- attack.initial_access\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- cve.2018-2894\r\nlevel: critical", "git_filepath": null, "sigma_text_keyword": "title: Oracle WebLogic Exploit\r\ndescription: Detects access to a webshell droped into a keytore folder on the WebLogic server\r\nauthor: Florian Roth\r\ndate: 2018/07/22\r\nstatus: experimental\r\nreferences:\r\n- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\r\n- https://twitter.com/pyn3rd/status/1020620932967223296\r\n- https://github.com/LandGrey/CVE-2018-2894\r\nlogsource:\r\n  category: webserver\r\ndetection:\r\n  selection:\r\n    c-uri-path: '*/config/keystore/*.jsp'\r\n  condition: selection\r\nfields:\r\n- c-ip\r\n- c-dns\r\nfalsepositives:\r\n- Unknown\r\ntags:\r\n- attack.t1100\r\n- attack.web_shell\r\n- attack.t1190\r\n- attack.initial_access\r\n- attack.persistence\r\n- attack.privilege_escalation\r\n- cve.2018-2894\r\nlevel: critical"}, "X53knmUBtApo-eN_iODk": {"category": 14, "updated": "2018-10-26T16:40:48.000Z", "hash": "16ab1580d1c230e7bc284811ec77353c321fda11be65e712bb88717fa1a2192e", "title": "Suspicious PowerShell Download", "permission_id": 3, "title_keyword": "Suspicious PowerShell Download", "released": "2017-03-05T14:01:51.000Z", "sigma_text": "title: Suspicious PowerShell Download\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell download command\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keywords:\r\n  - System.Net.WebClient).DownloadString(\r\n  - system.net.webclient).downloadfile(\r\n  condition: keywords\r\nfalsepositives:\r\n- PowerShell scripts that download content from the Internet\r\nlevel: medium", "git_filepath": "/windows/powershell/powershell_suspicious_download.yml", "sigma_text_keyword": "title: Suspicious PowerShell Download\r\nstatus: experimental\r\ndescription: Detects suspicious PowerShell download command\r\ntags:\r\n- attack.execution\r\n- attack.t1086\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: powershell\r\ndetection:\r\n  keywords:\r\n  - System.Net.WebClient).DownloadString(\r\n  - system.net.webclient).downloadfile(\r\n  condition: keywords\r\nfalsepositives:\r\n- PowerShell scripts that download content from the Internet\r\nlevel: medium"}, "zZ3knmUBtApo-eN_o-S4": {"category": 15, "updated": "2018-10-25T13:32:36.000Z", "hash": "cf5036f93c779c3168dbd18fc4d5d39d54361f4e5e3cda781943e7bc69f1d96c", "title": "Command Line Execution with suspicious URL and AppData Strings", "permission_id": 3, "title_keyword": "Command Line Execution with suspicious URL and AppData Strings", "released": "2017-04-03T08:41:10.000Z", "sigma_text": "title: Command Line Execution with suspicious URL and AppData Strings\r\nstatus: experimental\r\ndescription: Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100\r\n- https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - cmd.exe /c *http://*%AppData%\r\n    - cmd.exe /c *https://*%AppData%\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- High\r\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_susp_cmd_http_appdata.yml", "sigma_text_keyword": "title: Command Line Execution with suspicious URL and AppData Strings\r\nstatus: experimental\r\ndescription: Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)\r\nreferences:\r\n- https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100\r\n- https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    CommandLine:\r\n    - cmd.exe /c *http://*%AppData%\r\n    - cmd.exe /c *https://*%AppData%\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\nfalsepositives:\r\n- High\r\nlevel: medium"}, "9W1LDmgBFVBAemBcoGj4": {"category": 8, "updated": "2019-01-11T09:41:44.000Z", "hash": "f769d183e54c30d5fc1f9f64f0688e9f5ef0626e24919ea8fb33e7465246af45", "title": "Turla Backdoor (Sysmon).", "permission_id": 3, "title_keyword": "Turla Backdoor (Sysmon).", "released": "2019-01-02T11:33:48.000Z", "sigma_text": "title: Turla Backdoor (Sysmon).\r\ndescription: Turla Backdoor Detector.\r\nauthor: Dmitriy Dyakon, SOC Prime\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/915590893155098629\r\n- https://www.ncsc.gov.uk/content/files/protected_files/article_files/Turla%20group%20using%20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1.pdf\r\n- https://twitter.com/DrunkBinary/status/1079524850039967745\r\ndate: 2018/01/02\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_hashes:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - fd898c5a4cd57c3e9cef41f6fd4f71a7\r\n    - 9dab3dd7b7e7f4980397da908fbc9ff7\r\n    - 3eb5f44492ce1147790450d950954a52\r\n  condition: selection_hashes\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.T1064\r\n- attack.T1100\r\n- attack.Command and Control", "git_filepath": "", "sigma_text_keyword": "title: Turla Backdoor (Sysmon).\r\ndescription: Turla Backdoor Detector.\r\nauthor: Dmitriy Dyakon, SOC Prime\r\nreferences:\r\n- https://twitter.com/JohnLaTwC/status/915590893155098629\r\n- https://www.ncsc.gov.uk/content/files/protected_files/article_files/Turla%20group%20using%20Neuron%20and%20Nautilus%20tools%20alongside%20Snake%20malware_1.pdf\r\n- https://twitter.com/DrunkBinary/status/1079524850039967745\r\ndate: 2018/01/02\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection_hashes:\r\n    EventID: \"1\"\r\n    file_hash:\r\n    - fd898c5a4cd57c3e9cef41f6fd4f71a7\r\n    - 9dab3dd7b7e7f4980397da908fbc9ff7\r\n    - 3eb5f44492ce1147790450d950954a52\r\n  condition: selection_hashes\r\nfields:\r\n- Hashes\r\nfalsepositives:\r\n- Unknown.\r\nlevel: high\r\ntags:\r\n- attack.T1064\r\n- attack.T1100\r\n- attack.Command and Control"}, "853knmUBtApo-eN_quVh": {"category": 15, "updated": "2018-10-24T12:07:39.000Z", "hash": "89f60799c11cb8c690a5cfb9a11a80e3e31be3edceffa9f3f07973980f8b0537", "title": "DNS ServerLevelPluginDll Install", "permission_id": 3, "title_keyword": "DNS ServerLevelPluginDll Install", "released": "2017-05-08T11:39:50.000Z", "sigma_text": "title: DNS ServerLevelPluginDll Install\r\nstatus: experimental\r\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required). Modified by SOC Prime, replaced condition \"1 of them\" with \"selection and keyword\"\r\nreferences:\r\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\r\ndate: 2017/05/08\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  dnsadmin:\r\n    EventID: \"1\"\r\n    CommandLine: dnscmd.exe /config /serverlevelplugindll *\r\n  dnsregmod:\r\n    EventID: \"13\"\r\n    TargetObject: '*\\services\\DNS\\Parameters\\ServerLevelPluginDll'\r\n  condition: dnsadmin or dnsregmod\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- Image\r\n- User\r\n- TargetObject\r\nfalsepositives:\r\n- unknown\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_dns_serverlevelplugindll.yml", "sigma_text_keyword": "title: DNS ServerLevelPluginDll Install\r\nstatus: experimental\r\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required). Modified by SOC Prime, replaced condition \"1 of them\" with \"selection and keyword\"\r\nreferences:\r\n- https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\r\ndate: 2017/05/08\r\nauthor: Florian Roth\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  dnsadmin:\r\n    EventID: \"1\"\r\n    CommandLine: dnscmd.exe /config /serverlevelplugindll *\r\n  dnsregmod:\r\n    EventID: \"13\"\r\n    TargetObject: '*\\services\\DNS\\Parameters\\ServerLevelPluginDll'\r\n  condition: dnsadmin or dnsregmod\r\nfields:\r\n- EventID\r\n- CommandLine\r\n- ParentCommandLine\r\n- Image\r\n- User\r\n- TargetObject\r\nfalsepositives:\r\n- unknown\r\nlevel: high"}, "6Z3knmUBtApo-eN_nuMz": {"category": 15, "updated": "2018-10-25T13:34:17.000Z", "hash": "577f232efa4a19f11c1a2b35845b990af96135236e0e8f13608af76cd55ec666", "title": "Shells Spawned by Web Servers", "permission_id": 3, "title_keyword": "Shells Spawned by Web Servers", "released": "2017-02-12T14:50:39.000Z", "sigma_text": "title: Shells Spawned by Web Servers\r\nstatus: experimental\r\ndescription: Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\w3wp.exe'\r\n    - '*\\httpd.exe'\r\n    - '*\\nginx.exe'\r\n    - '*\\php-cgi.exe'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\powershell.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1100\r\nfalsepositives:\r\n- Particular web applications may spawn a shell process legitimately\r\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_webshell_spawn.yml", "sigma_text_keyword": "title: Shells Spawned by Web Servers\r\nstatus: experimental\r\ndescription: Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack\r\nauthor: Thomas Patzke\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    ParentImage:\r\n    - '*\\w3wp.exe'\r\n    - '*\\httpd.exe'\r\n    - '*\\nginx.exe'\r\n    - '*\\php-cgi.exe'\r\n    Image:\r\n    - '*\\cmd.exe'\r\n    - '*\\sh.exe'\r\n    - '*\\bash.exe'\r\n    - '*\\powershell.exe'\r\n  condition: selection\r\nfields:\r\n- CommandLine\r\n- ParentCommandLine\r\ntags:\r\n- attack.privilege_escalation\r\n- attack.persistence\r\n- attack.t1100\r\nfalsepositives:\r\n- Particular web applications may spawn a shell process legitimately\r\nlevel: high"}, "Ep3knmUBtApo-eN_q-ZG": {"category": 8, "updated": "2018-10-26T15:52:41.000Z", "hash": "0d67db6339f74bc3e3a4dbf1e84012d3cf90c62d319c9602b330b4df9462aeba", "title": "Locky Ransomware C2/Download/Payment Communication.", "permission_id": 3, "title_keyword": "Locky Ransomware C2/Download/Payment Communication.", "released": "2018-05-10T06:23:36.000Z", "sigma_text": "title: Locky Ransomware C2/Download/Payment Communication.\r\ndescription: Locky Ransomware C2/Download/Payment Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://malwarebreakdown.com/tag/locky/\r\ndate: 2017/01/14\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 115.29.247.219\r\n    - 211.149.241.201\r\n    - 176.114.0.20\r\n    - 162.144.211.154\r\n    - 202.133.118.222\r\n    - 194.28.49.140\r\n    - 216.110.144.152\r\n    - 209.126.99.6\r\n    - 193.201.225.124\r\n    - 176.121.14.95\r\n    - 138.128.171.35\r\n    - 178.62.242.179\r\n    - 92.53.120.233\r\n    - 200.7.102.105\r\n    - 188.127.239.53\r\n    - 62.75.162.77\r\n    - 218.232.104.232\r\n    - 210.196.232.211\r\n    - 104.27.149.238\r\n    - 37.59.51.53\r\n    - 211.40.221.90\r\n    - 207.45.186.214\r\n    - 122.114.99.100\r\n    - 97.74.215.147\r\n    - 212.85.104.64\r\n    - 89.149.4.195\r\n    - 123.30.181.207\r\n    - 37.187.143.115\r\n    - 212.23.79.123\r\n    - 195.228.152.23\r\n    - 188.94.74.76\r\n    - 172.246.156.150\r\n    - 180.71.58.101\r\n    - 119.29.99.214\r\n    - 208.56.45.17\r\n    - 203.98.84.123\r\n    - 211.149.250.179\r\n    - 120.39.243.225\r\n    - 202.125.36.106\r\n    - 85.13.128.34\r\n    - 107.180.51.106\r\n    - 103.63.26.159\r\n    - 119.29.9.237\r\n    - 216.249.101.162\r\n    - 31.202.128.199\r\n    - 162.144.116.161\r\n    - 222.124.206.41\r\n    - 199.101.51.76\r\n    - 107.180.1.210\r\n    - 116.255.193.108\r\n    - 91.142.90.46\r\n    - 95.211.144.65\r\n    - 185.87.184.130\r\n    - 120.25.161.125\r\n    - 94.231.77.230\r\n    - 185.25.149.13\r\n    - 139.224.165.195\r\n    - 69.195.129.70\r\n    - 93.185.104.25\r\n    - 37.153.89.141\r\n    - 108.163.209.27\r\n    - 194.1.239.152\r\n    - 51.255.107.20\r\n    - 194.28.87.26\r\n    - 185.17.41.83\r\n    - 176.103.56.119\r\n    - 109.234.35.230\r\n    - 192.186.241.104\r\n    - 108.168.206.100\r\n    - 208.100.26.234\r\n  incoming:\r\n    src_ip:\r\n    - 115.29.247.219\r\n    - 211.149.241.201\r\n    - 176.114.0.20\r\n    - 162.144.211.154\r\n    - 202.133.118.222\r\n    - 194.28.49.140\r\n    - 216.110.144.152\r\n    - 209.126.99.6\r\n    - 193.201.225.124\r\n    - 176.121.14.95\r\n    - 138.128.171.35\r\n    - 178.62.242.179\r\n    - 92.53.120.233\r\n    - 200.7.102.105\r\n    - 188.127.239.53\r\n    - 62.75.162.77\r\n    - 218.232.104.232\r\n    - 210.196.232.211\r\n    - 104.27.149.238\r\n    - 37.59.51.53\r\n    - 211.40.221.90\r\n    - 207.45.186.214\r\n    - 122.114.99.100\r\n    - 97.74.215.147\r\n    - 212.85.104.64\r\n    - 89.149.4.195\r\n    - 123.30.181.207\r\n    - 37.187.143.115\r\n    - 212.23.79.123\r\n    - 195.228.152.23\r\n    - 188.94.74.76\r\n    - 172.246.156.150\r\n    - 180.71.58.101\r\n    - 119.29.99.214\r\n    - 208.56.45.17\r\n    - 203.98.84.123\r\n    - 211.149.250.179\r\n    - 120.39.243.225\r\n    - 202.125.36.106\r\n    - 85.13.128.34\r\n    - 107.180.51.106\r\n    - 103.63.26.159\r\n    - 119.29.9.237\r\n    - 216.249.101.162\r\n    - 31.202.128.199\r\n    - 162.144.116.161\r\n    - 222.124.206.41\r\n    - 199.101.51.76\r\n    - 107.180.1.210\r\n    - 116.255.193.108\r\n    - 91.142.90.46\r\n    - 95.211.144.65\r\n    - 185.87.184.130\r\n    - 120.25.161.125\r\n    - 94.231.77.230\r\n    - 185.25.149.13\r\n    - 139.224.165.195\r\n    - 69.195.129.70\r\n    - 93.185.104.25\r\n    - 37.153.89.141\r\n    - 108.163.209.27\r\n    - 194.1.239.152\r\n    - 51.255.107.20\r\n    - 194.28.87.26\r\n    - 185.17.41.83\r\n    - 176.103.56.119\r\n    - 109.234.35.230\r\n    - 192.186.241.104\r\n    - 108.168.206.100\r\n    - 208.100.26.234\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043", "git_filepath": null, "sigma_text_keyword": "title: Locky Ransomware C2/Download/Payment Communication.\r\ndescription: Locky Ransomware C2/Download/Payment Communication Detection.\r\nauthor: Alexandr Yampolskyi, SOC Prime\r\nreferences: https://malwarebreakdown.com/tag/locky/\r\ndate: 2017/01/14\r\nstatus: stable\r\nlogsource:\r\n  product: firewall\r\ndetection:\r\n  outgoing:\r\n    dst_ip:\r\n    - 115.29.247.219\r\n    - 211.149.241.201\r\n    - 176.114.0.20\r\n    - 162.144.211.154\r\n    - 202.133.118.222\r\n    - 194.28.49.140\r\n    - 216.110.144.152\r\n    - 209.126.99.6\r\n    - 193.201.225.124\r\n    - 176.121.14.95\r\n    - 138.128.171.35\r\n    - 178.62.242.179\r\n    - 92.53.120.233\r\n    - 200.7.102.105\r\n    - 188.127.239.53\r\n    - 62.75.162.77\r\n    - 218.232.104.232\r\n    - 210.196.232.211\r\n    - 104.27.149.238\r\n    - 37.59.51.53\r\n    - 211.40.221.90\r\n    - 207.45.186.214\r\n    - 122.114.99.100\r\n    - 97.74.215.147\r\n    - 212.85.104.64\r\n    - 89.149.4.195\r\n    - 123.30.181.207\r\n    - 37.187.143.115\r\n    - 212.23.79.123\r\n    - 195.228.152.23\r\n    - 188.94.74.76\r\n    - 172.246.156.150\r\n    - 180.71.58.101\r\n    - 119.29.99.214\r\n    - 208.56.45.17\r\n    - 203.98.84.123\r\n    - 211.149.250.179\r\n    - 120.39.243.225\r\n    - 202.125.36.106\r\n    - 85.13.128.34\r\n    - 107.180.51.106\r\n    - 103.63.26.159\r\n    - 119.29.9.237\r\n    - 216.249.101.162\r\n    - 31.202.128.199\r\n    - 162.144.116.161\r\n    - 222.124.206.41\r\n    - 199.101.51.76\r\n    - 107.180.1.210\r\n    - 116.255.193.108\r\n    - 91.142.90.46\r\n    - 95.211.144.65\r\n    - 185.87.184.130\r\n    - 120.25.161.125\r\n    - 94.231.77.230\r\n    - 185.25.149.13\r\n    - 139.224.165.195\r\n    - 69.195.129.70\r\n    - 93.185.104.25\r\n    - 37.153.89.141\r\n    - 108.163.209.27\r\n    - 194.1.239.152\r\n    - 51.255.107.20\r\n    - 194.28.87.26\r\n    - 185.17.41.83\r\n    - 176.103.56.119\r\n    - 109.234.35.230\r\n    - 192.186.241.104\r\n    - 108.168.206.100\r\n    - 208.100.26.234\r\n  incoming:\r\n    src_ip:\r\n    - 115.29.247.219\r\n    - 211.149.241.201\r\n    - 176.114.0.20\r\n    - 162.144.211.154\r\n    - 202.133.118.222\r\n    - 194.28.49.140\r\n    - 216.110.144.152\r\n    - 209.126.99.6\r\n    - 193.201.225.124\r\n    - 176.121.14.95\r\n    - 138.128.171.35\r\n    - 178.62.242.179\r\n    - 92.53.120.233\r\n    - 200.7.102.105\r\n    - 188.127.239.53\r\n    - 62.75.162.77\r\n    - 218.232.104.232\r\n    - 210.196.232.211\r\n    - 104.27.149.238\r\n    - 37.59.51.53\r\n    - 211.40.221.90\r\n    - 207.45.186.214\r\n    - 122.114.99.100\r\n    - 97.74.215.147\r\n    - 212.85.104.64\r\n    - 89.149.4.195\r\n    - 123.30.181.207\r\n    - 37.187.143.115\r\n    - 212.23.79.123\r\n    - 195.228.152.23\r\n    - 188.94.74.76\r\n    - 172.246.156.150\r\n    - 180.71.58.101\r\n    - 119.29.99.214\r\n    - 208.56.45.17\r\n    - 203.98.84.123\r\n    - 211.149.250.179\r\n    - 120.39.243.225\r\n    - 202.125.36.106\r\n    - 85.13.128.34\r\n    - 107.180.51.106\r\n    - 103.63.26.159\r\n    - 119.29.9.237\r\n    - 216.249.101.162\r\n    - 31.202.128.199\r\n    - 162.144.116.161\r\n    - 222.124.206.41\r\n    - 199.101.51.76\r\n    - 107.180.1.210\r\n    - 116.255.193.108\r\n    - 91.142.90.46\r\n    - 95.211.144.65\r\n    - 185.87.184.130\r\n    - 120.25.161.125\r\n    - 94.231.77.230\r\n    - 185.25.149.13\r\n    - 139.224.165.195\r\n    - 69.195.129.70\r\n    - 93.185.104.25\r\n    - 37.153.89.141\r\n    - 108.163.209.27\r\n    - 194.1.239.152\r\n    - 51.255.107.20\r\n    - 194.28.87.26\r\n    - 185.17.41.83\r\n    - 176.103.56.119\r\n    - 109.234.35.230\r\n    - 192.186.241.104\r\n    - 108.168.206.100\r\n    - 208.100.26.234\r\n  condition: outgoing or incoming\r\nfalsepositives:\r\n- Unknown\r\nlevel: medium\r\ntags:\r\n- attack.Command and Control\r\n- attack.t1071\r\n- attack.t1043"}, "RJ3knmUBtApo-eN_rOZw": {"category": 1, "updated": "2018-10-25T09:45:33.000Z", "hash": "1770f08b30203e81bc5cfd0332a62b241747c917db00a2c694d9b5bcb0862665", "title": "Spring framework exceptions", "permission_id": 3, "title_keyword": "Spring framework exceptions", "released": "2017-08-11T22:43:10.000Z", "sigma_text": "title: Spring framework exceptions\r\ndescription: Detects suspicious Spring framework exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html\r\nlogsource:\r\n  category: application\r\n  product: spring\r\ndetection:\r\n  keywords:\r\n  - AccessDeniedException\r\n  - CsrfException\r\n  - InvalidCsrfTokenException\r\n  - MissingCsrfTokenException\r\n  - CookieTheftException\r\n  - InvalidCookieException\r\n  - RequestRejectedException\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium", "git_filepath": "/application/appframework_spring_exceptions.yml", "sigma_text_keyword": "title: Spring framework exceptions\r\ndescription: Detects suspicious Spring framework exceptions that could indicate exploitation attempts\r\nauthor: Thomas Patzke\r\nreferences:\r\n- https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html\r\nlogsource:\r\n  category: application\r\n  product: spring\r\ndetection:\r\n  keywords:\r\n  - AccessDeniedException\r\n  - CsrfException\r\n  - InvalidCsrfTokenException\r\n  - MissingCsrfTokenException\r\n  - CookieTheftException\r\n  - InvalidCookieException\r\n  - RequestRejectedException\r\n  condition: keywords\r\nfalsepositives:\r\n- Application bugs\r\n- Penetration testing\r\nlevel: medium"}, "up3knmUBtApo-eN_o-QJ": {"category": 8, "updated": "2018-10-26T14:46:24.000Z", "hash": "d3d2279837c27ecc541481f46cedd0dabf32c07bcbf5fe0e4dc6413771190864", "title": "Bitsadmin Download (Sysmon).", "permission_id": 3, "title_keyword": "Bitsadmin Download (Sysmon).", "released": "2018-09-07T12:39:18.000Z", "sigma_text": "title: Bitsadmin Download (Sysmon).\r\ndescription: Detects usage of bitsadmin downloading a file.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nreferences:\r\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\r\n- https://isc.sans.edu/diary/22264\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\bitsadmin.exe'\r\n    Command_Line:\r\n    - '*/transfer'\r\n    - '*/download'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059", "git_filepath": null, "sigma_text_keyword": "title: Bitsadmin Download (Sysmon).\r\ndescription: Detects usage of bitsadmin downloading a file.\r\nauthor: Michael Haag, Alexandr Yampolskyi\r\nreferences:\r\n- https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\r\n- https://isc.sans.edu/diary/22264\r\nstatus: stable\r\nlogsource:\r\n  product: windows\r\n  service: sysmon\r\ndetection:\r\n  selection:\r\n    EventID: \"1\"\r\n    Image:\r\n    - '*\\bitsadmin.exe'\r\n    Command_Line:\r\n    - '*/transfer'\r\n    - '*/download'\r\n  condition: selection\r\nfields:\r\n- Image\r\n- command_line\r\nfalsepositives:\r\n- Unknown\r\nlevel: high\r\ntags:\r\n- attack.Execution\r\n- attack.t1204\r\n- attack.t1059"}}